const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.DS5eee3c.js","assets/modulepreload-polyfill.B5Qt9EMX.js"])))=>i.map(i=>d[i]);
var TO=Object.defineProperty;var RO=(r,e,t)=>e in r?TO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var H=(r,e,t)=>RO(r,typeof e!="symbol"?e+"":e,t);import"./modulepreload-polyfill.B5Qt9EMX.js";function AO(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var hv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function kb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var lx={exports:{}},Ap={},cx={exports:{}},Jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iS;function IO(){if(iS)return Jt;iS=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=x&&D[x]||D["@@iterator"],typeof D=="function"?D:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,S={};function T(D,M,oe){this.props=D,this.context=M,this.refs=S,this.updater=oe||E}T.prototype.isReactComponent={},T.prototype.setState=function(D,M){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,M,"setState")},T.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function R(){}R.prototype=T.prototype;function A(D,M,oe){this.props=D,this.context=M,this.refs=S,this.updater=oe||E}var j=A.prototype=new R;j.constructor=A,N(j,T.prototype),j.isPureReactComponent=!0;var P=Array.isArray,U=Object.prototype.hasOwnProperty,B={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function Y(D,M,oe){var Ee,V={},ce=null,xe=null;if(M!=null)for(Ee in M.ref!==void 0&&(xe=M.ref),M.key!==void 0&&(ce=""+M.key),M)U.call(M,Ee)&&!$.hasOwnProperty(Ee)&&(V[Ee]=M[Ee]);var ve=arguments.length-2;if(ve===1)V.children=oe;else if(1<ve){for(var le=Array(ve),Ne=0;Ne<ve;Ne++)le[Ne]=arguments[Ne+2];V.children=le}if(D&&D.defaultProps)for(Ee in ve=D.defaultProps,ve)V[Ee]===void 0&&(V[Ee]=ve[Ee]);return{$$typeof:r,type:D,key:ce,ref:xe,props:V,_owner:B.current}}function J(D,M){return{$$typeof:r,type:D.type,key:M,ref:D.ref,props:D.props,_owner:D._owner}}function he(D){return typeof D=="object"&&D!==null&&D.$$typeof===r}function te(D){var M={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(oe){return M[oe]})}var ue=/\/+/g;function we(D,M){return typeof D=="object"&&D!==null&&D.key!=null?te(""+D.key):M.toString(36)}function ie(D,M,oe,Ee,V){var ce=typeof D;(ce==="undefined"||ce==="boolean")&&(D=null);var xe=!1;if(D===null)xe=!0;else switch(ce){case"string":case"number":xe=!0;break;case"object":switch(D.$$typeof){case r:case e:xe=!0}}if(xe)return xe=D,V=V(xe),D=Ee===""?"."+we(xe,0):Ee,P(V)?(oe="",D!=null&&(oe=D.replace(ue,"$&/")+"/"),ie(V,M,oe,"",function(Ne){return Ne})):V!=null&&(he(V)&&(V=J(V,oe+(!V.key||xe&&xe.key===V.key?"":(""+V.key).replace(ue,"$&/")+"/")+D)),M.push(V)),1;if(xe=0,Ee=Ee===""?".":Ee+":",P(D))for(var ve=0;ve<D.length;ve++){ce=D[ve];var le=Ee+we(ce,ve);xe+=ie(ce,M,oe,le,V)}else if(le=b(D),typeof le=="function")for(D=le.call(D),ve=0;!(ce=D.next()).done;)ce=ce.value,le=Ee+we(ce,ve++),xe+=ie(ce,M,oe,le,V);else if(ce==="object")throw M=String(D),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return xe}function se(D,M,oe){if(D==null)return D;var Ee=[],V=0;return ie(D,Ee,"","",function(ce){return M.call(oe,ce,V++)}),Ee}function pe(D){if(D._status===-1){var M=D._result;M=M(),M.then(function(oe){(D._status===0||D._status===-1)&&(D._status=1,D._result=oe)},function(oe){(D._status===0||D._status===-1)&&(D._status=2,D._result=oe)}),D._status===-1&&(D._status=0,D._result=M)}if(D._status===1)return D._result.default;throw D._result}var ee={current:null},G={transition:null},z={ReactCurrentDispatcher:ee,ReactCurrentBatchConfig:G,ReactCurrentOwner:B};function K(){throw Error("act(...) is not supported in production builds of React.")}return Jt.Children={map:se,forEach:function(D,M,oe){se(D,function(){M.apply(this,arguments)},oe)},count:function(D){var M=0;return se(D,function(){M++}),M},toArray:function(D){return se(D,function(M){return M})||[]},only:function(D){if(!he(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Jt.Component=T,Jt.Fragment=t,Jt.Profiler=s,Jt.PureComponent=A,Jt.StrictMode=n,Jt.Suspense=p,Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,Jt.act=K,Jt.cloneElement=function(D,M,oe){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var Ee=N({},D.props),V=D.key,ce=D.ref,xe=D._owner;if(M!=null){if(M.ref!==void 0&&(ce=M.ref,xe=B.current),M.key!==void 0&&(V=""+M.key),D.type&&D.type.defaultProps)var ve=D.type.defaultProps;for(le in M)U.call(M,le)&&!$.hasOwnProperty(le)&&(Ee[le]=M[le]===void 0&&ve!==void 0?ve[le]:M[le])}var le=arguments.length-2;if(le===1)Ee.children=oe;else if(1<le){ve=Array(le);for(var Ne=0;Ne<le;Ne++)ve[Ne]=arguments[Ne+2];Ee.children=ve}return{$$typeof:r,type:D.type,key:V,ref:ce,props:Ee,_owner:xe}},Jt.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:i,_context:D},D.Consumer=D},Jt.createElement=Y,Jt.createFactory=function(D){var M=Y.bind(null,D);return M.type=D,M},Jt.createRef=function(){return{current:null}},Jt.forwardRef=function(D){return{$$typeof:u,render:D}},Jt.isValidElement=he,Jt.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:pe}},Jt.memo=function(D,M){return{$$typeof:m,type:D,compare:M===void 0?null:M}},Jt.startTransition=function(D){var M=G.transition;G.transition={};try{D()}finally{G.transition=M}},Jt.unstable_act=K,Jt.useCallback=function(D,M){return ee.current.useCallback(D,M)},Jt.useContext=function(D){return ee.current.useContext(D)},Jt.useDebugValue=function(){},Jt.useDeferredValue=function(D){return ee.current.useDeferredValue(D)},Jt.useEffect=function(D,M){return ee.current.useEffect(D,M)},Jt.useId=function(){return ee.current.useId()},Jt.useImperativeHandle=function(D,M,oe){return ee.current.useImperativeHandle(D,M,oe)},Jt.useInsertionEffect=function(D,M){return ee.current.useInsertionEffect(D,M)},Jt.useLayoutEffect=function(D,M){return ee.current.useLayoutEffect(D,M)},Jt.useMemo=function(D,M){return ee.current.useMemo(D,M)},Jt.useReducer=function(D,M,oe){return ee.current.useReducer(D,M,oe)},Jt.useRef=function(D){return ee.current.useRef(D)},Jt.useState=function(D){return ee.current.useState(D)},Jt.useSyncExternalStore=function(D,M,oe){return ee.current.useSyncExternalStore(D,M,oe)},Jt.useTransition=function(){return ee.current.useTransition()},Jt.version="18.3.1",Jt}var aS;function Nb(){return aS||(aS=1,cx.exports=IO()),cx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lS;function PO(){if(lS)return Ap;lS=1;var r=Nb(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(u,p,m){var g,x={},b=null,E=null;m!==void 0&&(b=""+m),p.key!==void 0&&(b=""+p.key),p.ref!==void 0&&(E=p.ref);for(g in p)n.call(p,g)&&!i.hasOwnProperty(g)&&(x[g]=p[g]);if(u&&u.defaultProps)for(g in p=u.defaultProps,p)x[g]===void 0&&(x[g]=p[g]);return{$$typeof:e,type:u,key:b,ref:E,props:x,_owner:s.current}}return Ap.Fragment=t,Ap.jsx=c,Ap.jsxs=c,Ap}var cS;function FO(){return cS||(cS=1,lx.exports=PO()),lx.exports}var d=FO(),w=Nb();const nr=kb(w),Tb=AO({__proto__:null,default:nr},[w]);var pv={},ux={exports:{}},mo={},dx={exports:{}},fx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uS;function jO(){return uS||(uS=1,(function(r){function e(G,z){var K=G.length;G.push(z);e:for(;0<K;){var D=K-1>>>1,M=G[D];if(0<s(M,z))G[D]=z,G[K]=M,K=D;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var z=G[0],K=G.pop();if(K!==z){G[0]=K;e:for(var D=0,M=G.length,oe=M>>>1;D<oe;){var Ee=2*(D+1)-1,V=G[Ee],ce=Ee+1,xe=G[ce];if(0>s(V,K))ce<M&&0>s(xe,V)?(G[D]=xe,G[ce]=K,D=ce):(G[D]=V,G[Ee]=K,D=Ee);else if(ce<M&&0>s(xe,K))G[D]=xe,G[ce]=K,D=ce;else break e}}return z}function s(G,z){var K=G.sortIndex-z.sortIndex;return K!==0?K:G.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var c=Date,u=c.now();r.unstable_now=function(){return c.now()-u}}var p=[],m=[],g=1,x=null,b=3,E=!1,N=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(G){for(var z=t(m);z!==null;){if(z.callback===null)n(m);else if(z.startTime<=G)n(m),z.sortIndex=z.expirationTime,e(p,z);else break;z=t(m)}}function P(G){if(S=!1,j(G),!N)if(t(p)!==null)N=!0,pe(U);else{var z=t(m);z!==null&&ee(P,z.startTime-G)}}function U(G,z){N=!1,S&&(S=!1,R(Y),Y=-1),E=!0;var K=b;try{for(j(z),x=t(p);x!==null&&(!(x.expirationTime>z)||G&&!te());){var D=x.callback;if(typeof D=="function"){x.callback=null,b=x.priorityLevel;var M=D(x.expirationTime<=z);z=r.unstable_now(),typeof M=="function"?x.callback=M:x===t(p)&&n(p),j(z)}else n(p);x=t(p)}if(x!==null)var oe=!0;else{var Ee=t(m);Ee!==null&&ee(P,Ee.startTime-z),oe=!1}return oe}finally{x=null,b=K,E=!1}}var B=!1,$=null,Y=-1,J=5,he=-1;function te(){return!(r.unstable_now()-he<J)}function ue(){if($!==null){var G=r.unstable_now();he=G;var z=!0;try{z=$(!0,G)}finally{z?we():(B=!1,$=null)}}else B=!1}var we;if(typeof A=="function")we=function(){A(ue)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,se=ie.port2;ie.port1.onmessage=ue,we=function(){se.postMessage(null)}}else we=function(){T(ue,0)};function pe(G){$=G,B||(B=!0,we())}function ee(G,z){Y=T(function(){G(r.unstable_now())},z)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(G){G.callback=null},r.unstable_continueExecution=function(){N||E||(N=!0,pe(U))},r.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<G?Math.floor(1e3/G):5},r.unstable_getCurrentPriorityLevel=function(){return b},r.unstable_getFirstCallbackNode=function(){return t(p)},r.unstable_next=function(G){switch(b){case 1:case 2:case 3:var z=3;break;default:z=b}var K=b;b=z;try{return G()}finally{b=K}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(G,z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var K=b;b=G;try{return z()}finally{b=K}},r.unstable_scheduleCallback=function(G,z,K){var D=r.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?D+K:D):K=D,G){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=K+M,G={id:g++,callback:z,priorityLevel:G,startTime:K,expirationTime:M,sortIndex:-1},K>D?(G.sortIndex=K,e(m,G),t(p)===null&&G===t(m)&&(S?(R(Y),Y=-1):S=!0,ee(P,K-D))):(G.sortIndex=M,e(p,G),N||E||(N=!0,pe(U))),G},r.unstable_shouldYield=te,r.unstable_wrapCallback=function(G){var z=b;return function(){var K=b;b=z;try{return G.apply(this,arguments)}finally{b=K}}}})(fx)),fx}var dS;function OO(){return dS||(dS=1,dx.exports=jO()),dx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fS;function DO(){if(fS)return mo;fS=1;var r=Nb(),e=OO();function t(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(o,a){c(o,a),c(o+"Capture",a)}function c(o,a){for(s[o]=a,o=0;o<a.length;o++)n.add(a[o])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},x={};function b(o){return p.call(x,o)?!0:p.call(g,o)?!1:m.test(o)?x[o]=!0:(g[o]=!0,!1)}function E(o,a,h,v){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return v?!1:h!==null?!h.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function N(o,a,h,v){if(a===null||typeof a>"u"||E(o,a,h,v))return!0;if(v)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function S(o,a,h,v,_,k,F){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=v,this.attributeNamespace=_,this.mustUseProperty=h,this.propertyName=o,this.type=a,this.sanitizeURL=k,this.removeEmptyString=F}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){T[o]=new S(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var a=o[0];T[a]=new S(a,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){T[o]=new S(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){T[o]=new S(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){T[o]=new S(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){T[o]=new S(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){T[o]=new S(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){T[o]=new S(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){T[o]=new S(o,5,!1,o.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function A(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var a=o.replace(R,A);T[a]=new S(a,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var a=o.replace(R,A);T[a]=new S(a,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var a=o.replace(R,A);T[a]=new S(a,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){T[o]=new S(o,1,!1,o.toLowerCase(),null,!1,!1)}),T.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){T[o]=new S(o,1,!1,o.toLowerCase(),null,!0,!0)});function j(o,a,h,v){var _=T.hasOwnProperty(a)?T[a]:null;(_!==null?_.type!==0:v||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(N(a,h,_,v)&&(h=null),v||_===null?b(a)&&(h===null?o.removeAttribute(a):o.setAttribute(a,""+h)):_.mustUseProperty?o[_.propertyName]=h===null?_.type===3?!1:"":h:(a=_.attributeName,v=_.attributeNamespace,h===null?o.removeAttribute(a):(_=_.type,h=_===3||_===4&&h===!0?"":""+h,v?o.setAttributeNS(v,a,h):o.setAttribute(a,h))))}var P=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,U=Symbol.for("react.element"),B=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),he=Symbol.for("react.provider"),te=Symbol.for("react.context"),ue=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),ie=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),ee=Symbol.for("react.offscreen"),G=Symbol.iterator;function z(o){return o===null||typeof o!="object"?null:(o=G&&o[G]||o["@@iterator"],typeof o=="function"?o:null)}var K=Object.assign,D;function M(o){if(D===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);D=a&&a[1]||""}return`
`+D+o}var oe=!1;function Ee(o,a){if(!o||oe)return"";oe=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ye){var v=ye}Reflect.construct(o,[],a)}else{try{a.call()}catch(ye){v=ye}o.call(a.prototype)}else{try{throw Error()}catch(ye){v=ye}o()}}catch(ye){if(ye&&v&&typeof ye.stack=="string"){for(var _=ye.stack.split(`
`),k=v.stack.split(`
`),F=_.length-1,W=k.length-1;1<=F&&0<=W&&_[F]!==k[W];)W--;for(;1<=F&&0<=W;F--,W--)if(_[F]!==k[W]){if(F!==1||W!==1)do if(F--,W--,0>W||_[F]!==k[W]){var X=`
`+_[F].replace(" at new "," at ");return o.displayName&&X.includes("<anonymous>")&&(X=X.replace("<anonymous>",o.displayName)),X}while(1<=F&&0<=W);break}}}finally{oe=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?M(o):""}function V(o){switch(o.tag){case 5:return M(o.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return o=Ee(o.type,!1),o;case 11:return o=Ee(o.type.render,!1),o;case 1:return o=Ee(o.type,!0),o;default:return""}}function ce(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case $:return"Fragment";case B:return"Portal";case J:return"Profiler";case Y:return"StrictMode";case we:return"Suspense";case ie:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case te:return(o.displayName||"Context")+".Consumer";case he:return(o._context.displayName||"Context")+".Provider";case ue:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case se:return a=o.displayName||null,a!==null?a:ce(o.type)||"Memo";case pe:a=o._payload,o=o._init;try{return ce(o(a))}catch{}}return null}function xe(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ce(a);case 8:return a===Y?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ve(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function le(o){var a=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ne(o){var a=le(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,a),v=""+o[a];if(!o.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,k=h.set;return Object.defineProperty(o,a,{configurable:!0,get:function(){return _.call(this)},set:function(F){v=""+F,k.call(this,F)}}),Object.defineProperty(o,a,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(F){v=""+F},stopTracking:function(){o._valueTracker=null,delete o[a]}}}}function He(o){o._valueTracker||(o._valueTracker=Ne(o))}function Ue(o){if(!o)return!1;var a=o._valueTracker;if(!a)return!0;var h=a.getValue(),v="";return o&&(v=le(o)?o.checked?"true":"false":o.value),o=v,o!==h?(a.setValue(o),!0):!1}function Me(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Te(o,a){var h=a.checked;return K({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??o._wrapperState.initialChecked})}function gt(o,a){var h=a.defaultValue==null?"":a.defaultValue,v=a.checked!=null?a.checked:a.defaultChecked;h=ve(a.value!=null?a.value:h),o._wrapperState={initialChecked:v,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function jt(o,a){a=a.checked,a!=null&&j(o,"checked",a,!1)}function ot(o,a){jt(o,a);var h=ve(a.value),v=a.type;if(h!=null)v==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+h):o.value!==""+h&&(o.value=""+h);else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}a.hasOwnProperty("value")?Zt(o,a.type,h):a.hasOwnProperty("defaultValue")&&Zt(o,a.type,ve(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(o.defaultChecked=!!a.defaultChecked)}function Ut(o,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var v=a.type;if(!(v!=="submit"&&v!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+o._wrapperState.initialValue,h||a===o.value||(o.value=a),o.defaultValue=a}h=o.name,h!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,h!==""&&(o.name=h)}function Zt(o,a,h){(a!=="number"||Me(o.ownerDocument)!==o)&&(h==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+h&&(o.defaultValue=""+h))}var er=Array.isArray;function et(o,a,h,v){if(o=o.options,a){a={};for(var _=0;_<h.length;_++)a["$"+h[_]]=!0;for(h=0;h<o.length;h++)_=a.hasOwnProperty("$"+o[h].value),o[h].selected!==_&&(o[h].selected=_),_&&v&&(o[h].defaultSelected=!0)}else{for(h=""+ve(h),a=null,_=0;_<o.length;_++){if(o[_].value===h){o[_].selected=!0,v&&(o[_].defaultSelected=!0);return}a!==null||o[_].disabled||(a=o[_])}a!==null&&(a.selected=!0)}}function It(o,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return K({},a,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function hr(o,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(t(92));if(er(h)){if(1<h.length)throw Error(t(93));h=h[0]}a=h}a==null&&(a=""),h=a}o._wrapperState={initialValue:ve(h)}}function Ae(o,a){var h=ve(a.value),v=ve(a.defaultValue);h!=null&&(h=""+h,h!==o.value&&(o.value=h),a.defaultValue==null&&o.defaultValue!==h&&(o.defaultValue=h)),v!=null&&(o.defaultValue=""+v)}function Xe(o){var a=o.textContent;a===o._wrapperState.initialValue&&a!==""&&a!==null&&(o.value=a)}function pt(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tt(o,a){return o==null||o==="http://www.w3.org/1999/xhtml"?pt(a):o==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var Pt,Er=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,v,_){MSApp.execUnsafeLocalFunction(function(){return o(a,h,v,_)})}:o})(function(o,a){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=a;else{for(Pt=Pt||document.createElement("div"),Pt.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=Pt.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;a.firstChild;)o.appendChild(a.firstChild)}});function Dr(o,a){if(a){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=a;return}}o.textContent=a}var lt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kt=["Webkit","ms","Moz","O"];Object.keys(lt).forEach(function(o){kt.forEach(function(a){a=a+o.charAt(0).toUpperCase()+o.substring(1),lt[a]=lt[o]})});function de(o,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||lt.hasOwnProperty(o)&&lt[o]?(""+a).trim():a+"px"}function Ie(o,a){o=o.style;for(var h in a)if(a.hasOwnProperty(h)){var v=h.indexOf("--")===0,_=de(h,a[h],v);h==="float"&&(h="cssFloat"),v?o.setProperty(h,_):o[h]=_}}var Ge=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ut(o,a){if(a){if(Ge[o]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function Ft(o,a){if(o.indexOf("-")===-1)return typeof a.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cr=null;function ft(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Nt=null,Sr=null,as=null;function Vn(o){if(o=Mn(o)){if(typeof Nt!="function")throw Error(t(280));var a=o.stateNode;a&&(a=Fd(a),Nt(o.stateNode,o.type,a))}}function As(o){Sr?as?as.push(o):as=[o]:Sr=o}function Ji(){if(Sr){var o=Sr,a=as;if(as=Sr=null,Vn(o),a)for(o=0;o<a.length;o++)Vn(a[o])}}function Ir(o,a){return o(a)}function ls(){}var gi=!1;function Xi(o,a,h){if(gi)return o(a,h);gi=!0;try{return Ir(o,a,h)}finally{gi=!1,(Sr!==null||as!==null)&&(ls(),Ji())}}function Xs(o,a){var h=o.stateNode;if(h===null)return null;var v=Fd(h);if(v===null)return null;h=v[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(t(231,a,typeof h));return h}var bo=!1;if(u)try{var Qs={};Object.defineProperty(Qs,"passive",{get:function(){bo=!0}}),window.addEventListener("test",Qs,Qs),window.removeEventListener("test",Qs,Qs)}catch{bo=!1}function Qi(o,a,h,v,_,k,F,W,X){var ye=Array.prototype.slice.call(arguments,3);try{a.apply(h,ye)}catch(Fe){this.onError(Fe)}}var xn=!1,cs=null,Ho=!1,vi=null,Zi={onError:function(o){xn=!0,cs=o}};function Wa(o,a,h,v,_,k,F,W,X){xn=!1,cs=null,Qi.apply(Zi,arguments)}function us(o,a,h,v,_,k,F,W,X){if(Wa.apply(this,arguments),xn){if(xn){var ye=cs;xn=!1,cs=null}else throw Error(t(198));Ho||(Ho=!0,vi=ye)}}function Is(o){var a=o,h=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,(a.flags&4098)!==0&&(h=a.return),o=a.return;while(o)}return a.tag===3?h:null}function ea(o){if(o.tag===13){var a=o.memoizedState;if(a===null&&(o=o.alternate,o!==null&&(a=o.memoizedState)),a!==null)return a.dehydrated}return null}function ta(o){if(Is(o)!==o)throw Error(t(188))}function ra(o){var a=o.alternate;if(!a){if(a=Is(o),a===null)throw Error(t(188));return a!==o?null:o}for(var h=o,v=a;;){var _=h.return;if(_===null)break;var k=_.alternate;if(k===null){if(v=_.return,v!==null){h=v;continue}break}if(_.child===k.child){for(k=_.child;k;){if(k===h)return ta(_),o;if(k===v)return ta(_),a;k=k.sibling}throw Error(t(188))}if(h.return!==v.return)h=_,v=k;else{for(var F=!1,W=_.child;W;){if(W===h){F=!0,h=_,v=k;break}if(W===v){F=!0,v=_,h=k;break}W=W.sibling}if(!F){for(W=k.child;W;){if(W===h){F=!0,h=k,v=_;break}if(W===v){F=!0,v=k,h=_;break}W=W.sibling}if(!F)throw Error(t(189))}}if(h.alternate!==v)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?o:a}function na(o){return o=ra(o),o!==null?it(o):null}function it(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=it(o);if(a!==null)return a;o=o.sibling}return null}var Q=e.unstable_scheduleCallback,De=e.unstable_cancelCallback,We=e.unstable_shouldYield,xr=e.unstable_requestPaint,Dt=e.unstable_now,Pr=e.unstable_getCurrentPriorityLevel,Hr=e.unstable_ImmediatePriority,fn=e.unstable_UserBlockingPriority,wn=e.unstable_NormalPriority,yi=e.unstable_LowPriority,qr=e.unstable_IdlePriority,xi=null,qn=null;function Jc(o){if(qn&&typeof qn.onCommitFiberRoot=="function")try{qn.onCommitFiberRoot(xi,o,void 0,(o.current.flags&128)===128)}catch{}}var Ps=Math.clz32?Math.clz32:cd,ad=Math.log,ld=Math.LN2;function cd(o){return o>>>=0,o===0?32:31-(ad(o)/ld|0)|0}var sa=64,Bo=4194304;function Go(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function wi(o,a){var h=o.pendingLanes;if(h===0)return 0;var v=0,_=o.suspendedLanes,k=o.pingedLanes,F=h&268435455;if(F!==0){var W=F&~_;W!==0?v=Go(W):(k&=F,k!==0&&(v=Go(k)))}else F=h&~_,F!==0?v=Go(F):k!==0&&(v=Go(k));if(v===0)return 0;if(a!==0&&a!==v&&(a&_)===0&&(_=v&-v,k=a&-a,_>=k||_===16&&(k&4194240)!==0))return a;if((v&4)!==0&&(v|=h&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=v;0<a;)h=31-Ps(a),_=1<<h,v|=o[h],a&=~_;return v}function Xc(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mh(o,a){for(var h=o.suspendedLanes,v=o.pingedLanes,_=o.expirationTimes,k=o.pendingLanes;0<k;){var F=31-Ps(k),W=1<<F,X=_[F];X===-1?((W&h)===0||(W&v)!==0)&&(_[F]=Xc(W,a)):X<=a&&(o.expiredLanes|=W),k&=~W}}function zl(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Qc(){var o=sa;return sa<<=1,(sa&4194240)===0&&(sa=64),o}function Va(o){for(var a=[],h=0;31>h;h++)a.push(o);return a}function qa(o,a,h){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-Ps(a),o[a]=h}function ud(o,a){var h=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var v=o.eventTimes;for(o=o.expirationTimes;0<h;){var _=31-Ps(h),k=1<<_;a[_]=0,v[_]=-1,o[_]=-1,h&=~k}}function oa(o,a){var h=o.entangledLanes|=a;for(o=o.entanglements;h;){var v=31-Ps(h),_=1<<v;_&a|o[v]&a&&(o[v]|=a),h&=~_}}var sr=0;function be(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var $e,at,zt,Kt,Ht,nt=!1,Cr=[],Fs=null,ds=null,ia=null,Hl=new Map,Zc=new Map,aa=[],f0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qm(o,a){switch(o){case"focusin":case"focusout":Fs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":ia=null;break;case"pointerover":case"pointerout":Hl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zc.delete(a.pointerId)}}function Ka(o,a,h,v,_,k){return o===null||o.nativeEvent!==k?(o={blockedOn:a,domEventName:h,eventSystemFlags:v,nativeEvent:k,targetContainers:[_]},a!==null&&(a=Mn(a),a!==null&&at(a)),o):(o.eventSystemFlags|=v,a=o.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),o)}function h0(o,a,h,v,_){switch(a){case"focusin":return Fs=Ka(Fs,o,a,h,v,_),!0;case"dragenter":return ds=Ka(ds,o,a,h,v,_),!0;case"mouseover":return ia=Ka(ia,o,a,h,v,_),!0;case"pointerover":var k=_.pointerId;return Hl.set(k,Ka(Hl.get(k)||null,o,a,h,v,_)),!0;case"gotpointercapture":return k=_.pointerId,Zc.set(k,Ka(Zc.get(k)||null,o,a,h,v,_)),!0}return!1}function Zm(o){var a=Ko(o.target);if(a!==null){var h=Is(a);if(h!==null){if(a=h.tag,a===13){if(a=ea(h),a!==null){o.blockedOn=a,Ht(o.priority,function(){zt(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function dd(o){if(o.blockedOn!==null)return!1;for(var a=o.targetContainers;0<a.length;){var h=pd(o.domEventName,o.eventSystemFlags,a[0],o.nativeEvent);if(h===null){h=o.nativeEvent;var v=new h.constructor(h.type,h);cr=v,h.target.dispatchEvent(v),cr=null}else return a=Mn(h),a!==null&&at(a),o.blockedOn=h,!1;a.shift()}return!0}function eg(o,a,h){dd(o)&&h.delete(a)}function p0(){nt=!1,Fs!==null&&dd(Fs)&&(Fs=null),ds!==null&&dd(ds)&&(ds=null),ia!==null&&dd(ia)&&(ia=null),Hl.forEach(eg),Zc.forEach(eg)}function wr(o,a){o.blockedOn===a&&(o.blockedOn=null,nt||(nt=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,p0)))}function pr(o){function a(_){return wr(_,o)}if(0<Cr.length){wr(Cr[0],o);for(var h=1;h<Cr.length;h++){var v=Cr[h];v.blockedOn===o&&(v.blockedOn=null)}}for(Fs!==null&&wr(Fs,o),ds!==null&&wr(ds,o),ia!==null&&wr(ia,o),Hl.forEach(a),Zc.forEach(a),h=0;h<aa.length;h++)v=aa[h],v.blockedOn===o&&(v.blockedOn=null);for(;0<aa.length&&(h=aa[0],h.blockedOn===null);)Zm(h),h.blockedOn===null&&aa.shift()}var Bl=P.ReactCurrentBatchConfig,fd=!0;function m0(o,a,h,v){var _=sr,k=Bl.transition;Bl.transition=null;try{sr=1,gh(o,a,h,v)}finally{sr=_,Bl.transition=k}}function g0(o,a,h,v){var _=sr,k=Bl.transition;Bl.transition=null;try{sr=4,gh(o,a,h,v)}finally{sr=_,Bl.transition=k}}function gh(o,a,h,v){if(fd){var _=pd(o,a,h,v);if(_===null)Fh(o,a,v,hd,h),Qm(o,v);else if(h0(_,o,a,h,v))v.stopPropagation();else if(Qm(o,v),a&4&&-1<f0.indexOf(o)){for(;_!==null;){var k=Mn(_);if(k!==null&&$e(k),k=pd(o,a,h,v),k===null&&Fh(o,a,v,hd,h),k===_)break;_=k}_!==null&&v.stopPropagation()}else Fh(o,a,v,null,h)}}var hd=null;function pd(o,a,h,v){if(hd=null,o=ft(v),o=Ko(o),o!==null)if(a=Is(o),a===null)o=null;else if(h=a.tag,h===13){if(o=ea(a),o!==null)return o;o=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;o=null}else a!==o&&(o=null);return hd=o,null}function tg(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Pr()){case Hr:return 1;case fn:return 4;case wn:case yi:return 16;case qr:return 536870912;default:return 16}default:return 16}}var Br=null,eu=null,Wo=null;function vh(){if(Wo)return Wo;var o,a=eu,h=a.length,v,_="value"in Br?Br.value:Br.textContent,k=_.length;for(o=0;o<h&&a[o]===_[o];o++);var F=h-o;for(v=1;v<=F&&a[h-v]===_[k-v];v++);return Wo=_.slice(o,1<v?1-v:void 0)}function Gl(o){var a=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&a===13&&(o=13)):o=a,o===10&&(o=13),32<=o||o===13?o:0}function Kn(){return!0}function yh(){return!1}function fs(o){function a(h,v,_,k,F){this._reactName=h,this._targetInst=_,this.type=v,this.nativeEvent=k,this.target=F,this.currentTarget=null;for(var W in o)o.hasOwnProperty(W)&&(h=o[W],this[W]=h?h(k):k[W]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Kn:yh,this.isPropagationStopped=yh,this}return K(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Kn)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Kn)},persist:function(){},isPersistent:Kn}),a}var Ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},md=fs(Ya),Wl=K({},Ya,{view:0,detail:0}),rg=fs(Wl),Yn,xh,Dn,gd=K({},Wl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sh,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Dn&&(Dn&&o.type==="mousemove"?(Yn=o.screenX-Dn.screenX,xh=o.screenY-Dn.screenY):xh=Yn=0,Dn=o),Yn)},movementY:function(o){return"movementY"in o?o.movementY:xh}}),wh=fs(gd),la=K({},gd,{dataTransfer:0}),vd=fs(la),bh=K({},Wl,{relatedTarget:0}),Fr=fs(bh),ca=K({},Ya,{animationName:0,elapsedTime:0,pseudoElement:0}),_h=fs(ca),v0=K({},Ya,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Eh=fs(v0),y0=K({},Ya,{data:0}),ng=fs(y0),x0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vl(o){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(o):(o=yd[o])?!!a[o]:!1}function Sh(){return Vl}var og=K({},Wl,{key:function(o){if(o.key){var a=x0[o.key]||o.key;if(a!=="Unidentified")return a}return o.type==="keypress"?(o=Gl(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?sg[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sh,charCode:function(o){return o.type==="keypress"?Gl(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Gl(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),ig=fs(og),Ch=K({},gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xd=fs(Ch),ag=K({},Wl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sh}),w0=fs(ag),kh=K({},Ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nh=fs(kh),b0=K({},gd,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),lg=fs(b0),js=[9,13,27,32],tu=u&&"CompositionEvent"in window,bi=null;u&&"documentMode"in document&&(bi=document.documentMode);var cg=u&&"TextEvent"in window&&!bi,Th=u&&(!tu||bi&&8<bi&&11>=bi),ug=" ",dg=!1;function fg(o,a){switch(o){case"keyup":return js.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hg(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ql=!1;function Kl(o,a){switch(o){case"compositionend":return hg(a);case"keypress":return a.which!==32?null:(dg=!0,ug);case"textInput":return o=a.data,o===ug&&dg?null:o;default:return null}}function _0(o,a){if(ql)return o==="compositionend"||!tu&&fg(o,a)?(o=vh(),Wo=eu=Br=null,ql=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Th&&a.locale!=="ko"?null:a.data;default:return null}}var E0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wd(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a==="input"?!!E0[o.type]:a==="textarea"}function Rh(o,a,h,v){As(v),a=Rd(a,"onChange"),0<a.length&&(h=new md("onChange","change",null,h,v),o.push({event:h,listeners:a}))}var Zs=null,ua=null;function S0(o){wg(o,0)}function bd(o){var a=Mt(o);if(Ue(a))return o}function C0(o,a){if(o==="change")return a}var Ja=!1;if(u){var Os;if(u){var _d="oninput"in document;if(!_d){var pg=document.createElement("div");pg.setAttribute("oninput","return;"),_d=typeof pg.oninput=="function"}Os=_d}else Os=!1;Ja=Os&&(!document.documentMode||9<document.documentMode)}function mg(){Zs&&(Zs.detachEvent("onpropertychange",gg),ua=Zs=null)}function gg(o){if(o.propertyName==="value"&&bd(ua)){var a=[];Rh(a,ua,o,ft(o)),Xi(S0,a)}}function k0(o,a,h){o==="focusin"?(mg(),Zs=a,ua=h,Zs.attachEvent("onpropertychange",gg)):o==="focusout"&&mg()}function N0(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return bd(ua)}function Yl(o,a){if(o==="click")return bd(a)}function ne(o,a){if(o==="input"||o==="change")return bd(a)}function Se(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var ge=typeof Object.is=="function"?Object.is:Se;function Ke(o,a){if(ge(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var h=Object.keys(o),v=Object.keys(a);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var _=h[v];if(!p.call(a,_)||!ge(o[_],a[_]))return!1}return!0}function Ot(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function ur(o,a){var h=Ot(o);o=0;for(var v;h;){if(h.nodeType===3){if(v=o+h.textContent.length,o<=a&&v>=a)return{node:h,offset:a-o};o=v}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Ot(h)}}function an(o,a){return o&&a?o===a?!0:o&&o.nodeType===3?!1:a&&a.nodeType===3?an(o,a.parentNode):"contains"in o?o.contains(a):o.compareDocumentPosition?!!(o.compareDocumentPosition(a)&16):!1:!1}function kr(){for(var o=window,a=Me();a instanceof o.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)o=a.contentWindow;else break;a=Me(o.document)}return a}function ru(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a&&(a==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||a==="textarea"||o.contentEditable==="true")}function T0(o){var a=kr(),h=o.focusedElem,v=o.selectionRange;if(a!==h&&h&&h.ownerDocument&&an(h.ownerDocument.documentElement,h)){if(v!==null&&ru(h)){if(a=v.start,o=v.end,o===void 0&&(o=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(o,h.value.length);else if(o=(a=h.ownerDocument||document)&&a.defaultView||window,o.getSelection){o=o.getSelection();var _=h.textContent.length,k=Math.min(v.start,_);v=v.end===void 0?k:Math.min(v.end,_),!o.extend&&k>v&&(_=v,v=k,k=_),_=ur(h,k);var F=ur(h,v);_&&F&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==F.node||o.focusOffset!==F.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),o.removeAllRanges(),k>v?(o.addRange(a),o.extend(F.node,F.offset)):(a.setEnd(F.node,F.offset),o.addRange(a)))}}for(a=[],o=h;o=o.parentNode;)o.nodeType===1&&a.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)o=a[h],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var eo=u&&"documentMode"in document&&11>=document.documentMode,_i=null,Ah=null,Vo=null,Jl=!1;function nu(o,a,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Jl||_i==null||_i!==Me(v)||(v=_i,"selectionStart"in v&&ru(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Vo&&Ke(Vo,v)||(Vo=v,v=Rd(Ah,"onSelect"),0<v.length&&(a=new md("onSelect","select",null,a,h),o.push({event:a,listeners:v}),a.target=_i)))}function ir(o,a){var h={};return h[o.toLowerCase()]=a.toLowerCase(),h["Webkit"+o]="webkit"+a,h["Moz"+o]="moz"+a,h}var Xl={animationend:ir("Animation","AnimationEnd"),animationiteration:ir("Animation","AnimationIteration"),animationstart:ir("Animation","AnimationStart"),transitionend:ir("Transition","TransitionEnd")},Ed={},su={};u&&(su=document.createElement("div").style,"AnimationEvent"in window||(delete Xl.animationend.animation,delete Xl.animationiteration.animation,delete Xl.animationstart.animation),"TransitionEvent"in window||delete Xl.transitionend.transition);function Sd(o){if(Ed[o])return Ed[o];if(!Xl[o])return o;var a=Xl[o],h;for(h in a)if(a.hasOwnProperty(h)&&h in su)return Ed[o]=a[h];return o}var vg=Sd("animationend"),yg=Sd("animationiteration"),ou=Sd("animationstart"),Ei=Sd("transitionend"),iu=new Map,Ih="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _o(o,a){iu.set(o,a),i(a,[o])}for(var Cd=0;Cd<Ih.length;Cd++){var kd=Ih[Cd],Nd=kd.toLowerCase(),xg=kd[0].toUpperCase()+kd.slice(1);_o(Nd,"on"+xg)}_o(vg,"onAnimationEnd"),_o(yg,"onAnimationIteration"),_o(ou,"onAnimationStart"),_o("dblclick","onDoubleClick"),_o("focusin","onFocus"),_o("focusout","onBlur"),_o(Ei,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Si="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xa=new Set("cancel close invalid load scroll toggle".split(" ").concat(Si));function au(o,a,h){var v=o.type||"unknown-event";o.currentTarget=h,us(v,a,void 0,o),o.currentTarget=null}function wg(o,a){a=(a&4)!==0;for(var h=0;h<o.length;h++){var v=o[h],_=v.event;v=v.listeners;e:{var k=void 0;if(a)for(var F=v.length-1;0<=F;F--){var W=v[F],X=W.instance,ye=W.currentTarget;if(W=W.listener,X!==k&&_.isPropagationStopped())break e;au(_,W,ye),k=X}else for(F=0;F<v.length;F++){if(W=v[F],X=W.instance,ye=W.currentTarget,W=W.listener,X!==k&&_.isPropagationStopped())break e;au(_,W,ye),k=X}}}if(Ho)throw o=vi,Ho=!1,vi=null,o}function Lr(o,a){var h=a[Pd];h===void 0&&(h=a[Pd]=new Set);var v=o+"__bubble";h.has(v)||(Td(a,o,2,!1),h.add(v))}function Ph(o,a,h){var v=0;a&&(v|=4),Td(h,o,v,a)}var Qa="_reactListening"+Math.random().toString(36).slice(2);function da(o){if(!o[Qa]){o[Qa]=!0,n.forEach(function(h){h!=="selectionchange"&&(Xa.has(h)||Ph(h,!1,o),Ph(h,!0,o))});var a=o.nodeType===9?o:o.ownerDocument;a===null||a[Qa]||(a[Qa]=!0,Ph("selectionchange",!1,a))}}function Td(o,a,h,v){switch(tg(a)){case 1:var _=m0;break;case 4:_=g0;break;default:_=gh}h=_.bind(null,a,h,o),_=void 0,!bo||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),v?_!==void 0?o.addEventListener(a,h,{capture:!0,passive:_}):o.addEventListener(a,h,!0):_!==void 0?o.addEventListener(a,h,{passive:_}):o.addEventListener(a,h,!1)}function Fh(o,a,h,v,_){var k=v;if((a&1)===0&&(a&2)===0&&v!==null)e:for(;;){if(v===null)return;var F=v.tag;if(F===3||F===4){var W=v.stateNode.containerInfo;if(W===_||W.nodeType===8&&W.parentNode===_)break;if(F===4)for(F=v.return;F!==null;){var X=F.tag;if((X===3||X===4)&&(X=F.stateNode.containerInfo,X===_||X.nodeType===8&&X.parentNode===_))return;F=F.return}for(;W!==null;){if(F=Ko(W),F===null)return;if(X=F.tag,X===5||X===6){v=k=F;continue e}W=W.parentNode}}v=v.return}Xi(function(){var ye=k,Fe=ft(h),Oe=[];e:{var Pe=iu.get(o);if(Pe!==void 0){var Ye=md,rt=o;switch(o){case"keypress":if(Gl(h)===0)break e;case"keydown":case"keyup":Ye=ig;break;case"focusin":rt="focus",Ye=Fr;break;case"focusout":rt="blur",Ye=Fr;break;case"beforeblur":case"afterblur":Ye=Fr;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ye=wh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ye=vd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ye=w0;break;case vg:case yg:case ou:Ye=_h;break;case Ei:Ye=Nh;break;case"scroll":Ye=rg;break;case"wheel":Ye=lg;break;case"copy":case"cut":case"paste":Ye=Eh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ye=xd}var st=(a&4)!==0,nn=!st&&o==="scroll",fe=st?Pe!==null?Pe+"Capture":null:Pe;st=[];for(var re=ye,me;re!==null;){me=re;var Le=me.stateNode;if(me.tag===5&&Le!==null&&(me=Le,fe!==null&&(Le=Xs(re,fe),Le!=null&&st.push(Ql(re,Le,me)))),nn)break;re=re.return}0<st.length&&(Pe=new Ye(Pe,rt,null,h,Fe),Oe.push({event:Pe,listeners:st}))}}if((a&7)===0){e:{if(Pe=o==="mouseover"||o==="pointerover",Ye=o==="mouseout"||o==="pointerout",Pe&&h!==cr&&(rt=h.relatedTarget||h.fromElement)&&(Ko(rt)||rt[Ds]))break e;if((Ye||Pe)&&(Pe=Fe.window===Fe?Fe:(Pe=Fe.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,Ye?(rt=h.relatedTarget||h.toElement,Ye=ye,rt=rt?Ko(rt):null,rt!==null&&(nn=Is(rt),rt!==nn||rt.tag!==5&&rt.tag!==6)&&(rt=null)):(Ye=null,rt=ye),Ye!==rt)){if(st=wh,Le="onMouseLeave",fe="onMouseEnter",re="mouse",(o==="pointerout"||o==="pointerover")&&(st=xd,Le="onPointerLeave",fe="onPointerEnter",re="pointer"),nn=Ye==null?Pe:Mt(Ye),me=rt==null?Pe:Mt(rt),Pe=new st(Le,re+"leave",Ye,h,Fe),Pe.target=nn,Pe.relatedTarget=me,Le=null,Ko(Fe)===ye&&(st=new st(fe,re+"enter",rt,h,Fe),st.target=me,st.relatedTarget=nn,Le=st),nn=Le,Ye&&rt)t:{for(st=Ye,fe=rt,re=0,me=st;me;me=Zl(me))re++;for(me=0,Le=fe;Le;Le=Zl(Le))me++;for(;0<re-me;)st=Zl(st),re--;for(;0<me-re;)fe=Zl(fe),me--;for(;re--;){if(st===fe||fe!==null&&st===fe.alternate)break t;st=Zl(st),fe=Zl(fe)}st=null}else st=null;Ye!==null&&ln(Oe,Pe,Ye,st,!1),rt!==null&&nn!==null&&ln(Oe,nn,rt,st,!0)}}e:{if(Pe=ye?Mt(ye):window,Ye=Pe.nodeName&&Pe.nodeName.toLowerCase(),Ye==="select"||Ye==="input"&&Pe.type==="file")var ct=C0;else if(wd(Pe))if(Ja)ct=ne;else{ct=N0;var bt=k0}else(Ye=Pe.nodeName)&&Ye.toLowerCase()==="input"&&(Pe.type==="checkbox"||Pe.type==="radio")&&(ct=Yl);if(ct&&(ct=ct(o,ye))){Rh(Oe,ct,h,Fe);break e}bt&&bt(o,Pe,ye),o==="focusout"&&(bt=Pe._wrapperState)&&bt.controlled&&Pe.type==="number"&&Zt(Pe,"number",Pe.value)}switch(bt=ye?Mt(ye):window,o){case"focusin":(wd(bt)||bt.contentEditable==="true")&&(_i=bt,Ah=ye,Vo=null);break;case"focusout":Vo=Ah=_i=null;break;case"mousedown":Jl=!0;break;case"contextmenu":case"mouseup":case"dragend":Jl=!1,nu(Oe,h,Fe);break;case"selectionchange":if(eo)break;case"keydown":case"keyup":nu(Oe,h,Fe)}var vt;if(tu)e:{switch(o){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else ql?fg(o,h)&&(Tt="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Tt="onCompositionStart");Tt&&(Th&&h.locale!=="ko"&&(ql||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&ql&&(vt=vh()):(Br=Fe,eu="value"in Br?Br.value:Br.textContent,ql=!0)),bt=Rd(ye,Tt),0<bt.length&&(Tt=new ng(Tt,o,null,h,Fe),Oe.push({event:Tt,listeners:bt}),vt?Tt.data=vt:(vt=hg(h),vt!==null&&(Tt.data=vt)))),(vt=cg?Kl(o,h):_0(o,h))&&(ye=Rd(ye,"onBeforeInput"),0<ye.length&&(Fe=new ng("onBeforeInput","beforeinput",null,h,Fe),Oe.push({event:Fe,listeners:ye}),Fe.data=vt))}wg(Oe,a)})}function Ql(o,a,h){return{instance:o,listener:a,currentTarget:h}}function Rd(o,a){for(var h=a+"Capture",v=[];o!==null;){var _=o,k=_.stateNode;_.tag===5&&k!==null&&(_=k,k=Xs(o,h),k!=null&&v.unshift(Ql(o,k,_)),k=Xs(o,a),k!=null&&v.push(Ql(o,k,_))),o=o.return}return v}function Zl(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function ln(o,a,h,v,_){for(var k=a._reactName,F=[];h!==null&&h!==v;){var W=h,X=W.alternate,ye=W.stateNode;if(X!==null&&X===v)break;W.tag===5&&ye!==null&&(W=ye,_?(X=Xs(h,k),X!=null&&F.unshift(Ql(h,X,W))):_||(X=Xs(h,k),X!=null&&F.push(Ql(h,X,W)))),h=h.return}F.length!==0&&o.push({event:a,listeners:F})}var Ln=/\r\n?/g,R0=/\u0000|\uFFFD/g;function bg(o){return(typeof o=="string"?o:""+o).replace(Ln,`
`).replace(R0,"")}function lu(o,a,h){if(a=bg(a),bg(o)!==a&&h)throw Error(t(425))}function Ad(){}var cu=null,Za=null;function uu(o,a){return o==="textarea"||o==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var fa=typeof setTimeout=="function"?setTimeout:void 0,du=typeof clearTimeout=="function"?clearTimeout:void 0,ec=typeof Promise=="function"?Promise:void 0,Id=typeof queueMicrotask=="function"?queueMicrotask:typeof ec<"u"?function(o){return ec.resolve(null).then(o).catch(tc)}:fa;function tc(o){setTimeout(function(){throw o})}function jh(o,a){var h=a,v=0;do{var _=h.nextSibling;if(o.removeChild(h),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(v===0){o.removeChild(_),pr(a);return}v--}else h!=="$"&&h!=="$?"&&h!=="$!"||v++;h=_}while(h);pr(a)}function ha(o){for(;o!=null;o=o.nextSibling){var a=o.nodeType;if(a===1||a===3)break;if(a===8){if(a=o.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return o}function _g(o){o=o.previousSibling;for(var a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return o;a--}else h==="/$"&&a++}o=o.previousSibling}return null}var rc=Math.random().toString(36).slice(2),qo="__reactFiber$"+rc,pa="__reactProps$"+rc,Ds="__reactContainer$"+rc,Pd="__reactEvents$"+rc,O="__reactListeners$"+rc,nc="__reactHandles$"+rc;function Ko(o){var a=o[qo];if(a)return a;for(var h=o.parentNode;h;){if(a=h[Ds]||h[qo]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(o=_g(o);o!==null;){if(h=o[qo])return h;o=_g(o)}return a}o=h,h=o.parentNode}return null}function Mn(o){return o=o[qo]||o[Ds],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Mt(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function Fd(o){return o[pa]||null}var Oh=[],sc=-1;function hs(o){return{current:o}}function Mr(o){0>sc||(o.current=Oh[sc],Oh[sc]=null,sc--)}function jr(o,a){sc++,Oh[sc]=o.current,o.current=a}var ma={},$n=hs(ma),ps=hs(!1),Jn=ma;function oc(o,a){var h=o.type.contextTypes;if(!h)return ma;var v=o.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===a)return v.__reactInternalMemoizedMaskedChildContext;var _={},k;for(k in h)_[k]=a[k];return v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=_),_}function ms(o){return o=o.childContextTypes,o!=null}function jd(){Mr(ps),Mr($n)}function Eg(o,a,h){if($n.current!==ma)throw Error(t(168));jr($n,a),jr(ps,h)}function Sg(o,a,h){var v=o.stateNode;if(a=a.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var _ in v)if(!(_ in a))throw Error(t(108,xe(o)||"Unknown",_));return K({},h,v)}function to(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||ma,Jn=$n.current,jr($n,o),jr(ps,ps.current),!0}function Cg(o,a,h){var v=o.stateNode;if(!v)throw Error(t(169));h?(o=Sg(o,a,Jn),v.__reactInternalMemoizedMergedChildContext=o,Mr(ps),Mr($n),jr($n,o)):Mr(ps),jr(ps,h)}var Ci=null,Od=!1,Dh=!1;function kg(o){Ci===null?Ci=[o]:Ci.push(o)}function el(o){Od=!0,kg(o)}function ga(){if(!Dh&&Ci!==null){Dh=!0;var o=0,a=sr;try{var h=Ci;for(sr=1;o<h.length;o++){var v=h[o];do v=v(!0);while(v!==null)}Ci=null,Od=!1}catch(_){throw Ci!==null&&(Ci=Ci.slice(o+1)),Q(Hr,ga),_}finally{sr=a,Dh=!1}}return null}var ic=[],Un=0,Dd=null,Ld=0,ro=[],no=0,tl=null,Yo=1,Jo="";function rl(o,a){ic[Un++]=Ld,ic[Un++]=Dd,Dd=o,Ld=a}function Ng(o,a,h){ro[no++]=Yo,ro[no++]=Jo,ro[no++]=tl,tl=o;var v=Yo;o=Jo;var _=32-Ps(v)-1;v&=~(1<<_),h+=1;var k=32-Ps(a)+_;if(30<k){var F=_-_%5;k=(v&(1<<F)-1).toString(32),v>>=F,_-=F,Yo=1<<32-Ps(a)+_|h<<_|v,Jo=k+o}else Yo=1<<k|h<<_|v,Jo=o}function fu(o){o.return!==null&&(rl(o,1),Ng(o,1,0))}function nl(o){for(;o===Dd;)Dd=ic[--Un],ic[Un]=null,Ld=ic[--Un],ic[Un]=null;for(;o===tl;)tl=ro[--no],ro[no]=null,Jo=ro[--no],ro[no]=null,Yo=ro[--no],ro[no]=null}var zn=null,Ls=null,$r=!1,Eo=null;function Xo(o,a){var h=uo(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=o,a=o.deletions,a===null?(o.deletions=[h],o.flags|=16):a.push(h)}function Md(o,a){switch(o.tag){case 5:var h=o.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(o.stateNode=a,zn=o,Ls=ha(a.firstChild),!0):!1;case 6:return a=o.pendingProps===""||a.nodeType!==3?null:a,a!==null?(o.stateNode=a,zn=o,Ls=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=tl!==null?{id:Yo,overflow:Jo}:null,o.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=uo(18,null,null,0),h.stateNode=a,h.return=o,o.child=h,zn=o,Ls=null,!0):!1;default:return!1}}function ki(o){return(o.mode&1)!==0&&(o.flags&128)===0}function gs(o){if($r){var a=Ls;if(a){var h=a;if(!Md(o,a)){if(ki(o))throw Error(t(418));a=ha(h.nextSibling);var v=zn;a&&Md(o,a)?Xo(v,h):(o.flags=o.flags&-4097|2,$r=!1,zn=o)}}else{if(ki(o))throw Error(t(418));o.flags=o.flags&-4097|2,$r=!1,zn=o}}}function Tg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;zn=o}function hu(o){if(o!==zn)return!1;if(!$r)return Tg(o),$r=!0,!1;var a;if((a=o.tag!==3)&&!(a=o.tag!==5)&&(a=o.type,a=a!=="head"&&a!=="body"&&!uu(o.type,o.memoizedProps)),a&&(a=Ls)){if(ki(o))throw Lh(),Error(t(418));for(;a;)Xo(o,a),a=ha(a.nextSibling)}if(Tg(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"){if(a===0){Ls=ha(o.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}o=o.nextSibling}Ls=null}}else Ls=zn?ha(o.stateNode.nextSibling):null;return!0}function Lh(){for(var o=Ls;o;)o=ha(o.nextSibling)}function Qo(){Ls=zn=null,$r=!1}function Zo(o){Eo===null?Eo=[o]:Eo.push(o)}var Rg=P.ReactCurrentBatchConfig;function pu(o,a,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var v=h.stateNode}if(!v)throw Error(t(147,o));var _=v,k=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===k?a.ref:(a=function(F){var W=_.refs;F===null?delete W[k]:W[k]=F},a._stringRef=k,a)}if(typeof o!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,o))}return o}function sl(o,a){throw o=Object.prototype.toString.call(a),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function Ag(o){var a=o._init;return a(o._payload)}function Mh(o){function a(fe,re){if(o){var me=fe.deletions;me===null?(fe.deletions=[re],fe.flags|=16):me.push(re)}}function h(fe,re){if(!o)return null;for(;re!==null;)a(fe,re),re=re.sibling;return null}function v(fe,re){for(fe=new Map;re!==null;)re.key!==null?fe.set(re.key,re):fe.set(re.index,re),re=re.sibling;return fe}function _(fe,re){return fe=Ao(fe,re),fe.index=0,fe.sibling=null,fe}function k(fe,re,me){return fe.index=me,o?(me=fe.alternate,me!==null?(me=me.index,me<re?(fe.flags|=2,re):me):(fe.flags|=2,re)):(fe.flags|=1048576,re)}function F(fe){return o&&fe.alternate===null&&(fe.flags|=2),fe}function W(fe,re,me,Le){return re===null||re.tag!==6?(re=Sp(me,fe.mode,Le),re.return=fe,re):(re=_(re,me),re.return=fe,re)}function X(fe,re,me,Le){var ct=me.type;return ct===$?Fe(fe,re,me.props.children,Le,me.key):re!==null&&(re.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===pe&&Ag(ct)===re.type)?(Le=_(re,me.props),Le.ref=pu(fe,re,me),Le.return=fe,Le):(Le=wf(me.type,me.key,me.props,null,fe.mode,Le),Le.ref=pu(fe,re,me),Le.return=fe,Le)}function ye(fe,re,me,Le){return re===null||re.tag!==4||re.stateNode.containerInfo!==me.containerInfo||re.stateNode.implementation!==me.implementation?(re=Cp(me,fe.mode,Le),re.return=fe,re):(re=_(re,me.children||[]),re.return=fe,re)}function Fe(fe,re,me,Le,ct){return re===null||re.tag!==7?(re=ml(me,fe.mode,Le,ct),re.return=fe,re):(re=_(re,me),re.return=fe,re)}function Oe(fe,re,me){if(typeof re=="string"&&re!==""||typeof re=="number")return re=Sp(""+re,fe.mode,me),re.return=fe,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case U:return me=wf(re.type,re.key,re.props,null,fe.mode,me),me.ref=pu(fe,null,re),me.return=fe,me;case B:return re=Cp(re,fe.mode,me),re.return=fe,re;case pe:var Le=re._init;return Oe(fe,Le(re._payload),me)}if(er(re)||z(re))return re=ml(re,fe.mode,me,null),re.return=fe,re;sl(fe,re)}return null}function Pe(fe,re,me,Le){var ct=re!==null?re.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return ct!==null?null:W(fe,re,""+me,Le);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case U:return me.key===ct?X(fe,re,me,Le):null;case B:return me.key===ct?ye(fe,re,me,Le):null;case pe:return ct=me._init,Pe(fe,re,ct(me._payload),Le)}if(er(me)||z(me))return ct!==null?null:Fe(fe,re,me,Le,null);sl(fe,me)}return null}function Ye(fe,re,me,Le,ct){if(typeof Le=="string"&&Le!==""||typeof Le=="number")return fe=fe.get(me)||null,W(re,fe,""+Le,ct);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case U:return fe=fe.get(Le.key===null?me:Le.key)||null,X(re,fe,Le,ct);case B:return fe=fe.get(Le.key===null?me:Le.key)||null,ye(re,fe,Le,ct);case pe:var bt=Le._init;return Ye(fe,re,me,bt(Le._payload),ct)}if(er(Le)||z(Le))return fe=fe.get(me)||null,Fe(re,fe,Le,ct,null);sl(re,Le)}return null}function rt(fe,re,me,Le){for(var ct=null,bt=null,vt=re,Tt=re=0,En=null;vt!==null&&Tt<me.length;Tt++){vt.index>Tt?(En=vt,vt=null):En=vt.sibling;var dr=Pe(fe,vt,me[Tt],Le);if(dr===null){vt===null&&(vt=En);break}o&&vt&&dr.alternate===null&&a(fe,vt),re=k(dr,re,Tt),bt===null?ct=dr:bt.sibling=dr,bt=dr,vt=En}if(Tt===me.length)return h(fe,vt),$r&&rl(fe,Tt),ct;if(vt===null){for(;Tt<me.length;Tt++)vt=Oe(fe,me[Tt],Le),vt!==null&&(re=k(vt,re,Tt),bt===null?ct=vt:bt.sibling=vt,bt=vt);return $r&&rl(fe,Tt),ct}for(vt=v(fe,vt);Tt<me.length;Tt++)En=Ye(vt,fe,Tt,me[Tt],Le),En!==null&&(o&&En.alternate!==null&&vt.delete(En.key===null?Tt:En.key),re=k(En,re,Tt),bt===null?ct=En:bt.sibling=En,bt=En);return o&&vt.forEach(function(Ta){return a(fe,Ta)}),$r&&rl(fe,Tt),ct}function st(fe,re,me,Le){var ct=z(me);if(typeof ct!="function")throw Error(t(150));if(me=ct.call(me),me==null)throw Error(t(151));for(var bt=ct=null,vt=re,Tt=re=0,En=null,dr=me.next();vt!==null&&!dr.done;Tt++,dr=me.next()){vt.index>Tt?(En=vt,vt=null):En=vt.sibling;var Ta=Pe(fe,vt,dr.value,Le);if(Ta===null){vt===null&&(vt=En);break}o&&vt&&Ta.alternate===null&&a(fe,vt),re=k(Ta,re,Tt),bt===null?ct=Ta:bt.sibling=Ta,bt=Ta,vt=En}if(dr.done)return h(fe,vt),$r&&rl(fe,Tt),ct;if(vt===null){for(;!dr.done;Tt++,dr=me.next())dr=Oe(fe,dr.value,Le),dr!==null&&(re=k(dr,re,Tt),bt===null?ct=dr:bt.sibling=dr,bt=dr);return $r&&rl(fe,Tt),ct}for(vt=v(fe,vt);!dr.done;Tt++,dr=me.next())dr=Ye(vt,fe,Tt,dr.value,Le),dr!==null&&(o&&dr.alternate!==null&&vt.delete(dr.key===null?Tt:dr.key),re=k(dr,re,Tt),bt===null?ct=dr:bt.sibling=dr,bt=dr);return o&&vt.forEach(function(J0){return a(fe,J0)}),$r&&rl(fe,Tt),ct}function nn(fe,re,me,Le){if(typeof me=="object"&&me!==null&&me.type===$&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case U:e:{for(var ct=me.key,bt=re;bt!==null;){if(bt.key===ct){if(ct=me.type,ct===$){if(bt.tag===7){h(fe,bt.sibling),re=_(bt,me.props.children),re.return=fe,fe=re;break e}}else if(bt.elementType===ct||typeof ct=="object"&&ct!==null&&ct.$$typeof===pe&&Ag(ct)===bt.type){h(fe,bt.sibling),re=_(bt,me.props),re.ref=pu(fe,bt,me),re.return=fe,fe=re;break e}h(fe,bt);break}else a(fe,bt);bt=bt.sibling}me.type===$?(re=ml(me.props.children,fe.mode,Le,me.key),re.return=fe,fe=re):(Le=wf(me.type,me.key,me.props,null,fe.mode,Le),Le.ref=pu(fe,re,me),Le.return=fe,fe=Le)}return F(fe);case B:e:{for(bt=me.key;re!==null;){if(re.key===bt)if(re.tag===4&&re.stateNode.containerInfo===me.containerInfo&&re.stateNode.implementation===me.implementation){h(fe,re.sibling),re=_(re,me.children||[]),re.return=fe,fe=re;break e}else{h(fe,re);break}else a(fe,re);re=re.sibling}re=Cp(me,fe.mode,Le),re.return=fe,fe=re}return F(fe);case pe:return bt=me._init,nn(fe,re,bt(me._payload),Le)}if(er(me))return rt(fe,re,me,Le);if(z(me))return st(fe,re,me,Le);sl(fe,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,re!==null&&re.tag===6?(h(fe,re.sibling),re=_(re,me),re.return=fe,fe=re):(h(fe,re),re=Sp(me,fe.mode,Le),re.return=fe,fe=re),F(fe)):h(fe,re)}return nn}var en=Mh(!0),$d=Mh(!1),mu=hs(null),Ms=null,va=null,ac=null;function Ni(){ac=va=Ms=null}function Ud(o){var a=mu.current;Mr(mu),o._currentValue=a}function Tn(o,a,h){for(;o!==null;){var v=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,v!==null&&(v.childLanes|=a)):v!==null&&(v.childLanes&a)!==a&&(v.childLanes|=a),o===h)break;o=o.return}}function ya(o,a){Ms=o,ac=va=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&a)!==0&&(Qn=!0),o.firstContext=null)}function so(o){var a=o._currentValue;if(ac!==o)if(o={context:o,memoizedValue:a,next:null},va===null){if(Ms===null)throw Error(t(308));va=o,Ms.dependencies={lanes:0,firstContext:o}}else va=va.next=o;return a}var ol=null;function $h(o){ol===null?ol=[o]:ol.push(o)}function zd(o,a,h,v){var _=a.interleaved;return _===null?(h.next=h,$h(a)):(h.next=_.next,_.next=h),a.interleaved=h,Ti(o,v)}function Ti(o,a){o.lanes|=a;var h=o.alternate;for(h!==null&&(h.lanes|=a),h=o,o=o.return;o!==null;)o.childLanes|=a,h=o.alternate,h!==null&&(h.childLanes|=a),h=o,o=o.return;return h.tag===3?h.stateNode:null}var oo=!1;function Hd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ig(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ri(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function io(o,a,h){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(ar&2)!==0){var _=v.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),v.pending=a,Ti(o,h)}return _=v.interleaved,_===null?(a.next=a,$h(v)):(a.next=_.next,_.next=a),v.interleaved=a,Ti(o,h)}function Bd(o,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var v=a.lanes;v&=o.pendingLanes,h|=v,a.lanes=h,oa(o,h)}}function Pg(o,a){var h=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var _=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var F={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};k===null?_=k=F:k=k.next=F,h=h.next}while(h!==null);k===null?_=k=a:k=k.next=a}else _=k=a;h={baseState:v.baseState,firstBaseUpdate:_,lastBaseUpdate:k,shared:v.shared,effects:v.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=a:o.next=a,h.lastBaseUpdate=a}function lc(o,a,h,v){var _=o.updateQueue;oo=!1;var k=_.firstBaseUpdate,F=_.lastBaseUpdate,W=_.shared.pending;if(W!==null){_.shared.pending=null;var X=W,ye=X.next;X.next=null,F===null?k=ye:F.next=ye,F=X;var Fe=o.alternate;Fe!==null&&(Fe=Fe.updateQueue,W=Fe.lastBaseUpdate,W!==F&&(W===null?Fe.firstBaseUpdate=ye:W.next=ye,Fe.lastBaseUpdate=X))}if(k!==null){var Oe=_.baseState;F=0,Fe=ye=X=null,W=k;do{var Pe=W.lane,Ye=W.eventTime;if((v&Pe)===Pe){Fe!==null&&(Fe=Fe.next={eventTime:Ye,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var rt=o,st=W;switch(Pe=a,Ye=h,st.tag){case 1:if(rt=st.payload,typeof rt=="function"){Oe=rt.call(Ye,Oe,Pe);break e}Oe=rt;break e;case 3:rt.flags=rt.flags&-65537|128;case 0:if(rt=st.payload,Pe=typeof rt=="function"?rt.call(Ye,Oe,Pe):rt,Pe==null)break e;Oe=K({},Oe,Pe);break e;case 2:oo=!0}}W.callback!==null&&W.lane!==0&&(o.flags|=64,Pe=_.effects,Pe===null?_.effects=[W]:Pe.push(W))}else Ye={eventTime:Ye,lane:Pe,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Fe===null?(ye=Fe=Ye,X=Oe):Fe=Fe.next=Ye,F|=Pe;if(W=W.next,W===null){if(W=_.shared.pending,W===null)break;Pe=W,W=Pe.next,Pe.next=null,_.lastBaseUpdate=Pe,_.shared.pending=null}}while(!0);if(Fe===null&&(X=Oe),_.baseState=X,_.firstBaseUpdate=ye,_.lastBaseUpdate=Fe,a=_.shared.interleaved,a!==null){_=a;do F|=_.lane,_=_.next;while(_!==a)}else k===null&&(_.shared.lanes=0);Ea|=F,o.lanes=F,o.memoizedState=Oe}}function Uh(o,a,h){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var v=o[a],_=v.callback;if(_!==null){if(v.callback=null,v=h,typeof _!="function")throw Error(t(191,_));_.call(v)}}}var gu={},ei=hs(gu),vu=hs(gu),cc=hs(gu);function Ai(o){if(o===gu)throw Error(t(174));return o}function zh(o,a){switch(jr(cc,a),jr(vu,o),jr(ei,gu),o=a.nodeType,o){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:tt(null,"");break;default:o=o===8?a.parentNode:a,a=o.namespaceURI||null,o=o.tagName,a=tt(a,o)}Mr(ei),jr(ei,a)}function xa(){Mr(ei),Mr(vu),Mr(cc)}function Hh(o){Ai(cc.current);var a=Ai(ei.current),h=tt(a,o.type);a!==h&&(jr(vu,o),jr(ei,h))}function Gd(o){vu.current===o&&(Mr(ei),Mr(vu))}var Gr=hs(0);function il(o){for(var a=o;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Bh=[];function Wd(){for(var o=0;o<Bh.length;o++)Bh[o]._workInProgressVersionPrimary=null;Bh.length=0}var yu=P.ReactCurrentDispatcher,Gh=P.ReactCurrentBatchConfig,wa=0,Kr=null,rn=null,hn=null,uc=!1,xu=!1,al=0,Bt=0;function Hn(){throw Error(t(321))}function Wh(o,a){if(a===null)return!1;for(var h=0;h<a.length&&h<o.length;h++)if(!ge(o[h],a[h]))return!1;return!0}function ll(o,a,h,v,_,k){if(wa=k,Kr=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,yu.current=o===null||o.memoizedState===null?I0:Qd,o=h(v,_),xu){k=0;do{if(xu=!1,al=0,25<=k)throw Error(t(301));k+=1,hn=rn=null,a.updateQueue=null,yu.current=pc,o=h(v,_)}while(xu)}if(yu.current=Xd,a=rn!==null&&rn.next!==null,wa=0,hn=rn=Kr=null,uc=!1,a)throw Error(t(300));return o}function Vd(){var o=al!==0;return al=0,o}function ti(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hn===null?Kr.memoizedState=hn=o:hn=hn.next=o,hn}function ao(){if(rn===null){var o=Kr.alternate;o=o!==null?o.memoizedState:null}else o=rn.next;var a=hn===null?Kr.memoizedState:hn.next;if(a!==null)hn=a,rn=o;else{if(o===null)throw Error(t(310));rn=o,o={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},hn===null?Kr.memoizedState=hn=o:hn=hn.next=o}return hn}function Bn(o,a){return typeof a=="function"?a(o):a}function Vh(o){var a=ao(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var v=rn,_=v.baseQueue,k=h.pending;if(k!==null){if(_!==null){var F=_.next;_.next=k.next,k.next=F}v.baseQueue=_=k,h.pending=null}if(_!==null){k=_.next,v=v.baseState;var W=F=null,X=null,ye=k;do{var Fe=ye.lane;if((wa&Fe)===Fe)X!==null&&(X=X.next={lane:0,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null}),v=ye.hasEagerState?ye.eagerState:o(v,ye.action);else{var Oe={lane:Fe,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null};X===null?(W=X=Oe,F=v):X=X.next=Oe,Kr.lanes|=Fe,Ea|=Fe}ye=ye.next}while(ye!==null&&ye!==k);X===null?F=v:X.next=W,ge(v,a.memoizedState)||(Qn=!0),a.memoizedState=v,a.baseState=F,a.baseQueue=X,h.lastRenderedState=v}if(o=h.interleaved,o!==null){_=o;do k=_.lane,Kr.lanes|=k,Ea|=k,_=_.next;while(_!==o)}else _===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function dc(o){var a=ao(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var v=h.dispatch,_=h.pending,k=a.memoizedState;if(_!==null){h.pending=null;var F=_=_.next;do k=o(k,F.action),F=F.next;while(F!==_);ge(k,a.memoizedState)||(Qn=!0),a.memoizedState=k,a.baseQueue===null&&(a.baseState=k),h.lastRenderedState=k}return[k,v]}function qd(){}function qh(o,a){var h=Kr,v=ao(),_=a(),k=!ge(v.memoizedState,_);if(k&&(v.memoizedState=_,Qn=!0),v=v.queue,ri(Ii.bind(null,h,v,o),[o]),v.getSnapshot!==a||k||hn!==null&&hn.memoizedState.tag&1){if(h.flags|=2048,fc(9,vs.bind(null,h,v,_,a),void 0,null),_n===null)throw Error(t(349));(wa&30)!==0||Kh(h,a,_)}return _}function Kh(o,a,h){o.flags|=16384,o={getSnapshot:a,value:h},a=Kr.updateQueue,a===null?(a={lastEffect:null,stores:null},Kr.updateQueue=a,a.stores=[o]):(h=a.stores,h===null?a.stores=[o]:h.push(o))}function vs(o,a,h,v){a.value=h,a.getSnapshot=v,Kd(a)&&Yh(o)}function Ii(o,a,h){return h(function(){Kd(a)&&Yh(o)})}function Kd(o){var a=o.getSnapshot;o=o.value;try{var h=a();return!ge(o,h)}catch{return!0}}function Yh(o){var a=Ti(o,1);a!==null&&Ro(a,o,1,-1)}function wu(o){var a=ti();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bn,lastRenderedState:o},a.queue=o,o=o.dispatch=Mg.bind(null,Kr,o),[a.memoizedState,o]}function fc(o,a,h,v){return o={tag:o,create:a,destroy:h,deps:v,next:null},a=Kr.updateQueue,a===null?(a={lastEffect:null,stores:null},Kr.updateQueue=a,a.lastEffect=o.next=o):(h=a.lastEffect,h===null?a.lastEffect=o.next=o:(v=h.next,h.next=o,o.next=v,a.lastEffect=o)),o}function Yd(){return ao().memoizedState}function bu(o,a,h,v){var _=ti();Kr.flags|=o,_.memoizedState=fc(1|a,h,void 0,v===void 0?null:v)}function hc(o,a,h,v){var _=ao();v=v===void 0?null:v;var k=void 0;if(rn!==null){var F=rn.memoizedState;if(k=F.destroy,v!==null&&Wh(v,F.deps)){_.memoizedState=fc(a,h,k,v);return}}Kr.flags|=o,_.memoizedState=fc(1|a,h,k,v)}function Jd(o,a){return bu(8390656,8,o,a)}function ri(o,a){return hc(2048,8,o,a)}function Fg(o,a){return hc(4,2,o,a)}function Pi(o,a){return hc(4,4,o,a)}function Jh(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function Xh(o,a,h){return h=h!=null?h.concat([o]):null,hc(4,4,Jh.bind(null,a,o),h)}function _u(){}function jg(o,a){var h=ao();a=a===void 0?null:a;var v=h.memoizedState;return v!==null&&a!==null&&Wh(a,v[1])?v[0]:(h.memoizedState=[o,a],o)}function Og(o,a){var h=ao();a=a===void 0?null:a;var v=h.memoizedState;return v!==null&&a!==null&&Wh(a,v[1])?v[0]:(o=o(),h.memoizedState=[o,a],o)}function Dg(o,a,h){return(wa&21)===0?(o.baseState&&(o.baseState=!1,Qn=!0),o.memoizedState=h):(ge(h,a)||(h=Qc(),Kr.lanes|=h,Ea|=h,o.baseState=!0),a)}function Lg(o,a){var h=sr;sr=h!==0&&4>h?h:4,o(!0);var v=Gh.transition;Gh.transition={};try{o(!1),a()}finally{sr=h,Gh.transition=v}}function Qh(){return ao().memoizedState}function A0(o,a,h){var v=ka(o);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},Zh(o))Xn(a,h);else if(h=zd(o,a,h,v),h!==null){var _=ts();Ro(h,o,v,_),So(h,a,v)}}function Mg(o,a,h){var v=ka(o),_={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(Zh(o))Xn(a,_);else{var k=o.alternate;if(o.lanes===0&&(k===null||k.lanes===0)&&(k=a.lastRenderedReducer,k!==null))try{var F=a.lastRenderedState,W=k(F,h);if(_.hasEagerState=!0,_.eagerState=W,ge(W,F)){var X=a.interleaved;X===null?(_.next=_,$h(a)):(_.next=X.next,X.next=_),a.interleaved=_;return}}catch{}finally{}h=zd(o,a,_,v),h!==null&&(_=ts(),Ro(h,o,v,_),So(h,a,v))}}function Zh(o){var a=o.alternate;return o===Kr||a!==null&&a===Kr}function Xn(o,a){xu=uc=!0;var h=o.pending;h===null?a.next=a:(a.next=h.next,h.next=a),o.pending=a}function So(o,a,h){if((h&4194240)!==0){var v=a.lanes;v&=o.pendingLanes,h|=v,a.lanes=h,oa(o,h)}}var Xd={readContext:so,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},I0={readContext:so,useCallback:function(o,a){return ti().memoizedState=[o,a===void 0?null:a],o},useContext:so,useEffect:Jd,useImperativeHandle:function(o,a,h){return h=h!=null?h.concat([o]):null,bu(4194308,4,Jh.bind(null,a,o),h)},useLayoutEffect:function(o,a){return bu(4194308,4,o,a)},useInsertionEffect:function(o,a){return bu(4,2,o,a)},useMemo:function(o,a){var h=ti();return a=a===void 0?null:a,o=o(),h.memoizedState=[o,a],o},useReducer:function(o,a,h){var v=ti();return a=h!==void 0?h(a):a,v.memoizedState=v.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},v.queue=o,o=o.dispatch=A0.bind(null,Kr,o),[v.memoizedState,o]},useRef:function(o){var a=ti();return o={current:o},a.memoizedState=o},useState:wu,useDebugValue:_u,useDeferredValue:function(o){return ti().memoizedState=o},useTransition:function(){var o=wu(!1),a=o[0];return o=Lg.bind(null,o[1]),ti().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,h){var v=Kr,_=ti();if($r){if(h===void 0)throw Error(t(407));h=h()}else{if(h=a(),_n===null)throw Error(t(349));(wa&30)!==0||Kh(v,a,h)}_.memoizedState=h;var k={value:h,getSnapshot:a};return _.queue=k,Jd(Ii.bind(null,v,k,o),[o]),v.flags|=2048,fc(9,vs.bind(null,v,k,h,a),void 0,null),h},useId:function(){var o=ti(),a=_n.identifierPrefix;if($r){var h=Jo,v=Yo;h=(v&~(1<<32-Ps(v)-1)).toString(32)+h,a=":"+a+"R"+h,h=al++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=Bt++,a=":"+a+"r"+h.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},Qd={readContext:so,useCallback:jg,useContext:so,useEffect:ri,useImperativeHandle:Xh,useInsertionEffect:Fg,useLayoutEffect:Pi,useMemo:Og,useReducer:Vh,useRef:Yd,useState:function(){return Vh(Bn)},useDebugValue:_u,useDeferredValue:function(o){var a=ao();return Dg(a,rn.memoizedState,o)},useTransition:function(){var o=Vh(Bn)[0],a=ao().memoizedState;return[o,a]},useMutableSource:qd,useSyncExternalStore:qh,useId:Qh,unstable_isNewReconciler:!1},pc={readContext:so,useCallback:jg,useContext:so,useEffect:ri,useImperativeHandle:Xh,useInsertionEffect:Fg,useLayoutEffect:Pi,useMemo:Og,useReducer:dc,useRef:Yd,useState:function(){return dc(Bn)},useDebugValue:_u,useDeferredValue:function(o){var a=ao();return rn===null?a.memoizedState=o:Dg(a,rn.memoizedState,o)},useTransition:function(){var o=dc(Bn)[0],a=ao().memoizedState;return[o,a]},useMutableSource:qd,useSyncExternalStore:qh,useId:Qh,unstable_isNewReconciler:!1};function lo(o,a){if(o&&o.defaultProps){a=K({},a),o=o.defaultProps;for(var h in o)a[h]===void 0&&(a[h]=o[h]);return a}return a}function Zd(o,a,h,v){a=o.memoizedState,h=h(v,a),h=h==null?a:K({},a,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var ef={isMounted:function(o){return(o=o._reactInternals)?Is(o)===o:!1},enqueueSetState:function(o,a,h){o=o._reactInternals;var v=ts(),_=ka(o),k=Ri(v,_);k.payload=a,h!=null&&(k.callback=h),a=io(o,k,_),a!==null&&(Ro(a,o,_,v),Bd(a,o,_))},enqueueReplaceState:function(o,a,h){o=o._reactInternals;var v=ts(),_=ka(o),k=Ri(v,_);k.tag=1,k.payload=a,h!=null&&(k.callback=h),a=io(o,k,_),a!==null&&(Ro(a,o,_,v),Bd(a,o,_))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var h=ts(),v=ka(o),_=Ri(h,v);_.tag=2,a!=null&&(_.callback=a),a=io(o,_,v),a!==null&&(Ro(a,o,v,h),Bd(a,o,v))}};function ep(o,a,h,v,_,k,F){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,k,F):a.prototype&&a.prototype.isPureReactComponent?!Ke(h,v)||!Ke(_,k):!0}function cl(o,a,h){var v=!1,_=ma,k=a.contextType;return typeof k=="object"&&k!==null?k=so(k):(_=ms(a)?Jn:$n.current,v=a.contextTypes,k=(v=v!=null)?oc(o,_):ma),a=new a(h,k),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=ef,o.stateNode=a,a._reactInternals=o,v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=_,o.__reactInternalMemoizedMaskedChildContext=k),a}function mc(o,a,h,v){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,v),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,v),a.state!==o&&ef.enqueueReplaceState(a,a.state,null)}function tp(o,a,h,v){var _=o.stateNode;_.props=h,_.state=o.memoizedState,_.refs={},Hd(o);var k=a.contextType;typeof k=="object"&&k!==null?_.context=so(k):(k=ms(a)?Jn:$n.current,_.context=oc(o,k)),_.state=o.memoizedState,k=a.getDerivedStateFromProps,typeof k=="function"&&(Zd(o,a,k,h),_.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&ef.enqueueReplaceState(_,_.state,null),lc(o,h,_,v),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308)}function ul(o,a){try{var h="",v=a;do h+=V(v),v=v.return;while(v);var _=h}catch(k){_=`
Error generating stack: `+k.message+`
`+k.stack}return{value:o,source:a,stack:_,digest:null}}function tf(o,a,h){return{value:o,source:null,stack:h??null,digest:a??null}}function gc(o,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var $g=typeof WeakMap=="function"?WeakMap:Map;function Eu(o,a,h){h=Ri(-1,h),h.tag=3,h.payload={element:null};var v=a.value;return h.callback=function(){hf||(hf=!0,vp=v),gc(o,a)},h}function rf(o,a,h){h=Ri(-1,h),h.tag=3;var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var _=a.value;h.payload=function(){return v(_)},h.callback=function(){gc(o,a)}}var k=o.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(h.callback=function(){gc(o,a),typeof v!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var F=a.stack;this.componentDidCatch(a.value,{componentStack:F!==null?F:""})}),h}function Su(o,a,h){var v=o.pingCache;if(v===null){v=o.pingCache=new $g;var _=new Set;v.set(a,_)}else _=v.get(a),_===void 0&&(_=new Set,v.set(a,_));_.has(h)||(_.add(h),o=$0.bind(null,o,a,h),a.then(o,o))}function Ug(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function rp(o,a,h,v,_){return(o.mode&1)===0?(o===a?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=Ri(-1,1),a.tag=2,io(h,a,1))),h.lanes|=1),o):(o.flags|=65536,o.lanes=_,o)}var nf=P.ReactCurrentOwner,Qn=!1;function Rn(o,a,h,v){a.child=o===null?$d(a,null,h,v):en(a,o.child,h,v)}function zg(o,a,h,v,_){h=h.render;var k=a.ref;return ya(a,_),v=ll(o,a,h,v,k,_),h=Vd(),o!==null&&!Qn?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Co(o,a,_)):($r&&h&&fu(a),a.flags|=1,Rn(o,a,v,_),a.child)}function np(o,a,h,v,_){if(o===null){var k=h.type;return typeof k=="function"&&!xf(k)&&k.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=k,ni(o,a,k,v,_)):(o=wf(h.type,null,v,a,a.mode,_),o.ref=a.ref,o.return=a,a.child=o)}if(k=o.child,(o.lanes&_)===0){var F=k.memoizedProps;if(h=h.compare,h=h!==null?h:Ke,h(F,v)&&o.ref===a.ref)return Co(o,a,_)}return a.flags|=1,o=Ao(k,v),o.ref=a.ref,o.return=a,a.child=o}function ni(o,a,h,v,_){if(o!==null){var k=o.memoizedProps;if(Ke(k,v)&&o.ref===a.ref)if(Qn=!1,a.pendingProps=v=k,(o.lanes&_)!==0)(o.flags&131072)!==0&&(Qn=!0);else return a.lanes=o.lanes,Co(o,a,_)}return ip(o,a,h,v,_)}function sp(o,a,h){var v=a.pendingProps,_=v.children,k=o!==null?o.memoizedState:null;if(v.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},jr(wc,Us),Us|=h;else{if((h&1073741824)===0)return o=k!==null?k.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,jr(wc,Us),Us|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=k!==null?k.baseLanes:h,jr(wc,Us),Us|=v}else k!==null?(v=k.baseLanes|h,a.memoizedState=null):v=h,jr(wc,Us),Us|=v;return Rn(o,a,_,h),a.child}function op(o,a){var h=a.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function ip(o,a,h,v,_){var k=ms(h)?Jn:$n.current;return k=oc(a,k),ya(a,_),h=ll(o,a,h,v,k,_),v=Vd(),o!==null&&!Qn?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Co(o,a,_)):($r&&v&&fu(a),a.flags|=1,Rn(o,a,h,_),a.child)}function ap(o,a,h,v,_){if(ms(h)){var k=!0;to(a)}else k=!1;if(ya(a,_),a.stateNode===null)of(o,a),cl(a,h,v),tp(a,h,v,_),v=!0;else if(o===null){var F=a.stateNode,W=a.memoizedProps;F.props=W;var X=F.context,ye=h.contextType;typeof ye=="object"&&ye!==null?ye=so(ye):(ye=ms(h)?Jn:$n.current,ye=oc(a,ye));var Fe=h.getDerivedStateFromProps,Oe=typeof Fe=="function"||typeof F.getSnapshotBeforeUpdate=="function";Oe||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(W!==v||X!==ye)&&mc(a,F,v,ye),oo=!1;var Pe=a.memoizedState;F.state=Pe,lc(a,v,F,_),X=a.memoizedState,W!==v||Pe!==X||ps.current||oo?(typeof Fe=="function"&&(Zd(a,h,Fe,v),X=a.memoizedState),(W=oo||ep(a,h,W,v,Pe,X,ye))?(Oe||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(a.flags|=4194308)):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=v,a.memoizedState=X),F.props=v,F.state=X,F.context=ye,v=W):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),v=!1)}else{F=a.stateNode,Ig(o,a),W=a.memoizedProps,ye=a.type===a.elementType?W:lo(a.type,W),F.props=ye,Oe=a.pendingProps,Pe=F.context,X=h.contextType,typeof X=="object"&&X!==null?X=so(X):(X=ms(h)?Jn:$n.current,X=oc(a,X));var Ye=h.getDerivedStateFromProps;(Fe=typeof Ye=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(W!==Oe||Pe!==X)&&mc(a,F,v,X),oo=!1,Pe=a.memoizedState,F.state=Pe,lc(a,v,F,_);var rt=a.memoizedState;W!==Oe||Pe!==rt||ps.current||oo?(typeof Ye=="function"&&(Zd(a,h,Ye,v),rt=a.memoizedState),(ye=oo||ep(a,h,ye,v,Pe,rt,X)||!1)?(Fe||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(v,rt,X),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(v,rt,X)),typeof F.componentDidUpdate=="function"&&(a.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof F.componentDidUpdate!="function"||W===o.memoizedProps&&Pe===o.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Pe===o.memoizedState||(a.flags|=1024),a.memoizedProps=v,a.memoizedState=rt),F.props=v,F.state=rt,F.context=X,v=ye):(typeof F.componentDidUpdate!="function"||W===o.memoizedProps&&Pe===o.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Pe===o.memoizedState||(a.flags|=1024),v=!1)}return lp(o,a,h,v,k,_)}function lp(o,a,h,v,_,k){op(o,a);var F=(a.flags&128)!==0;if(!v&&!F)return _&&Cg(a,h,!1),Co(o,a,k);v=a.stateNode,nf.current=a;var W=F&&typeof h.getDerivedStateFromError!="function"?null:v.render();return a.flags|=1,o!==null&&F?(a.child=en(a,o.child,null,k),a.child=en(a,null,W,k)):Rn(o,a,W,k),a.memoizedState=v.state,_&&Cg(a,h,!0),a.child}function Hg(o){var a=o.stateNode;a.pendingContext?Eg(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Eg(o,a.context,!1),zh(o,a.containerInfo)}function si(o,a,h,v,_){return Qo(),Zo(_),a.flags|=256,Rn(o,a,h,v),a.child}var Cu={dehydrated:null,treeContext:null,retryLane:0};function ku(o){return{baseLanes:o,cachePool:null,transitions:null}}function sf(o,a,h){var v=a.pendingProps,_=Gr.current,k=!1,F=(a.flags&128)!==0,W;if((W=F)||(W=o!==null&&o.memoizedState===null?!1:(_&2)!==0),W?(k=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(_|=1),jr(Gr,_&1),o===null)return gs(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((a.mode&1)===0?a.lanes=1:o.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(F=v.children,o=v.fallback,k?(v=a.mode,k=a.child,F={mode:"hidden",children:F},(v&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=F):k=bf(F,v,0,null),o=ml(o,v,h,null),k.return=a,o.return=a,k.sibling=o,a.child=k,a.child.memoizedState=ku(h),a.memoizedState=Cu,o):vc(a,F));if(_=o.memoizedState,_!==null&&(W=_.dehydrated,W!==null))return St(o,a,F,v,W,_,h);if(k){k=v.fallback,F=a.mode,_=o.child,W=_.sibling;var X={mode:"hidden",children:v.children};return(F&1)===0&&a.child!==_?(v=a.child,v.childLanes=0,v.pendingProps=X,a.deletions=null):(v=Ao(_,X),v.subtreeFlags=_.subtreeFlags&14680064),W!==null?k=Ao(W,k):(k=ml(k,F,h,null),k.flags|=2),k.return=a,v.return=a,v.sibling=k,a.child=v,v=k,k=a.child,F=o.child.memoizedState,F=F===null?ku(h):{baseLanes:F.baseLanes|h,cachePool:null,transitions:F.transitions},k.memoizedState=F,k.childLanes=o.childLanes&~h,a.memoizedState=Cu,v}return k=o.child,o=k.sibling,v=Ao(k,{mode:"visible",children:v.children}),(a.mode&1)===0&&(v.lanes=h),v.return=a,v.sibling=null,o!==null&&(h=a.deletions,h===null?(a.deletions=[o],a.flags|=16):h.push(o)),a.child=v,a.memoizedState=null,v}function vc(o,a){return a=bf({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function Fi(o,a,h,v){return v!==null&&Zo(v),en(a,o.child,null,h),o=vc(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function St(o,a,h,v,_,k,F){if(h)return a.flags&256?(a.flags&=-257,v=tf(Error(t(422))),Fi(o,a,F,v)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(k=v.fallback,_=a.mode,v=bf({mode:"visible",children:v.children},_,0,null),k=ml(k,_,F,null),k.flags|=2,v.return=a,k.return=a,v.sibling=k,a.child=v,(a.mode&1)!==0&&en(a,o.child,null,F),a.child.memoizedState=ku(F),a.memoizedState=Cu,k);if((a.mode&1)===0)return Fi(o,a,F,null);if(_.data==="$!"){if(v=_.nextSibling&&_.nextSibling.dataset,v)var W=v.dgst;return v=W,k=Error(t(419)),v=tf(k,v,void 0),Fi(o,a,F,v)}if(W=(F&o.childLanes)!==0,Qn||W){if(v=_n,v!==null){switch(F&-F){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(v.suspendedLanes|F))!==0?0:_,_!==0&&_!==k.retryLane&&(k.retryLane=_,Ti(o,_),Ro(v,o,_,-1))}return Ep(),v=tf(Error(t(421))),Fi(o,a,F,v)}return _.data==="$?"?(a.flags|=128,a.child=o.child,a=U0.bind(null,o),_._reactRetry=a,null):(o=k.treeContext,Ls=ha(_.nextSibling),zn=a,$r=!0,Eo=null,o!==null&&(ro[no++]=Yo,ro[no++]=Jo,ro[no++]=tl,Yo=o.id,Jo=o.overflow,tl=a),a=vc(a,v.children),a.flags|=4096,a)}function Nu(o,a,h){o.lanes|=a;var v=o.alternate;v!==null&&(v.lanes|=a),Tn(o.return,a,h)}function Tu(o,a,h,v,_){var k=o.memoizedState;k===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:_}:(k.isBackwards=a,k.rendering=null,k.renderingStartTime=0,k.last=v,k.tail=h,k.tailMode=_)}function ba(o,a,h){var v=a.pendingProps,_=v.revealOrder,k=v.tail;if(Rn(o,a,v.children,h),v=Gr.current,(v&2)!==0)v=v&1|2,a.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Nu(o,h,a);else if(o.tag===19)Nu(o,h,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}if(jr(Gr,v),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(h=a.child,_=null;h!==null;)o=h.alternate,o!==null&&il(o)===null&&(_=h),h=h.sibling;h=_,h===null?(_=a.child,a.child=null):(_=h.sibling,h.sibling=null),Tu(a,!1,_,h,k);break;case"backwards":for(h=null,_=a.child,a.child=null;_!==null;){if(o=_.alternate,o!==null&&il(o)===null){a.child=_;break}o=_.sibling,_.sibling=h,h=_,_=o}Tu(a,!0,h,null,k);break;case"together":Tu(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function of(o,a){(a.mode&1)===0&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Co(o,a,h){if(o!==null&&(a.dependencies=o.dependencies),Ea|=a.lanes,(h&a.childLanes)===0)return null;if(o!==null&&a.child!==o.child)throw Error(t(153));if(a.child!==null){for(o=a.child,h=Ao(o,o.pendingProps),a.child=h,h.return=a;o.sibling!==null;)o=o.sibling,h=h.sibling=Ao(o,o.pendingProps),h.return=a;h.sibling=null}return a.child}function Bg(o,a,h){switch(a.tag){case 3:Hg(a),Qo();break;case 5:Hh(a);break;case 1:ms(a.type)&&to(a);break;case 4:zh(a,a.stateNode.containerInfo);break;case 10:var v=a.type._context,_=a.memoizedProps.value;jr(mu,v._currentValue),v._currentValue=_;break;case 13:if(v=a.memoizedState,v!==null)return v.dehydrated!==null?(jr(Gr,Gr.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?sf(o,a,h):(jr(Gr,Gr.current&1),o=Co(o,a,h),o!==null?o.sibling:null);jr(Gr,Gr.current&1);break;case 19:if(v=(h&a.childLanes)!==0,(o.flags&128)!==0){if(v)return ba(o,a,h);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),jr(Gr,Gr.current),v)break;return null;case 22:case 23:return a.lanes=0,sp(o,a,h)}return Co(o,a,h)}var An,cp,Gg,up;An=function(o,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)o.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},cp=function(){},Gg=function(o,a,h,v){var _=o.memoizedProps;if(_!==v){o=a.stateNode,Ai(ei.current);var k=null;switch(h){case"input":_=Te(o,_),v=Te(o,v),k=[];break;case"select":_=K({},_,{value:void 0}),v=K({},v,{value:void 0}),k=[];break;case"textarea":_=It(o,_),v=It(o,v),k=[];break;default:typeof _.onClick!="function"&&typeof v.onClick=="function"&&(o.onclick=Ad)}ut(h,v);var F;h=null;for(ye in _)if(!v.hasOwnProperty(ye)&&_.hasOwnProperty(ye)&&_[ye]!=null)if(ye==="style"){var W=_[ye];for(F in W)W.hasOwnProperty(F)&&(h||(h={}),h[F]="")}else ye!=="dangerouslySetInnerHTML"&&ye!=="children"&&ye!=="suppressContentEditableWarning"&&ye!=="suppressHydrationWarning"&&ye!=="autoFocus"&&(s.hasOwnProperty(ye)?k||(k=[]):(k=k||[]).push(ye,null));for(ye in v){var X=v[ye];if(W=_!=null?_[ye]:void 0,v.hasOwnProperty(ye)&&X!==W&&(X!=null||W!=null))if(ye==="style")if(W){for(F in W)!W.hasOwnProperty(F)||X&&X.hasOwnProperty(F)||(h||(h={}),h[F]="");for(F in X)X.hasOwnProperty(F)&&W[F]!==X[F]&&(h||(h={}),h[F]=X[F])}else h||(k||(k=[]),k.push(ye,h)),h=X;else ye==="dangerouslySetInnerHTML"?(X=X?X.__html:void 0,W=W?W.__html:void 0,X!=null&&W!==X&&(k=k||[]).push(ye,X)):ye==="children"?typeof X!="string"&&typeof X!="number"||(k=k||[]).push(ye,""+X):ye!=="suppressContentEditableWarning"&&ye!=="suppressHydrationWarning"&&(s.hasOwnProperty(ye)?(X!=null&&ye==="onScroll"&&Lr("scroll",o),k||W===X||(k=[])):(k=k||[]).push(ye,X))}h&&(k=k||[]).push("style",h);var ye=k;(a.updateQueue=ye)&&(a.flags|=4)}},up=function(o,a,h,v){h!==v&&(a.flags|=4)};function Ru(o,a){if(!$r)switch(o.tailMode){case"hidden":a=o.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function In(o){var a=o.alternate!==null&&o.alternate.child===o.child,h=0,v=0;if(a)for(var _=o.child;_!==null;)h|=_.lanes|_.childLanes,v|=_.subtreeFlags&14680064,v|=_.flags&14680064,_.return=o,_=_.sibling;else for(_=o.child;_!==null;)h|=_.lanes|_.childLanes,v|=_.subtreeFlags,v|=_.flags,_.return=o,_=_.sibling;return o.subtreeFlags|=v,o.childLanes=h,a}function P0(o,a,h){var v=a.pendingProps;switch(nl(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return In(a),null;case 1:return ms(a.type)&&jd(),In(a),null;case 3:return v=a.stateNode,xa(),Mr(ps),Mr($n),Wd(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(o===null||o.child===null)&&(hu(a)?a.flags|=4:o===null||o.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Eo!==null&&(wp(Eo),Eo=null))),cp(o,a),In(a),null;case 5:Gd(a);var _=Ai(cc.current);if(h=a.type,o!==null&&a.stateNode!=null)Gg(o,a,h,v,_),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!v){if(a.stateNode===null)throw Error(t(166));return In(a),null}if(o=Ai(ei.current),hu(a)){v=a.stateNode,h=a.type;var k=a.memoizedProps;switch(v[qo]=a,v[pa]=k,o=(a.mode&1)!==0,h){case"dialog":Lr("cancel",v),Lr("close",v);break;case"iframe":case"object":case"embed":Lr("load",v);break;case"video":case"audio":for(_=0;_<Si.length;_++)Lr(Si[_],v);break;case"source":Lr("error",v);break;case"img":case"image":case"link":Lr("error",v),Lr("load",v);break;case"details":Lr("toggle",v);break;case"input":gt(v,k),Lr("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!k.multiple},Lr("invalid",v);break;case"textarea":hr(v,k),Lr("invalid",v)}ut(h,k),_=null;for(var F in k)if(k.hasOwnProperty(F)){var W=k[F];F==="children"?typeof W=="string"?v.textContent!==W&&(k.suppressHydrationWarning!==!0&&lu(v.textContent,W,o),_=["children",W]):typeof W=="number"&&v.textContent!==""+W&&(k.suppressHydrationWarning!==!0&&lu(v.textContent,W,o),_=["children",""+W]):s.hasOwnProperty(F)&&W!=null&&F==="onScroll"&&Lr("scroll",v)}switch(h){case"input":He(v),Ut(v,k,!0);break;case"textarea":He(v),Xe(v);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(v.onclick=Ad)}v=_,a.updateQueue=v,v!==null&&(a.flags|=4)}else{F=_.nodeType===9?_:_.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=pt(h)),o==="http://www.w3.org/1999/xhtml"?h==="script"?(o=F.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof v.is=="string"?o=F.createElement(h,{is:v.is}):(o=F.createElement(h),h==="select"&&(F=o,v.multiple?F.multiple=!0:v.size&&(F.size=v.size))):o=F.createElementNS(o,h),o[qo]=a,o[pa]=v,An(o,a,!1,!1),a.stateNode=o;e:{switch(F=Ft(h,v),h){case"dialog":Lr("cancel",o),Lr("close",o),_=v;break;case"iframe":case"object":case"embed":Lr("load",o),_=v;break;case"video":case"audio":for(_=0;_<Si.length;_++)Lr(Si[_],o);_=v;break;case"source":Lr("error",o),_=v;break;case"img":case"image":case"link":Lr("error",o),Lr("load",o),_=v;break;case"details":Lr("toggle",o),_=v;break;case"input":gt(o,v),_=Te(o,v),Lr("invalid",o);break;case"option":_=v;break;case"select":o._wrapperState={wasMultiple:!!v.multiple},_=K({},v,{value:void 0}),Lr("invalid",o);break;case"textarea":hr(o,v),_=It(o,v),Lr("invalid",o);break;default:_=v}ut(h,_),W=_;for(k in W)if(W.hasOwnProperty(k)){var X=W[k];k==="style"?Ie(o,X):k==="dangerouslySetInnerHTML"?(X=X?X.__html:void 0,X!=null&&Er(o,X)):k==="children"?typeof X=="string"?(h!=="textarea"||X!=="")&&Dr(o,X):typeof X=="number"&&Dr(o,""+X):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(s.hasOwnProperty(k)?X!=null&&k==="onScroll"&&Lr("scroll",o):X!=null&&j(o,k,X,F))}switch(h){case"input":He(o),Ut(o,v,!1);break;case"textarea":He(o),Xe(o);break;case"option":v.value!=null&&o.setAttribute("value",""+ve(v.value));break;case"select":o.multiple=!!v.multiple,k=v.value,k!=null?et(o,!!v.multiple,k,!1):v.defaultValue!=null&&et(o,!!v.multiple,v.defaultValue,!0);break;default:typeof _.onClick=="function"&&(o.onclick=Ad)}switch(h){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return In(a),null;case 6:if(o&&a.stateNode!=null)up(o,a,o.memoizedProps,v);else{if(typeof v!="string"&&a.stateNode===null)throw Error(t(166));if(h=Ai(cc.current),Ai(ei.current),hu(a)){if(v=a.stateNode,h=a.memoizedProps,v[qo]=a,(k=v.nodeValue!==h)&&(o=zn,o!==null))switch(o.tag){case 3:lu(v.nodeValue,h,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&lu(v.nodeValue,h,(o.mode&1)!==0)}k&&(a.flags|=4)}else v=(h.nodeType===9?h:h.ownerDocument).createTextNode(v),v[qo]=a,a.stateNode=v}return In(a),null;case 13:if(Mr(Gr),v=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if($r&&Ls!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Lh(),Qo(),a.flags|=98560,k=!1;else if(k=hu(a),v!==null&&v.dehydrated!==null){if(o===null){if(!k)throw Error(t(318));if(k=a.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[qo]=a}else Qo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;In(a),k=!1}else Eo!==null&&(wp(Eo),Eo=null),k=!0;if(!k)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(v=v!==null,v!==(o!==null&&o.memoizedState!==null)&&v&&(a.child.flags|=8192,(a.mode&1)!==0&&(o===null||(Gr.current&1)!==0?pn===0&&(pn=3):Ep())),a.updateQueue!==null&&(a.flags|=4),In(a),null);case 4:return xa(),cp(o,a),o===null&&da(a.stateNode.containerInfo),In(a),null;case 10:return Ud(a.type._context),In(a),null;case 17:return ms(a.type)&&jd(),In(a),null;case 19:if(Mr(Gr),k=a.memoizedState,k===null)return In(a),null;if(v=(a.flags&128)!==0,F=k.rendering,F===null)if(v)Ru(k,!1);else{if(pn!==0||o!==null&&(o.flags&128)!==0)for(o=a.child;o!==null;){if(F=il(o),F!==null){for(a.flags|=128,Ru(k,!1),v=F.updateQueue,v!==null&&(a.updateQueue=v,a.flags|=4),a.subtreeFlags=0,v=h,h=a.child;h!==null;)k=h,o=v,k.flags&=14680066,F=k.alternate,F===null?(k.childLanes=0,k.lanes=o,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=F.childLanes,k.lanes=F.lanes,k.child=F.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=F.memoizedProps,k.memoizedState=F.memoizedState,k.updateQueue=F.updateQueue,k.type=F.type,o=F.dependencies,k.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),h=h.sibling;return jr(Gr,Gr.current&1|2),a.child}o=o.sibling}k.tail!==null&&Dt()>dl&&(a.flags|=128,v=!0,Ru(k,!1),a.lanes=4194304)}else{if(!v)if(o=il(F),o!==null){if(a.flags|=128,v=!0,h=o.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),Ru(k,!0),k.tail===null&&k.tailMode==="hidden"&&!F.alternate&&!$r)return In(a),null}else 2*Dt()-k.renderingStartTime>dl&&h!==1073741824&&(a.flags|=128,v=!0,Ru(k,!1),a.lanes=4194304);k.isBackwards?(F.sibling=a.child,a.child=F):(h=k.last,h!==null?h.sibling=F:a.child=F,k.last=F)}return k.tail!==null?(a=k.tail,k.rendering=a,k.tail=a.sibling,k.renderingStartTime=Dt(),a.sibling=null,h=Gr.current,jr(Gr,v?h&1|2:h&1),a):(In(a),null);case 22:case 23:return _p(),v=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==v&&(a.flags|=8192),v&&(a.mode&1)!==0?(Us&1073741824)!==0&&(In(a),a.subtreeFlags&6&&(a.flags|=8192)):In(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function F0(o,a){switch(nl(a),a.tag){case 1:return ms(a.type)&&jd(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return xa(),Mr(ps),Mr($n),Wd(),o=a.flags,(o&65536)!==0&&(o&128)===0?(a.flags=o&-65537|128,a):null;case 5:return Gd(a),null;case 13:if(Mr(Gr),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(t(340));Qo()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return Mr(Gr),null;case 4:return xa(),null;case 10:return Ud(a.type._context),null;case 22:case 23:return _p(),null;case 24:return null;default:return null}}var af=!1,Wr=!1,Zn=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function yc(o,a){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){Yr(o,a,v)}else h.current=null}function Au(o,a,h){try{h()}catch(v){Yr(o,a,v)}}var Wg=!1;function j0(o,a){if(cu=fd,o=kr(),ru(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var _=v.anchorOffset,k=v.focusNode;v=v.focusOffset;try{h.nodeType,k.nodeType}catch{h=null;break e}var F=0,W=-1,X=-1,ye=0,Fe=0,Oe=o,Pe=null;t:for(;;){for(var Ye;Oe!==h||_!==0&&Oe.nodeType!==3||(W=F+_),Oe!==k||v!==0&&Oe.nodeType!==3||(X=F+v),Oe.nodeType===3&&(F+=Oe.nodeValue.length),(Ye=Oe.firstChild)!==null;)Pe=Oe,Oe=Ye;for(;;){if(Oe===o)break t;if(Pe===h&&++ye===_&&(W=F),Pe===k&&++Fe===v&&(X=F),(Ye=Oe.nextSibling)!==null)break;Oe=Pe,Pe=Oe.parentNode}Oe=Ye}h=W===-1||X===-1?null:{start:W,end:X}}else h=null}h=h||{start:0,end:0}}else h=null;for(Za={focusedElem:o,selectionRange:h},fd=!1,Ze=a;Ze!==null;)if(a=Ze,o=a.child,(a.subtreeFlags&1028)!==0&&o!==null)o.return=a,Ze=o;else for(;Ze!==null;){a=Ze;try{var rt=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(rt!==null){var st=rt.memoizedProps,nn=rt.memoizedState,fe=a.stateNode,re=fe.getSnapshotBeforeUpdate(a.elementType===a.type?st:lo(a.type,st),nn);fe.__reactInternalSnapshotBeforeUpdate=re}break;case 3:var me=a.stateNode.containerInfo;me.nodeType===1?me.textContent="":me.nodeType===9&&me.documentElement&&me.removeChild(me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Le){Yr(a,a.return,Le)}if(o=a.sibling,o!==null){o.return=a.return,Ze=o;break}Ze=a.return}return rt=Wg,Wg=!1,rt}function ji(o,a,h){var v=a.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var _=v=v.next;do{if((_.tag&o)===o){var k=_.destroy;_.destroy=void 0,k!==void 0&&Au(a,h,k)}_=_.next}while(_!==v)}}function Iu(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&o)===o){var v=h.create;h.destroy=v()}h=h.next}while(h!==a)}}function lf(o){var a=o.ref;if(a!==null){var h=o.stateNode;switch(o.tag){case 5:o=h;break;default:o=h}typeof a=="function"?a(o):a.current=o}}function Vg(o){var a=o.alternate;a!==null&&(o.alternate=null,Vg(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&(delete a[qo],delete a[pa],delete a[Pd],delete a[O],delete a[nc])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function qg(o){return o.tag===5||o.tag===3||o.tag===4}function Kg(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||qg(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function dp(o,a,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(o,a):h.insertBefore(o,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(o,h)):(a=h,a.appendChild(o)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Ad));else if(v!==4&&(o=o.child,o!==null))for(dp(o,a,h),o=o.sibling;o!==null;)dp(o,a,h),o=o.sibling}function cf(o,a,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,a?h.insertBefore(o,a):h.appendChild(o);else if(v!==4&&(o=o.child,o!==null))for(cf(o,a,h),o=o.sibling;o!==null;)cf(o,a,h),o=o.sibling}var bn=null,ko=!1;function oi(o,a,h){for(h=h.child;h!==null;)fp(o,a,h),h=h.sibling}function fp(o,a,h){if(qn&&typeof qn.onCommitFiberUnmount=="function")try{qn.onCommitFiberUnmount(xi,h)}catch{}switch(h.tag){case 5:Wr||yc(h,a);case 6:var v=bn,_=ko;bn=null,oi(o,a,h),bn=v,ko=_,bn!==null&&(ko?(o=bn,h=h.stateNode,o.nodeType===8?o.parentNode.removeChild(h):o.removeChild(h)):bn.removeChild(h.stateNode));break;case 18:bn!==null&&(ko?(o=bn,h=h.stateNode,o.nodeType===8?jh(o.parentNode,h):o.nodeType===1&&jh(o,h),pr(o)):jh(bn,h.stateNode));break;case 4:v=bn,_=ko,bn=h.stateNode.containerInfo,ko=!0,oi(o,a,h),bn=v,ko=_;break;case 0:case 11:case 14:case 15:if(!Wr&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){_=v=v.next;do{var k=_,F=k.destroy;k=k.tag,F!==void 0&&((k&2)!==0||(k&4)!==0)&&Au(h,a,F),_=_.next}while(_!==v)}oi(o,a,h);break;case 1:if(!Wr&&(yc(h,a),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(W){Yr(h,a,W)}oi(o,a,h);break;case 21:oi(o,a,h);break;case 22:h.mode&1?(Wr=(v=Wr)||h.memoizedState!==null,oi(o,a,h),Wr=v):oi(o,a,h);break;default:oi(o,a,h)}}function xc(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new Zn),a.forEach(function(v){var _=z0.bind(null,o,v);h.has(v)||(h.add(v),v.then(_,_))})}}function $s(o,a){var h=a.deletions;if(h!==null)for(var v=0;v<h.length;v++){var _=h[v];try{var k=o,F=a,W=F;e:for(;W!==null;){switch(W.tag){case 5:bn=W.stateNode,ko=!1;break e;case 3:bn=W.stateNode.containerInfo,ko=!0;break e;case 4:bn=W.stateNode.containerInfo,ko=!0;break e}W=W.return}if(bn===null)throw Error(t(160));fp(k,F,_),bn=null,ko=!1;var X=_.alternate;X!==null&&(X.return=null),_.return=null}catch(ye){Yr(_,a,ye)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)hp(a,o),a=a.sibling}function hp(o,a){var h=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if($s(a,o),No(o),v&4){try{ji(3,o,o.return),Iu(3,o)}catch(st){Yr(o,o.return,st)}try{ji(5,o,o.return)}catch(st){Yr(o,o.return,st)}}break;case 1:$s(a,o),No(o),v&512&&h!==null&&yc(h,h.return);break;case 5:if($s(a,o),No(o),v&512&&h!==null&&yc(h,h.return),o.flags&32){var _=o.stateNode;try{Dr(_,"")}catch(st){Yr(o,o.return,st)}}if(v&4&&(_=o.stateNode,_!=null)){var k=o.memoizedProps,F=h!==null?h.memoizedProps:k,W=o.type,X=o.updateQueue;if(o.updateQueue=null,X!==null)try{W==="input"&&k.type==="radio"&&k.name!=null&&jt(_,k),Ft(W,F);var ye=Ft(W,k);for(F=0;F<X.length;F+=2){var Fe=X[F],Oe=X[F+1];Fe==="style"?Ie(_,Oe):Fe==="dangerouslySetInnerHTML"?Er(_,Oe):Fe==="children"?Dr(_,Oe):j(_,Fe,Oe,ye)}switch(W){case"input":ot(_,k);break;case"textarea":Ae(_,k);break;case"select":var Pe=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!k.multiple;var Ye=k.value;Ye!=null?et(_,!!k.multiple,Ye,!1):Pe!==!!k.multiple&&(k.defaultValue!=null?et(_,!!k.multiple,k.defaultValue,!0):et(_,!!k.multiple,k.multiple?[]:"",!1))}_[pa]=k}catch(st){Yr(o,o.return,st)}}break;case 6:if($s(a,o),No(o),v&4){if(o.stateNode===null)throw Error(t(162));_=o.stateNode,k=o.memoizedProps;try{_.nodeValue=k}catch(st){Yr(o,o.return,st)}}break;case 3:if($s(a,o),No(o),v&4&&h!==null&&h.memoizedState.isDehydrated)try{pr(a.containerInfo)}catch(st){Yr(o,o.return,st)}break;case 4:$s(a,o),No(o);break;case 13:$s(a,o),No(o),_=o.child,_.flags&8192&&(k=_.memoizedState!==null,_.stateNode.isHidden=k,!k||_.alternate!==null&&_.alternate.memoizedState!==null||(gp=Dt())),v&4&&xc(o);break;case 22:if(Fe=h!==null&&h.memoizedState!==null,o.mode&1?(Wr=(ye=Wr)||Fe,$s(a,o),Wr=ye):$s(a,o),No(o),v&8192){if(ye=o.memoizedState!==null,(o.stateNode.isHidden=ye)&&!Fe&&(o.mode&1)!==0)for(Ze=o,Fe=o.child;Fe!==null;){for(Oe=Ze=Fe;Ze!==null;){switch(Pe=Ze,Ye=Pe.child,Pe.tag){case 0:case 11:case 14:case 15:ji(4,Pe,Pe.return);break;case 1:yc(Pe,Pe.return);var rt=Pe.stateNode;if(typeof rt.componentWillUnmount=="function"){v=Pe,h=Pe.return;try{a=v,rt.props=a.memoizedProps,rt.state=a.memoizedState,rt.componentWillUnmount()}catch(st){Yr(v,h,st)}}break;case 5:yc(Pe,Pe.return);break;case 22:if(Pe.memoizedState!==null){_a(Oe);continue}}Ye!==null?(Ye.return=Pe,Ze=Ye):_a(Oe)}Fe=Fe.sibling}e:for(Fe=null,Oe=o;;){if(Oe.tag===5){if(Fe===null){Fe=Oe;try{_=Oe.stateNode,ye?(k=_.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(W=Oe.stateNode,X=Oe.memoizedProps.style,F=X!=null&&X.hasOwnProperty("display")?X.display:null,W.style.display=de("display",F))}catch(st){Yr(o,o.return,st)}}}else if(Oe.tag===6){if(Fe===null)try{Oe.stateNode.nodeValue=ye?"":Oe.memoizedProps}catch(st){Yr(o,o.return,st)}}else if((Oe.tag!==22&&Oe.tag!==23||Oe.memoizedState===null||Oe===o)&&Oe.child!==null){Oe.child.return=Oe,Oe=Oe.child;continue}if(Oe===o)break e;for(;Oe.sibling===null;){if(Oe.return===null||Oe.return===o)break e;Fe===Oe&&(Fe=null),Oe=Oe.return}Fe===Oe&&(Fe=null),Oe.sibling.return=Oe.return,Oe=Oe.sibling}}break;case 19:$s(a,o),No(o),v&4&&xc(o);break;case 21:break;default:$s(a,o),No(o)}}function No(o){var a=o.flags;if(a&2){try{e:{for(var h=o.return;h!==null;){if(qg(h)){var v=h;break e}h=h.return}throw Error(t(160))}switch(v.tag){case 5:var _=v.stateNode;v.flags&32&&(Dr(_,""),v.flags&=-33);var k=Kg(o);cf(o,k,_);break;case 3:case 4:var F=v.stateNode.containerInfo,W=Kg(o);dp(o,W,F);break;default:throw Error(t(161))}}catch(X){Yr(o,o.return,X)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function uf(o,a,h){Ze=o,pp(o)}function pp(o,a,h){for(var v=(o.mode&1)!==0;Ze!==null;){var _=Ze,k=_.child;if(_.tag===22&&v){var F=_.memoizedState!==null||af;if(!F){var W=_.alternate,X=W!==null&&W.memoizedState!==null||Wr;W=af;var ye=Wr;if(af=F,(Wr=X)&&!ye)for(Ze=_;Ze!==null;)F=Ze,X=F.child,F.tag===22&&F.memoizedState!==null?Yg(_):X!==null?(X.return=F,Ze=X):Yg(_);for(;k!==null;)Ze=k,pp(k),k=k.sibling;Ze=_,af=W,Wr=ye}To(o)}else(_.subtreeFlags&8772)!==0&&k!==null?(k.return=_,Ze=k):To(o)}}function To(o){for(;Ze!==null;){var a=Ze;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Wr||Iu(5,a);break;case 1:var v=a.stateNode;if(a.flags&4&&!Wr)if(h===null)v.componentDidMount();else{var _=a.elementType===a.type?h.memoizedProps:lo(a.type,h.memoizedProps);v.componentDidUpdate(_,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var k=a.updateQueue;k!==null&&Uh(a,k,v);break;case 3:var F=a.updateQueue;if(F!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}Uh(a,F,h)}break;case 5:var W=a.stateNode;if(h===null&&a.flags&4){h=W;var X=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":X.autoFocus&&h.focus();break;case"img":X.src&&(h.src=X.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var ye=a.alternate;if(ye!==null){var Fe=ye.memoizedState;if(Fe!==null){var Oe=Fe.dehydrated;Oe!==null&&pr(Oe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Wr||a.flags&512&&lf(a)}catch(Pe){Yr(a,a.return,Pe)}}if(a===o){Ze=null;break}if(h=a.sibling,h!==null){h.return=a.return,Ze=h;break}Ze=a.return}}function _a(o){for(;Ze!==null;){var a=Ze;if(a===o){Ze=null;break}var h=a.sibling;if(h!==null){h.return=a.return,Ze=h;break}Ze=a.return}}function Yg(o){for(;Ze!==null;){var a=Ze;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{Iu(4,a)}catch(X){Yr(a,h,X)}break;case 1:var v=a.stateNode;if(typeof v.componentDidMount=="function"){var _=a.return;try{v.componentDidMount()}catch(X){Yr(a,_,X)}}var k=a.return;try{lf(a)}catch(X){Yr(a,k,X)}break;case 5:var F=a.return;try{lf(a)}catch(X){Yr(a,F,X)}}}catch(X){Yr(a,a.return,X)}if(a===o){Ze=null;break}var W=a.sibling;if(W!==null){W.return=a.return,Ze=W;break}Ze=a.return}}var Jg=Math.ceil,df=P.ReactCurrentDispatcher,mp=P.ReactCurrentOwner,co=P.ReactCurrentBatchConfig,ar=0,_n=null,cn=null,Pn=0,Us=0,wc=hs(0),pn=0,Pu=null,Ea=0,Fu=0,ff=0,ju=null,ys=null,gp=0,dl=1/0,Oi=null,hf=!1,vp=null,Sa=null,pf=!1,Ca=null,es=0,Ou=0,yp=null,mf=-1,Du=0;function ts(){return(ar&6)!==0?Dt():mf!==-1?mf:mf=Dt()}function ka(o){return(o.mode&1)===0?1:(ar&2)!==0&&Pn!==0?Pn&-Pn:Rg.transition!==null?(Du===0&&(Du=Qc()),Du):(o=sr,o!==0||(o=window.event,o=o===void 0?16:tg(o.type)),o)}function Ro(o,a,h,v){if(50<Ou)throw Ou=0,yp=null,Error(t(185));qa(o,h,v),((ar&2)===0||o!==_n)&&(o===_n&&((ar&2)===0&&(Fu|=h),pn===4&&Na(o,Pn)),xs(o,v),h===1&&ar===0&&(a.mode&1)===0&&(dl=Dt()+500,Od&&ga()))}function xs(o,a){var h=o.callbackNode;mh(o,a);var v=wi(o,o===_n?Pn:0);if(v===0)h!==null&&De(h),o.callbackNode=null,o.callbackPriority=0;else if(a=v&-v,o.callbackPriority!==a){if(h!=null&&De(h),a===1)o.tag===0?el(Xg.bind(null,o)):kg(Xg.bind(null,o)),Id(function(){(ar&6)===0&&ga()}),h=null;else{switch(be(v)){case 1:h=Hr;break;case 4:h=fn;break;case 16:h=wn;break;case 536870912:h=qr;break;default:h=wn}h=sv(h,gf.bind(null,o))}o.callbackPriority=a,o.callbackNode=h}}function gf(o,a){if(mf=-1,Du=0,(ar&6)!==0)throw Error(t(327));var h=o.callbackNode;if(bc()&&o.callbackNode!==h)return null;var v=wi(o,o===_n?Pn:0);if(v===0)return null;if((v&30)!==0||(v&o.expiredLanes)!==0||a)a=vf(o,v);else{a=v;var _=ar;ar|=2;var k=Zg();(_n!==o||Pn!==a)&&(Oi=null,dl=Dt()+500,hl(o,a));do try{L0();break}catch(W){Qg(o,W)}while(!0);Ni(),df.current=k,ar=_,cn!==null?a=0:(_n=null,Pn=0,a=pn)}if(a!==0){if(a===2&&(_=zl(o),_!==0&&(v=_,a=xp(o,_))),a===1)throw h=Pu,hl(o,0),Na(o,v),xs(o,Dt()),h;if(a===6)Na(o,v);else{if(_=o.current.alternate,(v&30)===0&&!O0(_)&&(a=vf(o,v),a===2&&(k=zl(o),k!==0&&(v=k,a=xp(o,k))),a===1))throw h=Pu,hl(o,0),Na(o,v),xs(o,Dt()),h;switch(o.finishedWork=_,o.finishedLanes=v,a){case 0:case 1:throw Error(t(345));case 2:pl(o,ys,Oi);break;case 3:if(Na(o,v),(v&130023424)===v&&(a=gp+500-Dt(),10<a)){if(wi(o,0)!==0)break;if(_=o.suspendedLanes,(_&v)!==v){ts(),o.pingedLanes|=o.suspendedLanes&_;break}o.timeoutHandle=fa(pl.bind(null,o,ys,Oi),a);break}pl(o,ys,Oi);break;case 4:if(Na(o,v),(v&4194240)===v)break;for(a=o.eventTimes,_=-1;0<v;){var F=31-Ps(v);k=1<<F,F=a[F],F>_&&(_=F),v&=~k}if(v=_,v=Dt()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*Jg(v/1960))-v,10<v){o.timeoutHandle=fa(pl.bind(null,o,ys,Oi),v);break}pl(o,ys,Oi);break;case 5:pl(o,ys,Oi);break;default:throw Error(t(329))}}}return xs(o,Dt()),o.callbackNode===h?gf.bind(null,o):null}function xp(o,a){var h=ju;return o.current.memoizedState.isDehydrated&&(hl(o,a).flags|=256),o=vf(o,a),o!==2&&(a=ys,ys=h,a!==null&&wp(a)),o}function wp(o){ys===null?ys=o:ys.push.apply(ys,o)}function O0(o){for(var a=o;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var _=h[v],k=_.getSnapshot;_=_.value;try{if(!ge(k(),_))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Na(o,a){for(a&=~ff,a&=~Fu,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var h=31-Ps(a),v=1<<h;o[h]=-1,a&=~v}}function Xg(o){if((ar&6)!==0)throw Error(t(327));bc();var a=wi(o,0);if((a&1)===0)return xs(o,Dt()),null;var h=vf(o,a);if(o.tag!==0&&h===2){var v=zl(o);v!==0&&(a=v,h=xp(o,v))}if(h===1)throw h=Pu,hl(o,0),Na(o,a),xs(o,Dt()),h;if(h===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,pl(o,ys,Oi),xs(o,Dt()),null}function bp(o,a){var h=ar;ar|=1;try{return o(a)}finally{ar=h,ar===0&&(dl=Dt()+500,Od&&ga())}}function fl(o){Ca!==null&&Ca.tag===0&&(ar&6)===0&&bc();var a=ar;ar|=1;var h=co.transition,v=sr;try{if(co.transition=null,sr=1,o)return o()}finally{sr=v,co.transition=h,ar=a,(ar&6)===0&&ga()}}function _p(){Us=wc.current,Mr(wc)}function hl(o,a){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==-1&&(o.timeoutHandle=-1,du(h)),cn!==null)for(h=cn.return;h!==null;){var v=h;switch(nl(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&jd();break;case 3:xa(),Mr(ps),Mr($n),Wd();break;case 5:Gd(v);break;case 4:xa();break;case 13:Mr(Gr);break;case 19:Mr(Gr);break;case 10:Ud(v.type._context);break;case 22:case 23:_p()}h=h.return}if(_n=o,cn=o=Ao(o.current,null),Pn=Us=a,pn=0,Pu=null,ff=Fu=Ea=0,ys=ju=null,ol!==null){for(a=0;a<ol.length;a++)if(h=ol[a],v=h.interleaved,v!==null){h.interleaved=null;var _=v.next,k=h.pending;if(k!==null){var F=k.next;k.next=_,v.next=F}h.pending=v}ol=null}return o}function Qg(o,a){do{var h=cn;try{if(Ni(),yu.current=Xd,uc){for(var v=Kr.memoizedState;v!==null;){var _=v.queue;_!==null&&(_.pending=null),v=v.next}uc=!1}if(wa=0,hn=rn=Kr=null,xu=!1,al=0,mp.current=null,h===null||h.return===null){pn=1,Pu=a,cn=null;break}e:{var k=o,F=h.return,W=h,X=a;if(a=Pn,W.flags|=32768,X!==null&&typeof X=="object"&&typeof X.then=="function"){var ye=X,Fe=W,Oe=Fe.tag;if((Fe.mode&1)===0&&(Oe===0||Oe===11||Oe===15)){var Pe=Fe.alternate;Pe?(Fe.updateQueue=Pe.updateQueue,Fe.memoizedState=Pe.memoizedState,Fe.lanes=Pe.lanes):(Fe.updateQueue=null,Fe.memoizedState=null)}var Ye=Ug(F);if(Ye!==null){Ye.flags&=-257,rp(Ye,F,W,k,a),Ye.mode&1&&Su(k,ye,a),a=Ye,X=ye;var rt=a.updateQueue;if(rt===null){var st=new Set;st.add(X),a.updateQueue=st}else rt.add(X);break e}else{if((a&1)===0){Su(k,ye,a),Ep();break e}X=Error(t(426))}}else if($r&&W.mode&1){var nn=Ug(F);if(nn!==null){(nn.flags&65536)===0&&(nn.flags|=256),rp(nn,F,W,k,a),Zo(ul(X,W));break e}}k=X=ul(X,W),pn!==4&&(pn=2),ju===null?ju=[k]:ju.push(k),k=F;do{switch(k.tag){case 3:k.flags|=65536,a&=-a,k.lanes|=a;var fe=Eu(k,X,a);Pg(k,fe);break e;case 1:W=X;var re=k.type,me=k.stateNode;if((k.flags&128)===0&&(typeof re.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(Sa===null||!Sa.has(me)))){k.flags|=65536,a&=-a,k.lanes|=a;var Le=rf(k,W,a);Pg(k,Le);break e}}k=k.return}while(k!==null)}tv(h)}catch(ct){a=ct,cn===h&&h!==null&&(cn=h=h.return);continue}break}while(!0)}function Zg(){var o=df.current;return df.current=Xd,o===null?Xd:o}function Ep(){(pn===0||pn===3||pn===2)&&(pn=4),_n===null||(Ea&268435455)===0&&(Fu&268435455)===0||Na(_n,Pn)}function vf(o,a){var h=ar;ar|=2;var v=Zg();(_n!==o||Pn!==a)&&(Oi=null,hl(o,a));do try{D0();break}catch(_){Qg(o,_)}while(!0);if(Ni(),ar=h,df.current=v,cn!==null)throw Error(t(261));return _n=null,Pn=0,pn}function D0(){for(;cn!==null;)ev(cn)}function L0(){for(;cn!==null&&!We();)ev(cn)}function ev(o){var a=nv(o.alternate,o,Us);o.memoizedProps=o.pendingProps,a===null?tv(o):cn=a,mp.current=null}function tv(o){var a=o;do{var h=a.alternate;if(o=a.return,(a.flags&32768)===0){if(h=P0(h,a,Us),h!==null){cn=h;return}}else{if(h=F0(h,a),h!==null){h.flags&=32767,cn=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{pn=6,cn=null;return}}if(a=a.sibling,a!==null){cn=a;return}cn=a=o}while(a!==null);pn===0&&(pn=5)}function pl(o,a,h){var v=sr,_=co.transition;try{co.transition=null,sr=1,M0(o,a,h,v)}finally{co.transition=_,sr=v}return null}function M0(o,a,h,v){do bc();while(Ca!==null);if((ar&6)!==0)throw Error(t(327));h=o.finishedWork;var _=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var k=h.lanes|h.childLanes;if(ud(o,k),o===_n&&(cn=_n=null,Pn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||pf||(pf=!0,sv(wn,function(){return bc(),null})),k=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||k){k=co.transition,co.transition=null;var F=sr;sr=1;var W=ar;ar|=4,mp.current=null,j0(o,h),hp(h,o),T0(Za),fd=!!cu,Za=cu=null,o.current=h,uf(h),xr(),ar=W,sr=F,co.transition=k}else o.current=h;if(pf&&(pf=!1,Ca=o,es=_),k=o.pendingLanes,k===0&&(Sa=null),Jc(h.stateNode),xs(o,Dt()),a!==null)for(v=o.onRecoverableError,h=0;h<a.length;h++)_=a[h],v(_.value,{componentStack:_.stack,digest:_.digest});if(hf)throw hf=!1,o=vp,vp=null,o;return(es&1)!==0&&o.tag!==0&&bc(),k=o.pendingLanes,(k&1)!==0?o===yp?Ou++:(Ou=0,yp=o):Ou=0,ga(),null}function bc(){if(Ca!==null){var o=be(es),a=co.transition,h=sr;try{if(co.transition=null,sr=16>o?16:o,Ca===null)var v=!1;else{if(o=Ca,Ca=null,es=0,(ar&6)!==0)throw Error(t(331));var _=ar;for(ar|=4,Ze=o.current;Ze!==null;){var k=Ze,F=k.child;if((Ze.flags&16)!==0){var W=k.deletions;if(W!==null){for(var X=0;X<W.length;X++){var ye=W[X];for(Ze=ye;Ze!==null;){var Fe=Ze;switch(Fe.tag){case 0:case 11:case 15:ji(8,Fe,k)}var Oe=Fe.child;if(Oe!==null)Oe.return=Fe,Ze=Oe;else for(;Ze!==null;){Fe=Ze;var Pe=Fe.sibling,Ye=Fe.return;if(Vg(Fe),Fe===ye){Ze=null;break}if(Pe!==null){Pe.return=Ye,Ze=Pe;break}Ze=Ye}}}var rt=k.alternate;if(rt!==null){var st=rt.child;if(st!==null){rt.child=null;do{var nn=st.sibling;st.sibling=null,st=nn}while(st!==null)}}Ze=k}}if((k.subtreeFlags&2064)!==0&&F!==null)F.return=k,Ze=F;else e:for(;Ze!==null;){if(k=Ze,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:ji(9,k,k.return)}var fe=k.sibling;if(fe!==null){fe.return=k.return,Ze=fe;break e}Ze=k.return}}var re=o.current;for(Ze=re;Ze!==null;){F=Ze;var me=F.child;if((F.subtreeFlags&2064)!==0&&me!==null)me.return=F,Ze=me;else e:for(F=re;Ze!==null;){if(W=Ze,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:Iu(9,W)}}catch(ct){Yr(W,W.return,ct)}if(W===F){Ze=null;break e}var Le=W.sibling;if(Le!==null){Le.return=W.return,Ze=Le;break e}Ze=W.return}}if(ar=_,ga(),qn&&typeof qn.onPostCommitFiberRoot=="function")try{qn.onPostCommitFiberRoot(xi,o)}catch{}v=!0}return v}finally{sr=h,co.transition=a}}return!1}function yf(o,a,h){a=ul(h,a),a=Eu(o,a,1),o=io(o,a,1),a=ts(),o!==null&&(qa(o,1,a),xs(o,a))}function Yr(o,a,h){if(o.tag===3)yf(o,o,h);else for(;a!==null;){if(a.tag===3){yf(a,o,h);break}else if(a.tag===1){var v=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Sa===null||!Sa.has(v))){o=ul(h,o),o=rf(a,o,1),a=io(a,o,1),o=ts(),a!==null&&(qa(a,1,o),xs(a,o));break}}a=a.return}}function $0(o,a,h){var v=o.pingCache;v!==null&&v.delete(a),a=ts(),o.pingedLanes|=o.suspendedLanes&h,_n===o&&(Pn&h)===h&&(pn===4||pn===3&&(Pn&130023424)===Pn&&500>Dt()-gp?hl(o,0):ff|=h),xs(o,a)}function rv(o,a){a===0&&((o.mode&1)===0?a=1:(a=Bo,Bo<<=1,(Bo&130023424)===0&&(Bo=4194304)));var h=ts();o=Ti(o,a),o!==null&&(qa(o,a,h),xs(o,h))}function U0(o){var a=o.memoizedState,h=0;a!==null&&(h=a.retryLane),rv(o,h)}function z0(o,a){var h=0;switch(o.tag){case 13:var v=o.stateNode,_=o.memoizedState;_!==null&&(h=_.retryLane);break;case 19:v=o.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(a),rv(o,h)}var nv;nv=function(o,a,h){if(o!==null)if(o.memoizedProps!==a.pendingProps||ps.current)Qn=!0;else{if((o.lanes&h)===0&&(a.flags&128)===0)return Qn=!1,Bg(o,a,h);Qn=(o.flags&131072)!==0}else Qn=!1,$r&&(a.flags&1048576)!==0&&Ng(a,Ld,a.index);switch(a.lanes=0,a.tag){case 2:var v=a.type;of(o,a),o=a.pendingProps;var _=oc(a,$n.current);ya(a,h),_=ll(null,a,v,o,_,h);var k=Vd();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,ms(v)?(k=!0,to(a)):k=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Hd(a),_.updater=ef,a.stateNode=_,_._reactInternals=a,tp(a,v,o,h),a=lp(null,a,v,!0,k,h)):(a.tag=0,$r&&k&&fu(a),Rn(null,a,_,h),a=a.child),a;case 16:v=a.elementType;e:{switch(of(o,a),o=a.pendingProps,_=v._init,v=_(v._payload),a.type=v,_=a.tag=B0(v),o=lo(v,o),_){case 0:a=ip(null,a,v,o,h);break e;case 1:a=ap(null,a,v,o,h);break e;case 11:a=zg(null,a,v,o,h);break e;case 14:a=np(null,a,v,lo(v.type,o),h);break e}throw Error(t(306,v,""))}return a;case 0:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:lo(v,_),ip(o,a,v,_,h);case 1:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:lo(v,_),ap(o,a,v,_,h);case 3:e:{if(Hg(a),o===null)throw Error(t(387));v=a.pendingProps,k=a.memoizedState,_=k.element,Ig(o,a),lc(a,v,null,h);var F=a.memoizedState;if(v=F.element,k.isDehydrated)if(k={element:v,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},a.updateQueue.baseState=k,a.memoizedState=k,a.flags&256){_=ul(Error(t(423)),a),a=si(o,a,v,h,_);break e}else if(v!==_){_=ul(Error(t(424)),a),a=si(o,a,v,h,_);break e}else for(Ls=ha(a.stateNode.containerInfo.firstChild),zn=a,$r=!0,Eo=null,h=$d(a,null,v,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Qo(),v===_){a=Co(o,a,h);break e}Rn(o,a,v,h)}a=a.child}return a;case 5:return Hh(a),o===null&&gs(a),v=a.type,_=a.pendingProps,k=o!==null?o.memoizedProps:null,F=_.children,uu(v,_)?F=null:k!==null&&uu(v,k)&&(a.flags|=32),op(o,a),Rn(o,a,F,h),a.child;case 6:return o===null&&gs(a),null;case 13:return sf(o,a,h);case 4:return zh(a,a.stateNode.containerInfo),v=a.pendingProps,o===null?a.child=en(a,null,v,h):Rn(o,a,v,h),a.child;case 11:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:lo(v,_),zg(o,a,v,_,h);case 7:return Rn(o,a,a.pendingProps,h),a.child;case 8:return Rn(o,a,a.pendingProps.children,h),a.child;case 12:return Rn(o,a,a.pendingProps.children,h),a.child;case 10:e:{if(v=a.type._context,_=a.pendingProps,k=a.memoizedProps,F=_.value,jr(mu,v._currentValue),v._currentValue=F,k!==null)if(ge(k.value,F)){if(k.children===_.children&&!ps.current){a=Co(o,a,h);break e}}else for(k=a.child,k!==null&&(k.return=a);k!==null;){var W=k.dependencies;if(W!==null){F=k.child;for(var X=W.firstContext;X!==null;){if(X.context===v){if(k.tag===1){X=Ri(-1,h&-h),X.tag=2;var ye=k.updateQueue;if(ye!==null){ye=ye.shared;var Fe=ye.pending;Fe===null?X.next=X:(X.next=Fe.next,Fe.next=X),ye.pending=X}}k.lanes|=h,X=k.alternate,X!==null&&(X.lanes|=h),Tn(k.return,h,a),W.lanes|=h;break}X=X.next}}else if(k.tag===10)F=k.type===a.type?null:k.child;else if(k.tag===18){if(F=k.return,F===null)throw Error(t(341));F.lanes|=h,W=F.alternate,W!==null&&(W.lanes|=h),Tn(F,h,a),F=k.sibling}else F=k.child;if(F!==null)F.return=k;else for(F=k;F!==null;){if(F===a){F=null;break}if(k=F.sibling,k!==null){k.return=F.return,F=k;break}F=F.return}k=F}Rn(o,a,_.children,h),a=a.child}return a;case 9:return _=a.type,v=a.pendingProps.children,ya(a,h),_=so(_),v=v(_),a.flags|=1,Rn(o,a,v,h),a.child;case 14:return v=a.type,_=lo(v,a.pendingProps),_=lo(v.type,_),np(o,a,v,_,h);case 15:return ni(o,a,a.type,a.pendingProps,h);case 17:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:lo(v,_),of(o,a),a.tag=1,ms(v)?(o=!0,to(a)):o=!1,ya(a,h),cl(a,v,_),tp(a,v,_,h),lp(null,a,v,!0,o,h);case 19:return ba(o,a,h);case 22:return sp(o,a,h)}throw Error(t(156,a.tag))};function sv(o,a){return Q(o,a)}function H0(o,a,h,v){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function uo(o,a,h,v){return new H0(o,a,h,v)}function xf(o){return o=o.prototype,!(!o||!o.isReactComponent)}function B0(o){if(typeof o=="function")return xf(o)?1:0;if(o!=null){if(o=o.$$typeof,o===ue)return 11;if(o===se)return 14}return 2}function Ao(o,a){var h=o.alternate;return h===null?(h=uo(o.tag,a,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=a,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,a=o.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function wf(o,a,h,v,_,k){var F=2;if(v=o,typeof o=="function")xf(o)&&(F=1);else if(typeof o=="string")F=5;else e:switch(o){case $:return ml(h.children,_,k,a);case Y:F=8,_|=8;break;case J:return o=uo(12,h,a,_|2),o.elementType=J,o.lanes=k,o;case we:return o=uo(13,h,a,_),o.elementType=we,o.lanes=k,o;case ie:return o=uo(19,h,a,_),o.elementType=ie,o.lanes=k,o;case ee:return bf(h,_,k,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case he:F=10;break e;case te:F=9;break e;case ue:F=11;break e;case se:F=14;break e;case pe:F=16,v=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return a=uo(F,h,a,_),a.elementType=o,a.type=v,a.lanes=k,a}function ml(o,a,h,v){return o=uo(7,o,v,a),o.lanes=h,o}function bf(o,a,h,v){return o=uo(22,o,v,a),o.elementType=ee,o.lanes=h,o.stateNode={isHidden:!1},o}function Sp(o,a,h){return o=uo(6,o,null,a),o.lanes=h,o}function Cp(o,a,h){return a=uo(4,o.children!==null?o.children:[],o.key,a),a.lanes=h,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function G0(o,a,h,v,_){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Va(0),this.expirationTimes=Va(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Va(0),this.identifierPrefix=v,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function kp(o,a,h,v,_,k,F,W,X){return o=new G0(o,a,h,W,X),a===1?(a=1,k===!0&&(a|=8)):a=0,k=uo(3,null,null,a),o.current=k,k.stateNode=o,k.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hd(k),o}function W0(o,a,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:v==null?null:""+v,children:o,containerInfo:a,implementation:h}}function ov(o){if(!o)return ma;o=o._reactInternals;e:{if(Is(o)!==o||o.tag!==1)throw Error(t(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(ms(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(o.tag===1){var h=o.type;if(ms(h))return Sg(o,h,a)}return a}function iv(o,a,h,v,_,k,F,W,X){return o=kp(h,v,!0,o,_,k,F,W,X),o.context=ov(null),h=o.current,v=ts(),_=ka(h),k=Ri(v,_),k.callback=a??null,io(h,k,_),o.current.lanes=_,qa(o,_,v),xs(o,v),o}function _f(o,a,h,v){var _=a.current,k=ts(),F=ka(_);return h=ov(h),a.context===null?a.context=h:a.pendingContext=h,a=Ri(k,F),a.payload={element:o},v=v===void 0?null:v,v!==null&&(a.callback=v),o=io(_,a,F),o!==null&&(Ro(o,_,F,k),Bd(o,_,F)),F}function Ef(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function av(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<a?h:a}}function Np(o,a){av(o,a),(o=o.alternate)&&av(o,a)}function V0(){return null}var lv=typeof reportError=="function"?reportError:function(o){console.error(o)};function Sf(o){this._internalRoot=o}Lu.prototype.render=Sf.prototype.render=function(o){var a=this._internalRoot;if(a===null)throw Error(t(409));_f(o,a,null,null)},Lu.prototype.unmount=Sf.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var a=o.containerInfo;fl(function(){_f(null,o,null,null)}),a[Ds]=null}};function Lu(o){this._internalRoot=o}Lu.prototype.unstable_scheduleHydration=function(o){if(o){var a=Kt();o={blockedOn:null,target:o,priority:a};for(var h=0;h<aa.length&&a!==0&&a<aa[h].priority;h++);aa.splice(h,0,o),h===0&&Zm(o)}};function Tp(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Cf(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function cv(){}function q0(o,a,h,v,_){if(_){if(typeof v=="function"){var k=v;v=function(){var ye=Ef(F);k.call(ye)}}var F=iv(a,v,o,0,null,!1,!1,"",cv);return o._reactRootContainer=F,o[Ds]=F.current,da(o.nodeType===8?o.parentNode:o),fl(),F}for(;_=o.lastChild;)o.removeChild(_);if(typeof v=="function"){var W=v;v=function(){var ye=Ef(X);W.call(ye)}}var X=kp(o,0,!1,null,null,!1,!1,"",cv);return o._reactRootContainer=X,o[Ds]=X.current,da(o.nodeType===8?o.parentNode:o),fl(function(){_f(a,X,h,v)}),X}function gl(o,a,h,v,_){var k=h._reactRootContainer;if(k){var F=k;if(typeof _=="function"){var W=_;_=function(){var X=Ef(F);W.call(X)}}_f(a,F,o,_)}else F=q0(h,a,o,_,v);return Ef(F)}$e=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var h=Go(a.pendingLanes);h!==0&&(oa(a,h|1),xs(a,Dt()),(ar&6)===0&&(dl=Dt()+500,ga()))}break;case 13:fl(function(){var v=Ti(o,1);if(v!==null){var _=ts();Ro(v,o,1,_)}}),Np(o,1)}},at=function(o){if(o.tag===13){var a=Ti(o,134217728);if(a!==null){var h=ts();Ro(a,o,134217728,h)}Np(o,134217728)}},zt=function(o){if(o.tag===13){var a=ka(o),h=Ti(o,a);if(h!==null){var v=ts();Ro(h,o,a,v)}Np(o,a)}},Kt=function(){return sr},Ht=function(o,a){var h=sr;try{return sr=o,a()}finally{sr=h}},Nt=function(o,a,h){switch(a){case"input":if(ot(o,h),a=h.name,h.type==="radio"&&a!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var v=h[a];if(v!==o&&v.form===o.form){var _=Fd(v);if(!_)throw Error(t(90));Ue(v),ot(v,_)}}}break;case"textarea":Ae(o,h);break;case"select":a=h.value,a!=null&&et(o,!!h.multiple,a,!1)}},Ir=bp,ls=fl;var K0={usingClientEntryPoint:!1,Events:[Mn,Mt,Fd,As,Ji,bp]},Mu={findFiberByHostInstance:Ko,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Y0={bundleType:Mu.bundleType,version:Mu.version,rendererPackageName:Mu.rendererPackageName,rendererConfig:Mu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=na(o),o===null?null:o.stateNode},findFiberByHostInstance:Mu.findFiberByHostInstance||V0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kf.isDisabled&&kf.supportsFiber)try{xi=kf.inject(Y0),qn=kf}catch{}}return mo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K0,mo.createPortal=function(o,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tp(a))throw Error(t(200));return W0(o,a,null,h)},mo.createRoot=function(o,a){if(!Tp(o))throw Error(t(299));var h=!1,v="",_=lv;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=kp(o,1,!1,null,null,h,!1,v,_),o[Ds]=a.current,da(o.nodeType===8?o.parentNode:o),new Sf(a)},mo.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=na(a),o=o===null?null:o.stateNode,o},mo.flushSync=function(o){return fl(o)},mo.hydrate=function(o,a,h){if(!Cf(a))throw Error(t(200));return gl(null,o,a,!0,h)},mo.hydrateRoot=function(o,a,h){if(!Tp(o))throw Error(t(405));var v=h!=null&&h.hydratedSources||null,_=!1,k="",F=lv;if(h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(k=h.identifierPrefix),h.onRecoverableError!==void 0&&(F=h.onRecoverableError)),a=iv(a,null,o,1,h??null,_,!1,k,F),o[Ds]=a.current,da(o),v)for(o=0;o<v.length;o++)h=v[o],_=h._getVersion,_=_(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,_]:a.mutableSourceEagerHydrationData.push(h,_);return new Lu(a)},mo.render=function(o,a,h){if(!Cf(a))throw Error(t(200));return gl(null,o,a,!1,h)},mo.unmountComponentAtNode=function(o){if(!Cf(o))throw Error(t(40));return o._reactRootContainer?(fl(function(){gl(null,null,o,!1,function(){o._reactRootContainer=null,o[Ds]=null})}),!0):!1},mo.unstable_batchedUpdates=bp,mo.unstable_renderSubtreeIntoContainer=function(o,a,h,v){if(!Cf(h))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return gl(o,a,h,!1,v)},mo.version="18.3.1-next-f1338f8080-20240426",mo}var hS;function y1(){if(hS)return ux.exports;hS=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),ux.exports=DO(),ux.exports}var pS;function LO(){if(pS)return pv;pS=1;var r=y1();return pv.createRoot=r.createRoot,pv.hydrateRoot=r.hydrateRoot,pv}var MO=LO();const $O=kb(MO);class UO{constructor(e){H(this,"logger");H(this,"changeListeners",new Set);var t;this.logger=e,(t=chrome==null?void 0:chrome.storage)!=null&&t.onChanged&&chrome.storage.onChanged.addListener(this.handleStorageChange.bind(this))}async getLocalItem(e){try{const t=await new Promise((n,s)=>{chrome.storage.local.get(e,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})});try{if(t[e]!==void 0){const n=JSON.parse(t[e]);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),n}return null}catch{return this.logger.debug(`Local item with key: ${e} is not JSON, returning as is`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),t[e]}}catch(t){return this.logger.error(`Error retrieving local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){try{const n={[e]:JSON.stringify(t)};await new Promise((s,i)=>{chrome.storage.local.set(n,()=>{chrome.runtime.lastError?i(new Error(chrome.runtime.lastError.message)):s()})}),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"})}catch(n){throw this.logger.error(`Error storing local item with key: ${e}`,n,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"}),n}}async removeLocalItem(e){try{await new Promise((t,n)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):t()})}),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"})}catch(t){throw this.logger.error(`Error removing local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"}),t}}async clearLocal(){try{await new Promise((e,t)=>{chrome.storage.local.clear(()=>{chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e()})}),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"})}catch(e){throw this.logger.error("Error clearing local storage",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"}),e}}async getAllKeys(){try{const e=await new Promise((n,s)=>{chrome.storage.local.get(null,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})}),t=Object.keys(e);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),t}catch(e){return this.logger.error("Error getting all keys",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}onChanged(e){this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}handleStorageChange(e,t){if((t==="local"||t==="session"||t==="sync")&&this.changeListeners.size>0){const n={};for(const[s,i]of Object.entries(e))try{n[s]={oldValue:i.oldValue?JSON.parse(i.oldValue):void 0,newValue:i.newValue?JSON.parse(i.newValue):void 0}}catch(c){this.logger.debug("Storage change value not JSON",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange",key:s,areaName:t,error:c}),n[s]={oldValue:i.oldValue,newValue:i.newValue}}this.changeListeners.forEach(s=>{try{s(n)}catch(i){this.logger.error("Error in storage change callback",i,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange"})}})}}}class zO{constructor(e){H(this,"logger");H(this,"threadListeners",new Set);H(this,"currentThread",null);this.logger=e,this.initializeStorageListeners()}initializeStorageListeners(){var e,t,n;(t=(e=chrome==null?void 0:chrome.storage)==null?void 0:e.local)!=null&&t.onChanged&&chrome.storage.local.onChanged.addListener(s=>{Object.keys(s).some(c=>c.includes("threadId_window_")&&c.includes("_tab_")||c.includes("threadData_window_")&&c.includes("_tab_"))&&(this.logger.debug("Tab-specific thread data changed, triggering update",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",changedKeys:Object.keys(s)}),this.handleThreadDataChange())}),(n=chrome==null?void 0:chrome.tabs)!=null&&n.onActivated&&chrome.tabs.onActivated.addListener(s=>{this.logger.debug("Tab activated, updating thread data",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",tabId:s.tabId,windowId:s.windowId}),setTimeout(()=>{this.handleThreadDataChange()},100)})}async getCurrentTabInfo(){try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return!(e!=null&&e.id)||!(e!=null&&e.windowId)?(this.logger.warn("No active tab found",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null):{tabId:e.id,windowId:e.windowId}}catch(e){return this.logger.error("Error getting current tab info",e,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null}}async handleThreadDataChange(){var e;try{const t=await this.getCurrentTabInfo(),n=await this.getCurrentThread(),s=(n==null?void 0:n.threadId)||null,i=((e=this.currentThread)==null?void 0:e.threadId)||null;s!==i&&(this.logger.info("Notifying thread listeners for tab",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange",tabId:t==null?void 0:t.tabId,windowId:t==null?void 0:t.windowId,newThreadId:s,currentThreadId:i}),this.currentThread=n,this.notifyThreadListeners(n))}catch(t){this.logger.error("Error handling thread data change",t,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange"})}}async getCurrentThread(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`,i=`threadData_window_${n}_tab_${t}`;return new Promise(c=>{chrome.storage.local.get([s,i],u=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread data",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null);return}const p=u[s],m=u[i];if(!p||!m){this.logger.debug(`No thread data found for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,hasThreadId:!!p,hasThreadData:!!m}),c(null);return}try{const g=this.transformToEmailThread(p,m);this.logger.debug(`Retrieved thread data for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,threadId:p}),c(g)}catch(g){this.logger.error("Error transforming thread data",g,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null)}})})}async getCurrentThreadId(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread ID",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`;return new Promise(i=>{chrome.storage.local.get([s],c=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread ID",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n}),i(null);return}const u=c[s]||null;this.logger.debug(`Retrieved thread ID for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n,threadId:u}),i(u)})})}getCurrentUserEmail(){return this.logger.debug("getCurrentUserEmail called for Chrome - not needed, backend handles filtering",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}transformToEmailThread(e,t){var n;if(!t||!Array.isArray(t))return this.logger.warn("Invalid thread data format",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null;try{const s=t.map(c=>({from:c.from||"Unknown",timestamp:c.timestamp||new Date().toISOString(),subject:c.subject||"No Subject",body:c.body||"",html:c.html||c.body||""})),i=new Set;return t.forEach(c=>{c.from&&typeof c.from=="string"&&i.add(c.from),c.to&&Array.isArray(c.to)&&c.to.forEach(u=>{typeof u=="string"&&i.add(u)}),c.cc&&Array.isArray(c.cc)&&c.cc.forEach(u=>{typeof u=="string"&&i.add(u)}),c.bcc&&Array.isArray(c.bcc)&&c.bcc.forEach(u=>{typeof u=="string"&&i.add(u)})}),{threadId:e,messages:s,subject:((n=s[0])==null?void 0:n.subject)||"No Subject",participants:Array.from(i)}}catch(s){return this.logger.error("Error transforming email messages",s,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null}}}const HO="CandleLogsDB",BO=1,hx="logs";let Ip=null;function GO(){return Ip||(Ip=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(HO,BO);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(hx)){console.log(`[Logger] Creating object store: ${hx}`);const i=s.createObjectStore(hx,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),Ip=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),Ip)}GO().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const WO=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),VO=r=>WO(r)?["id_token","access_token","refresh_token","expires_in","token_type"].every(t=>{switch(t){case"expires_in":return typeof r[t]=="number";default:return typeof r[t]=="string"}}):!1,x1=r=>({setHttpHandler(e){r.httpHandler=e},httpHandler(){return r.httpHandler},updateHttpClientConfig(e,t){var n;(n=r.httpHandler)==null||n.updateHttpClientConfig(e,t)},httpHandlerConfigs(){return r.httpHandler.httpHandlerConfigs()}}),w1=r=>({httpHandler:r.httpHandler()});var ym;(function(r){r.HTTP="http",r.HTTPS="https"})(ym||(ym={}));var Xv;(function(r){r.MD5="md5",r.CRC32="crc32",r.CRC32C="crc32c",r.SHA1="sha1",r.SHA256="sha256"})(Xv||(Xv={}));const Ew="__smithy_context";class Uo{constructor(e){H(this,"method");H(this,"protocol");H(this,"hostname");H(this,"port");H(this,"path");H(this,"query");H(this,"headers");H(this,"username");H(this,"password");H(this,"fragment");H(this,"body");this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new Uo({...e,headers:{...e.headers}});return t.query&&(t.query=qO(t.query)),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&typeof t.query=="object"&&typeof t.headers=="object"}clone(){return Uo.clone(this)}}function qO(r){return Object.keys(r).reduce((e,t)=>{const n=r[t];return{...e,[t]:Array.isArray(n)?[...n]:n}},{})}class eh{constructor(e){H(this,"statusCode");H(this,"reason");H(this,"headers");H(this,"body");this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return typeof t.statusCode=="number"&&typeof t.headers=="object"}}const KO=r=>e=>async t=>{if(!Uo.isInstance(t.request))return e(t);const{request:n}=t,{handlerProtocol:s=""}=r.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let i=n.hostname;n.port!=null&&(i+=`:${n.port}`),n.headers.host=i}return e(t)},YO={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},b1=r=>({applyToStack:e=>{e.add(KO(r),YO)}}),JO=()=>(r,e)=>async t=>{var n,s;try{const i=await r(t),{clientName:c,commandName:u,logger:p,dynamoDbDocumentClientOptions:m={}}=e,{overrideInputFilterSensitiveLog:g,overrideOutputFilterSensitiveLog:x}=m,b=g??e.inputFilterSensitiveLog,E=x??e.outputFilterSensitiveLog,{$metadata:N,...S}=i.output;return(n=p==null?void 0:p.info)==null||n.call(p,{clientName:c,commandName:u,input:b(t.input),output:E(S),metadata:N}),i}catch(i){const{clientName:c,commandName:u,logger:p,dynamoDbDocumentClientOptions:m={}}=e,{overrideInputFilterSensitiveLog:g}=m,x=g??e.inputFilterSensitiveLog;throw(s=p==null?void 0:p.error)==null||s.call(p,{clientName:c,commandName:u,input:x(t.input),error:i,metadata:i.$metadata}),i}},XO={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},_1=r=>({applyToStack:e=>{e.add(JO(),XO)}}),QO={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},ZO=()=>r=>async e=>r(e),E1=r=>({applyToStack:e=>{e.add(ZO(),QO)}}),nd=r=>r[Ew]||(r[Ew]={}),zi=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},e2=(r,e)=>{if(!e||e.length===0)return r;const t=[];for(const n of e)for(const s of r)s.schemeId.split("#")[1]===n&&t.push(s);for(const n of r)t.find(({schemeId:s})=>s===n.schemeId)||t.push(n);return t};function t2(r){const e=new Map;for(const t of r)e.set(t.schemeId,t);return e}const r2=(r,e)=>(t,n)=>async s=>{var x;const i=r.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(r,n,s.input)),c=r.authSchemePreference?await r.authSchemePreference():[],u=e2(i,c),p=t2(r.httpAuthSchemes),m=nd(n),g=[];for(const b of u){const E=p.get(b.schemeId);if(!E){g.push(`HttpAuthScheme \`${b.schemeId}\` was not enabled for this service.`);continue}const N=E.identityProvider(await e.identityProviderConfigProvider(r));if(!N){g.push(`HttpAuthScheme \`${b.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:S={},signingProperties:T={}}=((x=b.propertiesExtractor)==null?void 0:x.call(b,r,n))||{};b.identityProperties=Object.assign(b.identityProperties||{},S),b.signingProperties=Object.assign(b.signingProperties||{},T),m.selectedHttpAuthScheme={httpAuthOption:b,identity:await N(b.identityProperties),signer:E.signer};break}if(!m.selectedHttpAuthScheme)throw new Error(g.join(`
`));return t(s)},n2={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},S1=(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t})=>({applyToStack:n=>{n.addRelativeTo(r2(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t}),n2)}}),s2={name:"serializerMiddleware"},o2=r=>e=>{throw e},i2=(r,e)=>{},a2=r=>(e,t)=>async n=>{if(!Uo.isInstance(n.request))return e(n);const i=nd(t).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:c={}},identity:u,signer:p}=i,m=await e({...n,request:await p.sign(n.request,u,c)}).catch((p.errorHandler||o2)(c));return(p.successHandler||i2)(m.response,c),m},l2={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},C1=r=>({applyToStack:e=>{e.addRelativeTo(a2(),l2)}}),fm=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},k1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mS=Object.entries(k1).reduce((r,[e,t])=>(r[t]=Number(e),r),{}),c2=k1.split(""),Wf=6,hm=8,u2=63,Mm=r=>{let e=r.length/4*3;r.slice(-2)==="=="?e-=2:r.slice(-1)==="="&&e--;const t=new ArrayBuffer(e),n=new DataView(t);for(let s=0;s<r.length;s+=4){let i=0,c=0;for(let m=s,g=s+3;m<=g;m++)if(r[m]!=="="){if(!(r[m]in mS))throw new TypeError(`Invalid character ${r[m]} in base64 string.`);i|=mS[r[m]]<<(g-m)*Wf,c+=Wf}else i>>=Wf;const u=s/4*3;i>>=c%hm;const p=Math.floor(c/hm);for(let m=0;m<p;m++){const g=(p-m-1)*hm;n.setUint8(u+m,(i&255<<g)>>g)}}return new Uint8Array(t)},Qu=r=>new TextEncoder().encode(r),xm=r=>typeof r=="string"?Qu(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r),Oy=r=>{if(typeof r=="string")return r;if(typeof r!="object"||typeof r.byteOffset!="number"||typeof r.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(r)};function wm(r){let e;typeof r=="string"?e=Qu(r):e=r;const t=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!t&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let i=0;i<e.length;i+=3){let c=0,u=0;for(let m=i,g=Math.min(i+3,e.length);m<g;m++)c|=e[m]<<(g-m-1)*hm,u+=hm;const p=Math.ceil(u/Wf);c<<=p*Wf-u;for(let m=1;m<=p;m++){const g=(p-m)*Wf;s+=c2[(c&u2<<g)>>g]}s+="==".slice(0,4-p)}return s}class Yu extends Uint8Array{static fromString(e,t="utf-8"){if(typeof e=="string")return t==="base64"?Yu.mutate(Mm(e)):Yu.mutate(Qu(e));throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,Yu.prototype),e}transformToString(e="utf-8"){return e==="base64"?wm(this):Oy(this)}}const Ju=r=>encodeURIComponent(r).replace(/[!'()*]/g,d2),d2=r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`;function f2(r){const e=[];for(let t of Object.keys(r).sort()){const n=r[t];if(t=Ju(t),Array.isArray(n))for(let s=0,i=n.length;s<i;s++)e.push(`${t}=${Ju(n[s])}`);else{let s=t;(n||typeof n=="string")&&(s+=`=${Ju(n)}`),e.push(s)}}return e.join("&")}function gS(r,e){return new Request(r,e)}function h2(r=0){return new Promise((e,t)=>{r&&setTimeout(()=>{const n=new Error(`Request did not complete within ${r} ms`);n.name="TimeoutError",t(n)},r)})}const px={supported:void 0};class Dy{constructor(e){H(this,"config");H(this,"configProvider");typeof e=="function"?this.configProvider=e().then(t=>t||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),px.supported===void 0&&(px.supported=typeof Request<"u"&&"keepalive"in gS("https://[::1]"))}static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new Dy(e)}destroy(){}async handle(e,{abortSignal:t,requestTimeout:n}={}){var A;this.config||(this.config=await this.configProvider);const s=n??this.config.requestTimeout,i=this.config.keepAlive===!0,c=this.config.credentials;if(t!=null&&t.aborted){const j=new Error("Request aborted");return j.name="AbortError",Promise.reject(j)}let u=e.path;const p=f2(e.query||{});p&&(u+=`?${p}`),e.fragment&&(u+=`#${e.fragment}`);let m="";if(e.username!=null||e.password!=null){const j=e.username??"",P=e.password??"";m=`${j}:${P}@`}const{port:g,method:x}=e,b=`${e.protocol}//${m}${e.hostname}${g?`:${g}`:""}${u}`,E=x==="GET"||x==="HEAD"?void 0:e.body,N={body:E,headers:new Headers(e.headers),method:x,credentials:c};(A=this.config)!=null&&A.cache&&(N.cache=this.config.cache),E&&(N.duplex="half"),typeof AbortController<"u"&&(N.signal=t),px.supported&&(N.keepalive=i),typeof this.config.requestInit=="function"&&Object.assign(N,this.config.requestInit(e));let S=()=>{};const T=gS(b,N),R=[fetch(T).then(j=>{const P=j.headers,U={};for(const $ of P.entries())U[$[0]]=$[1];return j.body!=null?{response:new eh({headers:U,reason:j.statusText,statusCode:j.status,body:j.body})}:j.blob().then($=>({response:new eh({headers:U,reason:j.statusText,statusCode:j.status,body:$})}))}),h2(s)];return t&&R.push(new Promise((j,P)=>{const U=()=>{const B=new Error("Request aborted");B.name="AbortError",P(B)};if(typeof t.addEventListener=="function"){const B=t;B.addEventListener("abort",U,{once:!0}),S=()=>B.removeEventListener("abort",U)}else t.onabort=U})),Promise.race(R).finally(S)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=t,n))}httpHandlerConfigs(){return this.config??{}}}const N1=async r=>{var e;return typeof Blob=="function"&&r instanceof Blob||((e=r.constructor)==null?void 0:e.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await r.arrayBuffer()):p2(r):m2(r)};async function p2(r){const e=await g2(r),t=Mm(e);return new Uint8Array(t)}async function m2(r){const e=[],t=r.getReader();let n=!1,s=0;for(;!n;){const{done:u,value:p}=await t.read();p&&(e.push(p),s+=p.length),n=u}const i=new Uint8Array(s);let c=0;for(const u of e)i.set(u,c),c+=u.length;return i}function g2(r){return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState!==2)return t(new Error("Reader aborted too early"));const s=n.result??"",i=s.indexOf(","),c=i>-1?i+1:s.length;e(s.substring(c))},n.onabort=()=>t(new Error("Read aborted")),n.onerror=()=>t(n.error),n.readAsDataURL(r)})}const T1={},Sw={};for(let r=0;r<256;r++){let e=r.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),T1[r]=e,Sw[e]=r}function v2(r){if(r.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2){const n=r.slice(t,t+2).toLowerCase();if(n in Sw)e[t/2]=Sw[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function Xu(r){let e="";for(let t=0;t<r.byteLength;t++)e+=T1[r[t]];return e}const Cw=async(r=new Uint8Array,e)=>{if(r instanceof Uint8Array)return Yu.mutate(r);if(!r)return Yu.mutate(new Uint8Array);const t=e.streamCollector(r);return Yu.mutate(await t)},Lv=r=>typeof r=="function"?r():r,R1=(r,e,t,n,s)=>({name:e,namespace:r,traits:t,input:n,output:s}),y2=r=>(e,t)=>async n=>{var x,b,E,N;const{response:s}=await e(n),{operationSchema:i}=nd(t),[,c,u,p,m,g]=i??[];try{const S=await r.protocol.deserializeResponse(R1(c,u,p,m,g),{...r,...t},s);return{response:s,output:S}}catch(S){if(Object.defineProperty(S,"$response",{value:s,enumerable:!1,writable:!1,configurable:!1}),!("$metadata"in S)){const T="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{S.message+=`
  `+T}catch{!t.logger||((b=(x=t.logger)==null?void 0:x.constructor)==null?void 0:b.name)==="NoOpLogger"?console.warn(T):(N=(E=t.logger)==null?void 0:E.warn)==null||N.call(E,T)}typeof S.$responseBodyText<"u"&&S.$response&&(S.$response.body=S.$responseBodyText);try{if(eh.isInstance(s)){const{headers:R={}}=s,A=Object.entries(R);S.$metadata={httpStatusCode:s.statusCode,requestId:mx(/^x-[\w-]+-request-?id$/,A),extendedRequestId:mx(/^x-[\w-]+-id-2$/,A),cfId:mx(/^x-[\w-]+-cf-id$/,A)}}}catch{}}throw S}},mx=(r,e)=>(e.find(([t])=>t.match(r))||[void 0,void 0])[1],x2=r=>(e,t)=>async n=>{var b;const{operationSchema:s}=nd(t),[,i,c,u,p,m]=s??[],g=(b=t.endpointV2)!=null&&b.url&&r.urlParser?async()=>r.urlParser(t.endpointV2.url):r.endpoint,x=await r.protocol.serializeRequest(R1(i,c,u,p,m),n.input,{...r,...t,endpoint:g});return e({...n,request:x})},w2={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},b2={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function A1(r){return{applyToStack:e=>{e.add(x2(r),b2),e.add(y2(r),w2),r.protocol.setSerdeContext(r)}}}function Zp(r){if(typeof r=="object")return r;r=r|0;const e={};let t=0;for(const n of["httpLabel","idempotent","idempotencyToken","sensitive","httpPayload","httpResponseCode","httpQueryParams"])(r>>t++&1)===1&&(e[n]=1);return e}const vS={it:Symbol.for("@smithy/nor-struct-it")},Pc=class Pc{constructor(e,t){H(this,"ref");H(this,"memberName");H(this,"symbol",Pc.symbol);H(this,"name");H(this,"schema");H(this,"_isMemberSchema");H(this,"traits");H(this,"memberTraits");H(this,"normalizedTraits");this.ref=e,this.memberName=t;const n=[];let s=e,i=e;for(this._isMemberSchema=!1;gx(s);)n.push(s[1]),s=s[0],i=Lv(s),this._isMemberSchema=!0;if(n.length>0){this.memberTraits={};for(let c=n.length-1;c>=0;--c){const u=n[c];Object.assign(this.memberTraits,Zp(u))}}else this.memberTraits=0;if(i instanceof Pc){const c=this.memberTraits;Object.assign(this,i),this.memberTraits=Object.assign({},c,i.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.memberName=t??i.memberName;return}if(this.schema=Lv(i),_2(this.schema)?(this.name=`${this.schema[1]}#${this.schema[2]}`,this.traits=this.schema[3]):(this.name=this.memberName??String(i),this.traits=0),this._isMemberSchema&&!t)throw new Error(`@smithy/core/schema - NormalizedSchema member init ${this.getName(!0)} missing member name.`)}static[Symbol.hasInstance](e){const t=this.prototype.isPrototypeOf(e);return!t&&typeof e=="object"&&e!==null?e.symbol===this.symbol:t}static of(e){const t=Lv(e);if(t instanceof Pc)return t;if(gx(t)){const[n,s]=t;if(n instanceof Pc)return Object.assign(n.getMergedTraits(),Zp(s)),n;throw new Error(`@smithy/core/schema - may not init unwrapped member schema=${JSON.stringify(e,null,2)}.`)}return new Pc(t)}getSchema(){const e=this.schema;return Array.isArray(e)&&e[0]===0?e[4]:e}getName(e=!1){const{name:t}=this;return!e&&t&&t.includes("#")?t.split("#")[1]:t||void 0}getMemberName(){return this.memberName}isMemberSchema(){return this._isMemberSchema}isListSchema(){const e=this.getSchema();return typeof e=="number"?e>=64&&e<128:e[0]===1}isMapSchema(){const e=this.getSchema();return typeof e=="number"?e>=128&&e<=255:e[0]===2}isStructSchema(){const e=this.getSchema();if(typeof e!="object")return!1;const t=e[0];return t===3||t===-3||t===4}isUnionSchema(){const e=this.getSchema();return typeof e!="object"?!1:e[0]===4}isBlobSchema(){const e=this.getSchema();return e===21||e===42}isTimestampSchema(){const e=this.getSchema();return typeof e=="number"&&e>=4&&e<=7}isUnitSchema(){return this.getSchema()==="unit"}isDocumentSchema(){return this.getSchema()===15}isStringSchema(){return this.getSchema()===0}isBooleanSchema(){return this.getSchema()===2}isNumericSchema(){return this.getSchema()===1}isBigIntegerSchema(){return this.getSchema()===17}isBigDecimalSchema(){return this.getSchema()===19}isStreaming(){const{streaming:e}=this.getMergedTraits();return!!e||this.getSchema()===42}isIdempotencyToken(){return!!this.getMergedTraits().idempotencyToken}getMergedTraits(){return this.normalizedTraits??(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()})}getMemberTraits(){return Zp(this.memberTraits)}getOwnTraits(){return Zp(this.traits)}getKeySchema(){const[e,t]=[this.isDocumentSchema(),this.isMapSchema()];if(!e&&!t)throw new Error(`@smithy/core/schema - cannot get key for non-map: ${this.getName(!0)}`);const n=this.getSchema(),s=e?15:n[4]??0;return Pp([s,0],"key")}getValueSchema(){const e=this.getSchema(),[t,n,s]=[this.isDocumentSchema(),this.isMapSchema(),this.isListSchema()],i=typeof e=="number"?63&e:e&&typeof e=="object"&&(n||s)?e[3+e[0]]:t?15:void 0;if(i!=null)return Pp([i,0],n?"value":"member");throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no value member.`)}getMemberSchema(e){const t=this.getSchema();if(this.isStructSchema()&&t[4].includes(e)){const n=t[4].indexOf(e),s=t[5][n];return Pp(gx(s)?s:[s,0],e)}if(this.isDocumentSchema())return Pp([15,0],e);throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no no member=${e}.`)}getMemberSchemas(){const e={};try{for(const[t,n]of this.structIterator())e[t]=n}catch{}return e}getEventStreamMember(){if(this.isStructSchema()){for(const[e,t]of this.structIterator())if(t.isStreaming()&&t.isStructSchema())return e}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw new Error("@smithy/core/schema - cannot iterate non-struct schema.");const e=this.getSchema(),t=e[4].length;let n=e[vS.it];if(n&&t===n.length){yield*n;return}n=Array(t);for(let s=0;s<t;++s){const i=e[4][s],c=Pp([e[5][s],0],i);yield n[s]=[i,c]}e[vS.it]=n}};H(Pc,"symbol",Symbol.for("@smithy/nor"));let xo=Pc;function Pp(r,e){if(r instanceof xo)return Object.assign(r,{memberName:e,_isMemberSchema:!0});const t=xo;return new t(r,e)}const gx=r=>Array.isArray(r)&&r.length===2,_2=r=>Array.isArray(r)&&r.length>=5,ja=class ja{constructor(e,t=new Map,n=new Map){H(this,"namespace");H(this,"schemas");H(this,"exceptions");this.namespace=e,this.schemas=t,this.exceptions=n}static for(e){return ja.registries.has(e)||ja.registries.set(e,new ja(e)),ja.registries.get(e)}register(e,t){const n=this.normalizeShapeId(e);ja.for(n.split("#")[0]).schemas.set(n,t)}getSchema(e){const t=this.normalizeShapeId(e);if(!this.schemas.has(t))throw new Error(`@smithy/core/schema - schema not found for ${t}`);return this.schemas.get(t)}registerError(e,t){const n=e,s=ja.for(n[1]);s.schemas.set(n[1]+"#"+n[2],n),s.exceptions.set(n,t)}getErrorCtor(e){const t=e;return ja.for(t[1]).exceptions.get(t)}getBaseException(){for(const e of this.exceptions.keys())if(Array.isArray(e)){const[,t,n]=e,s=t+"#"+n;if(s.startsWith("smithy.ts.sdk.synthetic.")&&s.endsWith("ServiceException"))return e}}find(e){return[...this.schemas.values()].find(e)}clear(){this.schemas.clear(),this.exceptions.clear()}normalizeShapeId(e){return e.includes("#")?e:this.namespace+"#"+e}};H(ja,"registries",new Map);let dt=ja;const kw=r=>{if(r!=null){if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return String(e)!==String(r)&&I2.warn(A2(`Expected number but observed string: ${r}`)),e}if(typeof r=="number")return r;throw new TypeError(`Expected number, got ${typeof r}: ${r}`)}},E2=Math.ceil(2**127*(2-2**-23)),yS=r=>{const e=kw(r);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>E2)throw new TypeError(`Expected 32-bit float, got ${r}`);return e},S2=r=>{if(r!=null){if(Number.isInteger(r)&&!Number.isNaN(r))return r;throw new TypeError(`Expected integer, got ${typeof r}: ${r}`)}},xS=r=>I1(r,16),wS=r=>I1(r,8),I1=(r,e)=>{const t=S2(r);if(t!==void 0&&C2(t,e)!==t)throw new TypeError(`Expected ${e}-bit integer, got ${r}`);return t},C2=(r,e)=>{switch(e){case 32:return Int32Array.of(r)[0];case 16:return Int16Array.of(r)[0];case 8:return Int8Array.of(r)[0]}},k2=r=>kw(typeof r=="string"?Ly(r):r),N2=r=>yS(typeof r=="string"?Ly(r):r),T2=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,Ly=r=>{const e=r.match(T2);if(e===null||e[0].length!==r.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(r)},Qv=r=>xS(typeof r=="string"?Ly(r):r),R2=r=>wS(typeof r=="string"?Ly(r):r),A2=r=>String(new TypeError(r).stack||r).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),I2={warn:console.warn},P2=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Rb=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function F2(r){const e=r.getUTCFullYear(),t=r.getUTCMonth(),n=r.getUTCDay(),s=r.getUTCDate(),i=r.getUTCHours(),c=r.getUTCMinutes(),u=r.getUTCSeconds(),p=s<10?`0${s}`:`${s}`,m=i<10?`0${i}`:`${i}`,g=c<10?`0${c}`:`${c}`,x=u<10?`0${u}`:`${u}`;return`${P2[n]}, ${p} ${Rb[t]} ${e} ${m}:${g}:${x} GMT`}const j2=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),O2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=j2.exec(r);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[t,n,s,i,c,u,p,m,g]=e,x=Qv(bm(n)),b=Dc(s,"month",1,12),E=Dc(i,"day",1,31),N=Mv(x,b,E,{hours:c,minutes:u,seconds:p,fractionalMilliseconds:m});return g.toUpperCase()!="Z"&&N.setTime(N.getTime()-K2(g)),N},D2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),L2=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),M2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),$2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=D2.exec(r);if(e){const[t,n,s,i,c,u,p,m]=e;return Mv(Qv(bm(i)),vx(s),Dc(n,"day",1,31),{hours:c,minutes:u,seconds:p,fractionalMilliseconds:m})}if(e=L2.exec(r),e){const[t,n,s,i,c,u,p,m]=e;return B2(Mv(z2(i),vx(s),Dc(n,"day",1,31),{hours:c,minutes:u,seconds:p,fractionalMilliseconds:m}))}if(e=M2.exec(r),e){const[t,n,s,i,c,u,p,m]=e;return Mv(Qv(bm(m)),vx(n),Dc(s.trimLeft(),"day",1,31),{hours:i,minutes:c,seconds:u,fractionalMilliseconds:p})}throw new TypeError("Invalid RFC-7231 date-time value")},U2=r=>{if(r==null)return;let e;if(typeof r=="number")e=r;else if(typeof r=="string")e=k2(r);else if(typeof r=="object"&&r.tag===1)e=r.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},Mv=(r,e,t,n)=>{const s=e-1;return W2(r,s,t),new Date(Date.UTC(r,s,t,Dc(n.hours,"hour",0,23),Dc(n.minutes,"minute",0,59),Dc(n.seconds,"seconds",0,60),q2(n.fractionalMilliseconds)))},z2=r=>{const e=new Date().getUTCFullYear(),t=Math.floor(e/100)*100+Qv(bm(r));return t<e?t+100:t},H2=50*365*24*60*60*1e3,B2=r=>r.getTime()-new Date().getTime()>H2?new Date(Date.UTC(r.getUTCFullYear()-100,r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())):r,vx=r=>{const e=Rb.indexOf(r);if(e<0)throw new TypeError(`Invalid month: ${r}`);return e+1},G2=[31,28,31,30,31,30,31,31,30,31,30,31],W2=(r,e,t)=>{let n=G2[e];if(e===1&&V2(r)&&(n=29),t>n)throw new TypeError(`Invalid day for ${Rb[e]} in ${r}: ${t}`)},V2=r=>r%4===0&&(r%100!==0||r%400===0),Dc=(r,e,t,n)=>{const s=R2(bm(r));if(s<t||s>n)throw new TypeError(`${e} must be between ${t} and ${n}, inclusive`);return s},q2=r=>r==null?0:N2("0."+r)*1e3,K2=r=>{const e=r[0];let t=1;if(e=="+")t=1;else if(e=="-")t=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const n=Number(r.substring(1,3)),s=Number(r.substring(4,6));return t*(n*60+s)*60*1e3},bm=r=>{let e=0;for(;e<r.length-1&&r.charAt(e)==="0";)e++;return e===0?r:r.slice(e)},bS=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ws=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0")),P1=()=>{if(bS)return bS();const r=new Uint8Array(16);return crypto.getRandomValues(r),r[6]=r[6]&15|64,r[8]=r[8]&63|128,ws[r[0]]+ws[r[1]]+ws[r[2]]+ws[r[3]]+"-"+ws[r[4]]+ws[r[5]]+"-"+ws[r[6]]+ws[r[7]]+"-"+ws[r[8]]+ws[r[9]]+"-"+ws[r[10]]+ws[r[11]]+ws[r[12]]+ws[r[13]]+ws[r[14]]+ws[r[15]]},jc=function(e){return Object.assign(new String(e),{deserializeJSON(){return JSON.parse(String(e))},toString(){return String(e)},toJSON(){return String(e)}})};jc.from=r=>r&&typeof r=="object"&&(r instanceof jc||"deserializeJSON"in r)?r:typeof r=="string"||Object.getPrototypeOf(r)===String.prototype?jc(String(r)):jc(JSON.stringify(r));jc.fromObject=jc.from;const _S=/^-?\d*(\.\d+)?$/;class Ma{constructor(e,t){H(this,"string");H(this,"type");if(this.string=e,this.type=t,!_S.test(e))throw new Error('@smithy/core/serde - NumericValue must only contain [0-9], at most one decimal point ".", and an optional negation prefix "-".')}toString(){return this.string}static[Symbol.hasInstance](e){if(!e||typeof e!="object")return!1;const t=e;return Ma.prototype.isPrototypeOf(e)||t.type==="bigDecimal"&&_S.test(t.string)}}const Y2="modulepreload",J2=function(r){return"/FileServer_Prod/dist-outlook-addin/"+r},ES={},Nw=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),p=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));s=c(t.map(m=>{if(m=J2(m),m in ES)return;ES[m]=!0;const g=m.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":Y2,g||(b.as="script"),b.crossOrigin="",b.href=m,p&&b.setAttribute("nonce",p),document.head.appendChild(b),g)return new Promise((E,N)=>{b.addEventListener("load",E),b.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return s.then(c=>{for(const u of c||[])u.status==="rejected"&&i(u.reason);return e().catch(i)})};class X2{constructor(){H(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class Q2 extends X2{constructor(t){super();H(this,"options");this.options=t}getRequestType(){return Uo}getResponseType(){return eh}setSerdeContext(t){this.serdeContext=t,this.serializer.setSerdeContext(t),this.deserializer.setSerdeContext(t),this.getPayloadCodec()&&this.getPayloadCodec().setSerdeContext(t)}updateServiceEndpoint(t,n){if("url"in n){t.protocol=n.url.protocol,t.hostname=n.url.hostname,t.port=n.url.port?Number(n.url.port):void 0,t.path=n.url.pathname,t.fragment=n.url.hash||void 0,t.username=n.url.username||void 0,t.password=n.url.password||void 0,t.query||(t.query={});for(const[s,i]of n.url.searchParams.entries())t.query[s]=i;return t}else return t.protocol=n.protocol,t.hostname=n.hostname,t.port=n.port?Number(n.port):void 0,t.path=n.path,t.query={...n.query},t}setHostPrefix(t,n,s){var u,p;if((u=this.serdeContext)!=null&&u.disableHostPrefix)return;const i=xo.of(n.input),c=Zp(n.traits??{});if(c.endpoint){let m=(p=c.endpoint)==null?void 0:p[0];if(typeof m=="string"){const g=[...i.structIterator()].filter(([,x])=>x.getMergedTraits().hostLabel);for(const[x]of g){const b=s[x];if(typeof b!="string")throw new Error(`@smithy/core/schema - ${x} in input must be a string as hostLabel.`);m=m.replace(`{${x}}`,b)}t.hostname=m+t.hostname}}}deserializeMetadata(t){return{httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}}async serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s}){return(await this.loadEventStreamCapability()).serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s})}async deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s}){return(await this.loadEventStreamCapability()).deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s})}async loadEventStreamCapability(){const{EventStreamSerde:t}=await Nw(async()=>{const{EventStreamSerde:n}=await import("./index.DS5eee3c.js");return{EventStreamSerde:n}},__vite__mapDeps([0,1]));return new t({marshaller:this.getEventStreamMarshaller(),serializer:this.serializer,deserializer:this.deserializer,serdeContext:this.serdeContext,defaultContentType:this.getDefaultContentType()})}getDefaultContentType(){throw new Error(`@smithy/core/protocols - ${this.constructor.name} getDefaultContentType() implementation missing.`)}async deserializeHttpMessage(t,n,s,i,c){return[]}getEventStreamMarshaller(){const t=this.serdeContext;if(!t.eventStreamMarshaller)throw new Error("@smithy/core - HttpProtocol: eventStreamMarshaller missing in serdeContext.");return t.eventStreamMarshaller}}class Z2 extends Q2{async serializeRequest(e,t,n){const s=this.serializer,i={},c={},u=await n.endpoint(),p=xo.of(e==null?void 0:e.input),m=p.getSchema();let g;const x=new Uo({protocol:"",hostname:"",port:void 0,path:"/",fragment:void 0,query:i,headers:c,body:void 0});u&&(this.updateServiceEndpoint(x,u),this.setHostPrefix(x,e,t));const b={...t};if(t){const E=p.getEventStreamMember();if(E){if(b[E]){const N={};for(const[S,T]of p.structIterator())S!==E&&b[S]&&(s.write(T,b[S]),N[S]=s.flush());g=await this.serializeEventStream({eventStream:b[E],requestSchema:p,initialRequest:N})}}else s.write(m,b),g=s.flush()}return x.headers=c,x.query=i,x.body=g,x.method="POST",x}async deserializeResponse(e,t,n){const s=this.deserializer,i=xo.of(e.output),c={};if(n.statusCode>=300){const p=await Cw(n.body,t);throw p.byteLength>0&&Object.assign(c,await s.read(15,p)),await this.handleError(e,t,n,c,this.deserializeMetadata(n)),new Error("@smithy/core/protocols - RPC Protocol error handler failed to throw.")}for(const p in n.headers){const m=n.headers[p];delete n.headers[p],n.headers[p.toLowerCase()]=m}const u=i.getEventStreamMember();if(u)c[u]=await this.deserializeEventStream({response:n,responseSchema:i,initialResponseContainer:c});else{const p=await Cw(n.body,t);p.byteLength>0&&Object.assign(c,await s.read(i,p))}return c.$metadata=this.deserializeMetadata(n),c}}function F1(r,e){if(e.timestampFormat.useTrait&&r.isTimestampSchema()&&(r.getSchema()===5||r.getSchema()===6||r.getSchema()===7))return r.getSchema();const{httpLabel:t,httpPrefixHeaders:n,httpHeader:s,httpQuery:i}=r.getMergedTraits();return(e.httpBindings?typeof n=="string"||s?6:i||t?5:void 0:void 0)??e.timestampFormat.default}function eD(r,e,t){r.__smithy_context?r.__smithy_context.features||(r.__smithy_context.features={}):r.__smithy_context={features:{}},r.__smithy_context.features[e]=t}class j1{constructor(e){H(this,"authSchemes",new Map);for(const[t,n]of Object.entries(e))n!==void 0&&this.authSchemes.set(t,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}class O1{async sign(e,t,n){return e}}const tD=r=>function(t){return D1(t)&&t.expiration.getTime()-Date.now()<r},rD=3e5,nD=tD(rD),D1=r=>r.expiration!==void 0,sD=(r,e,t)=>{if(r===void 0)return;const n=typeof r!="function"?async()=>Promise.resolve(r):r;let s,i,c,u=!1;const p=async m=>{i||(i=n(m));try{s=await i,c=!0,u=!1}finally{i=void 0}return s};return e===void 0?async m=>((!c||m!=null&&m.forceRefresh)&&(s=await p(m)),s):async m=>((!c||m!=null&&m.forceRefresh)&&(s=await p(m)),u?s:t(s)?(e(s)&&await p(m),s):(u=!0,s))},oD=void 0;function iD(r){return r===void 0?!0:typeof r=="string"&&r.length<=50}function L1(r){const e=fm(r.userAgentAppId??oD),{customUserAgent:t}=r;return Object.assign(r,{customUserAgent:typeof t=="string"?[[t]]:t,userAgentAppId:async()=>{var s,i;const n=await e();if(!iD(n)){const c=((i=(s=r.logger)==null?void 0:s.constructor)==null?void 0:i.name)==="NoOpLogger"||!r.logger?console:r.logger;typeof n!="string"?c==null||c.warn("userAgentAppId must be a string or undefined."):n.length>50&&(c==null||c.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return n}})}class M1{constructor({size:e,params:t}){H(this,"capacity");H(this,"data",new Map);H(this,"parameters",[]);this.capacity=e??50,t&&(this.parameters=t)}get(e,t){const n=this.hash(e);if(n===!1)return t();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const s=this.data.keys();let i=0;for(;;){const{value:c,done:u}=s.next();if(this.data.delete(c),u||++i>10)break}}this.data.set(n,t())}return this.data.get(n)}size(){return this.data.size}hash(e){let t="";const{parameters:n}=this;if(n.length===0)return!1;for(const s of n){const i=String(e[s]??"");if(i.includes("|;"))return!1;t+=i+"|;"}return t}}const aD=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),Ab=r=>aD.test(r)||r.startsWith("[")&&r.endsWith("]"),lD=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),$m=(r,e=!1)=>{if(!e)return lD.test(r);const t=r.split(".");for(const n of t)if(!$m(n))return!1;return!0},th={},_m="endpoints";function zc(r){return typeof r!="object"||r==null?r:"ref"in r?`$${zc(r.ref)}`:"fn"in r?`${r.fn}(${(r.argv||[]).map(zc).join(", ")})`:JSON.stringify(r,null,2)}class zo extends Error{constructor(e){super(e),this.name="EndpointError"}}const cD=(r,e)=>r===e,uD=r=>{const e=r.split("."),t=[];for(const n of e){const s=n.indexOf("[");if(s!==-1){if(n.indexOf("]")!==n.length-1)throw new zo(`Path: '${r}' does not end with ']'`);const i=n.slice(s+1,-1);if(Number.isNaN(parseInt(i)))throw new zo(`Invalid array index: '${i}' in path: '${r}'`);s!==0&&t.push(n.slice(0,s)),t.push(i)}else t.push(n)}return t},$1=(r,e)=>uD(e).reduce((t,n)=>{if(typeof t!="object")throw new zo(`Index '${n}' in '${e}' not found in '${JSON.stringify(r)}'`);return Array.isArray(t)?t[parseInt(n)]:t[n]},r),dD=r=>r!=null,fD=r=>!r,yx={[ym.HTTP]:80,[ym.HTTPS]:443},hD=r=>{const e=(()=>{try{if(r instanceof URL)return r;if(typeof r=="object"&&"hostname"in r){const{hostname:b,port:E,protocol:N="",path:S="",query:T={}}=r,R=new URL(`${N}//${b}${E?`:${E}`:""}${S}`);return R.search=Object.entries(T).map(([A,j])=>`${A}=${j}`).join("&"),R}return new URL(r)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(r)} as a whatwg URL.`),null;const t=e.href,{host:n,hostname:s,pathname:i,protocol:c,search:u}=e;if(u)return null;const p=c.slice(0,-1);if(!Object.values(ym).includes(p))return null;const m=Ab(s),g=t.includes(`${n}:${yx[p]}`)||typeof r=="string"&&r.includes(`${n}:${yx[p]}`),x=`${n}${g?`:${yx[p]}`:""}`;return{scheme:p,authority:x,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:m}},pD=(r,e)=>r===e,mD=(r,e,t,n)=>e>=t||r.length<t?null:n?r.substring(r.length-t,r.length-e):r.substring(e,t),gD=r=>encodeURIComponent(r).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),vD={booleanEquals:cD,getAttr:$1,isSet:dD,isValidHostLabel:$m,not:fD,parseURL:hD,stringEquals:pD,substring:mD,uriEncode:gD},U1=(r,e)=>{const t=[],n={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<r.length;){const i=r.indexOf("{",s);if(i===-1){t.push(r.slice(s));break}t.push(r.slice(s,i));const c=r.indexOf("}",i);if(c===-1){t.push(r.slice(i));break}r[i+1]==="{"&&r[c+1]==="}"&&(t.push(r.slice(i+1,c)),s=c+2);const u=r.substring(i+1,c);if(u.includes("#")){const[p,m]=u.split("#");t.push($1(n[p],m))}else t.push(n[u]);s=c+1}return t.join("")},yD=({ref:r},e)=>({...e.endpointParams,...e.referenceRecord})[r],My=(r,e,t)=>{if(typeof r=="string")return U1(r,t);if(r.fn)return H1.callFunction(r,t);if(r.ref)return yD(r,t);throw new zo(`'${e}': ${String(r)} is not a string, function or reference.`)},z1=({fn:r,argv:e},t)=>{const n=e.map(i=>["boolean","number"].includes(typeof i)?i:H1.evaluateExpression(i,"arg",t)),s=r.split(".");return s[0]in th&&s[1]!=null?th[s[0]][s[1]](...n):vD[r](...n)},H1={evaluateExpression:My,callFunction:z1},xD=({assign:r,...e},t)=>{var s,i;if(r&&r in t.referenceRecord)throw new zo(`'${r}' is already defined in Reference Record.`);const n=z1(e,t);return(i=(s=t.logger)==null?void 0:s.debug)==null||i.call(s,`${_m} evaluateCondition: ${zc(e)} = ${zc(n)}`),{result:n===""?!0:!!n,...r!=null&&{toAssign:{name:r,value:n}}}},Ib=(r=[],e)=>{var n,s;const t={};for(const i of r){const{result:c,toAssign:u}=xD(i,{...e,referenceRecord:{...e.referenceRecord,...t}});if(!c)return{result:c};u&&(t[u.name]=u.value,(s=(n=e.logger)==null?void 0:n.debug)==null||s.call(n,`${_m} assign: ${u.name} := ${zc(u.value)}`))}return{result:!0,referenceRecord:t}},wD=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:s.map(i=>{const c=My(i,"Header value entry",e);if(typeof c!="string")throw new zo(`Header '${n}' value '${c}' is not a string`);return c})}),{}),B1=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:W1.getEndpointProperty(s,e)}),{}),G1=(r,e)=>{if(Array.isArray(r))return r.map(t=>G1(t,e));switch(typeof r){case"string":return U1(r,e);case"object":if(r===null)throw new zo(`Unexpected endpoint property: ${r}`);return W1.getEndpointProperties(r,e);case"boolean":return r;default:throw new zo(`Unexpected endpoint property type: ${typeof r}`)}},W1={getEndpointProperty:G1,getEndpointProperties:B1},bD=(r,e)=>{const t=My(r,"Endpoint URL",e);if(typeof t=="string")try{return new URL(t)}catch(n){throw console.error(`Failed to construct URL with ${t}`,n),n}throw new zo(`Endpoint URL must be a string, got ${typeof t}`)},_D=(r,e)=>{var g,x;const{conditions:t,endpoint:n}=r,{result:s,referenceRecord:i}=Ib(t,e);if(!s)return;const c={...e,referenceRecord:{...e.referenceRecord,...i}},{url:u,properties:p,headers:m}=n;return(x=(g=e.logger)==null?void 0:g.debug)==null||x.call(g,`${_m} Resolving endpoint from template: ${zc(n)}`),{...m!=null&&{headers:wD(m,c)},...p!=null&&{properties:B1(p,c)},url:bD(u,c)}},ED=(r,e)=>{const{conditions:t,error:n}=r,{result:s,referenceRecord:i}=Ib(t,e);if(s)throw new zo(My(n,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},V1=(r,e)=>{for(const t of r)if(t.type==="endpoint"){const n=_D(t,e);if(n)return n}else if(t.type==="error")ED(t,e);else if(t.type==="tree"){const n=q1.evaluateTreeRule(t,e);if(n)return n}else throw new zo(`Unknown endpoint rule: ${t}`);throw new zo("Rules evaluation failed")},SD=(r,e)=>{const{conditions:t,rules:n}=r,{result:s,referenceRecord:i}=Ib(t,e);if(s)return q1.evaluateRules(n,{...e,referenceRecord:{...e.referenceRecord,...i}})},q1={evaluateRules:V1,evaluateTreeRule:SD},K1=(r,e)=>{var m,g,x,b;const{endpointParams:t,logger:n}=e,{parameters:s,rules:i}=r;(g=(m=e.logger)==null?void 0:m.debug)==null||g.call(m,`${_m} Initial EndpointParams: ${zc(t)}`);const c=Object.entries(s).filter(([,E])=>E.default!=null).map(([E,N])=>[E,N.default]);if(c.length>0)for(const[E,N]of c)t[E]=t[E]??N;const u=Object.entries(s).filter(([,E])=>E.required).map(([E])=>E);for(const E of u)if(t[E]==null)throw new zo(`Missing required parameter: '${E}'`);const p=V1(i,{endpointParams:t,logger:n,referenceRecord:{}});return(b=(x=e.logger)==null?void 0:x.debug)==null||b.call(x,`${_m} Resolved endpoint: ${zc(p)}`),p},Y1=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!Y1(t))return!1;return!0}return!(!$m(r)||r.length<3||r.length>63||r!==r.toLowerCase()||Ab(r))},SS=":",CD="/",kD=r=>{const e=r.split(SS);if(e.length<6)return null;const[t,n,s,i,c,...u]=e;if(t!=="arn"||n===""||s===""||u.join(SS)==="")return null;const p=u.map(m=>m.split(CD)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:p}},ND=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],TD={partitions:ND};let RD=TD;const AD=r=>{const{partitions:e}=RD;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,u]of Object.entries(s))if(c===r)return{...i,...u}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},ID={isVirtualHostableS3Bucket:Y1,parseArn:kD,partition:AD};th.aws=ID;function PD(r){const e={};if(r=r.replace(/^\?/,""),r)for(const t of r.split("&")){let[n,s=null]=t.split("=");n=decodeURIComponent(n),s&&(s=decodeURIComponent(s)),n in e?Array.isArray(e[n])?e[n].push(s):e[n]=[e[n],s]:e[n]=s}return e}const Em=r=>{if(typeof r=="string")return Em(new URL(r));const{hostname:e,pathname:t,port:n,protocol:s,search:i}=r;let c;return i&&(c=PD(i)),{hostname:e,port:n?parseInt(n):void 0,protocol:s,path:t,query:c}};function FD(r,e,t){return r.$source||(r.$source={}),r.$source[e]=t,r}function Ra(r,e,t){r.__aws_sdk_context?r.__aws_sdk_context.features||(r.__aws_sdk_context.features={}):r.__aws_sdk_context={features:{}},r.__aws_sdk_context.features[e]=t}const CS=r=>{var e,t;return eh.isInstance(r)?((e=r.headers)==null?void 0:e.date)??((t=r.headers)==null?void 0:t.Date):void 0},J1=r=>new Date(Date.now()+r),jD=(r,e)=>Math.abs(J1(e).getTime()-r)>=3e5,kS=(r,e)=>{const t=Date.parse(r);return jD(t,e)?t-Date.now():e},pm=(r,e)=>{if(!e)throw new Error(`Property \`${r}\` is not resolved for AWS SDK SigV4Auth`);return e},OD=async r=>{var m,g,x;const e=pm("context",r.context),t=pm("config",r.config),n=(x=(g=(m=e.endpointV2)==null?void 0:m.properties)==null?void 0:g.authSchemes)==null?void 0:x[0],i=await pm("signer",t.signer)(n),c=r==null?void 0:r.signingRegion,u=r==null?void 0:r.signingRegionSet,p=r==null?void 0:r.signingName;return{config:t,signer:i,signingRegion:c,signingRegionSet:u,signingName:p}};class X1{async sign(e,t,n){var x;if(!Uo.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await OD(n),{config:i,signer:c}=s;let{signingRegion:u,signingName:p}=s;const m=n.context;if(((x=m==null?void 0:m.authSchemes)==null?void 0:x.length)??!1){const[b,E]=m.authSchemes;(b==null?void 0:b.name)==="sigv4a"&&(E==null?void 0:E.name)==="sigv4"&&(u=(E==null?void 0:E.signingRegion)??u,p=(E==null?void 0:E.signingName)??p)}return await c.sign(e,{signingDate:J1(i.systemClockOffset),signingRegion:u,signingService:p})}errorHandler(e){return t=>{const n=t.ServerTime??CS(t.$response);if(n){const s=pm("config",e.config),i=s.systemClockOffset;s.systemClockOffset=kS(n,s.systemClockOffset),s.systemClockOffset!==i&&t.$metadata&&(t.$metadata.clockSkewCorrected=!0)}throw t}}successHandler(e,t){const n=CS(e);if(n){const s=pm("config",t.config);s.systemClockOffset=kS(n,s.systemClockOffset)}}}const DD=(r,e,t)=>{let n,s,i,c=!1;const u=async()=>{s||(s=r());try{n=await s,i=!0,c=!1}finally{s=void 0}return n};return async p=>((!i||p!=null&&p.forceRefresh)&&(n=await u()),n)},LD="X-Amz-Algorithm",MD="X-Amz-Credential",Q1="X-Amz-Date",$D="X-Amz-SignedHeaders",UD="X-Amz-Expires",Z1="X-Amz-Signature",eN="X-Amz-Security-Token",tN="authorization",rN=Q1.toLowerCase(),zD="date",HD=[tN,rN,zD],BD=Z1.toLowerCase(),Tw="x-amz-content-sha256",GD=eN.toLowerCase(),WD={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},VD=/^proxy-/,qD=/^sec-/,xx="AWS4-HMAC-SHA256",KD="AWS4-HMAC-SHA256-PAYLOAD",YD="UNSIGNED-PAYLOAD",JD=50,nN="aws4_request",XD=3600*24*7,mv={},wx=[],bx=(r,e,t)=>`${r}/${e}/${t}/${nN}`,QD=async(r,e,t,n,s)=>{const i=await NS(r,e.secretAccessKey,e.accessKeyId),c=`${t}:${n}:${s}:${Xu(i)}:${e.sessionToken}`;if(c in mv)return mv[c];for(wx.push(c);wx.length>JD;)delete mv[wx.shift()];let u=`AWS4${e.secretAccessKey}`;for(const p of[t,n,s,nN])u=await NS(r,u,p);return mv[c]=u},NS=(r,e,t)=>{const n=new r(e);return n.update(xm(t)),n.digest()},TS=({headers:r},e,t)=>{const n={};for(const s of Object.keys(r).sort()){if(r[s]==null)continue;const i=s.toLowerCase();(i in WD||e!=null&&e.has(i)||VD.test(i)||qD.test(i))&&(!t||t&&!t.has(i))||(n[i]=r[s].trim().replace(/\s+/g," "))}return n},ZD=r=>typeof ArrayBuffer=="function"&&r instanceof ArrayBuffer||Object.prototype.toString.call(r)==="[object ArrayBuffer]",_x=async({headers:r,body:e},t)=>{for(const n of Object.keys(r))if(n.toLowerCase()===Tw)return r[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||ZD(e)){const n=new t;return n.update(xm(e)),Xu(await n.digest())}return YD};class eL{format(e){const t=[];for(const i of Object.keys(e)){const c=Qu(i);t.push(Uint8Array.from([c.byteLength]),c,this.formatHeaderValue(e[i]))}const n=new Uint8Array(t.reduce((i,c)=>i+c.byteLength,0));let s=0;for(const i of t)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const c=new Uint8Array(i.buffer);return c.set(e.value,3),c;case"string":const u=Qu(e.value),p=new DataView(new ArrayBuffer(3+u.byteLength));p.setUint8(0,7),p.setUint16(1,u.byteLength,!1);const m=new Uint8Array(p.buffer);return m.set(u,3),m;case"timestamp":const g=new Uint8Array(9);return g[0]=8,g.set(Pb.fromNumber(e.value.valueOf()).bytes,1),g;case"uuid":if(!tL.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const x=new Uint8Array(17);return x[0]=9,x.set(v2(e.value.replace(/\-/g,"")),1),x}}}var RS;(function(r){r[r.boolTrue=0]="boolTrue",r[r.boolFalse=1]="boolFalse",r[r.byte=2]="byte",r[r.short=3]="short",r[r.integer=4]="integer",r[r.long=5]="long",r[r.byteArray=6]="byteArray",r[r.string=7]="string",r[r.timestamp=8]="timestamp",r[r.uuid=9]="uuid"})(RS||(RS={}));const tL=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class Pb{constructor(e){H(this,"bytes");if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)t[n]=s;return e<0&&AS(t),new Pb(t)}valueOf(){const e=this.bytes.slice(0),t=e[0]&128;return t&&AS(e),parseInt(Xu(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function AS(r){for(let e=0;e<8;e++)r[e]^=255;for(let e=7;e>-1&&(r[e]++,r[e]===0);e--);}const rL=(r,e)=>{r=r.toLowerCase();for(const t of Object.keys(e))if(r===t.toLowerCase())return!0;return!1},nL=(r,e={})=>{var s,i;const{headers:t,query:n={}}=Uo.clone(r);for(const c of Object.keys(t)){const u=c.toLowerCase();(u.slice(0,6)==="x-amz-"&&!((s=e.unhoistableHeaders)!=null&&s.has(u))||(i=e.hoistableHeaders)!=null&&i.has(u))&&(n[c]=t[c],delete t[c])}return{...r,headers:t,query:n}},IS=r=>{r=Uo.clone(r);for(const e of Object.keys(r.headers))HD.indexOf(e.toLowerCase())>-1&&delete r.headers[e];return r},sL=({query:r={}})=>{const e=[],t={};for(const n of Object.keys(r)){if(n.toLowerCase()===BD)continue;const s=Ju(n);e.push(s);const i=r[n];typeof i=="string"?t[s]=`${s}=${Ju(i)}`:Array.isArray(i)&&(t[s]=i.slice(0).reduce((c,u)=>c.concat([`${s}=${Ju(u)}`]),[]).sort().join("&"))}return e.sort().map(n=>t[n]).filter(n=>n).join("&")},oL=r=>iL(r).toISOString().replace(/\.\d{3}Z$/,"Z"),iL=r=>typeof r=="number"?new Date(r*1e3):typeof r=="string"?Number(r)?new Date(Number(r)*1e3):new Date(r):r;class aL{constructor({applyChecksum:e,credentials:t,region:n,service:s,sha256:i,uriEscapePath:c=!0}){H(this,"service");H(this,"regionProvider");H(this,"credentialProvider");H(this,"sha256");H(this,"uriEscapePath");H(this,"applyChecksum");this.service=s,this.sha256=i,this.uriEscapePath=c,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=zi(n),this.credentialProvider=zi(t)}createCanonicalRequest(e,t,n){const s=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${sL(e)}
${s.map(i=>`${i}:${t[i]}`).join(`
`)}

${s.join(";")}
${n}`}async createStringToSign(e,t,n,s){const i=new this.sha256;i.update(xm(n));const c=await i.digest();return`${s}
${e}
${t}
${Xu(c)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?t.pop():t.push(i));const n=`${e!=null&&e.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return Ju(n).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(e){const t=oL(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class PS extends aL{constructor({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:u=!0}){super({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:u});H(this,"headerFormatter",new eL)}async presign(t,n={}){const{signingDate:s=new Date,expiresIn:i=3600,unsignableHeaders:c,unhoistableHeaders:u,signableHeaders:p,hoistableHeaders:m,signingRegion:g,signingService:x}=n,b=await this.credentialProvider();this.validateResolvedCredentials(b);const E=g??await this.regionProvider(),{longDate:N,shortDate:S}=this.formatDate(s);if(i>XD)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const T=bx(S,E,x??this.service),R=nL(IS(t),{unhoistableHeaders:u,hoistableHeaders:m});b.sessionToken&&(R.query[eN]=b.sessionToken),R.query[LD]=xx,R.query[MD]=`${b.accessKeyId}/${T}`,R.query[Q1]=N,R.query[UD]=i.toString(10);const A=TS(R,c,p);return R.query[$D]=this.getCanonicalHeaderList(A),R.query[Z1]=await this.getSignature(N,T,this.getSigningKey(b,E,S,x),this.createCanonicalRequest(R,A,await _x(t,this.sha256))),R}async sign(t,n){return typeof t=="string"?this.signString(t,n):t.headers&&t.payload?this.signEvent(t,n):t.message?this.signMessage(t,n):this.signRequest(t,n)}async signEvent({headers:t,payload:n},{signingDate:s=new Date,priorSignature:i,signingRegion:c,signingService:u}){const p=c??await this.regionProvider(),{shortDate:m,longDate:g}=this.formatDate(s),x=bx(m,p,u??this.service),b=await _x({headers:{},body:n},this.sha256),E=new this.sha256;E.update(t);const N=Xu(await E.digest()),S=[KD,g,x,i,N,b].join(`
`);return this.signString(S,{signingDate:s,signingRegion:p,signingService:u})}async signMessage(t,{signingDate:n=new Date,signingRegion:s,signingService:i}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:n,signingRegion:s,signingService:i,priorSignature:t.priorSignature}).then(u=>({message:t.message,signature:u}))}async signString(t,{signingDate:n=new Date,signingRegion:s,signingService:i}={}){const c=await this.credentialProvider();this.validateResolvedCredentials(c);const u=s??await this.regionProvider(),{shortDate:p}=this.formatDate(n),m=new this.sha256(await this.getSigningKey(c,u,p,i));return m.update(xm(t)),Xu(await m.digest())}async signRequest(t,{signingDate:n=new Date,signableHeaders:s,unsignableHeaders:i,signingRegion:c,signingService:u}={}){const p=await this.credentialProvider();this.validateResolvedCredentials(p);const m=c??await this.regionProvider(),g=IS(t),{longDate:x,shortDate:b}=this.formatDate(n),E=bx(b,m,u??this.service);g.headers[rN]=x,p.sessionToken&&(g.headers[GD]=p.sessionToken);const N=await _x(g,this.sha256);!rL(Tw,g.headers)&&this.applyChecksum&&(g.headers[Tw]=N);const S=TS(g,i,s),T=await this.getSignature(x,E,this.getSigningKey(p,m,b,u),this.createCanonicalRequest(g,S,N));return g.headers[tN]=`${xx} Credential=${p.accessKeyId}/${E}, SignedHeaders=${this.getCanonicalHeaderList(S)}, Signature=${T}`,g}async getSignature(t,n,s,i){const c=await this.createStringToSign(t,n,i,xx),u=new this.sha256(await s);return u.update(xm(c)),Xu(await u.digest())}getSigningKey(t,n,s,i){return QD(this.sha256,t,s,n,i||this.service)}}const sN=r=>{let e=r.credentials,t=!!r.credentials,n;Object.defineProperty(r,"credentials",{set(m){m&&m!==e&&m!==n&&(t=!0),e=m;const g=lL(r,{credentials:e,credentialDefaultProvider:r.credentialDefaultProvider}),x=cL(r,g);if(t&&!x.attributed){const b=typeof e=="object"&&e!==null;n=async E=>{const S=await x(E);return b&&(!S.$source||Object.keys(S.$source).length===0)?FD(S,"CREDENTIALS_CODE","e"):S},n.memoized=x.memoized,n.configBound=x.configBound,n.attributed=!0}else n=x},get(){return n},enumerable:!0,configurable:!0}),r.credentials=e;const{signingEscapePath:s=!0,systemClockOffset:i=r.systemClockOffset||0,sha256:c}=r;let u;return r.signer?u=fm(r.signer):r.regionInfoProvider?u=()=>fm(r.region)().then(async m=>[await r.regionInfoProvider(m,{useFipsEndpoint:await r.useFipsEndpoint(),useDualstackEndpoint:await r.useDualstackEndpoint()})||{},m]).then(([m,g])=>{const{signingRegion:x,signingService:b}=m;r.signingRegion=r.signingRegion||x||g,r.signingName=r.signingName||b||r.serviceId;const E={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},N=r.signerConstructor||PS;return new N(E)}):u=async m=>{m=Object.assign({},{name:"sigv4",signingName:r.signingName||r.defaultSigningName,signingRegion:await fm(r.region)(),properties:{}},m);const g=m.signingRegion,x=m.signingName;r.signingRegion=r.signingRegion||g,r.signingName=r.signingName||x||r.serviceId;const b={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},E=r.signerConstructor||PS;return new E(b)},Object.assign(r,{systemClockOffset:i,signingEscapePath:s,signer:u})};function lL(r,{credentials:e,credentialDefaultProvider:t}){let n;return e?e!=null&&e.memoized?n=e:n=sD(e,nD,D1):t?n=fm(t(Object.assign({},r,{parentClientConfig:r}))):n=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},n.memoized=!0,n}function cL(r,e){if(e.configBound)return e;const t=async n=>e({...n,callerClientConfig:r});return t.memoized=e.memoized,t.configBound=!0,t}const FS=typeof TextEncoder=="function"?new TextEncoder:null,oN=r=>{if(typeof r=="string"){if(FS)return FS.encode(r).byteLength;let e=r.length;for(let t=e-1;t>=0;t--){const n=r.charCodeAt(t);n>127&&n<=2047?e++:n>2047&&n<=65535&&(e+=2),n>=56320&&n<=57343&&t--}return e}else{if(typeof r.byteLength=="number")return r.byteLength;if(typeof r.size=="number")return r.size}throw new Error(`Body Length computation failed for ${r}`)},Uu=(r,e)=>{const t=[];if(r&&t.push(r),e)for(const n of e)t.push(n);return t},Ec=(r,e)=>`${r||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,Zv=()=>{let r=[],e=[],t=!1;const n=new Set,s=x=>x.sort((b,E)=>jS[E.step]-jS[b.step]||OS[E.priority||"normal"]-OS[b.priority||"normal"]),i=x=>{let b=!1;const E=N=>{const S=Uu(N.name,N.aliases);if(S.includes(x)){b=!0;for(const T of S)n.delete(T);return!1}return!0};return r=r.filter(E),e=e.filter(E),b},c=x=>{let b=!1;const E=N=>{if(N.middleware===x){b=!0;for(const S of Uu(N.name,N.aliases))n.delete(S);return!1}return!0};return r=r.filter(E),e=e.filter(E),b},u=x=>{var b;return r.forEach(E=>{x.add(E.middleware,{...E})}),e.forEach(E=>{x.addRelativeTo(E.middleware,{...E})}),(b=x.identifyOnResolve)==null||b.call(x,g.identifyOnResolve()),x},p=x=>{const b=[];return x.before.forEach(E=>{E.before.length===0&&E.after.length===0?b.push(E):b.push(...p(E))}),b.push(x),x.after.reverse().forEach(E=>{E.before.length===0&&E.after.length===0?b.push(E):b.push(...p(E))}),b},m=(x=!1)=>{const b=[],E=[],N={};return r.forEach(T=>{const R={...T,before:[],after:[]};for(const A of Uu(R.name,R.aliases))N[A]=R;b.push(R)}),e.forEach(T=>{const R={...T,before:[],after:[]};for(const A of Uu(R.name,R.aliases))N[A]=R;E.push(R)}),E.forEach(T=>{if(T.toMiddleware){const R=N[T.toMiddleware];if(R===void 0){if(x)return;throw new Error(`${T.toMiddleware} is not found when adding ${Ec(T.name,T.aliases)} middleware ${T.relation} ${T.toMiddleware}`)}T.relation==="after"&&R.after.push(T),T.relation==="before"&&R.before.push(T)}}),s(b).map(p).reduce((T,R)=>(T.push(...R),T),[])},g={add:(x,b={})=>{const{name:E,override:N,aliases:S}=b,T={step:"initialize",priority:"normal",middleware:x,...b},R=Uu(E,S);if(R.length>0){if(R.some(A=>n.has(A))){if(!N)throw new Error(`Duplicate middleware name '${Ec(E,S)}'`);for(const A of R){const j=r.findIndex(U=>{var B;return U.name===A||((B=U.aliases)==null?void 0:B.some($=>$===A))});if(j===-1)continue;const P=r[j];if(P.step!==T.step||T.priority!==P.priority)throw new Error(`"${Ec(P.name,P.aliases)}" middleware with ${P.priority} priority in ${P.step} step cannot be overridden by "${Ec(E,S)}" middleware with ${T.priority} priority in ${T.step} step.`);r.splice(j,1)}}for(const A of R)n.add(A)}r.push(T)},addRelativeTo:(x,b)=>{const{name:E,override:N,aliases:S}=b,T={middleware:x,...b},R=Uu(E,S);if(R.length>0){if(R.some(A=>n.has(A))){if(!N)throw new Error(`Duplicate middleware name '${Ec(E,S)}'`);for(const A of R){const j=e.findIndex(U=>{var B;return U.name===A||((B=U.aliases)==null?void 0:B.some($=>$===A))});if(j===-1)continue;const P=e[j];if(P.toMiddleware!==T.toMiddleware||P.relation!==T.relation)throw new Error(`"${Ec(P.name,P.aliases)}" middleware ${P.relation} "${P.toMiddleware}" middleware cannot be overridden by "${Ec(E,S)}" middleware ${T.relation} "${T.toMiddleware}" middleware.`);e.splice(j,1)}}for(const A of R)n.add(A)}e.push(T)},clone:()=>u(Zv()),use:x=>{x.applyToStack(g)},remove:x=>typeof x=="string"?i(x):c(x),removeByTag:x=>{let b=!1;const E=N=>{const{tags:S,name:T,aliases:R}=N;if(S&&S.includes(x)){const A=Uu(T,R);for(const j of A)n.delete(j);return b=!0,!1}return!0};return r=r.filter(E),e=e.filter(E),b},concat:x=>{var E;const b=u(Zv());return b.use(x),b.identifyOnResolve(t||b.identifyOnResolve()||(((E=x.identifyOnResolve)==null?void 0:E.call(x))??!1)),b},applyToStack:u,identify:()=>m(!0).map(x=>{const b=x.step??x.relation+" "+x.toMiddleware;return Ec(x.name,x.aliases)+" - "+b}),identifyOnResolve(x){return typeof x=="boolean"&&(t=x),t},resolve:(x,b)=>{for(const E of m().map(N=>N.middleware).reverse())x=E(x,b);return t&&console.log(g.identify()),x}};return g},jS={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},OS={high:3,normal:2,low:1};class iN{constructor(e){H(this,"config");H(this,"middlewareStack",Zv());H(this,"initConfig");H(this,"handlers");this.config=e;const{protocol:t,protocolSettings:n}=e;n&&typeof t=="function"&&(e.protocol=new t(n))}send(e,t,n){const s=typeof t!="function"?t:void 0,i=typeof t=="function"?t:n,c=s===void 0&&this.config.cacheMiddleware===!0;let u;if(c){this.handlers||(this.handlers=new WeakMap);const p=this.handlers;p.has(e.constructor)?u=p.get(e.constructor):(u=e.resolveMiddleware(this.middlewareStack,this.config,s),p.set(e.constructor,u))}else delete this.handlers,u=e.resolveMiddleware(this.middlewareStack,this.config,s);if(i)u(e).then(p=>i(null,p.output),p=>i(p)).catch(()=>{});else return u(e).then(p=>p.output)}destroy(){var e,t,n;(n=(t=(e=this.config)==null?void 0:e.requestHandler)==null?void 0:t.destroy)==null||n.call(t),delete this.handlers}}const Ex="***SensitiveInformation***";function Rw(r,e){if(e==null)return e;const t=xo.of(r);if(t.getMergedTraits().sensitive)return Ex;if(t.isListSchema()){if(!!t.getValueSchema().getMergedTraits().sensitive)return Ex}else if(t.isMapSchema()){if(!!t.getKeySchema().getMergedTraits().sensitive||!!t.getValueSchema().getMergedTraits().sensitive)return Ex}else if(t.isStructSchema()&&typeof e=="object"){const n=e,s={};for(const[i,c]of t.structIterator())n[i]!=null&&(s[i]=Rw(c,n[i]));return s}return e}class aN{constructor(){H(this,"middlewareStack",Zv());H(this,"schema")}static classBuilder(){return new uL}resolveMiddlewareWithContext(e,t,n,{middlewareFn:s,clientName:i,commandName:c,inputFilterSensitiveLog:u,outputFilterSensitiveLog:p,smithyContext:m,additionalContext:g,CommandCtor:x}){for(const T of s.bind(this)(x,e,t,n))this.middlewareStack.use(T);const b=e.concat(this.middlewareStack),{logger:E}=t,N={logger:E,clientName:i,commandName:c,inputFilterSensitiveLog:u,outputFilterSensitiveLog:p,[Ew]:{commandInstance:this,...m},...g},{requestHandler:S}=t;return b.resolve(T=>S.handle(T.request,n||{}),N)}}class uL{constructor(){H(this,"_init",()=>{});H(this,"_ep",{});H(this,"_middlewareFn",()=>[]);H(this,"_commandName","");H(this,"_clientName","");H(this,"_additionalContext",{});H(this,"_smithyContext",{});H(this,"_inputFilterSensitiveLog");H(this,"_outputFilterSensitiveLog");H(this,"_serializer",null);H(this,"_deserializer",null);H(this,"_operationSchema")}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,n={}){return this._smithyContext={service:e,operation:t,...n},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=n=>n,t=n=>n){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){const e=this;let t;return t=class extends aN{constructor(...[s]){super();H(this,"input");H(this,"serialize",e._serializer);H(this,"deserialize",e._deserializer);this.input=s??{},e._init(this),this.schema=e._operationSchema}static getEndpointParameterInstructions(){return e._ep}resolveMiddleware(s,i,c){const u=e._operationSchema,p=(u==null?void 0:u[4])??(u==null?void 0:u.input),m=(u==null?void 0:u[5])??(u==null?void 0:u.output);return this.resolveMiddlewareWithContext(s,i,c,{CommandCtor:t,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog??(u?Rw.bind(null,p):g=>g),outputFilterSensitiveLog:e._outputFilterSensitiveLog??(u?Rw.bind(null,m):g=>g),smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}class zf extends Error{constructor(t){super(t.message);H(this,"$fault");H(this,"$response");H(this,"$retryable");H(this,"$metadata");Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;const n=t;return zf.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;const n=t;return this===zf?zf.isInstance(t):zf.isInstance(t)?n.name&&this.name?this.prototype.isPrototypeOf(t)||n.name===this.name:this.prototype.isPrototypeOf(t):!1}}const DS=(r,e={})=>{Object.entries(e).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(r[n]==null||r[n]==="")&&(r[n]=s)});const t=r.message||r.Message||"UnknownError";return r.message=t,delete r.Message,r},lN=r=>{switch(r){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},dL=r=>{const e=[];for(const t in Xv){const n=Xv[t];r[n]!==void 0&&e.push({algorithmId:()=>n,checksumConstructor:()=>r[n]})}return{addChecksumAlgorithm(t){e.push(t)},checksumAlgorithms(){return e}}},fL=r=>{const e={};return r.checksumAlgorithms().forEach(t=>{e[t.algorithmId()]=t.checksumConstructor()}),e},hL=r=>({setRetryStrategy(e){r.retryStrategy=e},retryStrategy(){return r.retryStrategy}}),pL=r=>{const e={};return e.retryStrategy=r.retryStrategy(),e},cN=r=>Object.assign(dL(r),hL(r)),uN=r=>Object.assign(fL(r),pL(r));class Fb{trace(){}debug(){}info(){}warn(){}error(){}}class mL{constructor(e=!1){H(this,"queryCompat");this.queryCompat=e}resolveRestContentType(e,t){const n=t.getMemberSchemas(),s=Object.values(n).find(i=>!!i.getMergedTraits().httpPayload);if(s){const i=s.getMergedTraits().mediaType;return i||(s.isStringSchema()?"text/plain":s.isBlobSchema()?"application/octet-stream":e)}else if(!t.isUnitSchema()&&Object.values(n).find(c=>{const{httpQuery:u,httpQueryParams:p,httpHeader:m,httpLabel:g,httpPrefixHeaders:x}=c.getMergedTraits();return!u&&!p&&!m&&!g&&x===void 0}))return e}async getErrorSchemaOrThrowBaseException(e,t,n,s,i,c){let u=t,p=e;e.includes("#")&&([u,p]=e.split("#"));const m={$metadata:i,$fault:n.statusCode<500?"client":"server"},g=dt.for(u);try{return{errorSchema:(c==null?void 0:c(g,p))??g.getSchema(e),errorMetadata:m}}catch{s.message=s.message??s.Message??"UnknownError";const b=dt.for("smithy.ts.sdk.synthetic."+u),E=b.getBaseException();if(E){const N=b.getErrorCtor(E)??Error;throw this.decorateServiceException(Object.assign(new N({name:p}),m),s)}throw this.decorateServiceException(Object.assign(new Error(p),m),s)}}decorateServiceException(e,t={}){if(this.queryCompat){const n=e.Message??t.Message,s=DS(e,t);n&&(s.message=n),s.Error={...s.Error,Type:s.Error.Type,Code:s.Error.Code,Message:s.Error.message??s.Error.Message??n};const i=s.$metadata.requestId;return i&&(s.RequestId=i),s}return DS(e,t)}setQueryCompatError(e,t){var s;const n=(s=t.headers)==null?void 0:s["x-amzn-query-error"];if(e!==void 0&&n!=null){const[i,c]=n.split(";"),u=Object.entries(e),p={Code:i,Type:c};Object.assign(e,p);for(const[m,g]of u)p[m==="message"?"Message":m]=g;delete p.__type,e.Error=p}}queryCompatOutput(e,t){e.Error&&(t.Error=e.Error),e.Type&&(t.Type=e.Type),e.Code&&(t.Code=e.Code)}findQueryCompatibleError(e,t){try{return e.getSchema(t)}catch{return e.find(s=>{var i;return((i=xo.of(s).getMergedTraits().awsQueryError)==null?void 0:i[0])===t})}}}class jb{constructor(){H(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class gL{constructor(e,t){H(this,"from");H(this,"to");H(this,"keys");this.from=e,this.to=t,this.keys=new Set(Object.keys(this.from).filter(n=>n!=="__type"))}mark(e){this.keys.delete(e)}hasUnknown(){return this.keys.size===1&&Object.keys(this.to).length===0}writeUnknown(){if(this.hasUnknown()){const e=this.keys.values().next().value,t=this.from[e];this.to.$unknown=[e,t]}}}function vL(r,e,t){if(t!=null&&t.source){const n=t.source;if(typeof e=="number"&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||n!==String(e)))return n.includes(".")?new Ma(n,"bigDecimal"):BigInt(n)}return e}const yL=(r,e)=>Cw(r,e).then(t=>((e==null?void 0:e.utf8Encoder)??Oy)(t)),xL=(r,e)=>yL(r,e).then(t=>{if(t.length)try{return JSON.parse(t)}catch(n){throw(n==null?void 0:n.name)==="SyntaxError"&&Object.defineProperty(n,"$responseBodyText",{value:t}),n}return{}}),wL=(r,e)=>{const t=(i,c)=>Object.keys(i).find(u=>u.toLowerCase()===c.toLowerCase()),n=i=>{let c=i;return typeof c=="number"&&(c=c.toString()),c.indexOf(",")>=0&&(c=c.split(",")[0]),c.indexOf(":")>=0&&(c=c.split(":")[0]),c.indexOf("#")>=0&&(c=c.split("#")[1]),c},s=t(r.headers,"x-amzn-errortype");if(s!==void 0)return n(r.headers[s]);if(e&&typeof e=="object"){const i=t(e,"code");if(i&&e[i]!==void 0)return n(e[i]);if(e.__type!==void 0)return n(e.__type)}};class bL extends jb{constructor(t){super();H(this,"settings");this.settings=t}async read(t,n){return this._read(t,typeof n=="string"?JSON.parse(n,vL):await xL(n,this.serdeContext))}readObject(t,n){return this._read(t,n)}_read(t,n){const s=n!==null&&typeof n=="object",i=xo.of(t);if(s){if(i.isStructSchema()){const u=n,p=i.isUnionSchema(),m={};let g;const{jsonName:x}=this.settings;x&&(g={});let b;p&&(b=new gL(u,m));for(const[E,N]of i.structIterator()){let S=E;x&&(S=N.getMergedTraits().jsonName??S,g[S]=E),p&&b.mark(S),u[S]!=null&&(m[E]=this._read(N,u[S]))}if(p)b.writeUnknown();else if(typeof u.__type=="string")for(const[E,N]of Object.entries(u)){const S=x?g[E]??E:E;S in m||(m[S]=N)}return m}if(Array.isArray(n)&&i.isListSchema()){const u=i.getValueSchema(),p=[],m=!!i.getMergedTraits().sparse;for(const g of n)(m||g!=null)&&p.push(this._read(u,g));return p}if(i.isMapSchema()){const u=i.getValueSchema(),p={},m=!!i.getMergedTraits().sparse;for(const[g,x]of Object.entries(n))(m||x!=null)&&(p[g]=this._read(u,x));return p}}if(i.isBlobSchema()&&typeof n=="string")return Mm(n);const c=i.getMergedTraits().mediaType;if(i.isStringSchema()&&typeof n=="string"&&c)return c==="application/json"||c.endsWith("+json")?jc.from(n):n;if(i.isTimestampSchema()&&n!=null)switch(F1(i,this.settings)){case 5:return O2(n);case 6:return $2(n);case 7:return U2(n);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",n),new Date(n)}if(i.isBigIntegerSchema()&&(typeof n=="number"||typeof n=="string"))return BigInt(n);if(i.isBigDecimalSchema()&&n!=null){if(n instanceof Ma)return n;const u=n;return u.type==="bigDecimal"&&"string"in u?new Ma(u.string,u.type):new Ma(String(n),"bigDecimal")}if(i.isNumericSchema()&&typeof n=="string"){switch(n){case"Infinity":return 1/0;case"-Infinity":return-1/0;case"NaN":return NaN}return n}if(i.isDocumentSchema())if(s){const u=Array.isArray(n)?[]:{};for(const[p,m]of Object.entries(n))m instanceof Ma?u[p]=m:u[p]=this._read(i,m);return u}else return structuredClone(n);return n}}const LS="";class _L{constructor(){H(this,"values",new Map);H(this,"counter",0);H(this,"stage",0)}createReplacer(){if(this.stage===1)throw new Error("@aws-sdk/core/protocols - JsonReplacer already created.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");return this.stage=1,(e,t)=>{if(t instanceof Ma){const n=`${LS+"nv"+this.counter++}_`+t.string;return this.values.set(`"${n}"`,t.string),n}if(typeof t=="bigint"){const n=t.toString(),s=`${LS+"b"+this.counter++}_`+n;return this.values.set(`"${s}"`,n),s}return t}}replaceInJson(e){if(this.stage===0)throw new Error("@aws-sdk/core/protocols - JsonReplacer not created yet.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");if(this.stage=2,this.counter===0)return e;for(const[t,n]of this.values)e=e.replace(t,n);return e}}class EL extends jb{constructor(t){super();H(this,"settings");H(this,"buffer");H(this,"useReplacer",!1);H(this,"rootSchema");this.settings=t}write(t,n){this.rootSchema=xo.of(t),this.buffer=this._write(this.rootSchema,n)}writeDiscriminatedDocument(t,n){this.write(t,n),typeof this.buffer=="object"&&(this.buffer.__type=xo.of(t).getName(!0))}flush(){const{rootSchema:t,useReplacer:n}=this;if(this.rootSchema=void 0,this.useReplacer=!1,t!=null&&t.isStructSchema()||t!=null&&t.isDocumentSchema()){if(!n)return JSON.stringify(this.buffer);const s=new _L;return s.replaceInJson(JSON.stringify(this.buffer,s.createReplacer(),0))}return this.buffer}_write(t,n,s){var u,p;const i=n!==null&&typeof n=="object",c=xo.of(t);if(i){if(c.isStructSchema()){const m=n,g={},{jsonName:x}=this.settings;let b;x&&(b={});for(const[E,N]of c.structIterator()){const S=this._write(N,m[E],c);if(S!==void 0){let T=E;x&&(T=N.getMergedTraits().jsonName??E,b[E]=T),g[T]=S}}if(c.isUnionSchema()&&Object.keys(g).length===0){const{$unknown:E}=m;if(Array.isArray(E)){const[N,S]=E;g[N]=this._write(15,S)}}else if(typeof m.__type=="string")for(const[E,N]of Object.entries(m)){const S=x?b[E]??E:E;S in g||(g[S]=this._write(15,N))}return g}if(Array.isArray(n)&&c.isListSchema()){const m=c.getValueSchema(),g=[],x=!!c.getMergedTraits().sparse;for(const b of n)(x||b!=null)&&g.push(this._write(m,b));return g}if(c.isMapSchema()){const m=c.getValueSchema(),g={},x=!!c.getMergedTraits().sparse;for(const[b,E]of Object.entries(n))(x||E!=null)&&(g[b]=this._write(m,E));return g}if(n instanceof Uint8Array&&(c.isBlobSchema()||c.isDocumentSchema()))return c===this.rootSchema?n:(((u=this.serdeContext)==null?void 0:u.base64Encoder)??wm)(n);if(n instanceof Date&&(c.isTimestampSchema()||c.isDocumentSchema()))switch(F1(c,this.settings)){case 5:return n.toISOString().replace(".000Z","Z");case 6:return F2(n);case 7:return n.getTime()/1e3;default:return console.warn("Missing timestamp format, using epoch seconds",n),n.getTime()/1e3}n instanceof Ma&&(this.useReplacer=!0)}if(!(n===null&&(s!=null&&s.isStructSchema()))){if(c.isStringSchema()){if(typeof n>"u"&&c.isIdempotencyToken())return P1();const m=c.getMergedTraits().mediaType;return n!=null&&m&&(m==="application/json"||m.endsWith("+json"))?jc.from(n):n}if(typeof n=="number"&&c.isNumericSchema())return Math.abs(n)===1/0||isNaN(n)?String(n):n;if(typeof n=="string"&&c.isBlobSchema())return c===this.rootSchema?n:(((p=this.serdeContext)==null?void 0:p.base64Encoder)??wm)(n);if(typeof n=="bigint"&&(this.useReplacer=!0),c.isDocumentSchema())if(i){const m=Array.isArray(n)?[]:{};for(const[g,x]of Object.entries(n))x instanceof Ma?(this.useReplacer=!0,m[g]=x):m[g]=this._write(c,x);return m}else return structuredClone(n);return n}}}class SL extends jb{constructor(t){super();H(this,"settings");this.settings=t}createSerializer(){const t=new EL(this.settings);return t.setSerdeContext(this.serdeContext),t}createDeserializer(){const t=new bL(this.settings);return t.setSerdeContext(this.serdeContext),t}}class CL extends Z2{constructor({defaultNamespace:t,serviceTarget:n,awsQueryCompatible:s,jsonCodec:i}){super({defaultNamespace:t});H(this,"serializer");H(this,"deserializer");H(this,"serviceTarget");H(this,"codec");H(this,"mixin");H(this,"awsQueryCompatible");this.serviceTarget=n,this.codec=i??new SL({timestampFormat:{useTrait:!0,default:7},jsonName:!1}),this.serializer=this.codec.createSerializer(),this.deserializer=this.codec.createDeserializer(),this.awsQueryCompatible=!!s,this.mixin=new mL(this.awsQueryCompatible)}async serializeRequest(t,n,s){const i=await super.serializeRequest(t,n,s);return i.path.endsWith("/")||(i.path+="/"),Object.assign(i.headers,{"content-type":`application/x-amz-json-${this.getJsonRpcVersion()}`,"x-amz-target":`${this.serviceTarget}.${t.name}`}),this.awsQueryCompatible&&(i.headers["x-amzn-query-mode"]="true"),(Lv(t.input)==="unit"||!i.body)&&(i.body="{}"),i}getPayloadCodec(){return this.codec}async handleError(t,n,s,i,c){this.awsQueryCompatible&&this.mixin.setQueryCompatError(i,s);const u=wL(s,i)??"Unknown",{errorSchema:p,errorMetadata:m}=await this.mixin.getErrorSchemaOrThrowBaseException(u,this.options.defaultNamespace,s,i,c,this.awsQueryCompatible?this.mixin.findQueryCompatibleError:void 0),g=xo.of(p),x=i.message??i.Message??"Unknown",b=dt.for(p[1]).getErrorCtor(p)??Error,E=new b(x),N={};for(const[S,T]of g.structIterator())i[S]!=null&&(N[S]=this.codec.createDeserializer().readObject(T,i[S]));throw this.awsQueryCompatible&&this.mixin.queryCompatOutput(i,N),this.mixin.decorateServiceException(Object.assign(E,m,{$fault:g.getMergedTraits().error,message:x},N),i)}}class dN extends CL{constructor({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s}){super({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s})}getShapeId(){return"aws.protocols#awsJson1_1"}getJsonRpcVersion(){return"1.1"}getDefaultContentType(){return"application/x-amz-json-1.1"}}const kL=/\d{12}\.ddb/;async function NL(r,e,t){var i,c,u,p,m,g,x;const n=t.request;if(((i=n==null?void 0:n.headers)==null?void 0:i["smithy-protocol"])==="rpc-v2-cbor"&&Ra(r,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const b=await e.retryStrategy();typeof b.acquireInitialRetryToken=="function"?(u=(c=b.constructor)==null?void 0:c.name)!=null&&u.includes("Adaptive")?Ra(r,"RETRY_MODE_ADAPTIVE","F"):Ra(r,"RETRY_MODE_STANDARD","E"):Ra(r,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const b=r.endpointV2;switch(String((p=b==null?void 0:b.url)==null?void 0:p.hostname).match(kL)&&Ra(r,"ACCOUNT_ID_ENDPOINT","O"),await((m=e.accountIdEndpointMode)==null?void 0:m.call(e))){case"disabled":Ra(r,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":Ra(r,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":Ra(r,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=(x=(g=r.__smithy_context)==null?void 0:g.selectedHttpAuthScheme)==null?void 0:x.identity;if(s!=null&&s.$source){const b=s;b.accountId&&Ra(r,"RESOLVED_ACCOUNT_ID","T");for(const[E,N]of Object.entries(b.$source??{}))Ra(r,E,N)}}const MS="user-agent",Sx="x-amz-user-agent",$S=" ",Cx="/",TL=/[^!$%&'*+\-.^_`|~\w]/g,RL=/[^!$%&'*+\-.^_`|~\w#]/g,US="-",AL=1024;function IL(r){let e="";for(const t in r){const n=r[t];if(e.length+n.length+1<=AL){e.length?e+=","+n:e+=n;continue}break}return e}const PL=r=>(e,t)=>async n=>{var E,N,S,T;const{request:s}=n;if(!Uo.isInstance(s))return e(n);const{headers:i}=s,c=((E=t==null?void 0:t.userAgent)==null?void 0:E.map(gv))||[],u=(await r.defaultUserAgentProvider()).map(gv);await NL(t,r,n);const p=t;u.push(`m/${IL(Object.assign({},(N=t.__smithy_context)==null?void 0:N.features,(S=p.__aws_sdk_context)==null?void 0:S.features))}`);const m=((T=r==null?void 0:r.customUserAgent)==null?void 0:T.map(gv))||[],g=await r.userAgentAppId();g&&u.push(gv(["app",`${g}`]));const x=[].concat([...u,...c,...m]).join($S),b=[...u.filter(R=>R.startsWith("aws-sdk-")),...m].join($S);return r.runtime!=="browser"?(b&&(i[Sx]=i[Sx]?`${i[MS]} ${b}`:b),i[MS]=x):i[Sx]=x,e({...n,request:s})},gv=r=>{var c;const e=r[0].split(Cx).map(u=>u.replace(TL,US)).join(Cx),t=(c=r[1])==null?void 0:c.replace(RL,US),n=e.indexOf(Cx),s=e.substring(0,n);let i=e.substring(n+1);return s==="api"&&(i=i.toLowerCase()),[s,i,t].filter(u=>u&&u.length>0).reduce((u,p,m)=>{switch(m){case 0:return p;case 1:return`${u}/${p}`;default:return`${u}#${p}`}},"")},FL={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},fN=r=>({applyToStack:e=>{e.add(PL(r),FL)}}),hN=!1,pN=!1,zS=new Set,jL=(r,e=$m)=>{if(!zS.has(r)&&!e(r))if(r==="*")console.warn('@smithy/config-resolver WARN - Please use the caller region instead of "*". See "sigv4a" in https://github.com/aws/aws-sdk-js-v3/blob/main/supplemental-docs/CLIENTS.md.');else throw new Error(`Region not accepted: region="${r}" is not a valid hostname component.`);else zS.add(r)},mN=r=>typeof r=="string"&&(r.startsWith("fips-")||r.endsWith("-fips")),OL=r=>mN(r)?["fips-aws-global","aws-fips"].includes(r)?"us-east-1":r.replace(/fips-(dkr-|prod-)?|-fips/,""):r,gN=r=>{const{region:e,useFipsEndpoint:t}=r;if(!e)throw new Error("Region is missing");return Object.assign(r,{region:async()=>{const n=typeof e=="function"?await e():e,s=OL(n);return jL(s),s},useFipsEndpoint:async()=>{const n=typeof e=="string"?e:await e();return mN(n)?!0:typeof t!="function"?Promise.resolve(!!t):t()}})},HS="content-length";function DL(r){return e=>async t=>{const n=t.request;if(Uo.isInstance(n)){const{body:s,headers:i}=n;if(s&&Object.keys(i).map(c=>c.toLowerCase()).indexOf(HS)===-1)try{const c=r(s);n.headers={...n.headers,[HS]:String(c)}}catch{}}return e({...t,request:n})}}const LL={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},vN=r=>({applyToStack:e=>{e.add(DL(r.bodyLengthChecker),LL)}}),ML=async r=>{const e=(r==null?void 0:r.Bucket)||"";if(typeof r.Bucket=="string"&&(r.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),BL(e)){if(r.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!HL(e)||e.indexOf(".")!==-1&&!String(r.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(r.ForcePathStyle=!0);return r.DisableMultiRegionAccessPoints&&(r.disableMultiRegionAccessPoints=!0,r.DisableMRAP=!0),r},$L=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,UL=/(\d+\.){3}\d+/,zL=/\.\./,HL=r=>$L.test(r)&&!UL.test(r)&&!zL.test(r),BL=r=>{const[e,t,n,,,s]=r.split(":"),i=e==="arn"&&r.split(":").length>=6,c=!!(i&&t&&n&&s);if(i&&!c)throw new Error(`Invalid ARN: ${r} was an invalid ARN.`);return c},GL=(r,e,t,n=!1)=>{const s=async()=>{let i;if(n){const c=t.clientContextParams;i=(c==null?void 0:c[r])??t[r]??t[e]}else i=t[r]??t[e];return typeof i=="function"?i():i};return r==="credentialScope"||e==="CredentialScope"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.credentialScope)??(i==null?void 0:i.CredentialScope)}:r==="accountId"||e==="AccountId"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.accountId)??(i==null?void 0:i.AccountId)}:r==="endpoint"||e==="endpoint"?async()=>{if(t.isCustomEndpoint===!1)return;const i=await s();if(i&&typeof i=="object"){if("url"in i)return i.url.href;if("hostname"in i){const{protocol:c,hostname:u,port:p,path:m}=i;return`${c}//${u}${p?":"+p:""}${m}`}}return i}:s},yN=async r=>{},xN=r=>typeof r=="object"?"url"in r?Em(r.url):r:Em(r),WL=async(r,e,t,n)=>{if(!t.isCustomEndpoint){let c;t.serviceConfiguredEndpoint?c=await t.serviceConfiguredEndpoint():c=await yN(t.serviceId),c&&(t.endpoint=()=>Promise.resolve(xN(c)),t.isCustomEndpoint=!0)}const s=await VL(r,e,t);if(typeof t.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return t.endpointProvider(s,n)},VL=async(r,e,t)=>{var i;const n={},s=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[c,u]of Object.entries(s))switch(u.type){case"staticContextParams":n[c]=u.value;break;case"contextParams":n[c]=r[u.name];break;case"clientContextParams":case"builtInParams":n[c]=await GL(u.name,c,t,u.type!=="builtInParams")();break;case"operationContextParams":n[c]=u.get(r);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(u))}return Object.keys(s).length===0&&Object.assign(n,t),String(t.serviceId).toLowerCase()==="s3"&&await ML(n),n},qL=({config:r,instructions:e})=>(t,n)=>async s=>{var u,p,m;r.isCustomEndpoint&&eD(n,"ENDPOINT_OVERRIDE","N");const i=await WL(s.input,{getEndpointParameterInstructions(){return e}},{...r},n);n.endpointV2=i,n.authSchemes=(u=i.properties)==null?void 0:u.authSchemes;const c=(p=n.authSchemes)==null?void 0:p[0];if(c){n.signing_region=c.signingRegion,n.signing_service=c.signingName;const g=nd(n),x=(m=g==null?void 0:g.selectedHttpAuthScheme)==null?void 0:m.httpAuthOption;x&&(x.signingProperties=Object.assign(x.signingProperties||{},{signing_region:c.signingRegion,signingRegion:c.signingRegion,signing_service:c.signingName,signingName:c.signingName,signingRegionSet:c.signingRegionSet},c.properties))}return t({...s})},KL={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:s2.name},YL=(r,e)=>({applyToStack:t=>{t.addRelativeTo(qL({config:r,instructions:e}),KL)}}),wN=r=>{const e=r.tls??!0,{endpoint:t,useDualstackEndpoint:n,useFipsEndpoint:s}=r,i=t!=null?async()=>xN(await zi(t)()):void 0,u=Object.assign(r,{endpoint:i,tls:e,isCustomEndpoint:!!t,useDualstackEndpoint:zi(n??!1),useFipsEndpoint:zi(s??!1)});let p;return u.serviceConfiguredEndpoint=async()=>(r.serviceId&&!p&&(p=yN(r.serviceId)),p),u};var rh;(function(r){r.STANDARD="standard",r.ADAPTIVE="adaptive"})(rh||(rh={}));const Sm=3,bN=rh.STANDARD,JL=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],XL=["TimeoutError","RequestTimeout","RequestTimeoutException"],QL=[500,502,503,504],ZL=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],eM=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],tM=r=>(r==null?void 0:r.$retryable)!==void 0,rM=r=>{var e;return(e=r.$metadata)==null?void 0:e.clockSkewCorrected},nM=r=>{const e=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return r&&r instanceof TypeError?e.has(r.message):!1},_N=r=>{var e,t;return((e=r.$metadata)==null?void 0:e.httpStatusCode)===429||JL.includes(r.name)||((t=r.$retryable)==null?void 0:t.throttling)==!0},Ob=(r,e=0)=>{var t;return tM(r)||rM(r)||XL.includes(r.name)||ZL.includes((r==null?void 0:r.code)||"")||eM.includes((r==null?void 0:r.code)||"")||QL.includes(((t=r.$metadata)==null?void 0:t.httpStatusCode)||0)||nM(r)||r.cause!==void 0&&e<=10&&Ob(r.cause,e+1)},sM=r=>{var e;if(((e=r.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const t=r.$metadata.httpStatusCode;return 500<=t&&t<=599&&!Ob(r)}return!1},jy=class jy{constructor(e){H(this,"beta");H(this,"minCapacity");H(this,"minFillRate");H(this,"scaleConstant");H(this,"smooth");H(this,"currentCapacity",0);H(this,"enabled",!1);H(this,"lastMaxRate",0);H(this,"measuredTxRate",0);H(this,"requestCount",0);H(this,"fillRate");H(this,"lastThrottleTime");H(this,"lastTimestamp",0);H(this,"lastTxRateBucket");H(this,"maxCapacity");H(this,"timeWindow",0);this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>jy.setTimeoutFn(n,t))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),_N(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),t=Math.floor(e*2)/2;if(this.requestCount++,t>this.lastTxRateBucket){const n=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}};H(jy,"setTimeoutFn",setTimeout);let Aw=jy;const Iw=100,EN=20*1e3,oM=500,BS=500,iM=5,aM=10,lM=1,cM="amz-sdk-invocation-id",uM="amz-sdk-request",dM=()=>{let r=Iw;return{computeNextBackoffDelay:n=>Math.floor(Math.min(EN,Math.random()*2**n*r)),setDelayBase:n=>{r=n}}},GS=({retryDelay:r,retryCount:e,retryCost:t})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(EN,r),getRetryCost:()=>t});class SN{constructor(e){H(this,"maxAttempts");H(this,"mode",rh.STANDARD);H(this,"capacity",BS);H(this,"retryBackoffStrategy",dM());H(this,"maxAttemptsProvider");this.maxAttempts=e,this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return GS({retryDelay:Iw,retryCount:0})}async refreshRetryTokenForRetry(e,t){const n=await this.getMaxAttempts();if(this.shouldRetry(e,t,n)){const s=t.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?oM:Iw);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),c=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,i):i,u=this.getCapacityCost(s);return this.capacity-=u,GS({retryDelay:c,retryCount:e.getRetryCount()+1,retryCost:u})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(BS,this.capacity+(e.getRetryCost()??lM))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Sm}`),Sm}}shouldRetry(e,t,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return e==="TRANSIENT"?aM:iM}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class fM{constructor(e,t){H(this,"maxAttemptsProvider");H(this,"rateLimiter");H(this,"standardRetryStrategy");H(this,"mode",rh.ADAPTIVE);this.maxAttemptsProvider=e;const{rateLimiter:n}=t??{};this.rateLimiter=n??new Aw,this.standardRetryStrategy=new SN(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}const hM=r=>r instanceof Error?r:r instanceof Object?Object.assign(new Error,r):typeof r=="string"?new Error(r):new Error(`AWS SDK error wrapper for ${r}`),CN=r=>{const{retryStrategy:e,retryMode:t,maxAttempts:n}=r,s=zi(n??Sm);return Object.assign(r,{maxAttempts:s,retryStrategy:async()=>e||(await zi(t)()===rh.ADAPTIVE?new fM(s):new SN(s))})},pM=r=>(r==null?void 0:r.body)instanceof ReadableStream,mM=r=>(e,t)=>async n=>{var c;let s=await r.retryStrategy();const i=await r.maxAttempts();if(gM(s)){s=s;let u=await s.acquireInitialRetryToken(t.partition_id),p=new Error,m=0,g=0;const{request:x}=n,b=Uo.isInstance(x);for(b&&(x.headers[cM]=P1());;)try{b&&(x.headers[uM]=`attempt=${m+1}; max=${i}`);const{response:E,output:N}=await e(n);return s.recordSuccess(u),N.$metadata.attempts=m+1,N.$metadata.totalRetryDelay=g,{response:E,output:N}}catch(E){const N=vM(E);if(p=hM(E),b&&pM(x))throw(c=t.logger instanceof Fb?console:t.logger)==null||c.warn("An error was encountered in a non-retryable streaming request."),p;try{u=await s.refreshRetryTokenForRetry(u,N)}catch{throw p.$metadata||(p.$metadata={}),p.$metadata.attempts=m+1,p.$metadata.totalRetryDelay=g,p}m=u.getRetryCount();const S=u.getRetryDelay();g+=S,await new Promise(T=>setTimeout(T,S))}}else return s=s,s!=null&&s.mode&&(t.userAgent=[...t.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,n)},gM=r=>typeof r.acquireInitialRetryToken<"u"&&typeof r.refreshRetryTokenForRetry<"u"&&typeof r.recordSuccess<"u",vM=r=>{const e={error:r,errorType:yM(r)},t=wM(r.$response);return t&&(e.retryAfterHint=t),e},yM=r=>_N(r)?"THROTTLING":Ob(r)?"TRANSIENT":sM(r)?"SERVER_ERROR":"CLIENT_ERROR",xM={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},kN=r=>({applyToStack:e=>{e.add(mM(r),xM)}}),wM=r=>{if(!eh.isInstance(r))return;const e=Object.keys(r.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const t=r.headers[e],n=Number(t);return Number.isNaN(n)?new Date(t):new Date(n*1e3)},bM=async(r,e,t)=>({operation:nd(e).operation,region:await zi(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function _M(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-idp",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function mr(r){return{schemeId:"smithy.api#noAuth"}}const EM=r=>{const e=[];switch(r.operation){case"AssociateSoftwareToken":{e.push(mr());break}case"ChangePassword":{e.push(mr());break}case"CompleteWebAuthnRegistration":{e.push(mr());break}case"ConfirmDevice":{e.push(mr());break}case"ConfirmForgotPassword":{e.push(mr());break}case"ConfirmSignUp":{e.push(mr());break}case"DeleteUser":{e.push(mr());break}case"DeleteUserAttributes":{e.push(mr());break}case"DeleteWebAuthnCredential":{e.push(mr());break}case"ForgetDevice":{e.push(mr());break}case"ForgotPassword":{e.push(mr());break}case"GetDevice":{e.push(mr());break}case"GetTokensFromRefreshToken":{e.push(mr());break}case"GetUser":{e.push(mr());break}case"GetUserAttributeVerificationCode":{e.push(mr());break}case"GetUserAuthFactors":{e.push(mr());break}case"GlobalSignOut":{e.push(mr());break}case"InitiateAuth":{e.push(mr());break}case"ListDevices":{e.push(mr());break}case"ListWebAuthnCredentials":{e.push(mr());break}case"ResendConfirmationCode":{e.push(mr());break}case"RespondToAuthChallenge":{e.push(mr());break}case"RevokeToken":{e.push(mr());break}case"SetUserMFAPreference":{e.push(mr());break}case"SetUserSettings":{e.push(mr());break}case"SignUp":{e.push(mr());break}case"StartWebAuthnRegistration":{e.push(mr());break}case"UpdateAuthEventFeedback":{e.push(mr());break}case"UpdateDeviceStatus":{e.push(mr());break}case"UpdateUserAttributes":{e.push(mr());break}case"VerifySoftwareToken":{e.push(mr());break}case"VerifyUserAttribute":{e.push(mr());break}default:e.push(_M(r))}return e},SM=r=>{const e=sN(r);return Object.assign(e,{authSchemePreference:zi(r.authSchemePreference??[])})},CM=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-idp"}),kM={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},NM="3.981.0",TM={version:NM},RM=r=>new TextEncoder().encode(r);var AM=typeof Buffer<"u"&&Buffer.from?function(r){return Buffer.from(r,"utf8")}:RM;function Cm(r){return r instanceof Uint8Array?r:typeof r=="string"?AM(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r)}function Pw(r){return typeof r=="string"?r.length===0:r.byteLength===0}var NN={name:"SHA-256"},WS={name:"HMAC",hash:NN},IM=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const PM={};function $v(){return typeof window<"u"?window:typeof self<"u"?self:PM}var FM=(function(){function r(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return r.prototype.update=function(e){if(!Pw(e)){var t=Cm(e),n=new Uint8Array(this.toHash.byteLength+t.byteLength);n.set(this.toHash,0),n.set(t,this.toHash.byteLength),this.toHash=n}},r.prototype.digest=function(){var e=this;return this.key?this.key.then(function(t){return $v().crypto.subtle.sign(WS,t,e.toHash).then(function(n){return new Uint8Array(n)})}):Pw(this.toHash)?Promise.resolve(IM):Promise.resolve().then(function(){return $v().crypto.subtle.digest(NN,e.toHash)}).then(function(t){return Promise.resolve(new Uint8Array(t))})},r.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(t,n){$v().crypto.subtle.importKey("raw",Cm(e.secret),WS,!1,["sign"]).then(t,n)}),this.key.catch(function(){}))},r})(),Oa=function(){return Oa=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Oa.apply(this,arguments)};function TN(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function jM(r,e,t,n){function s(i){return i instanceof t?i:new t(function(c){c(i)})}return new(t||(t=Promise))(function(i,c){function u(g){try{m(n.next(g))}catch(x){c(x)}}function p(g){try{m(n.throw(g))}catch(x){c(x)}}function m(g){g.done?i(g.value):s(g.value).then(u,p)}m((n=n.apply(r,e||[])).next())})}function OM(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=u(0),c.throw=u(1),c.return=u(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(m){return function(g){return p([m,g])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(i=m[0]&2?s.return:m[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,m[1])).done)return i;switch(s=0,i&&(m=[m[0]&2,i.value]),m[0]){case 0:case 1:i=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!i||m[1]>i[0]&&m[1]<i[3])){t.label=m[1];break}if(m[0]===6&&t.label<i[1]){t.label=i[1],i=m;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(m);break}i[2]&&t.ops.pop(),t.trys.pop();continue}m=e.call(r,t)}catch(g){m=[6,g],s=0}finally{n=i=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function DM(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var ai=64,LM=32,MM=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$M=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],UM=Math.pow(2,53)-1,Uv=(function(){function r(){this.state=Int32Array.from($M),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>UM)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===ai&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%ai>=ai-8){for(var s=this.bufferLength;s<ai;s++)t.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<ai-8;s++)t.setUint8(s,0);t.setUint32(ai-8,Math.floor(e/4294967296),!0),t.setUint32(ai-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(LM),s=0;s<8;s++)i[s*4]=this.state[s]>>>24&255,i[s*4+1]=this.state[s]>>>16&255,i[s*4+2]=this.state[s]>>>8&255,i[s*4+3]=this.state[s]>>>0&255;return i},r.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,n=e.state,s=n[0],i=n[1],c=n[2],u=n[3],p=n[4],m=n[5],g=n[6],x=n[7],b=0;b<ai;b++){if(b<16)this.temp[b]=(t[b*4]&255)<<24|(t[b*4+1]&255)<<16|(t[b*4+2]&255)<<8|t[b*4+3]&255;else{var E=this.temp[b-2],N=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=this.temp[b-15];var S=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;this.temp[b]=(N+this.temp[b-7]|0)+(S+this.temp[b-16]|0)}var T=(((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&m^~p&g)|0)+(x+(MM[b]+this.temp[b]|0)|0)|0,R=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&i^s&c^i&c)|0;x=g,g=m,m=p,p=u+T|0,u=c,c=i,i=s,s=T+R|0}n[0]+=s,n[1]+=i,n[2]+=c,n[3]+=u,n[4]+=p,n[5]+=m,n[6]+=g,n[7]+=x},r})(),zM=(function(){function r(e){this.secret=e,this.hash=new Uv,this.reset()}return r.prototype.update=function(e){if(!(Pw(e)||this.error))try{this.hash.update(Cm(e))}catch(t){this.error=t}},r.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},r.prototype.digest=function(){return jM(this,void 0,void 0,function(){return OM(this,function(e){return[2,this.digestSync()]})})},r.prototype.reset=function(){if(this.hash=new Uv,this.secret){this.outer=new Uv;var e=HM(this.secret),t=new Uint8Array(ai);t.set(e);for(var n=0;n<ai;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(var n=0;n<e.byteLength;n++)e[n]=0}},r})();function HM(r){var e=Cm(r);if(e.byteLength>ai){var t=new Uv;t.update(e),e=t.digest()}var n=new Uint8Array(ai);return n.set(e),n}var BM=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function GM(r){if(WM(r)&&typeof r.crypto.subtle=="object"){var e=r.crypto.subtle;return VM(e)}return!1}function WM(r){if(typeof r=="object"&&typeof r.crypto=="object"){var e=r.crypto.getRandomValues;return typeof e=="function"}return!1}function VM(r){return r&&BM.every(function(e){return typeof r[e]=="function"})}var RN=(function(){function r(e){GM($v())?this.hash=new FM(e):this.hash=new zM(e)}return r.prototype.update=function(e,t){this.hash.update(Cm(e))},r.prototype.digest=function(){return this.hash.digest()},r.prototype.reset=function(){this.hash.reset()},r})();const AN=({serviceId:r,clientVersion:e})=>async t=>{var E,N,S;const n=typeof window<"u"?window.navigator:void 0,s=(n==null?void 0:n.userAgent)??"",i=((E=n==null?void 0:n.userAgentData)==null?void 0:E.platform)??VS.os(s)??"other",c=void 0,u=((N=n==null?void 0:n.userAgentData)==null?void 0:N.brands)??[],p=u[u.length-1],m=(p==null?void 0:p.brand)??VS.browser(s)??"unknown",g=(p==null?void 0:p.version)??"unknown",x=[["aws-sdk-js",e],["ua","2.1"],[`os/${i}`,c],["lang/js"],["md/browser",`${m}_${g}`]];r&&x.push([`api/${r}`,e]);const b=await((S=t==null?void 0:t.userAgentAppId)==null?void 0:S.call(t));return b&&x.push([`app/${b}`]),x},VS={os(r){if(/iPhone|iPad|iPod/.test(r))return"iOS";if(/Macintosh|Mac OS X/.test(r))return"macOS";if(/Windows NT/.test(r))return"Windows";if(/Android/.test(r))return"Android";if(/Linux/.test(r))return"Linux"},browser(r){if(/EdgiOS|EdgA|Edg\//.test(r))return"Microsoft Edge";if(/Firefox\//.test(r))return"Firefox";if(/Chrome\//.test(r))return"Chrome";if(/Safari\//.test(r))return"Safari"}},IN=r=>()=>Promise.reject(r),qM=["in-region","cross-region","mobile","standard","legacy"],PN=({defaultsMode:r}={})=>DD(async()=>{const e=typeof r=="function"?await r():r;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(KM()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${qM.join(", ")}, got ${e}`)}}),KM=()=>{var e;const r=window==null?void 0:window.navigator;if(r!=null&&r.connection){const{effectiveType:t,rtt:n,downlink:s}=r==null?void 0:r.connection;if(typeof t=="string"&&t!=="4g"||Number(n)>100||Number(s)<10)return!0}return((e=r==null?void 0:r.userAgentData)==null?void 0:e.mobile)||typeof(r==null?void 0:r.maxTouchPoints)=="number"&&(r==null?void 0:r.maxTouchPoints)>1},FN=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!FN(t))return!1;return!0}return!(!$m(r)||r.length<3||r.length>63||r!==r.toLowerCase()||Ab(r))},qS=":",YM="/",JM=r=>{const e=r.split(qS);if(e.length<6)return null;const[t,n,s,i,c,...u]=e;if(t!=="arn"||n===""||s===""||u.join(qS)==="")return null;const p=u.map(m=>m.split(YM)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:p}},XM=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],QM={partitions:XM};let ZM=QM;const e$=r=>{const{partitions:e}=ZM;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,u]of Object.entries(s))if(c===r)return{...i,...u}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},Db={isVirtualHostableS3Bucket:FN,parseArn:JM,partition:e$};th.aws=Db;const jN="required",Es="fn",Ss="argv",ah="ref",KS=!0,YS="isSet",km="booleanEquals",Rf="error",Aa="endpoint",wl="tree",Lb="PartitionResult",Mb="getAttr",Fp="stringEquals",JS={[jN]:!1,type:"string"},XS={[jN]:!0,default:!1,type:"boolean"},QS={[ah]:"Endpoint"},ON={[Es]:km,[Ss]:[{[ah]:"UseFIPS"},!0]},DN={[Es]:km,[Ss]:[{[ah]:"UseDualStack"},!0]},Sn={},em={[ah]:"Region"},ZS={[Es]:Mb,[Ss]:[{[ah]:Lb},"supportsFIPS"]},LN={[ah]:Lb},eC={[Es]:km,[Ss]:[!0,{[Es]:Mb,[Ss]:[LN,"supportsDualStack"]}]},tC=[ON],rC=[DN],nC=[em],t$={parameters:{Region:JS,UseDualStack:XS,UseFIPS:XS,Endpoint:JS},rules:[{conditions:[{[Es]:YS,[Ss]:[QS]}],rules:[{conditions:tC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Rf},{conditions:rC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Rf},{endpoint:{url:QS,properties:Sn,headers:Sn},type:Aa}],type:wl},{conditions:[{[Es]:YS,[Ss]:nC}],rules:[{conditions:[{[Es]:"aws.partition",[Ss]:nC,assign:Lb}],rules:[{conditions:[ON,DN],rules:[{conditions:[{[Es]:km,[Ss]:[KS,ZS]},eC],rules:[{conditions:[{[Es]:Fp,[Ss]:[em,"us-east-1"]}],endpoint:{url:"https://cognito-idp-fips.us-east-1.amazonaws.com",properties:Sn,headers:Sn},type:Aa},{conditions:[{[Es]:Fp,[Ss]:[em,"us-east-2"]}],endpoint:{url:"https://cognito-idp-fips.us-east-2.amazonaws.com",properties:Sn,headers:Sn},type:Aa},{conditions:[{[Es]:Fp,[Ss]:[em,"us-west-1"]}],endpoint:{url:"https://cognito-idp-fips.us-west-1.amazonaws.com",properties:Sn,headers:Sn},type:Aa},{conditions:[{[Es]:Fp,[Ss]:[em,"us-west-2"]}],endpoint:{url:"https://cognito-idp-fips.us-west-2.amazonaws.com",properties:Sn,headers:Sn},type:Aa},{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Sn,headers:Sn},type:Aa}],type:wl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Rf}],type:wl},{conditions:tC,rules:[{conditions:[{[Es]:km,[Ss]:[ZS,KS]}],rules:[{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Sn,headers:Sn},type:Aa}],type:wl},{error:"FIPS is enabled but this partition does not support FIPS",type:Rf}],type:wl},{conditions:rC,rules:[{conditions:[eC],rules:[{conditions:[{[Es]:Fp,[Ss]:["aws",{[Es]:Mb,[Ss]:[LN,"name"]}]}],endpoint:{url:"https://cognito-idp.{Region}.amazonaws.com",properties:Sn,headers:Sn},type:Aa},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Sn,headers:Sn},type:Aa}],type:wl},{error:"DualStack is enabled but this partition does not support DualStack",type:Rf}],type:wl},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dnsSuffix}",properties:Sn,headers:Sn},type:Aa}],type:wl}],type:wl},{error:"Invalid Configuration: Missing Region",type:Rf}]},r$=t$,n$=new M1({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),s$=(r,e={})=>n$.get(r,()=>K1(r$,{endpointParams:r,logger:e.logger}));th.aws=Db;const o$=r=>({apiVersion:"2016-04-18",base64Decoder:(r==null?void 0:r.base64Decoder)??Mm,base64Encoder:(r==null?void 0:r.base64Encoder)??wm,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??s$,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??EM,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new X1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new O1}],logger:(r==null?void 0:r.logger)??new Fb,protocol:(r==null?void 0:r.protocol)??dN,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentityprovider",xmlNamespace:"http://cognito-idp.amazonaws.com/doc/2016-04-18/",version:"2016-04-18",serviceTarget:"AWSCognitoIdentityProviderService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity Provider",urlParser:(r==null?void 0:r.urlParser)??Em,utf8Decoder:(r==null?void 0:r.utf8Decoder)??Qu,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Oy}),i$=r=>{const e=PN(r),t=()=>e().then(lN),n=o$(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??oN,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??AN({serviceId:n.serviceId,clientVersion:TM.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Sm,region:(r==null?void 0:r.region)??IN("Region is missing"),requestHandler:Dy.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||bN),sha256:(r==null?void 0:r.sha256)??RN,streamCollector:(r==null?void 0:r.streamCollector)??N1,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(hN)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(pN))}},MN=r=>({setRegion(e){r.region=e},region(){return r.region}}),$N=r=>({region:r.region()}),a$=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},l$=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),c$=(r,e)=>{const t=Object.assign(MN(r),cN(r),x1(r),a$(r));return e.forEach(n=>n.configure(t)),Object.assign(r,$N(t),uN(t),w1(t),l$(t))};class $b extends iN{constructor(...[t]){const n=i$(t||{});super(n);H(this,"config");this.initConfig=n;const s=CM(n),i=L1(s),c=CN(i),u=gN(c),p=u,m=wN(p),g=SM(m),x=c$(g,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(A1(this.config)),this.middlewareStack.use(fN(this.config)),this.middlewareStack.use(kN(this.config)),this.middlewareStack.use(vN(this.config)),this.middlewareStack.use(b1(this.config)),this.middlewareStack.use(_1(this.config)),this.middlewareStack.use(E1(this.config)),this.middlewareStack.use(S1(this.config,{httpAuthSchemeParametersProvider:bM,identityProviderConfigProvider:async b=>new j1({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(C1(this.config))}destroy(){super.destroy()}}class mt extends zf{constructor(e){super(e),Object.setPrototypeOf(this,mt.prototype)}}class Ub extends mt{constructor(t){super({name:"InternalErrorException",$fault:"server",...t});H(this,"name","InternalErrorException");H(this,"$fault","server");Object.setPrototypeOf(this,Ub.prototype)}}class zb extends mt{constructor(t){super({name:"InvalidParameterException",$fault:"client",...t});H(this,"name","InvalidParameterException");H(this,"$fault","client");H(this,"reasonCode");Object.setPrototypeOf(this,zb.prototype),this.reasonCode=t.reasonCode}}class Hb extends mt{constructor(t){super({name:"NotAuthorizedException",$fault:"client",...t});H(this,"name","NotAuthorizedException");H(this,"$fault","client");Object.setPrototypeOf(this,Hb.prototype)}}class Bb extends mt{constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t});H(this,"name","ResourceNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,Bb.prototype)}}class Gb extends mt{constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t});H(this,"name","TooManyRequestsException");H(this,"$fault","client");Object.setPrototypeOf(this,Gb.prototype)}}class Wb extends mt{constructor(t){super({name:"UserImportInProgressException",$fault:"client",...t});H(this,"name","UserImportInProgressException");H(this,"$fault","client");Object.setPrototypeOf(this,Wb.prototype)}}class Vb extends mt{constructor(t){super({name:"UserNotFoundException",$fault:"client",...t});H(this,"name","UserNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,Vb.prototype)}}class qb extends mt{constructor(t){super({name:"InvalidLambdaResponseException",$fault:"client",...t});H(this,"name","InvalidLambdaResponseException");H(this,"$fault","client");Object.setPrototypeOf(this,qb.prototype)}}class Kb extends mt{constructor(t){super({name:"LimitExceededException",$fault:"client",...t});H(this,"name","LimitExceededException");H(this,"$fault","client");Object.setPrototypeOf(this,Kb.prototype)}}class Yb extends mt{constructor(t){super({name:"TooManyFailedAttemptsException",$fault:"client",...t});H(this,"name","TooManyFailedAttemptsException");H(this,"$fault","client");Object.setPrototypeOf(this,Yb.prototype)}}class Jb extends mt{constructor(t){super({name:"UnexpectedLambdaException",$fault:"client",...t});H(this,"name","UnexpectedLambdaException");H(this,"$fault","client");Object.setPrototypeOf(this,Jb.prototype)}}class Xb extends mt{constructor(t){super({name:"UserLambdaValidationException",$fault:"client",...t});H(this,"name","UserLambdaValidationException");H(this,"$fault","client");Object.setPrototypeOf(this,Xb.prototype)}}class Qb extends mt{constructor(t){super({name:"CodeDeliveryFailureException",$fault:"client",...t});H(this,"name","CodeDeliveryFailureException");H(this,"$fault","client");Object.setPrototypeOf(this,Qb.prototype)}}class Zb extends mt{constructor(t){super({name:"InvalidPasswordException",$fault:"client",...t});H(this,"name","InvalidPasswordException");H(this,"$fault","client");Object.setPrototypeOf(this,Zb.prototype)}}class e_ extends mt{constructor(t){super({name:"InvalidSmsRoleAccessPolicyException",$fault:"client",...t});H(this,"name","InvalidSmsRoleAccessPolicyException");H(this,"$fault","client");Object.setPrototypeOf(this,e_.prototype)}}class t_ extends mt{constructor(t){super({name:"InvalidSmsRoleTrustRelationshipException",$fault:"client",...t});H(this,"name","InvalidSmsRoleTrustRelationshipException");H(this,"$fault","client");Object.setPrototypeOf(this,t_.prototype)}}class r_ extends mt{constructor(t){super({name:"PreconditionNotMetException",$fault:"client",...t});H(this,"name","PreconditionNotMetException");H(this,"$fault","client");Object.setPrototypeOf(this,r_.prototype)}}class n_ extends mt{constructor(t){super({name:"UnsupportedUserStateException",$fault:"client",...t});H(this,"name","UnsupportedUserStateException");H(this,"$fault","client");Object.setPrototypeOf(this,n_.prototype)}}class s_ extends mt{constructor(t){super({name:"UsernameExistsException",$fault:"client",...t});H(this,"name","UsernameExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,s_.prototype)}}class o_ extends mt{constructor(t){super({name:"AliasExistsException",$fault:"client",...t});H(this,"name","AliasExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,o_.prototype)}}class i_ extends mt{constructor(t){super({name:"InvalidUserPoolConfigurationException",$fault:"client",...t});H(this,"name","InvalidUserPoolConfigurationException");H(this,"$fault","client");Object.setPrototypeOf(this,i_.prototype)}}class a_ extends mt{constructor(t){super({name:"InvalidEmailRoleAccessPolicyException",$fault:"client",...t});H(this,"name","InvalidEmailRoleAccessPolicyException");H(this,"$fault","client");Object.setPrototypeOf(this,a_.prototype)}}class l_ extends mt{constructor(t){super({name:"MFAMethodNotFoundException",$fault:"client",...t});H(this,"name","MFAMethodNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,l_.prototype)}}class c_ extends mt{constructor(t){super({name:"PasswordResetRequiredException",$fault:"client",...t});H(this,"name","PasswordResetRequiredException");H(this,"$fault","client");Object.setPrototypeOf(this,c_.prototype)}}class u_ extends mt{constructor(t){super({name:"UnsupportedOperationException",$fault:"client",...t});H(this,"name","UnsupportedOperationException");H(this,"$fault","client");Object.setPrototypeOf(this,u_.prototype)}}class d_ extends mt{constructor(t){super({name:"UserNotConfirmedException",$fault:"client",...t});H(this,"name","UserNotConfirmedException");H(this,"$fault","client");Object.setPrototypeOf(this,d_.prototype)}}class f_ extends mt{constructor(t){super({name:"UserPoolAddOnNotEnabledException",$fault:"client",...t});H(this,"name","UserPoolAddOnNotEnabledException");H(this,"$fault","client");Object.setPrototypeOf(this,f_.prototype)}}class h_ extends mt{constructor(t){super({name:"CodeMismatchException",$fault:"client",...t});H(this,"name","CodeMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,h_.prototype)}}class p_ extends mt{constructor(t){super({name:"ExpiredCodeException",$fault:"client",...t});H(this,"name","ExpiredCodeException");H(this,"$fault","client");Object.setPrototypeOf(this,p_.prototype)}}class m_ extends mt{constructor(t){super({name:"PasswordHistoryPolicyViolationException",$fault:"client",...t});H(this,"name","PasswordHistoryPolicyViolationException");H(this,"$fault","client");Object.setPrototypeOf(this,m_.prototype)}}class g_ extends mt{constructor(t){super({name:"SoftwareTokenMFANotFoundException",$fault:"client",...t});H(this,"name","SoftwareTokenMFANotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,g_.prototype)}}class v_ extends mt{constructor(t){super({name:"ConcurrentModificationException",$fault:"client",...t});H(this,"name","ConcurrentModificationException");H(this,"$fault","client");Object.setPrototypeOf(this,v_.prototype)}}class y_ extends mt{constructor(t){super({name:"ForbiddenException",$fault:"client",...t});H(this,"name","ForbiddenException");H(this,"$fault","client");Object.setPrototypeOf(this,y_.prototype)}}class x_ extends mt{constructor(t){super({name:"WebAuthnChallengeNotFoundException",$fault:"client",...t});H(this,"name","WebAuthnChallengeNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,x_.prototype)}}class w_ extends mt{constructor(t){super({name:"WebAuthnClientMismatchException",$fault:"client",...t});H(this,"name","WebAuthnClientMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,w_.prototype)}}class b_ extends mt{constructor(t){super({name:"WebAuthnCredentialNotSupportedException",$fault:"client",...t});H(this,"name","WebAuthnCredentialNotSupportedException");H(this,"$fault","client");Object.setPrototypeOf(this,b_.prototype)}}class __ extends mt{constructor(t){super({name:"WebAuthnNotEnabledException",$fault:"client",...t});H(this,"name","WebAuthnNotEnabledException");H(this,"$fault","client");Object.setPrototypeOf(this,__.prototype)}}class E_ extends mt{constructor(t){super({name:"WebAuthnOriginNotAllowedException",$fault:"client",...t});H(this,"name","WebAuthnOriginNotAllowedException");H(this,"$fault","client");Object.setPrototypeOf(this,E_.prototype)}}class S_ extends mt{constructor(t){super({name:"WebAuthnRelyingPartyMismatchException",$fault:"client",...t});H(this,"name","WebAuthnRelyingPartyMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,S_.prototype)}}class C_ extends mt{constructor(t){super({name:"DeviceKeyExistsException",$fault:"client",...t});H(this,"name","DeviceKeyExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,C_.prototype)}}class k_ extends mt{constructor(t){super({name:"GroupExistsException",$fault:"client",...t});H(this,"name","GroupExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,k_.prototype)}}class N_ extends mt{constructor(t){super({name:"DuplicateProviderException",$fault:"client",...t});H(this,"name","DuplicateProviderException");H(this,"$fault","client");Object.setPrototypeOf(this,N_.prototype)}}class T_ extends mt{constructor(t){super({name:"ManagedLoginBrandingExistsException",$fault:"client",...t});H(this,"name","ManagedLoginBrandingExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,T_.prototype)}}class R_ extends mt{constructor(t){super({name:"TermsExistsException",$fault:"client",...t});H(this,"name","TermsExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,R_.prototype)}}class A_ extends mt{constructor(t){super({name:"FeatureUnavailableInTierException",$fault:"client",...t});H(this,"name","FeatureUnavailableInTierException");H(this,"$fault","client");Object.setPrototypeOf(this,A_.prototype)}}class I_ extends mt{constructor(t){super({name:"TierChangeNotAllowedException",$fault:"client",...t});H(this,"name","TierChangeNotAllowedException");H(this,"$fault","client");Object.setPrototypeOf(this,I_.prototype)}}class P_ extends mt{constructor(t){super({name:"UserPoolTaggingException",$fault:"client",...t});H(this,"name","UserPoolTaggingException");H(this,"$fault","client");Object.setPrototypeOf(this,P_.prototype)}}class F_ extends mt{constructor(t){super({name:"InvalidOAuthFlowException",$fault:"client",...t});H(this,"name","InvalidOAuthFlowException");H(this,"$fault","client");Object.setPrototypeOf(this,F_.prototype)}}class j_ extends mt{constructor(t){super({name:"ScopeDoesNotExistException",$fault:"client",...t});H(this,"name","ScopeDoesNotExistException");H(this,"$fault","client");Object.setPrototypeOf(this,j_.prototype)}}class O_ extends mt{constructor(t){super({name:"UnsupportedIdentityProviderException",$fault:"client",...t});H(this,"name","UnsupportedIdentityProviderException");H(this,"$fault","client");Object.setPrototypeOf(this,O_.prototype)}}class D_ extends mt{constructor(t){super({name:"RefreshTokenReuseException",$fault:"client",...t});H(this,"name","RefreshTokenReuseException");H(this,"$fault","client");Object.setPrototypeOf(this,D_.prototype)}}class L_ extends mt{constructor(t){super({name:"UnauthorizedException",$fault:"client",...t});H(this,"name","UnauthorizedException");H(this,"$fault","client");Object.setPrototypeOf(this,L_.prototype)}}class M_ extends mt{constructor(t){super({name:"UnsupportedTokenTypeException",$fault:"client",...t});H(this,"name","UnsupportedTokenTypeException");H(this,"$fault","client");Object.setPrototypeOf(this,M_.prototype)}}class $_ extends mt{constructor(t){super({name:"WebAuthnConfigurationMissingException",$fault:"client",...t});H(this,"name","WebAuthnConfigurationMissingException");H(this,"$fault","client");Object.setPrototypeOf(this,$_.prototype)}}class U_ extends mt{constructor(t){super({name:"EnableSoftwareTokenMFAException",$fault:"client",...t});H(this,"name","EnableSoftwareTokenMFAException");H(this,"$fault","client");Object.setPrototypeOf(this,U_.prototype)}}const u$="AvailableChallenges",d$="AliasExistsException",f$="AnalyticsEndpointId",h$="AuthFlow",p$="AnalyticsMetadata",m$="AnalyticsMetadataType",g$="AuthParameters",v$="AuthParametersType",y$="AuthenticationResult",x$="AuthenticationResultType",w$="AccessToken",b$="CodeDeliveryFailureException",_$="ClientId",E$="ClientIdType",S$="ClientMetadata",C$="CodeMismatchException",k$="ConcurrentModificationException",N$="ChallengeName",T$="ChallengeParameters",R$="DeviceGroupKey",A$="DeviceKey",I$="DeviceKeyExistsException",P$="DuplicateProviderException",F$="ExpiredCodeException",j$="EncodedData",O$="ExpiresIn",D$="EnableSoftwareTokenMFAException",L$="ForbiddenException",M$="FeatureUnavailableInTierException",$$="GroupExistsException",U$="IpAddress",z$="InitiateAuthRequest",H$="InitiateAuthResponse",B$="InitiateAuth",G$="InternalErrorException",W$="InvalidEmailRoleAccessPolicyException",V$="InvalidLambdaResponseException",q$="InvalidOAuthFlowException",K$="InvalidParameterException",Y$="InvalidPasswordException",J$="InvalidSmsRoleAccessPolicyException",X$="InvalidSmsRoleTrustRelationshipException",Q$="IdToken",Z$="InvalidUserPoolConfigurationException",e4="LimitExceededException",t4="MFAMethodNotFoundException",r4="ManagedLoginBrandingExistsException",n4="NotAuthorizedException",s4="NewDeviceMetadata",o4="NewDeviceMetadataType",i4="PasswordHistoryPolicyViolationException",a4="PreconditionNotMetException",l4="PasswordResetRequiredException",c4="ResourceNotFoundException",u4="RefreshToken",d4="RefreshTokenReuseException",UN="Session",f4="ScopeDoesNotExistException",h4="SessionType",p4="SoftwareTokenMFANotFoundException",m4="TierChangeNotAllowedException",g4="TermsExistsException",v4="TooManyFailedAttemptsException",y4="TooManyRequestsException",x4="TokenModelType",w4="TokenType",b4="UserContextDataType",_4="UserContextData",E4="UnauthorizedException",S4="UsernameExistsException",C4="UserImportInProgressException",k4="UnsupportedIdentityProviderException",N4="UnexpectedLambdaException",T4="UserLambdaValidationException",R4="UserNotConfirmedException",A4="UserNotFoundException",I4="UnsupportedOperationException",P4="UserPoolAddOnNotEnabledException",F4="UserPoolTaggingException",j4="UnsupportedTokenTypeException",O4="UnsupportedUserStateException",D4="WebAuthnClientMismatchException",L4="WebAuthnConfigurationMissingException",M4="WebAuthnChallengeNotFoundException",$4="WebAuthnCredentialNotSupportedException",U4="WebAuthnNotEnabledException",z4="WebAuthnOriginNotAllowedException",H4="WebAuthnRelyingPartyMismatchException",_t="client",xt="error",Et="httpError",wt="message",B4="reasonCode",G4="server",zN="smithy.ts.sdk.synthetic.com.amazonaws.cognitoidentityprovider",Ce="com.amazonaws.cognitoidentityprovider";var W4=[0,Ce,E$,8,0],HN=[0,Ce,h4,8,0],kx=[0,Ce,x4,8,0],V4=[-3,Ce,d$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(V4,o_);var q4=[3,Ce,m$,0,[f$],[0]],K4=[3,Ce,x$,0,[w$,O$,w4,u4,Q$,s4],[[()=>kx,0],1,0,[()=>kx,0],[()=>kx,0],()=>x3]],Y4=[-3,Ce,b$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(Y4,Qb);var J4=[-3,Ce,C$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(J4,h_);var X4=[-3,Ce,k$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(X4,v_);var Q4=[-3,Ce,I$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(Q4,C_);var Z4=[-3,Ce,P$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(Z4,N_);var e3=[-3,Ce,D$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(e3,U_);var t3=[-3,Ce,F$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(t3,p_);var r3=[-3,Ce,M$,{[xt]:_t,[Et]:403},[wt],[0]];dt.for(Ce).registerError(r3,A_);var n3=[-3,Ce,L$,{[xt]:_t,[Et]:403},[wt],[0]];dt.for(Ce).registerError(n3,y_);var s3=[-3,Ce,$$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(s3,k_);var o3=[3,Ce,z$,0,[h$,_$,g$,S$,p$,_4,UN],[0,[()=>W4,0],[()=>eU,0],128,()=>q4,[()=>M3,0],[()=>HN,0]],2],i3=[3,Ce,H$,0,[N$,UN,T$,y$,u$],[0,[()=>HN,0],128,[()=>K4,0],64]],a3=[-3,Ce,G$,{[xt]:G4},[wt],[0]];dt.for(Ce).registerError(a3,Ub);var l3=[-3,Ce,W$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(l3,a_);var c3=[-3,Ce,V$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(c3,qb);var u3=[-3,Ce,q$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(u3,F_);var d3=[-3,Ce,K$,{[xt]:_t,[Et]:400},[wt,B4],[0,0]];dt.for(Ce).registerError(d3,zb);var f3=[-3,Ce,Y$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(f3,Zb);var h3=[-3,Ce,J$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(h3,e_);var p3=[-3,Ce,X$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(p3,t_);var m3=[-3,Ce,Z$,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(m3,i_);var g3=[-3,Ce,e4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(g3,Kb);var v3=[-3,Ce,r4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(v3,T_);var y3=[-3,Ce,t4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(y3,l_);var x3=[3,Ce,o4,0,[A$,R$],[0,0]],w3=[-3,Ce,n4,{[xt]:_t,[Et]:403},[wt],[0]];dt.for(Ce).registerError(w3,Hb);var b3=[-3,Ce,i4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(b3,m_);var _3=[-3,Ce,l4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(_3,c_);var E3=[-3,Ce,a4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(E3,r_);var S3=[-3,Ce,d4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(S3,D_);var C3=[-3,Ce,c4,{[xt]:_t,[Et]:404},[wt],[0]];dt.for(Ce).registerError(C3,Bb);var k3=[-3,Ce,f4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(k3,j_);var N3=[-3,Ce,p4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(N3,g_);var T3=[-3,Ce,g4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(T3,R_);var R3=[-3,Ce,m4,{[xt]:_t,[Et]:403},[wt],[0]];dt.for(Ce).registerError(R3,I_);var A3=[-3,Ce,v4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(A3,Yb);var I3=[-3,Ce,y4,{[xt]:_t,[Et]:429},[wt],[0]];dt.for(Ce).registerError(I3,Gb);var P3=[-3,Ce,E4,{[xt]:_t,[Et]:401},[wt],[0]];dt.for(Ce).registerError(P3,L_);var F3=[-3,Ce,N4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(F3,Jb);var j3=[-3,Ce,k4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(j3,O_);var O3=[-3,Ce,I4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(O3,u_);var D3=[-3,Ce,j4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(D3,M_);var L3=[-3,Ce,O4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(L3,n_);var M3=[3,Ce,b4,8,[U$,j$],[0,0]],$3=[-3,Ce,C4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError($3,Wb);var U3=[-3,Ce,T4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(U3,Xb);var z3=[-3,Ce,S4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(z3,s_);var H3=[-3,Ce,R4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(H3,d_);var B3=[-3,Ce,A4,{[xt]:_t,[Et]:404},[wt],[0]];dt.for(Ce).registerError(B3,Vb);var G3=[-3,Ce,P4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(G3,f_);var W3=[-3,Ce,F4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(W3,P_);var V3=[-3,Ce,M4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(V3,x_);var q3=[-3,Ce,D4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(q3,w_);var K3=[-3,Ce,L4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(K3,$_);var Y3=[-3,Ce,$4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(Y3,b_);var J3=[-3,Ce,U4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(J3,__);var X3=[-3,Ce,z4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(X3,E_);var Q3=[-3,Ce,H4,{[xt]:_t,[Et]:400},[wt],[0]];dt.for(Ce).registerError(Q3,S_);var Z3=[-3,zN,"CognitoIdentityProviderServiceException",0,[],[]];dt.for(zN).registerError(Z3,mt);var eU=[2,Ce,v$,8,0,0],tU=[9,Ce,B$,0,()=>o3,()=>i3];class z_ extends aN.classBuilder().ep(kM).m(function(e,t,n,s){return[YL(n,e.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityProviderService","InitiateAuth",{}).n("CognitoIdentityProviderClient","InitiateAuthCommand").sc(tU).build(){}const rU="0.0.0",BN="prod",nU="outlook-addin",sU="prod-outlook-app-id",oU="https://app.trycandle.ai/outlook-manifest.xml",iU="https://appsforoffice.microsoft.com/lib/1/hosted/office.js",aU="https://app.trycandle.ai/auth-dialog-pkce.html",lU=!0,Fw="https://app.trycandle.ai/auth-dialog-pkce.html?callback=true",cU="https://app.trycandle.ai/options",H_="https://app.trycandle.ai/auth/gmail/callback",yr="https://rar9obhm3f.execute-api.us-east-1.amazonaws.com/prod",uU="https://rar9obhm3f.execute-api.us-east-1.amazonaws.com/prod",GN="https://app.trycandle.ai",WN="https://candle-448049808205-us-east-1.auth.us-east-1.amazoncognito.com",lh="6s4fvuas12p625ssbstt48rpke",VN=r=>`${WN}/login?client_id=${lh}&response_type=code&scope=email+openid+profile&redirect_uri=${r}`,qN="https://candle-448049808205-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/token",dU="https://candle-448049808205-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/userInfo",Vf="https://app.trycandle.ai",KN="https://forms.gle/QFFz1rbFVmwJ96At6",fU="00db376f-0fb4-48b3-8844-c2cb1ba88920",YN="https://accounts.google.com/o/oauth2",JN="74023389454-6cal15ik3pu0p55rm5mr3go8kgro0gv8.apps.googleusercontent.com",B_=r=>`${YN}/auth?client_id=${JN}&redirect_uri=${r}&response_type=code&scope=https://www.googleapis.com/auth/gmail.readonly&access_type=offline&prompt=consent`,G_="https://rar9obhm3f.execute-api.us-east-1.amazonaws.com/prod/oauth/login/",jw="phc_4ClJshoQkUGePti88JMEx8whcKOhbFVRyMENqObYyj0",XN="https://us.i.posthog.com",hU="outlook",pU="prod",QN={buildTime:"2026-02-13T09:47:01.340Z",environment:"prod",configSource:"outlook_config.tsx",authMethod:"PKCE"},mU=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:uU,API_SERVER:yr,AUTH_DIALOG_URL:aU,AWS_CLIENT_ID:lh,AWS_COGNITO_DOMAIN:WN,AWS_LOGIN_PAGE_URI:VN,AWS_OAUTH_TOKEN_URI:qN,AWS_USERINFO_URI:dU,BASE_DOMAIN:GN,BUILD_ENV:pU,CONFIG_VERIFICATION:QN,FEEDBACK_FORM:KN,GMAIL_INTEGRATION_CLIENT_ID:JN,GMAIL_INTEGRATION_DOMAIN:YN,GMAIL_INTEGRATION_PAGE_URI:B_,GMAIL_INTEGRATION_REDIRECT_URI:H_,INTEGRATION_AUTH_URL_PREFIX:G_,LOGIN_REDIRECT_URI:Fw,MANIFEST_URL:oU,MODE:BN,OFFICE_JS_CDN:iU,OUTLOOK_APP_ID:sU,OUTLOOK_CLIENT_ID:fU,PLATFORM:hU,POSTHOG_HOST:XN,POSTHOG_KEY:jw,POST_LOGIN_REDIRECT_URI:cU,SETTINGS_PAGE_URL:Vf,TYPE:nU,USE_PKCE_AUTH:lU,VERSION:rU},Symbol.toStringTag,{value:"Module"})),qu="src/platforms/helpers/chromeAuthUtils.ts",W_=r=>new Promise(e=>{chrome.storage.local.set({token:JSON.stringify(r)},()=>{e()})}),gU=()=>new Promise(r=>{chrome.storage.local.get("token",e=>{const t=e.token?JSON.parse(e.token):null;r(t)})}),vU=()=>new Promise(r=>{chrome.storage.local.set({token:null},()=>{r()})});async function yU(r,e,t){const n="refreshAuthToken",s=new $b({region:"us-east-1"});try{t.info("Preparing for REFRESH_TOKEN_AUTH",{sourceFile:qu,functionName:n}),t.debug("AuthFlow: REFRESH_TOKEN_AUTH",{sourceFile:qu,functionName:n}),t.info("Refreshing auth token...",{sourceFile:qu,functionName:n});const i=new z_({ClientId:lh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),u=(await s.send(i)).AuthenticationResult;if(!u)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:p,AccessToken:m,RefreshToken:g,ExpiresIn:x,TokenType:b}=u;if(!p||!m||!x||!b)throw new Error("Missing required fields in AuthenticationResult.");const E={id_token:p,access_token:m,refresh_token:g||r.refresh_token,expires_in:x,token_type:b,fetched_at:e};return await W_(E),E}catch(i){throw t.error("Error refreshing auth token",i,{sourceFile:qu,functionName:n}),new Error("Failed to refresh authentication token.")}}async function xU(r){const e="handleLoginFlow";try{r.info("Starting OAuth flow in popup...",{sourceFile:qu,functionName:e});const t=VN(Fw);r.info("Auth URL",{sourceFile:qu,functionName:e,authUrl:t});const n=await chrome.identity.launchWebAuthFlow({url:t,interactive:!0});if(!n)throw new Error("Authentication was cancelled or failed");const i=new URL(n).searchParams.get("code");if(!i)throw new Error("No authorization code received");const c={grant_type:"authorization_code",code:i,redirect_uri:Fw,client_id:lh},u=await fetch(qN,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c).toString()});if(!u.ok)throw new Error(`Token exchange failed: ${u.statusText}`);const p=await u.json();if(!VO(p))throw new Error("Invalid token response format");const m={...p,fetched_at:Math.floor(Date.now())};return await W_(m),{success:!0}}catch(t){return r.error("Authentication failed",t,{sourceFile:qu,functionName:e}),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}class wU{constructor(e){H(this,"logger");H(this,"authListeners",new Set);this.logger=e}async login(){try{const e=await xU(this.logger);if(!e.success)throw new Error(e.error||"Login failed");const t=await this.getToken();if(!t)throw new Error("Token not found after login");return this.notifyAuthListeners(!0),t}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){var e;try{if(await this.deleteToken(),this.notifyAuthListeners(!1),(e=chrome==null?void 0:chrome.runtime)!=null&&e.sendMessage)try{await chrome.runtime.sendMessage({type:"USER_LOGGED_OUT"})}catch(t){this.logger.warn("Could not send logout message",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout",error:t})}}catch(t){throw this.logger.error("Logout failed",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout"}),t}}async getToken(){try{return await gU()}catch(e){return this.logger.error("Error getting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"getToken"}),null}}async saveToken(e){try{const t={...e,fetched_at:Math.floor(Date.now())};await W_(t)}catch(t){throw this.logger.error("Error saving auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"saveToken"}),t}}async deleteToken(){try{await vU()}catch(e){throw this.logger.error("Error deleting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"deleteToken"}),e}}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=e;return t.fetched_at?Math.floor(Date.now())+6e4-t.fetched_at<t.expires_in*1e3:!1}async refreshToken(e){try{const t=e,n=Math.floor(Date.now())+6e4;return await yU(t,n,this.logger)}catch(t){throw this.logger.error("Error refreshing auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"refreshToken"}),t}}async isAuthenticated(){try{const e=await this.getToken();if(this.logger.debug("Checking authentication status",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",token:e}),!e)return this.logger.debug("No token found - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(this.logger.debug("Authentication status checked",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",isValid:t,token:e}),!t){this.logger.debug("Token is not valid - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"});const n=await this.refreshToken(e);return this.logger.debug("Refreshed token",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",refreshedToken:n}),this.isTokenValid(n)}return this.logger.debug("Token is valid - user is authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(e){return this.logger.error("Error checking authentication status",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.logger.info("Notifying auth listeners",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners",isAuthenticated:e}),this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}}class bU{constructor(e){H(this,"logger");H(this,"messageListeners",new Set);this.logger=e,this.setupMessageListeners()}setupMessageListeners(){var e;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onMessage&&chrome.runtime.onMessage.addListener((t,n,s)=>{this.messageListeners.forEach(i=>{try{i(t)}catch(c){this.logger.error("Error in message callback",c,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"setupMessageListeners"})}})})}async sendMessage(e){return new Promise((t,n)=>{var s;if(!((s=chrome==null?void 0:chrome.runtime)!=null&&s.sendMessage)){n(new Error("Chrome runtime not available"));return}chrome.runtime.sendMessage(e,i=>{var c;chrome.runtime.lastError?(this.logger.error("Error sending message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),n(new Error(((c=chrome.runtime.lastError)==null?void 0:c.message)||"Unknown error"))):t(i)})})}onMessage(e){var n;const t=s=>{e(s)};this.messageListeners.add(t),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.addListener(t)}removeMessageListener(e){this.messageListeners.forEach(t=>{var n;(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.removeListener(t)}),this.messageListeners.clear()}async sendTabMessage(e,t){return new Promise((n,s)=>{var i;if(!((i=chrome==null?void 0:chrome.tabs)!=null&&i.sendMessage)){s(new Error("Chrome tabs API not available"));return}chrome.tabs.sendMessage(e,t,c=>{var u;chrome.runtime.lastError?(this.logger.error("Error sending tab message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendTabMessage",message:t}),s(new Error(((u=chrome.runtime.lastError)==null?void 0:u.message)||"Unknown error"))):n(c)})})}}class _U{constructor(e){H(this,"logger");H(this,"eventListeners",new Map);H(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Chrome platform already initialized",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),this.setupChromeEventListeners(),this.isInitialized=!0,this.logger.info("Chrome platform initialized successfully",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Chrome platform cleanup completed",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){try{typeof chrome<"u"&&chrome.sidePanel&&window.close(),this.logger.debug("Window close requested",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"})}catch(e){throw this.logger.error("Failed to close window",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"}),e}}onPlatformEvent(e,t){var n,s;switch(e){case"runtime.onInstalled":(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(t);break;case"runtime.onStartup":(s=chrome==null?void 0:chrome.runtime)!=null&&s.onStartup&&chrome.runtime.onStartup.addListener(t);break;default:this.logger.warn("Unknown platform event",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"onPlatformEvent",event:e})}}setupChromeEventListeners(){var e,t,n;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onStartup&&chrome.runtime.onStartup.addListener(()=>{this.emitPlatformEvent("startup")}),(t=chrome==null?void 0:chrome.runtime)!=null&&t.onSuspend&&chrome.runtime.onSuspend.addListener(()=>{this.emitPlatformEvent("suspend")}),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(s=>{this.emitPlatformEvent("installed",s)})}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}handleExtensionMessage(e,t,n){return this.logger.debug("Extension message received",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleExtensionMessage",message:e,sender:t}),!0}handleContextMenuClick(e,t){this.logger.debug("Context menu clicked",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleContextMenuClick",info:e,tab:t})}}const mi=async r=>{try{return(await On.createServices()).storage}catch(e){return r.warn("Platform detection failed, falling back to Chrome storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",error:e}),null}},EU=async r=>{const e=await mi(r);e&&await e.clearLocal()},SU=async(r,e)=>{try{const t=await On.createServices();if(On.getCurrentPlatform()==="outlook"){r.debug("Token saving handled by OutlookAuthProvider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"});return}const n=t.storage;n&&await n.setLocalItem("token",e)}catch(t){throw r.error("Failed to save auth token",t,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"}),t}},Nm=async r=>{try{const e=await On.createServices();if(On.getCurrentPlatform()==="outlook"){const n=await e.auth.getToken();return n?(r.info("Auth token retrieved from auth provider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform",authToken:n}),n):null}const t=e.storage;return t?await t.getLocalItem("token"):null}catch(e){return r.error("Failed to get auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform"}),null}},$y=async r=>{try{const e=await On.createServices();if(On.getCurrentPlatform()==="outlook"){await e.auth.logout();return}const t=e.storage;t&&await t.removeLocalItem("token")}catch(e){r.error("Failed to delete auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"deleteAuthTokenPlatform"})}},ZN=async(r,e)=>{const t=await mi(r);if(t){const n={...e};(!n.id||n.id==="")&&(n.id=String(Date.now())),await t.setLocalItem("configuration",n)}},ey=async r=>{const e=await mi(r);return e?await e.getLocalItem("configuration")||{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}:{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}},CU=async(r,e)=>{const t=await mi(r);t&&await t.setLocalItem("emailTemplates",e)},eT=async r=>{const e=await mi(r);return e?await e.getLocalItem("emailTemplates")||[]:[]},Um=async(r,e)=>{const t=await mi(r);t&&await t.setLocalItem("integrations",e)},zm=async r=>{const e=await mi(r);return e?await e.getLocalItem("integrations")||[]:[]},kU=async(r,e)=>{const t=await mi(r);t&&await t.setLocalItem("orgTemplates",e)},tT=async r=>{const e=await mi(r);return e?await e.getLocalItem("orgTemplates")||[]:[]},NU=async(r,e)=>{const t=await mi(r);if(t){const n=new Date().toISOString();await t.setLocalItem("gmailConnectionStatus",e),await t.setLocalItem("gmailConnectionStatusTimestamp",n),r.debug("Saved Gmail connection status to storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:e,timestamp:n})}},TU=async r=>{const e=await mi(r);if(e){const t=await e.getLocalItem("gmailConnectionStatus"),n=await e.getLocalItem("gmailConnectionStatusTimestamp");return r.debug("Retrieved Gmail connection status from storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:t,timestamp:n}),{isConnected:t,timestamp:n}}return{isConnected:null,timestamp:null}},rT=async r=>{const e=await mi(r);e&&(await e.removeLocalItem("clients"),await e.removeLocalItem("integrations"))},Ws="src/lib/utils/authUtils.tsx";async function nT(r,e,t,n){const s="withLock";if(r.current)return n.info(`${t} already in progress, waiting for completion...`,{sourceFile:Ws,functionName:s}),await r.current;r.current=e();try{return await r.current}finally{r.current=null}}const RU={current:null};async function Ow(r){return nT(RU,()=>AU(r),"Token validation",r)}async function AU(r){const e="performTokenValidation";let t=await Nm(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now()),s=t.expires_in*1e3+(t.fetched_at||0);if(r.info("Token expiry check",{sourceFile:Ws,functionName:e,tokenExpiry:new Date(s).toISOString(),currentTime:new Date(n).toISOString(),timeUntilExpiry:s-n}),s-n<3e5)try{r.info("Token expired. Refreshing...",{sourceFile:Ws,functionName:e}),t=await sT(t,n,r),r.info("New token received",{sourceFile:Ws,functionName:e})}catch(i){throw r.error("Token refresh failed",i,{sourceFile:Ws,functionName:e}),await $y(r),new Error("Unauthorized: Failed to refresh token.")}return t}const Nx=20,IU=500;function PU(r){return new Promise(e=>setTimeout(e,r))}function FU(r){var s;const e=r,t=(s=e==null?void 0:e.$metadata)==null?void 0:s.httpStatusCode;if(typeof t=="number")return t>=500||t===429||t===408;const n=["TimeoutError","NetworkError"];return typeof(e==null?void 0:e.name)=="string"&&n.includes(e.name),!0}async function sT(r,e,t){const n="refreshAuthToken",s=new $b({region:"us-east-1"});for(let i=1;i<=Nx;i++)try{t.info(`Refreshing auth token (attempt ${i})...`,{sourceFile:Ws,functionName:n});const c=new z_({ClientId:lh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),p=(await s.send(c)).AuthenticationResult;if(!p)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:m,AccessToken:g,RefreshToken:x,ExpiresIn:b,TokenType:E}=p;if(!m||!g||!b||!E)throw new Error("Missing required fields in AuthenticationResult.");const N={id_token:m,access_token:g,refresh_token:x||r.refresh_token,expires_in:b,token_type:E,fetched_at:e};return await SU(t,N),N}catch(c){const u=FU(c);if(t.error(`Error refreshing auth token (attempt ${i}/${Nx})`,c,{sourceFile:Ws,functionName:n,isTransient:u}),!u||i===Nx)throw await $y(t),new Error("Failed to refresh authentication token.");const p=IU*2**(i-1);t.warn(`Transient error refreshing token  retrying in ${p}ms`,{sourceFile:Ws,functionName:n,attempt:i}),await PU(p)}throw new Error("Failed to refresh authentication token.")}const jU={current:null};async function OU(r){return nT(jU,()=>DU(r),"Force token refresh",r)}async function DU(r){const e="performForceTokenRefresh",t=await Nm(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now());r.info("Force refreshing token before opening options page",{sourceFile:Ws,functionName:e,currentTime:new Date(n).toISOString()});const s=await sT(t,n,r);return r.info("Token force refresh successful",{sourceFile:Ws,functionName:e}),s}async function zr(r,e={},t){const n="fetchWithAuth",s=Date.now(),i=Date.now();let c=await Ow(t);const u=Date.now()-i;e.headers={...e.headers,Authorization:`${c.id_token}`};const p=Date.now(),m=await fetch(r,e),g=Date.now()-p;if(t.info("fetchWithAuth completed",{sourceFile:Ws,functionName:n,url:r.pathname,status:m.status,tokenValidationMs:u,networkFetchMs:g,totalMs:Date.now()-s}),m.status===401)try{t.info("Received 401, getting fresh token...",{sourceFile:Ws,functionName:n});const x=Date.now();c=await Ow(t);const b=Date.now()-x;t.info("New token received for retry",{sourceFile:Ws,functionName:n,retryTokenMs:b}),e.headers&&typeof e.headers=="object"&&!Array.isArray(e.headers)&&(e.headers.Authorization=`${c.id_token}`);const E=Date.now(),N=await fetch(r,e),S=Date.now()-E;return t.info("fetchWithAuth retry completed",{sourceFile:Ws,functionName:n,url:r.pathname,status:N.status,retryTokenMs:b,retryFetchMs:S,totalMs:Date.now()-s}),N}catch(x){throw t.error("Token refresh failed",x,{sourceFile:Ws,functionName:n}),await $y(t),new Error("Unauthorized: Failed to refresh token.")}return m}class LU{constructor(e){H(this,"logger");this.logger=e}getResourceURL(e){return chrome.runtime.getURL(e)}async queryTabs(e={}){return new Promise(t=>{chrome.tabs.query(e,n=>{t(n.map(s=>({id:s.id,url:s.url,active:s.active})))})})}async updateTab(e,t){return new Promise(n=>{chrome.tabs.update(e,t,()=>{n()})})}async reloadTab(e){return new Promise(t=>{chrome.tabs.reload(e,void 0,()=>{t()})})}async openOptionsPage(){return new Promise(async e=>{try{const t=await OU(this.logger);let n=Vf;t!=null&&t.id_token&&(n+=`?token=${encodeURIComponent(t.id_token)}`),this.logger.info("Opening external options page",{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage",url:Vf,hasToken:!!(t!=null&&t.id_token)}),chrome.tabs.create({url:n},()=>{e()})}catch(t){this.logger.error("Failed to open options page",t,{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage"}),chrome.tabs.create({url:Vf},()=>{e()})}})}async openURL(e,t="_blank"){return new Promise(n=>{t==="_blank"?chrome.tabs.create({url:e},()=>{n()}):(window.open(e,t),n())})}}function zv(r){const t=new DOMParser().parseFromString(r,"text/html"),n={white:"#ffffff",black:"#000000",red:"#e60000",orange:"#f90",yellow:"#ff0",green:"#008a00",blue:"#06c",purple:"#93f"};t.querySelectorAll("[class]").forEach(m=>{const g=m.classList,x={},b=[],E=m.getAttribute("style");E&&E.split(";").forEach(S=>{const[T,R]=S.split(":").map(A=>A.trim());T&&R&&(x[T]=R)});for(const S of["left","center","right","justify"]){const T=`ql-align-${S}`;if(g.contains(T)){const R=m.tagName.toLowerCase();R==="li"?S==="center"?(x["text-align"]="center",x["list-style-position"]="inside"):S==="right"?(x["text-align"]="right",x["list-style-position"]="inside"):S==="left"?x["text-align"]="left":S==="justify"&&(x["text-align"]="justify"):R==="ol"||R==="ul"?S==="center"?(x["margin-left"]="auto",x["margin-right"]="auto",x["padding-left"]="40px",x.width="fit-content"):S==="right"?(x["margin-left"]="auto",x["margin-right"]="0",x["padding-left"]="40px",x.width="fit-content"):S==="left"&&(x["margin-left"]="0",x["margin-right"]="auto"):x["text-align"]=S,b.push(T)}}g.contains("ql-font-serif")&&(x["font-family"]="Georgia, Times New Roman, serif",b.push("ql-font-serif")),g.contains("ql-font-monospace")&&(x["font-family"]="Monaco, Courier New, monospace",b.push("ql-font-monospace"));const N={"ql-size-small":"0.75em","ql-size-large":"1.5em","ql-size-huge":"2.5em"};for(const[S,T]of Object.entries(N))g.contains(S)&&(x["font-size"]=T,b.push(S));for(const[S,T]of Object.entries(n)){const R=`ql-color-${S}`;g.contains(R)&&(x.color=T,b.push(R))}for(const[S,T]of Object.entries(n)){const R=`ql-bg-${S}`;g.contains(R)&&(x["background-color"]=T,b.push(R))}if(Object.keys(x).length>0){const S=Object.entries(x).map(([T,R])=>`${T}: ${R}`).join("; ");m.setAttribute("style",S)}b.forEach(S=>{g.remove(S)}),g.length===0&&m.removeAttribute("class")});const i=t.createTreeWalker(t.body,NodeFilter.SHOW_TEXT,null),c=[];let u;for(;u=i.nextNode();)if(u.nodeValue&&u.nodeValue.includes("	")){const m=u.nodeValue.replace(/\t/g,"");c.push({node:u,newValue:m})}return c.forEach(({node:m,newValue:g})=>{m.nodeValue=g}),t.querySelectorAll("ul, ol").forEach(m=>{var E,N;const g=Array.from(m.children);if(g.length===0)return;const x=g.some(S=>S.getAttribute("data-list")==="bullet"),b=g.some(S=>S.getAttribute("data-list")==="ordered");if(x&&b){const S=t.createDocumentFragment();let T=null,R=null;g.forEach(A=>{const j=A.getAttribute("data-list")||"bullet";if(R!==j||!T){T=t.createElement(j==="ordered"?"ol":"ul");const P=m.getAttribute("style");P&&T.setAttribute("style",P);const U=m.getAttribute("class");U&&T.setAttribute("class",U),S.appendChild(T),R=j}T.appendChild(A.cloneNode(!0))}),(E=m.parentNode)==null||E.replaceChild(S,m)}else if(b&&m.tagName.toLowerCase()==="ul"){const S=t.createElement("ol");for(Array.from(m.attributes).forEach(T=>{S.setAttribute(T.name,T.value)});m.firstChild;)S.appendChild(m.firstChild);(N=m.parentNode)==null||N.replaceChild(S,m)}}),t.body.innerHTML}class MU{constructor(e){H(this,"logger");this.logger=e}async executeScript(e){var t;try{return(t=(await chrome.scripting.executeScript({target:e.target,func:e.func,args:e.args}))[0])==null?void 0:t.result}catch(n){throw this.logger.error("Error executing script",n,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"executeScript"}),n}}async insertContentIntoComposeBox(e){try{const t=zv(e),s=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];if(!(s!=null&&s.id))throw new Error("No active tab found or tab ID is undefined");await chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function u(x){var S;const b=window.getSelection();let E=null,N=0;if(b&&b.rangeCount>0&&(E=b.getRangeAt(0).cloneRange(),x.contains(E.startContainer)||x===E.startContainer)){const T=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let R=0,A;for(;A=T.nextNode();)if(A===E.startContainer){R+=E.startOffset;break}else R+=((S=A.textContent)==null?void 0:S.length)||0;N=R}return{selection:b,range:E,offset:N}}function p(x,b){var E;try{const{selection:N,range:S,offset:T}=b;if(!N)return;if(S&&x.contains(S.startContainer)){N.removeAllRanges(),N.addRange(S);return}if(T>0){const A=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let j=0,P;for(;P=A.nextNode();){const U=((E=P.textContent)==null?void 0:E.length)||0;if(j+U>=T){const B=document.createRange();B.setStart(P,T-j),B.collapse(!0),N.removeAllRanges(),N.addRange(B);return}j+=U}}const R=document.createRange();R.selectNodeContents(x),R.collapse(!1),N.removeAllRanges(),N.addRange(R)}catch(N){console.warn("Could not restore cursor position:",N)}}function m(x,b){document.execCommand("insertHTML",!1,b)}const g=c();if(!g)throw new Error("Compose box not found");try{const x=u(g);g.focus(),p(g,x),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste")}).catch(()=>{m(g,i)}):m(g,i)}catch(x){throw new Error("Error during paste operation: "+x)}},args:[t]})}catch(t){throw this.logger.error("Error inserting content into compose box",t,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),t}}}class $U{constructor(e){H(this,"logger");this.logger=e}async launchWebAuthFlow(e){try{const t=await chrome.identity.launchWebAuthFlow(e);if(!t)throw new Error("Authentication was cancelled or failed");return t}catch(t){throw this.logger.error("Error launching web auth flow",t,{sourceFile:"src/platforms/chrome/ChromeIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),t}}async initiateOAuth(e,t){return this.launchWebAuthFlow({url:e,interactive:!0})}}const UU="CandleLogsDB",zU=1,Ku="logs",HU=5e3,BU=500,sC={ERROR:1,WARN:2,INFO:3,DEBUG:4};let jp=null;function Dw(){return jp||(jp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(UU,zU);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(Ku)){console.log(`[Logger] Creating object store: ${Ku}`);const i=s.createObjectStore(Ku,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),jp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),jp)}Dw().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const Do=class Do{constructor(e){H(this,"context");H(this,"minLevel","INFO");this.context=e||"unknown"}async writeLog(e,t,n,s){if(sC[e]>sC[this.minLevel])return;const i=(n==null?void 0:n.sourceFile)||"unknown",c=n==null?void 0:n.sourceFunction;let u;s&&(s instanceof Error?u={name:s.name,message:s.message,stack:s.stack}:u=s);const{sourceFile:p,sourceFunction:m,...g}=n||{},x={...u?{error:u}:{},...g},b={timestamp:new Date().toISOString(),level:e,message:t,chromeContext:this.context,sourceFile:i,...c&&{sourceFunction:c},details:Object.keys(x).length>0?x:void 0};try{const N=(await Dw()).transaction(Ku,"readwrite"),T=N.objectStore(Ku).add(b);return new Promise((R,A)=>{T.onsuccess=()=>{R()},T.onerror=j=>{console.error("[Logger] Failed to write log to IndexedDB:",j.target.error,b),A(j.target.error)},N.onerror=j=>{console.error("[Logger] Transaction error writing log:",j.target.error,b),A(j.target.error)},N.onabort=j=>{console.warn("[Logger] Transaction aborted writing log:",j.target.error,b),A(new Error("Transaction aborted"))}})}catch(E){throw console.error("[Logger] Error obtaining DB or starting transaction:",E,b),E}}static async _cleanupOldLogs(){if(this._isCleaning){console.info("[Logger] Cleanup already in progress, skipping.");return}console.info("[Logger] Starting log cleanup check..."),this._isCleaning=!0;try{const t=(await Dw()).transaction(Ku,"readwrite"),n=t.objectStore(Ku),s=n.count(),i=await new Promise((m,g)=>{s.onsuccess=()=>m(s.result),s.onerror=x=>{console.error("[Logger] Failed to count logs for cleanup:",x.target.error),g(x.target.error)}});if(i<=this.MAX_LOG_ENTRIES){console.info(`[Logger] Log count (${i}) within limit (${this.MAX_LOG_ENTRIES}). No cleanup needed.`);return}let c=i-this.MAX_LOG_ENTRIES;console.warn(`[Logger] Log count (${i}) exceeds limit (${this.MAX_LOG_ENTRIES}). Deleting ${c} oldest logs.`);const u=n.openCursor();let p=0;await new Promise((m,g)=>{u.onsuccess=x=>{const b=x.target.result;if(b&&c>0){const E=b.delete();E.onsuccess=()=>{p++,c--,c>0?b.continue():m()},E.onerror=N=>{console.error("[Logger] Error deleting log entry during cleanup:",N.target.error,"Key:",b.primaryKey),b.continue()}}else m()},u.onerror=x=>{console.error("[Logger] Error opening cursor for cleanup:",x.target.error),g(x.target.error)}}),await new Promise((m,g)=>{t.oncomplete=()=>{console.info(`[Logger] Log cleanup finished. Deleted ${p} entries.`),m()},t.onerror=x=>{console.error("[Logger] Transaction error during cleanup:",x.target.error),g(x.target.error)},t.onabort=x=>{console.warn("[Logger] Transaction aborted during cleanup:",x.target.error),g(new Error("Cleanup transaction aborted"))}})}catch(e){console.error("[Logger] Error during log cleanup process:",e)}finally{this._isCleaning=!1,console.info("[Logger] Log cleanup check finished.")}}_triggerCleanupCheck(){if(Do._writeCount++,Do._writeCount>=Do.CLEANUP_TRIGGER_COUNT&&!Do._isCleaning){const e=Do._writeCount;Do._writeCount=0,console.info(`[Logger] Write count reached ${e}. Triggering background cleanup.`),Do._cleanupOldLogs().catch(t=>{console.error("[Logger] Background cleanup process failed:",t)})}}async debug(e,t){try{await this.writeLog("DEBUG",e,t),this._triggerCleanupCheck()}catch{}}async info(e,t){try{await this.writeLog("INFO",e,t),this._triggerCleanupCheck()}catch{}}async warn(e,t){try{await this.writeLog("WARN",e,t),this._triggerCleanupCheck()}catch{}}async error(e,t,n){try{await this.writeLog("ERROR",e,n,t),this._triggerCleanupCheck()}catch{}}};H(Do,"_writeCount",0),H(Do,"_isCleaning",!1),H(Do,"MAX_LOG_ENTRIES",HU),H(Do,"CLEANUP_TRIGGER_COUNT",BU);let Lw=Do;class GU{constructor(e){H(this,"logger");this.logger=new Lw(e)}async debug(e,t){return this.logger.debug(e,t)}async info(e,t){return this.logger.info(e,t)}async warn(e,t){return this.logger.warn(e,t)}async error(e,t,n){return this.logger.error(e,t,n)}setMinLevel(e){console.warn("[ChromeLoggingProvider] setMinLevel not yet implemented - using hardcoded INFO level")}getMinLevel(){return"INFO"}}function WU(r="unknown"){const e=new GU(r==="background"?"background":"options");return{storage:new UO(e),data:new zO(e),auth:new wU(e),messaging:new bU(e),lifecycle:new _U(e),tabs:new LU(e),contentScript:new MU(e),identity:new $U(e),logging:e}}class VU{constructor(e){H(this,"logger");H(this,"_changeListeners",[]);H(this,"onChanged",e=>{this.logger.warn("onChanged listener not fully supported with Office roaming settings. Callbacks will be stored but not automatically invoked.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"onChanged"}),this._changeListeners.push(e)});H(this,"removeChangeListener",e=>{this.logger.warn("removeChangeListener not fully supported with Office roaming settings.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeChangeListener"}),this._changeListeners=this._changeListeners.filter(t=>t!==e)});this.logger=e}async getLocalItem(e){var t;try{if(typeof localStorage<"u"){const n=localStorage.getItem(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings){const n=Office.context.roamingSettings.get(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}return null}catch(n){return this.logger.error(`Error retrieving local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){var n;try{if(typeof localStorage<"u")localStorage.setItem(e,JSON.stringify(t)),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),this._notifyChangeListeners({[e]:{newValue:t}});else if((n=Office==null?void 0:Office.context)!=null&&n.roamingSettings)Office.context.roamingSettings.set(e,JSON.stringify(t)),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var u;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Stored item in roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s()):i(new Error(((u=c.error)==null?void 0:u.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{newValue:t}});else throw new Error("No storage mechanism available")}catch(s){throw this.logger.error(`Error storing local item with key: ${e}`,s,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s}}async removeLocalItem(e){var t;try{const n=await this.getLocalItem(e);if(typeof localStorage<"u")localStorage.removeItem(e),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings)Office.context.roamingSettings.remove(e),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var u;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Removed item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),s()):i(new Error(((u=c.error)==null?void 0:u.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else throw new Error("No storage mechanism available")}catch(n){throw this.logger.error(`Error removing local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),n}}async clearLocal(){var e;try{if(typeof localStorage<"u")localStorage.clear(),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),this._notifyChangeListeners({});else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings){const t=await this.getAllKeys(),n={};for(const s of t){const i=await this.getLocalItem(s);Office.context.roamingSettings.remove(s),n[s]={oldValue:i,newValue:void 0}}await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var u;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Cleared all roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),s()):i(new Error(((u=c.error)==null?void 0:u.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners(n)}else throw new Error("No storage mechanism available")}catch(t){throw this.logger.error("Error clearing local storage",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),t}}async getAllKeys(){var e;try{if(typeof localStorage<"u"){const t=Object.keys(localStorage);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),t}else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings)return this.logger.warn("getAllKeys not fully supported with Office roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[];return[]}catch(t){return this.logger.error("Error getting all keys",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}_notifyChangeListeners(e){this._changeListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in storage change callback",n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"_notifyChangeListeners"})}})}}class qU{constructor(e){H(this,"logger");H(this,"threadListeners",new Set);H(this,"currentThread",null);H(this,"lastKnownThreadId");H(this,"debounceTimer",null);this.logger=e,this.initializeOutlookListeners()}initializeOutlookListeners(){var e,t,n,s;(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.debouncedHandleItemChanged.bind(this)),(s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item&&setTimeout(()=>this.handleItemChanged(),100)}debouncedHandleItemChanged(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.handleItemChanged(),this.debounceTimer=null},50)}async handleItemChanged(){var e,t;try{const n=await this.getCurrentThread(),s=n==null?void 0:n.threadId,i=s!==((e=this.currentThread)==null?void 0:e.threadId);if(n&&this.currentThread&&!i){const c=JSON.stringify(this.currentThread.participants.sort()),u=JSON.stringify(n.participants.sort());if(c===u)return}i||!this.currentThread&&n?(this.logger.info("Thread changed or initialized",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",oldThreadId:(t=this.currentThread)==null?void 0:t.threadId,newThreadId:s}),this.currentThread=n,this.lastKnownThreadId=s,this.notifyThreadListeners(n)):n&&this.currentThread?this.hasThreadContentChanged(this.currentThread,n)?(this.logger.info("Thread content updated",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",threadId:s}),this.currentThread=n,this.notifyThreadListeners(n)):this.currentThread=n:this.logger.info("No meaningful thread change detected",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",hasNewThread:!!n,hasCurrentThread:!!this.currentThread})}catch(n){this.logger.error("Error handling item change",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged"})}}hasThreadContentChanged(e,t){var i,c;if(e.subject!==t.subject)return!0;if(e.messages.length!==t.messages.length)return t.messages.length>e.messages.length;const n=new Set(e.participants),s=new Set(t.participants);if(n.size!==s.size)return!0;for(const u of n)if(!s.has(u))return!0;for(let u=0;u<Math.min(e.messages.length,t.messages.length);u++){const p=e.messages[u],m=t.messages[u],g=((i=p.body)==null?void 0:i.trim())||"",x=((c=m.body)==null?void 0:c.trim())||"";if(g!==x&&g.length>0&&x.length>0||p.from!==m.from)return!0}return!1}shouldPreserveThreadHistory(e){var t,n,s;return!!(this.currentThread&&this.currentThread.threadId===e&&this.currentThread.messages.length>0&&((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)&&(Office.context.mailbox.item.itemType==="message"||(s=Office.context.mailbox.item.itemClass)!=null&&s.includes("IPM.Note")))}async getCurrentThread(){return new Promise(e=>{var t,n;if(!((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)){this.logger.info("No Office context or mailbox item available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null);return}try{const s=Office.context.mailbox.item;this.logger.info("Getting current thread",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread",itemType:s.itemType,itemClass:s.itemClass,subject:s.subject,hasConversationId:!!s.conversationId,hasGetConversationIndexAsync:!!s.getConversationIndexAsync,hasCurrentThread:!!this.currentThread,lastKnownThreadId:this.lastKnownThreadId}),this.getThreadId(s).then(i=>{if(i)return this.getItemDetails(s,i);this.logger.warn("Could not determine thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}).then(i=>e(i||null)).catch(i=>{this.logger.error("Error getting current thread",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)})}catch(s){this.logger.error("Error in getCurrentThread",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}})}normalizeSubject(e){return e?e.replace(/^((re|fw|fwd):\s*)+/i,"").trim():""}async getThreadId(e){return new Promise(t=>{if(e.conversationId){const n=e.conversationId;this.logger.info("Using conversationId as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationId:n}),this.lastKnownThreadId=n,t(n);return}if(e.getConversationIndexAsync)e.getConversationIndexAsync(n=>{if(n.status===Office.AsyncResultStatus.Succeeded&&n.value)this.logger.info("Using conversation index as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationIndex:n.value}),this.lastKnownThreadId=n.value,t(n.value);else{this.logger.info("getConversationIndexAsync failed, trying other methods",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",error:n.error});const s=e.subject,i=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",c=this.normalizeSubject(s);if(s&&this.currentThread&&i===c&&this.lastKnownThreadId){this.logger.info("Using cached thread ID based on normalized subject match (async failed)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:s,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId);return}const u=e.itemId||this.lastKnownThreadId||"unknown";t(u)}});else{const n=e.subject,s=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",i=this.normalizeSubject(n);if(n&&this.currentThread&&s===i&&this.lastKnownThreadId)this.logger.info("Using cached thread ID based on normalized subject match (no async method)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:n,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId||null);else{const c=e.itemId||this.lastKnownThreadId||"unknown";this.logger.info("Using final fallback ID as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",fallbackId:c}),t(c)}}})}async getCurrentThreadId(){return new Promise(e=>{var n,s;if(!((s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item)){e(this.lastKnownThreadId||null);return}const t=Office.context.mailbox.item;this.getThreadId(t).then(e).catch(()=>e(this.lastKnownThreadId||null))})}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}destroy(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.threadListeners.clear()}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}async getItemDetails(e,t){return new Promise(async n=>{var s;try{const i=e;let c="No Subject";if(typeof i.subject=="string")c=i.subject||"No Subject";else if(i.subject&&typeof i.subject.getAsync=="function")try{c=await new Promise((g,x)=>{i.subject.getAsync(b=>{b.status===Office.AsyncResultStatus.Succeeded?g(b.value):x(b.error)})})||"No Subject"}catch{}let u=this.extractParticipants(i);try{const m=await this.extractAsyncParticipants(i),g=new Set([...u,...m]);u=Array.from(g)}catch(m){this.logger.warn("Could not extract async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",error:m})}const p={from:this.getFromAddress(i),timestamp:this.getTimestamp(i),subject:c,body:"",html:""};if(i.body&&i.body.getAsync)i.body.getAsync(Office.CoercionType.Html,m=>{var x;m.status===Office.AsyncResultStatus.Succeeded&&(p.html=m.value,p.body=this.stripHtml(m.value));const g=this.shouldPreserveThreadHistory(t)?[...((x=this.currentThread)==null?void 0:x.messages)||[],p]:[p];n({threadId:t,messages:g,subject:c,participants:u})});else{const m=this.shouldPreserveThreadHistory(t)?[...((s=this.currentThread)==null?void 0:s.messages)||[],p]:[p];n({threadId:t,messages:m,subject:c,participants:u})}}catch(i){this.logger.error("Error getting item details",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",threadId:t}),n(null)}})}extractParticipants(e){const t=new Set;try{const n=this.getFromAddress(e);n&&n!=="Unknown"&&t.add(n),e.sender&&e.sender.emailAddress&&t.add(e.sender.emailAddress),e.to&&Array.isArray(e.to)&&e.to.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.cc&&Array.isArray(e.cc)&&e.cc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.bcc&&Array.isArray(e.bcc)&&e.bcc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)})}catch(n){this.logger.warn("Error extracting participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractParticipants",error:n})}return Array.from(t)}async extractAsyncParticipants(e){const t=new Set;try{const n=[];e.to&&typeof e.to.getAsync=="function"&&n.push(this.getRecipientsAsync(e.to,"to")),e.cc&&typeof e.cc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.cc,"cc")),e.bcc&&typeof e.bcc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.bcc,"bcc")),(await Promise.allSettled(n)).forEach(i=>{i.status==="fulfilled"&&i.value.forEach(c=>t.add(c))})}catch(n){this.logger.warn("Error extracting async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractAsyncParticipants",error:n})}return Array.from(t)}getRecipientsAsync(e,t){return new Promise(n=>{e.getAsync(s=>{if(s.status===Office.AsyncResultStatus.Succeeded){const i=s.value.map(c=>c.emailAddress).filter(c=>c);n(i)}else this.logger.warn(`Error getting ${t} recipients`,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getRecipientsAsync",error:s.error}),n([])})})}getFromAddress(e){try{return e.from&&e.from.emailAddress?e.from.emailAddress:e.sender&&e.sender.emailAddress?e.sender.emailAddress:"Unknown"}catch(t){return this.logger.warn("Error getting from address",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getFromAddress",error:t}),"Unknown"}}getCurrentUserEmail(){var e,t,n;try{if((n=(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)==null?void 0:t.userProfile)!=null&&n.emailAddress){const s=Office.context.mailbox.userProfile.emailAddress;return this.logger.info("Retrieved current user email from Outlook API",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail",userEmail:s}),s}return this.logger.warn("userProfile.emailAddress not available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}catch(s){return this.logger.error("Error getting current user email",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}}getTimestamp(e){try{return e.dateTimeCreated?e.dateTimeCreated.toISOString():e.dateTimeModified?e.dateTimeModified.toISOString():new Date().toISOString()}catch(t){return this.logger.warn("Error getting timestamp",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getTimestamp",error:t}),new Date().toISOString()}}stripHtml(e){try{return e.replace(/<[^>]*>/g,"").trim()}catch(t){return this.logger.warn("Error stripping HTML",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"stripHtml",error:t}),e}}}const KU=async(r,e,t)=>({operation:nd(e).operation,region:await zi(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function YU(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-identity",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function vv(r){return{schemeId:"smithy.api#noAuth"}}const JU=r=>{const e=[];switch(r.operation){case"GetCredentialsForIdentity":{e.push(vv());break}case"GetId":{e.push(vv());break}case"GetOpenIdToken":{e.push(vv());break}case"UnlinkIdentity":{e.push(vv());break}default:e.push(YU(r))}return e},XU=r=>{const e=sN(r);return Object.assign(e,{authSchemePreference:zi(r.authSchemePreference??[])})},QU=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-identity"}),ZU="3.981.0",e5={version:ZU},oT="required",Cs="fn",ks="argv",ch="ref",oC=!0,iC="isSet",Tm="booleanEquals",Af="error",Ia="endpoint",bl="tree",V_="PartitionResult",q_="getAttr",Op="stringEquals",aC={[oT]:!1,type:"string"},lC={[oT]:!0,default:!1,type:"boolean"},cC={[ch]:"Endpoint"},iT={[Cs]:Tm,[ks]:[{[ch]:"UseFIPS"},!0]},aT={[Cs]:Tm,[ks]:[{[ch]:"UseDualStack"},!0]},Cn={},tm={[ch]:"Region"},uC={[Cs]:q_,[ks]:[{[ch]:V_},"supportsFIPS"]},lT={[ch]:V_},dC={[Cs]:Tm,[ks]:[!0,{[Cs]:q_,[ks]:[lT,"supportsDualStack"]}]},fC=[iT],hC=[aT],pC=[tm],t5={parameters:{Region:aC,UseDualStack:lC,UseFIPS:lC,Endpoint:aC},rules:[{conditions:[{[Cs]:iC,[ks]:[cC]}],rules:[{conditions:fC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Af},{conditions:hC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Af},{endpoint:{url:cC,properties:Cn,headers:Cn},type:Ia}],type:bl},{conditions:[{[Cs]:iC,[ks]:pC}],rules:[{conditions:[{[Cs]:"aws.partition",[ks]:pC,assign:V_}],rules:[{conditions:[iT,aT],rules:[{conditions:[{[Cs]:Tm,[ks]:[oC,uC]},dC],rules:[{conditions:[{[Cs]:Op,[ks]:[tm,"us-east-1"]}],endpoint:{url:"https://cognito-identity-fips.us-east-1.amazonaws.com",properties:Cn,headers:Cn},type:Ia},{conditions:[{[Cs]:Op,[ks]:[tm,"us-east-2"]}],endpoint:{url:"https://cognito-identity-fips.us-east-2.amazonaws.com",properties:Cn,headers:Cn},type:Ia},{conditions:[{[Cs]:Op,[ks]:[tm,"us-west-1"]}],endpoint:{url:"https://cognito-identity-fips.us-west-1.amazonaws.com",properties:Cn,headers:Cn},type:Ia},{conditions:[{[Cs]:Op,[ks]:[tm,"us-west-2"]}],endpoint:{url:"https://cognito-identity-fips.us-west-2.amazonaws.com",properties:Cn,headers:Cn},type:Ia},{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Cn,headers:Cn},type:Ia}],type:bl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Af}],type:bl},{conditions:fC,rules:[{conditions:[{[Cs]:Tm,[ks]:[uC,oC]}],rules:[{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Cn,headers:Cn},type:Ia}],type:bl},{error:"FIPS is enabled but this partition does not support FIPS",type:Af}],type:bl},{conditions:hC,rules:[{conditions:[dC],rules:[{conditions:[{[Cs]:Op,[ks]:["aws",{[Cs]:q_,[ks]:[lT,"name"]}]}],endpoint:{url:"https://cognito-identity.{Region}.amazonaws.com",properties:Cn,headers:Cn},type:Ia},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Cn,headers:Cn},type:Ia}],type:bl},{error:"DualStack is enabled but this partition does not support DualStack",type:Af}],type:bl},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dnsSuffix}",properties:Cn,headers:Cn},type:Ia}],type:bl}],type:bl},{error:"Invalid Configuration: Missing Region",type:Af}]},r5=t5,n5=new M1({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),s5=(r,e={})=>n5.get(r,()=>K1(r5,{endpointParams:r,logger:e.logger}));th.aws=Db;const o5=r=>({apiVersion:"2014-06-30",base64Decoder:(r==null?void 0:r.base64Decoder)??Mm,base64Encoder:(r==null?void 0:r.base64Encoder)??wm,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??s5,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??JU,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new X1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new O1}],logger:(r==null?void 0:r.logger)??new Fb,protocol:(r==null?void 0:r.protocol)??dN,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentity",xmlNamespace:"http://cognito-identity.amazonaws.com/doc/2014-06-30/",version:"2014-06-30",serviceTarget:"AWSCognitoIdentityService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity",urlParser:(r==null?void 0:r.urlParser)??Em,utf8Decoder:(r==null?void 0:r.utf8Decoder)??Qu,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Oy}),i5=r=>{const e=PN(r),t=()=>e().then(lN),n=o5(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??oN,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??AN({serviceId:n.serviceId,clientVersion:e5.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Sm,region:(r==null?void 0:r.region)??IN("Region is missing"),requestHandler:Dy.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||bN),sha256:(r==null?void 0:r.sha256)??RN,streamCollector:(r==null?void 0:r.streamCollector)??N1,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(hN)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(pN))}},a5=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},l5=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),c5=(r,e)=>{const t=Object.assign(MN(r),cN(r),x1(r),a5(r));return e.forEach(n=>n.configure(t)),Object.assign(r,$N(t),uN(t),w1(t),l5(t))};class u5 extends iN{constructor(...[t]){const n=i5(t||{});super(n);H(this,"config");this.initConfig=n;const s=QU(n),i=L1(s),c=CN(i),u=gN(c),p=u,m=wN(p),g=XU(m),x=c5(g,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(A1(this.config)),this.middlewareStack.use(fN(this.config)),this.middlewareStack.use(kN(this.config)),this.middlewareStack.use(vN(this.config)),this.middlewareStack.use(b1(this.config)),this.middlewareStack.use(_1(this.config)),this.middlewareStack.use(E1(this.config)),this.middlewareStack.use(S1(this.config,{httpAuthSchemeParametersProvider:KU,identityProviderConfigProvider:async b=>new j1({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(C1(this.config))}destroy(){super.destroy()}}var cT=(r=>(r.Succeeded="succeeded",r.Failed="failed",r))(cT||{}),Mw=(r=>(r.DialogMessageReceived="dialogMessageReceived",r.DialogEventReceived="dialogEventReceived",r))(Mw||{});class uT{constructor(e){H(this,"logger");this.logger=e}async launchWebAuthFlow(e){return this.logger.warn("launchWebAuthFlow using basic window.open approach in Outlook context",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),this.initiateOAuth(e.url,"")}async initiateOAuth(e,t){var n;try{const s=window.Office;return(n=s==null?void 0:s.ui)!=null&&n.displayDialogAsync?(this.logger.info("Using Office.ui.displayDialogAsync for OAuth",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{s.ui.displayDialogAsync(e,{height:60,width:60},u=>{var p;if(u.status===cT.Succeeded){const m=u.value;m.addEventHandler(Mw.DialogMessageReceived,g=>{m.close(),i(g.message||"")}),m.addEventHandler(Mw.DialogEventReceived,g=>{m.close(),g.error===12006?c(new Error("Authentication was cancelled by user")):c(new Error(`Authentication dialog failed with error: ${g.error}`))})}else c(new Error(`Failed to open authentication dialog: ${((p=u.error)==null?void 0:p.message)||"Unknown error"}`))})})):(this.logger.warn("Office.ui not available, using window.open fallback",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{const u=window.open(e,"_blank","width=500,height=600,scrollbars=yes,resizable=yes");if(!u){c(new Error("Failed to open authentication window. Please check popup blockers."));return}const p=setInterval(()=>{try{if(u.closed){clearInterval(p),c(new Error("Authentication was cancelled by user"));return}try{const m=u.location.href;if(m&&m.includes("access_token=")){clearInterval(p),u.close(),i(m);return}}catch{}}catch{clearInterval(p),u==null||u.close(),c(new Error("Error during authentication process"))}},1e3);setTimeout(()=>{clearInterval(p),u.closed||u.close(),c(new Error("Authentication timeout - please try again"))},3e5)}))}catch(s){throw this.logger.error("Error initiating OAuth",s,{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),s}}}const d5=()=>{const r=window.location.hostname,e=window.location.pathname;return r==="localhost"?{environment:"local",DIALOG_URL:"https://localhost:5174/auth-dialog-pkce.html"}:e.includes("FileServer_Staging")?{environment:"staging",DIALOG_URL:"https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:e.includes("FileServer_Prod")?{environment:"prod",DIALOG_URL:"https://candle-ai.github.io/FileServer_Prod/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:{environment:"dev",DIALOG_URL:"https://candle-ai.github.io/FileServer/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}};async function f5(){const r=d5();return new Promise((e,t)=>{let n=!1;console.log(`Starting PKCE authentication in ${r.environment} environment with dialog:`,r.DIALOG_URL),Office.context.ui.displayDialogAsync(r.DIALOG_URL,{height:70,width:50,promptBeforeOpen:!1},s=>{if(s.status!==Office.AsyncResultStatus.Succeeded)return console.error("Failed to open auth dialog:",s.error),t(new Error(`Failed to open authentication dialog: ${s.error.message}`));const i=s.value;console.log("Auth dialog opened successfully"),i.addEventHandler(Office.EventType.DialogMessageReceived,c=>{try{if(!n&&"message"in c){let u;if(typeof c.message=="string")u=JSON.parse(c.message);else if(typeof c.message=="object")u=c.message;else{console.log("Unknown message type:",typeof c.message,c.message);return}if(console.log(`Received message from auth dialog (${r.environment}):`,u.type),u.type==="AUTH_SUCCESS"){if(console.log(`Authentication successful in ${r.environment} environment`),n=!0,i.close(),!u.tokens||!u.tokens.access_token){t(new Error("Invalid token response from authentication dialog"));return}const p={access_token:u.tokens.access_token,refresh_token:u.tokens.refresh_token,id_token:u.tokens.id_token,expires_in:u.tokens.expires_in,token_type:u.tokens.token_type,fetched_at:u.tokens.fetched_at};console.log(`Tokens received successfully in ${r.environment} environment`),e(p)}else u.type==="AUTH_ERROR"&&(console.log(`Authentication error in ${r.environment}:`,u.error),n=!0,i.close(),t(new Error(`Authentication failed: ${u.error}`)))}}catch(u){console.error("Error handling dialog message:",u),n||(n=!0,i.close(),t(new Error("Error processing authentication response")))}}),i.addEventHandler(Office.EventType.DialogEventReceived,c=>{if(console.log("Dialog event received:",c),!n&&"error"in c){const u=c.error;u===12006?(console.log("User cancelled authentication"),n=!0,t(new Error("Authentication cancelled by user"))):u===12005?console.log("Dialog navigation occurred (normal during OAuth)"):(console.error("Dialog error:",u),n=!0,t(new Error(`Authentication dialog error: ${u}`)))}}),setTimeout(()=>{n||(console.log(`Authentication timeout in ${r.environment} environment`),n=!0,i.close(),t(new Error("Authentication timeout - please try again")))},300*1e3)})})}const mC="us-east-1";class h5{constructor(e,t){H(this,"logger");H(this,"authListeners",new Set);H(this,"cachedToken",null);H(this,"cognitoClient");H(this,"identityProvider");H(this,"storageProvider");this.logger=e,this.storageProvider=t,this.cognitoClient=new u5({region:mC}),this.identityProvider=new uT(e)}async login(){try{const e=await f5();return this.logger.info("Token received",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login",token:e}),this.cachedToken=e,await this.saveToken(e),this.notifyAuthListeners(!0),e}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){this.cachedToken=null,await this.deleteToken(),this.notifyAuthListeners(!1)}async getToken(){if(this.logger.debug("Getting token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken",hasCachedToken:!!this.cachedToken}),this.cachedToken)return this.logger.debug("Returning cached token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken;const e=await this.loadTokenFromStorage();return e?(this.logger.debug("Token loaded from storage, caching it",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken=e,e):(this.logger.debug("No token found in cache or storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),null)}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}async isAuthenticated(){console.log(" [OutlookAuthProvider] Checking authentication status"),this.logger.info("Checking authentication status",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"});const e=await this.getToken();if(!e)return console.log(" [OutlookAuthProvider] No token found"),this.logger.info("No token found - user is not authenticated",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(console.log(" [OutlookAuthProvider] Token valid?",t),!t){console.log(" [OutlookAuthProvider] Token is expired or expiring soon, attempting refresh"),this.logger.info("Token is expired or expiring soon, attempting refresh",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",tokenExpiry:e.expires_in,fetchedAt:e.fetched_at});try{return console.log(" [OutlookAuthProvider] Calling refreshToken()..."),await this.refreshToken(e),console.log(" [OutlookAuthProvider] Token refreshed successfully!"),this.logger.info("Token refreshed successfully during authentication check",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(n){return console.error(" [OutlookAuthProvider] Token refresh failed:",n),this.logger.error("Token refresh failed during authentication check",n,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}return this.logger.info("Authentication status checked - token is valid",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",hasToken:!!e,isValid:t,tokenExpiry:e.expires_in,fetchedAt:e.fetched_at}),!0}async validateToken(e){const t=await this.getToken();return t?this.isTokenValid(t):!1}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=Math.floor(Date.now()),n=e.fetched_at||0,s=n+e.expires_in*1e3,i=s-t<3e5;return this.logger.debug("Token validation",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isTokenValid",currentTime:t,fetchedAt:n,expiresIn:e.expires_in,tokenExpiry:s,isExpired:i,timeUntilExpiry:s-t}),!i}async refreshToken(e){console.log(" [OutlookAuthProvider.refreshToken] Starting token refresh using REFRESH_TOKEN_AUTH"),this.logger.info("Refreshing token using refresh_token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});try{const t=new $b({region:mC}),n=new z_({ClientId:lh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:e.refresh_token}});console.log(" [OutlookAuthProvider.refreshToken] Sending refresh request to AWS Cognito"),this.logger.debug("Sending refresh token request to Cognito",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});const s=await t.send(n);console.log(" [OutlookAuthProvider.refreshToken] Received response from Cognito");const i=s.AuthenticationResult;if(!i)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:c,AccessToken:u,RefreshToken:p,ExpiresIn:m,TokenType:g}=i;if(!c||!u||!m||!g)throw new Error("Missing required fields in AuthenticationResult.");const x={id_token:c,access_token:u,refresh_token:p||e.refresh_token,expires_in:m,token_type:g,fetched_at:Math.floor(Date.now())};return this.logger.info("Token refreshed successfully",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken",newExpiresIn:m}),this.cachedToken=x,await this.saveToken(x),this.notifyAuthListeners(!0),x}catch(t){return this.logger.error("Token refresh failed, falling back to full re-login",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"}),this.login()}}async saveToken(e){await this.storageProvider.setLocalItem("token",e)}async loadTokenFromStorage(){this.logger.debug("Loading token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"});try{const e=await this.storageProvider.getLocalItem("token");if(!e)return this.logger.debug("No token found in storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"}),null;const t=e;return this.logger.debug("Token successfully loaded from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",hasToken:!!t,fetchedAt:t==null?void 0:t.fetched_at,expiresIn:t==null?void 0:t.expires_in}),t}catch(e){return this.logger.warn("Failed to load token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",error:e}),null}}async deleteToken(){await this.storageProvider.removeLocalItem("token")}parseAccessTokenFromOAuthResponse(e){try{let t=e;e.includes("#")&&(t=e.split("#")[1]);const n=new URLSearchParams(t),s=n.get("access_token");if(!s)return this.logger.error("No access_token found in OAuth response",new Error("Missing access token"),{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e,fragment:t}),null;const i=n.get("error");if(i){const c=n.get("error_description")||"Unknown OAuth error";throw new Error(`OAuth error: ${i} - ${c}`)}return s}catch(t){return this.logger.error("Failed to parse OAuth response",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e}),null}}}class p5{constructor(e){H(this,"logger");this.logger=e}async sendMessage(e){return this.logger.debug("Sending message in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),Promise.resolve(e)}onMessage(e){this.logger.debug("Registering message callback in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"onMessage"})}removeMessageListener(e){this.logger.debug("Removing message listener in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"removeMessageListener"})}async sendOfficeNotification(e){try{typeof Office<"u"&&Office.context&&Office.context.ui&&Office.context.ui.displayDialogAsync(`data:text/html,<html><body><p>${e}</p></body></html>`,{height:20,width:40},t=>{t.status===Office.AsyncResultStatus.Succeeded&&setTimeout(()=>t.value.close(),3e3)})}catch(t){this.logger.error("Error showing Office notification",t,{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendOfficeNotification"})}}}class m5{constructor(e){H(this,"logger");H(this,"eventListeners",new Map);H(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Outlook platform already initialized",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),await this.waitForOfficeReady(),this.setupOutlookEventListeners();try{const e=JSON.stringify(QN);localStorage.setItem("CONFIG_VERIFICATION",e),this.logger.info(`[Debug] Saved CONFIG_VERIFICATION='${e}' to localStorage.`,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){this.logger.warn("[Debug] Could not save CONFIG_VERIFICATION to localStorage.",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}this.isInitialized=!0,this.logger.info("Outlook platform initialized successfully",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Outlook platform cleanup completed",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){this.logger.debug("Window close requested (no-op for Outlook)",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"closeWindow"})}onPlatformEvent(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}async waitForOfficeReady(){return new Promise(e=>{typeof Office<"u"&&Office.onReady?Office.onReady(()=>{e()}):e()})}setupOutlookEventListeners(){var e;typeof Office<"u"&&Office.context&&(e=Office.context.mailbox)!=null&&e.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.handleItemChanged.bind(this),t=>{t.status===Office.AsyncResultStatus.Failed&&this.logger.error("Failed to add item changed handler",t.error,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"setupOutlookEventListeners"})})}handleItemChanged(){this.emitPlatformEvent("itemChanged")}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}}class g5{constructor(e){H(this,"logger");this.logger=e}getResourceURL(e){return this.logger.debug("getResourceURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getResourceURL",path:e}),e.includes("options.html")?Vf:""}async getCurrentTab(){return this.logger.debug("getCurrentTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getCurrentTab"}),{id:1,windowId:1,index:0,url:window.location.href,title:document.title||"Outlook Add-in",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async createTab(e,t){return this.logger.debug("createTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"createTab",url:e}),window.open(e,"_blank"),{id:Date.now(),windowId:1,index:0,url:e,title:"New Tab",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async updateTab(e,t){this.logger.debug("updateTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"updateTab"})}async closeTab(e){this.logger.debug("closeTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"closeTab"})}onTabUpdated(e){this.logger.debug("onTabUpdated called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"onTabUpdated"})}removeTabUpdateListener(e){this.logger.debug("removeTabUpdateListener called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"removeTabUpdateListener"})}async openURL(e,t="_blank"){this.logger.debug("openURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openURL",url:e,target:t}),window.open(e,t)}async openOptionsPage(){this.logger.debug("openOptionsPage called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openOptionsPage"});const e=await Ow(this.logger);let t=Vf;e!=null&&e.id_token&&(t+=`?token=${e.id_token}`),window.open(t,"_blank")}}const Tx=32*1024;class v5{constructor(e){H(this,"logger");this.logger=e}truncateHtmlForReplyForm(e){const n=new TextEncoder().encode(e);if(n.length<=Tx)return e;this.logger.warn("HTML content exceeds 32 KB limit for reply form, truncating",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"truncateHtmlForReplyForm",originalSize:n.length,maxSize:Tx});let i=new TextDecoder().decode(n.slice(0,Tx-100));const c=Math.max(i.lastIndexOf("</p>"),i.lastIndexOf("</div>"),i.lastIndexOf("</li>"),i.lastIndexOf("<br>"));return c>i.length/2&&(i=i.substring(0,c+(i.includes("</p>")?4:i.includes("</div>")?6:i.includes("</li>")?5:4))),i+='<p style="color: gray; font-style: italic;">[Content truncated due to size limit]</p>',i}detectItemMode(){var e,t;try{if(!((t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.item))return"unknown";const n=Office.context.mailbox.item;if(!n.itemId)return this.logger.debug("Detected compose mode (no itemId)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose";const s=n.to;return s&&typeof s.setAsync=="function"?(this.logger.debug("Detected compose mode (to.setAsync exists)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose"):(this.logger.debug("Detected read mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"read")}catch(n){return this.logger.warn("Error detecting item mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode",error:n}),"unknown"}}async executeScript(e){throw this.logger.warn("Script execution not implemented for Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"executeScript"}),new Error("Script execution not available in Outlook context")}async injectScript(e){this.logger.warn("Script injection not applicable in Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"injectScript"})}async insertContentIntoComposeBox(e){var t;try{const n=zv(e);if(typeof Office<"u"&&Office.context&&Office.context.mailbox){const s=this.detectItemMode();this.logger.debug("Inserting content into compose box",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox",mode:s}),s==="compose"?(t=Office.context.mailbox.item)==null||t.body.setSelectedDataAsync(n,{coercionType:Office.CoercionType.Html},i=>{i.status===Office.AsyncResultStatus.Failed?(this.logger.error("Failed to insert content using setSelectedDataAsync, falling back to reply-all",i.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),this.replyAllWithContent(e)):this.logger.info("Successfully inserted content at cursor position",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}):(this.logger.info("In read mode - creating reply-all with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),await this.replyAllWithContent(e))}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}catch(n){throw this.logger.error("Error inserting content into compose box",n,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),n}}async replyWithContent(e){try{const t=zv(e),n=this.truncateHtmlForReplyForm(t);if(typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyFormAsync=="function")return new Promise((i,c)=>{s.displayReplyFormAsync(n,u=>{u.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),i()):(this.logger.error("Failed to display reply form (async)",u.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),c(u.error))})});s.displayReplyForm(n),this.logger.info("Successfully displayed reply form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}catch(t){throw this.logger.error("Error displaying reply form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),t}}async replyAllWithContent(e){try{const t=zv(e),n=this.truncateHtmlForReplyForm(t);if(this.logger.debug("Attempting to display reply all form",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent",contentLength:n.length,contentPreview:n.substring(0,200)}),typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyAllFormAsync=="function")return new Promise((i,c)=>{s.displayReplyAllFormAsync(n,u=>{u.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply all form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),i()):(this.logger.error("Failed to display reply all form (async)",u.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),c(u.error))})});s.displayReplyAllForm(n),this.logger.info("Successfully displayed reply all form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}catch(t){throw this.logger.error("Error displaying reply all form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),t}}}const gC={ERROR:1,WARN:2,INFO:3,DEBUG:4};class y5{constructor(e){H(this,"context");H(this,"minLevel");this.context=e||"unknown",this.minLevel="WARN"}shouldLog(e){return gC[e]<=gC[this.minLevel]}formatMessage(e,t,n){const s=(n==null?void 0:n.sourceFile)||"unknown",i=n==null?void 0:n.sourceFunction;return`[${e}] [Outlook:${this.context}] [${s}${i?` (${i})`:""}]: ${t}`}async debug(e,t){if(!this.shouldLog("DEBUG"))return;const n=this.formatMessage("DEBUG",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},u=[n];Object.keys(c).length>0&&u.push(c),console.debug(...u)}async info(e,t){if(!this.shouldLog("INFO"))return;const n=this.formatMessage("INFO",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},u=[n];Object.keys(c).length>0&&u.push(c),console.info(...u)}async warn(e,t){if(!this.shouldLog("WARN"))return;const n=this.formatMessage("WARN",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},u=[n];Object.keys(c).length>0&&u.push(c),console.warn(...u)}async error(e,t,n){if(!this.shouldLog("ERROR"))return;const s=this.formatMessage("ERROR",e,n),{sourceFile:i,sourceFunction:c,...u}=n||{},p=[s];t&&p.push(t),Object.keys(u).length>0&&p.push(u),console.error(...p)}setMinLevel(e){this.minLevel=e}getMinLevel(){return this.minLevel}getUnderlyingLogger(){return{context:this.context,minLevel:this.minLevel,writeLog:async(e,t,n,s)=>{switch(e){case"DEBUG":return this.debug(t,n);case"INFO":return this.info(t,n);case"WARN":return this.warn(t,n);case"ERROR":return this.error(t,s,n)}},_triggerCleanupCheck:()=>{},debug:(e,t)=>this.debug(e,t),info:(e,t)=>this.info(e,t),warn:(e,t)=>this.warn(e,t),error:(e,t,n)=>this.error(e,t,n)}}}function x5(){const r=new y5("background"),e=new VU(r);return{storage:e,data:new qU(r),auth:new h5(r,e),messaging:new p5(r),lifecycle:new m5(r),tabs:new g5(r),contentScript:new v5(r),identity:new uT(r),logging:r}}const _s=class _s{static async createServices(e){const t=e||_s.detectPlatform();if(_s.instance&&_s.currentPlatform===t)return _s.instance;let n;if(t==="chrome"){const s=_s.detectExecutionContext();n=WU(s)}else if(t==="outlook")n=x5();else throw new Error(`Unsupported platform: ${t}`);return await n.lifecycle.initialize(),_s.instance=n,_s.currentPlatform=t,n}static detectPlatform(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id)return"chrome";if(typeof Office<"u"&&Office.context)return"outlook";throw new Error("Unable to detect platform. Neither Chrome nor Office APIs available.")}static detectExecutionContext(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id){if(typeof document>"u")return"background";try{if(typeof window<"u"&&window.location){const e=window.location.href;return e.includes("options.html")?"options":e.includes("popup.html")?"popup":"content"}}catch{return"content"}return"content"}return"unknown"}static getCurrentPlatform(){return _s.currentPlatform}static async resetInstance(){_s.instance&&(await _s.instance.lifecycle.cleanup(),_s.instance=null,_s.currentPlatform=null)}};H(_s,"instance",null),H(_s,"currentPlatform",null);let On=_s;const K_=w.createContext({platform:"unassigned",services:null,isLoading:!0,error:null});function w5({children:r}){const[e,t]=w.useState("unassigned"),[n,s]=w.useState(null),[i,c]=w.useState(!0),[u,p]=w.useState(null),m=w.useCallback(async g=>{if(g!=null&&g.lifecycle)try{await g.lifecycle.cleanup()}catch(x){console.error("Error during platform cleanup",x,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"cleanup"})}},[]);return w.useEffect(()=>{let g=null;async function x(){try{console.info("Initializing platform services...",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"});const b=await On.createServices();if(g=b,t(On.getCurrentPlatform()||"unassigned"),On.getCurrentPlatform()==="unassigned")throw new Error("Platform not supported");await b.lifecycle.initialize(),s(b),p(null),console.info("Platform services initialized successfully",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"})}catch(b){const E=b instanceof Error?b.message:"Unknown error occurred";console.error("Failed to initialize platform services",b,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"}),p(E)}finally{c(!1)}}return x(),()=>{g&&m(g)}},[m]),d.jsx(K_.Provider,{value:{platform:e,services:n,isLoading:i,error:u},children:i?d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsx("div",{className:"text-sm text-gray-600",children:"Initializing platform..."})}):u?d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsxs("div",{className:"text-sm text-red-600",children:["Error: ",u]})}):r})}const dT=w.createContext(void 0),Wi=()=>{const r=w.useContext(dT);if(r===void 0)throw console.error("useGmailConnection hook called outside of GmailConnectionProvider"),console.error("Component stack:",new Error().stack),new Error("useGmailConnection must be used within a GmailConnectionProvider. Check that the component using this hook is properly wrapped in the provider hierarchy.");return r},fr="src/lib/utils/cacheUtils.ts",b5=100,_5=1440*60*1e3,E5=100,S5=3600*1e3,C5=100,k5=1440*60*1e3,N5=100,T5=3600*1e3,R5=50,A5=1800*1e3,Lt={EMAIL_SUMMARY:"cache_email_summary_",EMAIL_SUMMARY_INDEX:"cache_email_summary_index",DOCUMENTS:"cache_documents_",DOCUMENTS_INDEX:"cache_documents_index",PROJECT_DOCUMENTS:"cache_project_documents_",PROJECT_DOCUMENTS_INDEX:"cache_project_documents_index",NON_EXISTENT_CLIENT:"cache_non_existent_client_",NON_EXISTENT_CLIENT_INDEX:"cache_non_existent_client_index",CLIENT:"cache_client_",CLIENT_INDEX:"cache_client_index",GENERATED_RESPONSE:"cache_generated_response_",GENERATED_RESPONSE_INDEX:"cache_generated_response_index"},I5=30*1e3,Rm=new Map;function P5(r){const e=r.toLowerCase(),t=Rm.get(e);return t?Date.now()-t.timestamp>I5?(Rm.delete(e),{inCache:!1}):{inCache:!0,errorType:t.errorType}:{inCache:!1}}function vC(r,e){const t=r.toLowerCase();Rm.set(t,{timestamp:Date.now(),errorType:e})}function fT(r){const e=r.toLowerCase();Rm.delete(e)}function F5(){Rm.clear()}async function Rs(r){try{return(await On.createServices()).storage}catch(e){return r.warn("Platform detection failed, storage unavailable",{sourceFile:fr,error:e}),null}}async function Hm(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[];if(i.length>=n){i.sort((u,p)=>u.timestamp-p.timestamp);const c=i.splice(0,i.length-n+1);for(const u of c)await r.removeLocalItem(u.key);await r.setLocalItem(e,i)}}catch(i){s.warn("Error managing cache size",{sourceFile:fr,error:i})}}async function Bm(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[],c=i.findIndex(u=>u.key===t);c!==-1&&i.splice(c,1),i.push({key:t,timestamp:n}),await r.setLocalItem(e,i)}catch(i){s.warn("Error updating cache index",{sourceFile:fr,error:i})}}async function hT(r){await Promise.all([D5(r),L5(r),U5(r),vT(r),G5(r)])}async function j5(r,e,t,n){try{const s=await Rs(n);if(!s)return;const i=`${Lt.EMAIL_SUMMARY}${r}`,c=Date.now();await Hm(s,Lt.EMAIL_SUMMARY_INDEX,Lt.EMAIL_SUMMARY,b5,n);const u={summary:e,importantDetails:t,timestamp:c};await s.setLocalItem(i,u),await Bm(s,Lt.EMAIL_SUMMARY_INDEX,i,c,n),n.debug("Added to summary cache",{sourceFile:fr,functionName:"addToSummaryCache",threadId:r})}catch(s){n.warn("Error adding to summary cache",{sourceFile:fr,functionName:"addToSummaryCache",threadId:r,error:s})}}async function O5(r,e){try{const t=await Rs(e);if(!t)return null;const n=`${Lt.EMAIL_SUMMARY}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>_5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from summary cache",{sourceFile:fr,functionName:"getFromSummaryCache",threadId:r,error:t}),null}}async function D5(r){try{const e=await Rs(r);if(!e)return;const t=await e.getLocalItem(Lt.EMAIL_SUMMARY_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Lt.EMAIL_SUMMARY_INDEX),r.debug("Summary cache cleared",{sourceFile:fr,functionName:"clearSummaryCache"})}catch(e){r.warn("Error clearing summary cache",{sourceFile:fr,functionName:"clearSummaryCache",error:e})}}async function pT(r,e,t){try{const n=await Rs(t);if(!n)return;const s=`${Lt.PROJECT_DOCUMENTS}${r}`,i=Date.now();await Hm(n,Lt.PROJECT_DOCUMENTS_INDEX,Lt.PROJECT_DOCUMENTS,E5,t);const c={documents:e,timestamp:i};await n.setLocalItem(s,c),await Bm(n,Lt.PROJECT_DOCUMENTS_INDEX,s,i,t),t.debug("Added to project document cache",{sourceFile:fr,functionName:"addToProjectDocumentCache",projectId:r})}catch(n){t.warn("Error adding to project document cache",{sourceFile:fr,functionName:"addToProjectDocumentCache",projectId:r,error:n})}}async function mT(r,e){try{const t=await Rs(e);if(!t)return null;e.debug("Getting documents from project document cache",{sourceFile:fr,functionName:"getFromProjectDocumentCache",projectId:r});const n=`${Lt.PROJECT_DOCUMENTS}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>S5?(await t.removeLocalItem(n),null):s.documents:null}catch(t){return e.warn("Error getting from project document cache",{sourceFile:fr,functionName:"getFromProjectDocumentCache",projectId:r,error:t}),null}}async function L5(r){try{const e=await Rs(r);if(!e)return;const t=await e.getLocalItem(Lt.DOCUMENTS_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Lt.DOCUMENTS_INDEX),r.debug("Document cache cleared",{sourceFile:fr,functionName:"clearDocumentCache"})}catch(e){r.warn("Error clearing document cache",{sourceFile:fr,functionName:"clearDocumentCache",error:e})}}async function M5(r,e){try{const t=await Rs(e);if(!t)return;const n=r.toLowerCase(),s=`${Lt.NON_EXISTENT_CLIENT}${n}`,i=Date.now();await Hm(t,Lt.NON_EXISTENT_CLIENT_INDEX,Lt.NON_EXISTENT_CLIENT,C5,e),await t.setLocalItem(s,i),await Bm(t,Lt.NON_EXISTENT_CLIENT_INDEX,s,i,e),e.debug("Added to non-existent client cache",{sourceFile:fr,functionName:"addToNonExistentClientCache",email:n})}catch(t){e.warn("Error adding to non-existent client cache",{sourceFile:fr,functionName:"addToNonExistentClientCache",email:r,error:t})}}async function $5(r,e){try{const t=await Rs(e);if(!t)return!1;const n=r.toLowerCase(),s=`${Lt.NON_EXISTENT_CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i>k5?(await t.removeLocalItem(s),!1):!0:!1}catch(t){return e.warn("Error checking non-existent client cache",{sourceFile:fr,functionName:"isInNonExistentClientCache",email:r,error:t}),!1}}async function U5(r){try{const e=await Rs(r);if(!e)return;const t=await e.getLocalItem(Lt.NON_EXISTENT_CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Lt.NON_EXISTENT_CLIENT_INDEX),r.debug("Non-existent client cache cleared",{sourceFile:fr,functionName:"clearNonExistentClientCache"})}catch(e){r.warn("Error clearing non-existent client cache",{sourceFile:fr,functionName:"clearNonExistentClientCache",error:e})}}async function z5(r,e,t){try{const n=await Rs(t);if(!n)return;const s=r.toLowerCase(),i=`${Lt.CLIENT}${s}`,c=Date.now();await Hm(n,Lt.CLIENT_INDEX,Lt.CLIENT,N5,t);const u={data:e,timestamp:c};await n.setLocalItem(i,u),await Bm(n,Lt.CLIENT_INDEX,i,c,t),t.debug("Added to client cache",{sourceFile:fr,functionName:"addToClientCache",clientEmail:s})}catch(n){t.warn("Error adding to client cache",{sourceFile:fr,functionName:"addToClientCache",clientEmail:r,error:n})}}async function gT(r,e){try{const t=await Rs(e);if(!t)return null;const n=r.toLowerCase();e.debug("Getting client info from client cache",{sourceFile:fr,functionName:"getFromClientCache",clientEmail:n});const s=`${Lt.CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i.timestamp>T5?(await t.removeLocalItem(s),null):i.data:null}catch(t){return e.warn("Error getting from client cache",{sourceFile:fr,functionName:"getFromClientCache",clientEmail:r,error:t}),null}}async function vT(r){try{const e=await Rs(r);if(!e)return;const t=await e.getLocalItem(Lt.CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Lt.CLIENT_INDEX),r.debug("Client cache cleared",{sourceFile:fr,functionName:"clearClientCache"})}catch(e){r.warn("Error clearing client cache",{sourceFile:fr,functionName:"clearClientCache",error:e})}}async function H5(r,e){try{const t=await Rs(e);if(!t)return;const n=r.toLowerCase();fT(n);const s=`${Lt.CLIENT}${n}`;await t.removeLocalItem(s);const i=await t.getLocalItem(Lt.CLIENT_INDEX)||[],c=i.filter(E=>E.key!==s);c.length!==i.length&&await t.setLocalItem(Lt.CLIENT_INDEX,c);const u=`${Lt.NON_EXISTENT_CLIENT}${n}`;await t.removeLocalItem(u);const p=await t.getLocalItem(Lt.NON_EXISTENT_CLIENT_INDEX)||[],m=p.filter(E=>E.key!==u);m.length!==p.length&&await t.setLocalItem(Lt.NON_EXISTENT_CLIENT_INDEX,m);const g=`${Lt.DOCUMENTS}${n}`;await t.removeLocalItem(g);const x=await t.getLocalItem(Lt.DOCUMENTS_INDEX)||[],b=x.filter(E=>E.key!==g);b.length!==x.length&&await t.setLocalItem(Lt.DOCUMENTS_INDEX,b),e.debug("Cleared all cached data for client email",{sourceFile:fr,functionName:"clearClientDataForEmail",clientEmail:n})}catch(t){e.warn("Error clearing client data for email",{sourceFile:fr,functionName:"clearClientDataForEmail",clientEmail:r,error:t})}}async function yC(r,e,t,n,s){try{const i=await Rs(s);if(!i)return;const c=`${Lt.GENERATED_RESPONSE}${r}`,u=Date.now();await Hm(i,Lt.GENERATED_RESPONSE_INDEX,Lt.GENERATED_RESPONSE,R5,s);const p={response:e,references:t,cmsData:n,timestamp:u};await i.setLocalItem(c,p),await Bm(i,Lt.GENERATED_RESPONSE_INDEX,c,u,s),s.debug("Added to generated response cache",{sourceFile:fr,functionName:"addToGeneratedResponseCache",cacheKey:r})}catch(i){s.warn("Error adding to generated response cache",{sourceFile:fr,functionName:"addToGeneratedResponseCache",cacheKey:r,error:i})}}async function B5(r,e){try{const t=await Rs(e);if(!t)return null;e.debug("Getting generated response from cache",{sourceFile:fr,functionName:"getFromGeneratedResponseCache",cacheKey:r});const n=`${Lt.GENERATED_RESPONSE}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>A5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from generated response cache",{sourceFile:fr,functionName:"getFromGeneratedResponseCache",cacheKey:r,error:t}),null}}async function G5(r){try{const e=await Rs(r);if(!e)return;const t=await e.getLocalItem(Lt.GENERATED_RESPONSE_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Lt.GENERATED_RESPONSE_INDEX),r.debug("Generated response cache cleared",{sourceFile:fr,functionName:"clearGeneratedResponseCache"})}catch(e){r.warn("Error clearing generated response cache",{sourceFile:fr,functionName:"clearGeneratedResponseCache",error:e})}}function yT(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=yT(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function xT(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=yT(r))&&(n&&(n+=" "),n+=e);return n}const Y_="-",W5=r=>{const e=q5(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:c=>{const u=c.split(Y_);return u[0]===""&&u.length!==1&&u.shift(),wT(u,e)||V5(c)},getConflictingClassGroupIds:(c,u)=>{const p=t[c]||[];return u&&n[c]?[...p,...n[c]]:p}}},wT=(r,e)=>{var c;if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?wT(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(Y_);return(c=e.validators.find(({validator:u})=>u(i)))==null?void 0:c.classGroupId},xC=/^\[(.+)\]$/,V5=r=>{if(xC.test(r)){const e=xC.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},q5=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return Y5(Object.entries(r.classGroups),t).forEach(([i,c])=>{$w(c,n,i,e)}),n},$w=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:wC(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(K5(s)){$w(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,c])=>{$w(c,wC(e,i),t,n)})})},wC=(r,e)=>{let t=r;return e.split(Y_).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},K5=r=>r.isThemeGetter,Y5=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,u])=>[e+c,u])):i);return[t,s]}):r,J5=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,c)=>{t.set(i,c),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let c=t.get(i);if(c!==void 0)return c;if((c=n.get(i))!==void 0)return s(i,c),c},set(i,c){t.has(i)?t.set(i,c):s(i,c)}}},bT="!",X5=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,c=u=>{const p=[];let m=0,g=0,x;for(let T=0;T<u.length;T++){let R=u[T];if(m===0){if(R===s&&(n||u.slice(T,T+i)===e)){p.push(u.slice(g,T)),g=T+i;continue}if(R==="/"){x=T;continue}}R==="["?m++:R==="]"&&m--}const b=p.length===0?u:u.substring(g),E=b.startsWith(bT),N=E?b.substring(1):b,S=x&&x>g?x-g:void 0;return{modifiers:p,hasImportantModifier:E,baseClassName:N,maybePostfixModifierPosition:S}};return t?u=>t({className:u,parseClassName:c}):c},Q5=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},Z5=r=>({cache:J5(r.cacheSize),parseClassName:X5(r),...W5(r)}),e6=/\s+/,t6=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],c=r.trim().split(e6);let u="";for(let p=c.length-1;p>=0;p-=1){const m=c[p],{modifiers:g,hasImportantModifier:x,baseClassName:b,maybePostfixModifierPosition:E}=t(m);let N=!!E,S=n(N?b.substring(0,E):b);if(!S){if(!N){u=m+(u.length>0?" "+u:u);continue}if(S=n(b),!S){u=m+(u.length>0?" "+u:u);continue}N=!1}const T=Q5(g).join(":"),R=x?T+bT:T,A=R+S;if(i.includes(A))continue;i.push(A);const j=s(S,N);for(let P=0;P<j.length;++P){const U=j[P];i.push(R+U)}u=m+(u.length>0?" "+u:u)}return u};function r6(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=_T(e))&&(n&&(n+=" "),n+=t);return n}const _T=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=_T(r[n]))&&(t&&(t+=" "),t+=e);return t};function n6(r,...e){let t,n,s,i=c;function c(p){const m=e.reduce((g,x)=>x(g),r());return t=Z5(m),n=t.cache.get,s=t.cache.set,i=u,u(p)}function u(p){const m=n(p);if(m)return m;const g=t6(p,t);return s(p,g),g}return function(){return i(r6.apply(null,arguments))}}const Jr=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},ET=/^\[(?:([a-z-]+):)?(.+)\]$/i,s6=/^\d+\/\d+$/,o6=new Set(["px","full","screen"]),i6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,a6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,l6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,c6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,u6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,_l=r=>qf(r)||o6.has(r)||s6.test(r),Sc=r=>uh(r,"length",y6),qf=r=>!!r&&!Number.isNaN(Number(r)),Rx=r=>uh(r,"number",qf),Dp=r=>!!r&&Number.isInteger(Number(r)),d6=r=>r.endsWith("%")&&qf(r.slice(0,-1)),Wt=r=>ET.test(r),Cc=r=>i6.test(r),f6=new Set(["length","size","percentage"]),h6=r=>uh(r,f6,ST),p6=r=>uh(r,"position",ST),m6=new Set(["image","url"]),g6=r=>uh(r,m6,w6),v6=r=>uh(r,"",x6),Lp=()=>!0,uh=(r,e,t)=>{const n=ET.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},y6=r=>a6.test(r)&&!l6.test(r),ST=()=>!1,x6=r=>c6.test(r),w6=r=>u6.test(r),b6=()=>{const r=Jr("colors"),e=Jr("spacing"),t=Jr("blur"),n=Jr("brightness"),s=Jr("borderColor"),i=Jr("borderRadius"),c=Jr("borderSpacing"),u=Jr("borderWidth"),p=Jr("contrast"),m=Jr("grayscale"),g=Jr("hueRotate"),x=Jr("invert"),b=Jr("gap"),E=Jr("gradientColorStops"),N=Jr("gradientColorStopPositions"),S=Jr("inset"),T=Jr("margin"),R=Jr("opacity"),A=Jr("padding"),j=Jr("saturate"),P=Jr("scale"),U=Jr("sepia"),B=Jr("skew"),$=Jr("space"),Y=Jr("translate"),J=()=>["auto","contain","none"],he=()=>["auto","hidden","clip","visible","scroll"],te=()=>["auto",Wt,e],ue=()=>[Wt,e],we=()=>["",_l,Sc],ie=()=>["auto",qf,Wt],se=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],pe=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],G=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",Wt],K=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>[qf,Wt];return{cacheSize:500,separator:":",theme:{colors:[Lp],spacing:[_l,Sc],blur:["none","",Cc,Wt],brightness:D(),borderColor:[r],borderRadius:["none","","full",Cc,Wt],borderSpacing:ue(),borderWidth:we(),contrast:D(),grayscale:z(),hueRotate:D(),invert:z(),gap:ue(),gradientColorStops:[r],gradientColorStopPositions:[d6,Sc],inset:te(),margin:te(),opacity:D(),padding:ue(),saturate:D(),scale:D(),sepia:z(),skew:D(),space:ue(),translate:ue()},classGroups:{aspect:[{aspect:["auto","square","video",Wt]}],container:["container"],columns:[{columns:[Cc]}],"break-after":[{"break-after":K()}],"break-before":[{"break-before":K()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...se(),Wt]}],overflow:[{overflow:he()}],"overflow-x":[{"overflow-x":he()}],"overflow-y":[{"overflow-y":he()}],overscroll:[{overscroll:J()}],"overscroll-x":[{"overscroll-x":J()}],"overscroll-y":[{"overscroll-y":J()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[S]}],"inset-x":[{"inset-x":[S]}],"inset-y":[{"inset-y":[S]}],start:[{start:[S]}],end:[{end:[S]}],top:[{top:[S]}],right:[{right:[S]}],bottom:[{bottom:[S]}],left:[{left:[S]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Dp,Wt]}],basis:[{basis:te()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Wt]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Dp,Wt]}],"grid-cols":[{"grid-cols":[Lp]}],"col-start-end":[{col:["auto",{span:["full",Dp,Wt]},Wt]}],"col-start":[{"col-start":ie()}],"col-end":[{"col-end":ie()}],"grid-rows":[{"grid-rows":[Lp]}],"row-start-end":[{row:["auto",{span:[Dp,Wt]},Wt]}],"row-start":[{"row-start":ie()}],"row-end":[{"row-end":ie()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Wt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Wt]}],gap:[{gap:[b]}],"gap-x":[{"gap-x":[b]}],"gap-y":[{"gap-y":[b]}],"justify-content":[{justify:["normal",...G()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...G(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...G(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[T]}],mx:[{mx:[T]}],my:[{my:[T]}],ms:[{ms:[T]}],me:[{me:[T]}],mt:[{mt:[T]}],mr:[{mr:[T]}],mb:[{mb:[T]}],ml:[{ml:[T]}],"space-x":[{"space-x":[$]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[$]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Wt,e]}],"min-w":[{"min-w":[Wt,e,"min","max","fit"]}],"max-w":[{"max-w":[Wt,e,"none","full","min","max","fit","prose",{screen:[Cc]},Cc]}],h:[{h:[Wt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Wt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Wt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Wt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Cc,Sc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Rx]}],"font-family":[{font:[Lp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Wt]}],"line-clamp":[{"line-clamp":["none",qf,Rx]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",_l,Wt]}],"list-image":[{"list-image":["none",Wt]}],"list-style-type":[{list:["none","disc","decimal",Wt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[R]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[R]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...pe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",_l,Sc]}],"underline-offset":[{"underline-offset":["auto",_l,Wt]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ue()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Wt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Wt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[R]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...se(),p6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",h6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},g6]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[N]}],"gradient-via-pos":[{via:[N]}],"gradient-to-pos":[{to:[N]}],"gradient-from":[{from:[E]}],"gradient-via":[{via:[E]}],"gradient-to":[{to:[E]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[u]}],"border-w-x":[{"border-x":[u]}],"border-w-y":[{"border-y":[u]}],"border-w-s":[{"border-s":[u]}],"border-w-e":[{"border-e":[u]}],"border-w-t":[{"border-t":[u]}],"border-w-r":[{"border-r":[u]}],"border-w-b":[{"border-b":[u]}],"border-w-l":[{"border-l":[u]}],"border-opacity":[{"border-opacity":[R]}],"border-style":[{border:[...pe(),"hidden"]}],"divide-x":[{"divide-x":[u]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[u]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[R]}],"divide-style":[{divide:pe()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...pe()]}],"outline-offset":[{"outline-offset":[_l,Wt]}],"outline-w":[{outline:[_l,Sc]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:we()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[R]}],"ring-offset-w":[{"ring-offset":[_l,Sc]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Cc,v6]}],"shadow-color":[{shadow:[Lp]}],opacity:[{opacity:[R]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",Cc,Wt]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[x]}],saturate:[{saturate:[j]}],sepia:[{sepia:[U]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[R]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[U]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Wt]}],duration:[{duration:D()}],ease:[{ease:["linear","in","out","in-out",Wt]}],delay:[{delay:D()}],animate:[{animate:["none","spin","ping","pulse","bounce",Wt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[Dp,Wt]}],"translate-x":[{"translate-x":[Y]}],"translate-y":[{"translate-y":[Y]}],"skew-x":[{"skew-x":[B]}],"skew-y":[{"skew-y":[B]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Wt]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Wt]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ue()}],"scroll-mx":[{"scroll-mx":ue()}],"scroll-my":[{"scroll-my":ue()}],"scroll-ms":[{"scroll-ms":ue()}],"scroll-me":[{"scroll-me":ue()}],"scroll-mt":[{"scroll-mt":ue()}],"scroll-mr":[{"scroll-mr":ue()}],"scroll-mb":[{"scroll-mb":ue()}],"scroll-ml":[{"scroll-ml":ue()}],"scroll-p":[{"scroll-p":ue()}],"scroll-px":[{"scroll-px":ue()}],"scroll-py":[{"scroll-py":ue()}],"scroll-ps":[{"scroll-ps":ue()}],"scroll-pe":[{"scroll-pe":ue()}],"scroll-pt":[{"scroll-pt":ue()}],"scroll-pr":[{"scroll-pr":ue()}],"scroll-pb":[{"scroll-pb":ue()}],"scroll-pl":[{"scroll-pl":ue()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Wt]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[_l,Sc,Rx]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},_6=n6(b6);function _r(...r){return _6(xT(r))}async function Ax(r){let e;if(r instanceof File)e=await r.arrayBuffer();else if(r instanceof ArrayBuffer)e=r;else if(r instanceof Uint8Array)e=r.buffer;else throw new Error("Unsupported data type for checksum calculation");const t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}const br="src/lib/utils/serverUtils.tsx",Ix=new Map,If=3,bC=1e3;function _C(r){if(r instanceof Error){const e=r.message.toLowerCase();return e.includes("timeout")||e.includes("network")||e.includes("failed to fetch")||e.includes("504")||e.includes("503")}return!1}function Uy(r){const e=["x-trace-id","x-request-id","x-correlation-id","x-amzn-request-id","x-amzn-requestid","x-amzn-trace-id","request-id","trace-id","correlation-id"];for(const t of e){const n=r.headers.get(t);if(n)return n}return null}new URL(yr+"/email-template");const E6=new URL(yr+"/email-templates"),S6=new URL(yr+"/email/generate"),C6=new URL(yr+"/email/generate_for_outlook"),k6=new URL(yr+"/email/reformat"),N6=new URL(yr+"/email/participants"),T6=new URL(yr+"/email/participants_with_category");new URL(yr+"/email/register");new URL(yr+"/email/unregister");const R6=new URL(yr+"/email/get_registration"),A6=new URL(yr+"/email/summarization"),I6=new URL(yr+"/email/description_summarization"),P6=new URL(yr+"/email/summarization_for_outlook");new URL(yr+"/integration");const F6=new URL(yr+"/integrations"),j6=new URL(yr+"/integrations/client"),O6=new URL(yr+"/integrations/document"),D6=new URL(yr+"/integrations/clients"),L6=new URL(yr+"/integrations/project_documents"),M6=new URL(yr+"/integrations/case_summary");new URL(yr+"/integrations/uscis/case");const $6=new URL(yr+"/integrations/user"),U6=new URL(yr+"/integrations/users"),Gm=new URL(yr+"/integrations/write"),z6=new URL(yr+"/integrations/projects"),H6=new URL(yr+"/integrations/project");new URL(yr+"/integrations/contacts");const B6=new URL(yr+"/integrations/settings"),G6=new URL(yr+"/email/generate_task_description");new URL(yr+"/admin/users");new URL(yr+"/admin/user");const W6="CANDLE_ERROR_TOKEN_NOT_FOUND",V6="CANDLE_ERROR_TOKEN_REFRESH_FAILED";function Vc(r,e){const t={sourceFile:br};e.status===404?e.json().then(n=>{(n.error_code===W6||n.error_code===V6)&&(r.warn("404 error, Gmail might be disconnected from server, checking...",{...t,data:n}),zy(r).then(s=>{s||r.error("Gmail has been disconnected from server unexpectedly!",new Error("Gmail has been disconnected from server, syncing..."),{...t,data:n})}))}):r.warn("HTTP error! status: "+e.status,{...t,data:e})}async function q6(r){const e={sourceFile:br};r.debug("Starting to fetch response...",e);const t=await zr(E6,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:t}),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=t.headers.get("content-type");if(r.debug("Content-Type:",{...e,data:n}),n&&n.includes("application/json")){r.debug("Content-Type is JSON, parsing...",e);const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),s.user_templates&&s.user_templates.length>0&&r.debug("First user template tags:",{...e,data:s.user_templates[0].tags}),s.org_templates&&s.org_templates.length>0&&r.debug("First org template tags:",{...e,data:s.org_templates[0].tags});const i=s.user_templates.map(u=>({...u,source:"SCOPE_USER"})),c=s.org_templates.map(u=>({...u,source:"SCOPE_TENANT"}));return r.debug("Enhanced user templates with source:",{...e,data:i}),r.debug("Enhanced org templates with source:",{...e,data:c}),{user_templates:i,org_templates:c}}else{r.debug("Content-Type is not JSON, handling as text...",e);const s=await t.text();throw r.error("Received non-JSON response:",s,e),new Error("Received non-JSON response from server")}}async function K6(r,e,t,n,s,i=[],c,u=!1){const p={sourceFile:br};c.debug("Starting to fetch response...",p),u?c.info("Force refresh flag is TRUE - will bypass backend cache",{...p,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...p,forceRefresh:!1});const m=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t},{role:"user",content:"This is the specific email in the thread to respond to:"+e}],g={WEB_SOURCES:{PUBLIC:i}};try{const x=await zr(S6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,datasources:g,format_instruction:s+" "+n,additional_context:m,force_refresh:u})},c);if(c.debug("Response received:",{...p,data:x}),!x.ok)throw Vc(c,x),new Error(`HTTP error! status: ${x.status}`);const b=x.headers.get("content-type");c.debug("Content-Type:",{...p,data:b});let E;if(b&&b.includes("application/json"))c.debug("Content-Type is JSON, parsing...",p),E=await x.json();else{c.debug("Content-Type is not JSON, handling as text...",p);const U=await x.text();throw c.error("Received non-JSON response:",U,p),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...p,data:E});const N=E.response,S=E.references,T=E.cms_fields_used,R=E.cms_data;c.info("Result response:",{...p,data:N}),c.info("Result references:",{...p,data:S});const P=new DOMParser().parseFromString(N,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...p,data:P}),{response:P,references:S,cms_fields_used:T,cms_data:R}}catch(x){return c.error("Error caught:",x,p),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function Y6(r,e,t,n,s,i,c,u=!1){const p={sourceFile:br};c.debug("Starting to fetch response for Outlook...",p),u?c.info("Force refresh flag is TRUE - will bypass backend cache",{...p,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...p,forceRefresh:!1});const m=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t}];try{const g=await zr(C6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thread_id:r,full_thread:e,email_participants:i,format_instruction:s+" "+n,additional_context:m,force_refresh:u})},c);if(c.debug("Response received:",{...p,data:g}),!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const x=g.headers.get("content-type");c.debug("Content-Type:",{...p,data:x});let b;if(x&&x.includes("application/json"))c.debug("Content-Type is JSON, parsing...",p),b=await g.json();else{c.debug("Content-Type is not JSON, handling as text...",p);const P=await g.text();throw c.error("Received non-JSON response:",P,p),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...p,data:b});const E=b.response,N=b.references,S=b.cms_fields_used,T=b.cms_data;c.debug("Result response:",{...p,data:E}),c.debug("Result references:",{...p,data:N});const j=new DOMParser().parseFromString(E,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...p,data:j}),{response:j,references:N,cms_fields_used:S,cms_data:T}}catch(g){return c.error("Error caught:",g,p),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function J6(r,e,t){const n={sourceFile:br};t.debug("Starting to fetch response...",n);const s=await zr(k6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reformat_instruction:e,chat_history:[{content:"Here's the HTML Content. Respond with only the HTML content for the revised email response:"+r}]})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(t.debug("Content-Type:",{...n,data:i}),i&&i.includes("application/json")){t.debug("Content-Type is JSON, parsing...",n);const c=await s.json();t.debug("Parsed JSON response:",{...n,data:c});const u=c.replace(/^```html\s*/,"");t.debug("Cleaned data:",{...n,data:u});const g=new DOMParser().parseFromString(u,"text/html").body.innerHTML;return t.debug("Extracted HTML body content:",{...n,data:g}),g}else{t.debug("Content-Type is not JSON, handling as text...",n);const c=await s.text();throw t.error("Received non-JSON response:",c,n),new Error("Received non-JSON response from server")}}async function Hc(r,e){const t={sourceFile:br};e.debug("Starting to list integrations...",t);const n=new URL(F6);n.searchParams.append("integration_scope",r);try{const s=await zr(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();e.debug("Integrations:",{...t,data:c.integrations});const u=c.integrations.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:r}));return await Um(e,u),u||[]}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error listing integrations:",s,t),s}}async function zy(r){const e={sourceFile:br};r.debug("Starting to check if Gmail integration is connected...",e);try{const t=await zr(R6,{method:"GET",headers:{"Content-Type":"application/json"}},r);r.debug("Response received:",{...e,data:t});let n=!1;if(t.ok){const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),n=s.is_registered===!0}return await NU(r,n),n}catch(t){r.error("Error checking Gmail connection status:",t,e);try{const n=await TU(r);if(n.isConnected!==null)return r.debug("Returning cached Gmail connection status due to error",{...e,cachedStatus:n.isConnected,cachedTimestamp:n.timestamp}),n.isConnected}catch(n){r.error("Error retrieving cached Gmail connection status:",n,e)}return!1}}async function X6(r,e){const t={sourceFile:br};try{const n=await zr(A6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw Vc(e,n),new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(u){e.error("Error parsing important details:",u,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function EC(r,e,t){const n={sourceFile:br};try{const s=await zr(I6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,email_thread_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw Vc(t,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();if(!c||!c.message)throw new Error("Summary not found in response");return{description:c.message}}else throw new Error("Received non-JSON response from server")}catch(s){return t.error("Error caught:",s,n),{description:""}}}async function Q6(r,e){const t={sourceFile:br};try{const n=await zr(P6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_thread:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(u){e.error("Error parsing important details:",u,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function J_(r,e,t,n=!1){const s={sourceFile:br,functionName:"getClientDataFromServer"},i=e.toLowerCase(),c=`${r}:${i}`,u=Ix.get(c);if(u)return t.debug("Returning existing in-flight request",{...s,clientEmail:e}),console.log(` [${r.toUpperCase()}] Deduplicating request for ${e} - returning in-flight promise`),u;const p=Uw(r,e,t,n);return Ix.set(c,p),p.finally(()=>{Ix.delete(c)})}async function Uw(r,e,t,n=!1,s=0){const i={sourceFile:br,functionName:"fetchClientDataInternal"},c=Date.now();if(console.group(` [${r.toUpperCase()}] getClientDataFromServer - ${e}${s>0?` (retry ${s})`:""}`),console.time("getClientDataFromServer:total"),console.log("Integration:",r),console.log("Client Email:",e),t.info("Starting client data fetch",{...i,clientEmail:e,integrationType:r,retryCount:s}),s===0){const N=P5(e);if(N.inCache)throw console.log(` Timeout cache hit: Email recently failed with ${N.errorType}`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in timeout cache, skipping API call to prevent retry storm",{...i,clientEmail:e,errorType:N.errorType,totalMs:Date.now()-c}),new Error(`Request recently failed (${N.errorType}) - try again later`)}console.time("getClientDataFromServer:nonExistentCacheCheck");const u=Date.now(),p=await $5(e,t),m=Date.now()-u;if(console.timeEnd("getClientDataFromServer:nonExistentCacheCheck"),p)throw console.log(" Non-existent cache hit: Email known to have no client data"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in non-existent cache, skipping API call",{...i,clientEmail:e,nonExistentCacheCheckMs:m,totalMs:Date.now()-c}),new Error("Client not found (cached)");console.time("getClientDataFromServer:clientCacheCheck");const g=Date.now(),x=await gT(e,t),b=Date.now()-g;if(console.timeEnd("getClientDataFromServer:clientCacheCheck"),x)return console.log(" Cache hit: Client data found in cache"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data found in cache",{...i,clientEmail:e,nonExistentCacheCheckMs:m,clientCacheCheckMs:b,totalMs:Date.now()-c}),x;const E=new URL(j6);E.searchParams.append("integration_type",r),E.searchParams.append("client_email",e),E.searchParams.append("data_type","client_data"),n&&E.searchParams.append("force_refresh","true");try{console.time("getClientDataFromServer:apiCall"),console.log(" Making API request to:",E.toString());const N=Date.now(),S=await zr(E,{method:"GET",headers:{"Content-Type":"application/json"}},t),T=Date.now()-N,R=Uy(S);if(console.timeEnd("getClientDataFromServer:apiCall"),console.log(" Response status:",S.status,`(${T}ms)`),console.log(" Trace ID:",R||"N/A"),S.status===504||S.status===503)if(console.error(` ${S.status} Gateway Timeout - API call took too long`),console.log("Request URL:",E.toString()),console.log("Time elapsed before timeout:",T,"ms"),console.log(" Trace ID for debugging:",R||"N/A"),s<If){const j=bC*Math.pow(2,s);return console.log(` Retrying in ${j}ms (attempt ${s+1}/${If})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after timeout",{...i,clientEmail:e,status:S.status,retryCount:s+1,delayMs:j,traceId:R}),await new Promise(P=>setTimeout(P,j)),Uw(r,e,t,n,s+1)}else vC(e,`${S.status}`),console.log(` Max retries (${If}) exhausted, added to timeout cache`),t.warn("Max retries exhausted for timeout error, added to timeout cache",{...i,clientEmail:e,status:S.status,retryCount:s,traceId:R});if(t.info("API response received",{...i,clientEmail:e,status:S.status,apiMs:T,nonExistentCacheCheckMs:m,clientCacheCheckMs:b,traceId:R,retryCount:s}),!S.ok)throw S.status===404&&(await M5(e,t),Vc(t,S)),console.error(" API error:",S.status),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),new Error(`HTTP error! status: ${S.status}`);const A=S.headers.get("content-type");if(A&&A.includes("application/json")){console.time("getClientDataFromServer:parseJson");const j=Date.now(),P=await S.json(),U=Date.now()-j;console.timeEnd("getClientDataFromServer:parseJson");const B=P.requestId,$=P.traceId,Y=B||R;B&&console.log(" Request ID (from body):",B),$&&console.log(" Trace ID (from body):",$);const J={client_data:P.client_data||{},case_data:P.case_data||[]};console.time("getClientDataFromServer:cacheWrite");const he=Date.now();await z5(e,J,t);const te=Date.now()-he;console.timeEnd("getClientDataFromServer:cacheWrite"),fT(e);const ue=Date.now()-c;return console.log(" Client data fetch completed"),console.log(" Timing breakdown:",{nonExistentCacheCheck:`${m}ms`,clientCacheCheck:`${b}ms`,apiCall:`${T}ms`,parseJson:`${U}ms`,cacheWrite:`${te}ms`,total:`${ue}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch completed",{...i,clientEmail:e,nonExistentCacheCheckMs:m,clientCacheCheckMs:b,apiMs:T,parseMs:U,cacheWriteMs:te,totalMs:ue,retryCount:s,requestId:Y,traceId:$||R}),J}else throw console.error(" Received non-JSON response"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(N){const S=Date.now()-c;if(s<If&&_C(N)){const T=bC*Math.pow(2,s);return console.log(` Retrying after error in ${T}ms (attempt ${s+1}/${If})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after network error",{...i,clientEmail:e,error:N instanceof Error?N.message:String(N),retryCount:s+1,delayMs:T}),await new Promise(R=>setTimeout(R,T)),Uw(r,e,t,n,s+1)}if(_C(N)){const T=N instanceof Error?N.message.includes("timeout")?"timeout":"network":"unknown";vC(e,T),console.log(` Max retries (${If}) exhausted for ${T} error, added to timeout cache`),t.warn("Max retries exhausted for network error, added to timeout cache",{...i,clientEmail:e,errorType:T,retryCount:s})}throw console.error(" Client data fetch failed:",N instanceof Error?N.message:String(N)),console.log(" Timing at failure:",{nonExistentCacheCheck:`${m}ms`,clientCacheCheck:`${b}ms`,total:`${S}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch failed",{...i,clientEmail:e,error:N instanceof Error?N.message:String(N),nonExistentCacheCheckMs:m,clientCacheCheckMs:b,totalMs:S,retryCount:s}),N}}async function CT(r,e,t){const n={sourceFile:br,functionName:"getDocumentListForProject"};t.debug("Starting to fetch project documents...",{...n,projectId:e});const s=new URL(L6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await zr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return Vc(t,i),{documents:[]};throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const u=await i.json();return t.debug("Parsed JSON response:",{...n,data:u}),{documents:u.documents||[]}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.debug("Error fetching project documents:",{...n,error:i}),i}}async function Z6(r,e,t){const n={sourceFile:br,functionName:"getCaseSummaryForProject"};t.debug("Starting to fetch case summary...",{...n,projectId:e});const s=new URL(M6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await zr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return Vc(t,i),null;throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const u=await i.json();return t.debug("Parsed JSON response:",{...n,data:u}),{caseFacts:u.caseFacts||"",supioLink:u.supioLink||"",statuteoflimitations:u.statuteoflimitations||{dateValue:"",doneDate:null},disbursementSheet:u.disbursementSheet||null,totalMeds:u.totalMeds||0,totalLiens:u.totalLiens||0}}else throw new Error("Received non-JSON response from server")}catch(i){return t.debug("Error fetching case summary:",{...n,error:i}),null}}async function e8(r,e){const t={sourceFile:br,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await zr(N6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw Vc(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_participants}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function kT(r,e){const t={sourceFile:br,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await zr(T6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw Vc(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_details}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function t8(r,e,t){const n={sourceFile:br,functionName:"getDocumentURLFromServer"};t.debug("Starting to fetch document data...",n);const s=new URL(O6);s.searchParams.append("integration_type",r),s.searchParams.append("document_id",e);try{const i=await zr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok)throw i.status===404?new Error("Document not found or integration not configured"):new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const u=await i.json();if(t.debug("Parsed JSON response:",{...n,data:u}),!u.url)throw new Error("Document URL not found in response");return{documentId:parseInt(e),url:u.url}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.error("Error fetching document data:",i,n),i}}async function r8(r,e){const t={sourceFile:br,functionName:"getAllClientsFromServer"};r.debug("Starting to fetch all clients for project...",t);const n=new URL(D6);n.searchParams.append("integration_type",e);try{const s=await zr(n,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...t,data:s}),!s.ok)throw s.status===400?new Error("Missing required parameters"):s.status===404?new Error("No integration found for the specified type"):new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return r.debug("Parsed JSON response:",{...t,data:c}),{clients:c}}else throw new Error("Received non-JSON response from server")}catch(s){throw r.error("Error fetching all clients:",s,t),s}}async function Hy(r,e,t){var i,c;const n={sourceFile:br},s=Date.now();console.group(` [${r.toUpperCase()}] searchProjectsFromServer - "${e}"`),console.time("searchProjectsFromServer:total"),console.log("Integration:",r),console.log("Search Term:",e);try{t.info("Searching projects",{...n,integrationType:r,searchTerm:e});const u=new URL(z6);u.searchParams.append("integration_type",r),u.searchParams.append("search_term",e),u.searchParams.append("exclude_archived","true"),u.searchParams.append("limit","10"),console.time("searchProjectsFromServer:apiCall"),console.log(" Making API request to:",u.toString());const p=Date.now(),m=await zr(u,{method:"GET",headers:{"Content-Type":"application/json"}},t),g=Date.now()-p,x=Uy(m);if(console.timeEnd("searchProjectsFromServer:apiCall"),console.log(" Response status:",m.status,`(${g}ms)`),console.log(" Trace ID:",x||"N/A"),m.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",u.toString()),console.log("Time elapsed before timeout:",g,"ms"),console.log(" Trace ID for debugging:",x||"N/A")),!m.ok){if(m.status===404)return console.log(" No projects found (404)"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.debug("No projects found",{...n,traceId:x}),{projects:[],total:0,hasMore:!1};throw console.error(" API error:",m.status),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error(`Search failed: ${m.status}`)}const b=m.headers.get("content-type");if(b&&b.includes("application/json")){console.time("searchProjectsFromServer:parseJson");const E=await m.json();console.timeEnd("searchProjectsFromServer:parseJson");const N=Date.now()-s;return console.log(" Project search completed"),console.log(" Results:",((i=E.projects)==null?void 0:i.length)||0,"projects found"),console.log(" Timing breakdown:",{apiCall:`${g}ms`,total:`${N}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.info("Project search successful",{...n,resultCount:((c=E.projects)==null?void 0:c.length)||0}),E}else throw console.error(" Received non-JSON response"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(u){const p=Date.now()-s;throw console.error(" Project search failed:",u instanceof Error?u.message:String(u)),console.log(" Timing at failure:",{total:`${p}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.error("Error searching projects",u,{...n,integrationType:r,searchTerm:e}),u}}async function n8(r,e,t){var i,c,u,p;const n={sourceFile:br},s=Date.now();console.group(` [${r.toUpperCase()}] getProjectDataById - ${e}`),console.time("getProjectDataById:total"),console.log("Integration:",r),console.log("Project ID:",e);try{t.info("Fetching project data by ID",{...n,integrationType:r,projectId:e});const m=new URL(H6);m.searchParams.append("integration_type",r),m.searchParams.append("project_id",e),console.time("getProjectDataById:apiCall"),console.log(" Making API request to:",m.toString());const g=Date.now(),x=await zr(m,{method:"GET",headers:{"Content-Type":"application/json"}},t),b=Date.now()-g,E=Uy(x);if(console.timeEnd("getProjectDataById:apiCall"),console.log(" Response status:",x.status,`(${b}ms)`),console.log(" Trace ID:",E||"N/A"),x.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",m.toString()),console.log("Time elapsed before timeout:",b,"ms"),console.log(" Trace ID for debugging:",E||"N/A")),!x.ok){if(x.status===404)return console.log(" Project not found (404)"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.debug("Project not found",{...n,traceId:E}),{};throw console.error(" API error:",x.status),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error(`Failed to fetch project: ${x.status}`)}const N=x.headers.get("content-type");if(N&&N.includes("application/json")){console.time("getProjectDataById:parseJson");const S=await x.json();console.timeEnd("getProjectDataById:parseJson");const T=S.project||{},R=Date.now()-s;return console.log(" Project data fetched successfully"),console.log(" Data includes:",{hasCalendarEntries:!!((i=T.case_data)!=null&&i.calendar_entries||T.calendar_entries),hasNotes:!!((c=T.case_data)!=null&&c.notes||T.notes),hasTasks:!!((u=T.case_data)!=null&&u.last_completed_task||(p=T.case_data)!=null&&p.next_upcoming_task)}),console.log(" Timing breakdown:",{apiCall:`${b}ms`,total:`${R}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.info("Project data fetched successfully",{...n,projectId:e}),T}else throw console.error(" Received non-JSON response"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(m){const g=Date.now()-s;throw console.error(" Project data fetch failed:",m instanceof Error?m.message:String(m)),console.log(" Timing at failure:",{total:`${g}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.error("Error fetching project by ID",m,{...n,integrationType:r,projectId:e}),m}}async function s8(r,e){const t={sourceFile:br,functionName:"getUserDataFromServer"},n=Date.now(),s=`getUserDataFromServer:${n}`;r.debug("Starting to fetch user data...",t);const i=new URL($6);i.searchParams.append("integration_type",e);try{const c=Date.now(),u=await zr(i,{method:"GET",headers:{"Content-Type":"application/json"}},r),p=Uy(u);if(console.timeEnd("getUserDataFromServer:apiCall"),u.status===504&&console.error(" 504 Gateway Timeout - API call took too long"),r.debug("Response received:",{...t,data:u,traceId:p}),!u.ok)throw u.status===400?(console.error(" API error: 400 - Missing required parameters"),new Error("Missing required parameters")):u.status===404?(console.error(" API error: 404 - No integration found"),new Error("No integration found for the specified type")):(console.error(" API error:",u.status),new Error(`HTTP error! status: ${u.status}`));const m=u.headers.get("content-type");if(m&&m.includes("application/json")){console.time("getUserDataFromServer:parseJson");const g=await u.json();return console.timeEnd("getUserDataFromServer:parseJson"),console.timeEnd(s),console.groupEnd(),r.debug("Parsed JSON response:",{...t,data:g}),{id:g.id||null,name:g.name||null,rate:g.rate||0}}else throw console.error(" Received non-JSON response"),new Error("Received non-JSON response from server")}catch(c){const u=Date.now()-n;throw console.error(" User data fetch failed:",c instanceof Error?c.message:String(c)),console.log(" Timing at failure:",{total:`${u}ms`}),console.timeEnd(s),console.groupEnd(),r.error("Error fetching user data:",c,t),c}}async function o8(r,e,t){var i,c;const n={sourceFile:br,functionName:"searchFirmUsersFromServer"};t.debug("Starting to search firm users...",{...n,integrationType:r,searchTerm:e});const s=new URL(U6);s.searchParams.append("integration_type",r),s.searchParams.append("request_function","search_firm_users"),s.searchParams.append("search_term",e),s.searchParams.append("limit","10");try{const u=await zr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,status:u.status}),!u.ok){if(u.status===404)return t.debug("No users found",n),{users:[],total:0,hasMore:!1};throw new Error(`HTTP error! status: ${u.status}`)}const p=u.headers.get("content-type");if(p&&p.includes("application/json")){const m=await u.json();return t.debug("Parsed JSON response:",{...n,usersCount:((i=m.users)==null?void 0:i.length)||0}),{users:m.users||[],total:m.total||((c=m.users)==null?void 0:c.length)||0,hasMore:m.has_more||!1}}else throw new Error("Received non-JSON response from server")}catch(u){throw t.error("Error searching firm users:",u,n),u}}async function ty(r,e,t,n,s,i,c,u,p,m,g,x,b,E,N,S){const T={sourceFile:br,functionName:"writeTimeEntryToServer"};S.debug("Starting to write time entry to server...",T);try{const R=await zr(Gm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_email:r,function:"write_time_entry_to_clio",integration_type:e,date:t,quantity:n,description:s,matter_id:i,write_time_entry:c,email_subject:u,email_body:p,sent_at:m,sender_email:g,recipient_emails:x,non_billable:b,no_charge:E,price:N})},S);if(S.debug("Response received:",{...T,data:R,sourceFile:br}),!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const A=R.headers.get("content-type");if(A&&A.includes("application/json")){const j=await R.json();return S.debug("Parsed JSON response:",{...T,data:j}),j.message||"Time entry written successfully"}else throw new Error("Received non-JSON response from server")}catch(R){throw S.error("Error writing time entry:",R,{...T,sourceFile:br}),R}}async function i8(r){const e={sourceFile:br,functionName:"getIntegrationSettingsFromServer"};r.debug("Starting to fetch integration settings...",{...e});const t=new URL(B6);try{const n=await zr(t,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:n}),!n.ok){if(n.status===404)return r.debug("No settings found, returning defaults",e),{};throw new Error(`HTTP error! status: ${n.status}`)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return r.debug("Parsed JSON response:",{...e,data:i}),i.integration_settings||{}}else throw new Error("Received non-JSON response from server")}catch(n){return r.error("Error fetching integration settings:",n,e),{}}}async function a8(r,e,t){const n={sourceFile:br,functionName:"generateTaskDescriptionFromEmail"};t.debug("Starting to generate task description from email...",n);try{const s=await zr(G6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integration_type:r,email_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return t.debug("Parsed JSON response:",{...n,data:c}),{name:c.name||"",description:c.description||""}}else throw new Error("Received non-JSON response from server")}catch(s){throw t.error("Error generating task description:",s,n),s}}async function l8(r,e,t,n,s,i,c,u,p,m){const g={sourceFile:br,functionName:"createClioTask"};c.debug("Starting to create Clio task...",{...g,taskName:e,matterId:n,dueAt:s,priority:i,assigneeId:u,reminder:p,notificationFlags:m});try{const x={function:"write_task_to_clio",integration_type:r,name:e,description:t,matter_id:n,due_at:s,priority:i};u&&(x.assignee_id=u),p&&(x.reminder=p),m&&(x.notify_assignee=m.notifyAssignee,x.notify_completion=m.notifyCompletion);const b=await zr(Gm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)},c);if(c.debug("Response received:",{...g,data:b}),!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const E=b.headers.get("content-type");if(E&&E.includes("application/json")){const N=await b.json();return c.debug("Parsed JSON response:",{...g,data:N}),{taskId:N.task_id||"",message:N.message||"Task created successfully"}}else throw new Error("Received non-JSON response from server")}catch(x){throw c.error("Error creating Clio task:",x,g),x}}async function c8(r,e,t,n,s,i,c){const u={sourceFile:br,functionName:"createClioNote"};try{const m=await zr(Gm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"write_note_to_clio",integration_type:r,subject:e,detail:t,date:n,matter_id:s,contact_id:i})},c);if(!m.ok){const x=await m.json();throw new Error(x.message||`HTTP error! status: ${m.status}`)}const g=await m.json();return c.info("Note created successfully",{...u,noteId:g.note_id}),{noteId:g.note_id,message:g.message||"Note created successfully"}}catch(p){throw c.error("Error creating note",p,u),p}}async function u8(r,e){const t={sourceFile:br,functionName:"createContactInClio"};e.debug("Starting to create Clio contact...",{...t,email:r.email});try{const n=await zr(Gm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"create_contact_in_clio",integration_type:"clio",first_name:r.firstName,last_name:r.lastName,email:r.email,phone_number:r.phoneNumber,contact_type:r.type,company_name:r.companyName})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok){const c=(await n.json().catch(()=>({}))).error||`HTTP error! status: ${n.status}`;throw new Error(c)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return e.debug("Parsed JSON response:",{...t,data:i}),{id:i.contact_id||i.id||"",message:i.message||"Contact created successfully"}}else throw new Error("Received non-JSON response from server")}catch(n){throw e.error("Error creating Clio contact:",n,t),n}}async function d8(r,e,t,n,s){const i={sourceFile:br,functionName:"linkContactToMatter"};s.debug("Starting to link contact to matter...",{...i,contactId:e,matterId:t,relationship:n});try{const c=await zr(Gm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"link_contact_to_matter",integration_type:r,contact_id:e,matter_id:t,relationship:n})},s);if(s.debug("Response received:",{...i,data:c}),!c.ok){const m=(await c.json().catch(()=>({}))).error||`HTTP error! status: ${c.status}`;throw new Error(m)}const u=c.headers.get("content-type");if(u&&u.includes("application/json")){const p=await c.json();return s.debug("Parsed JSON response:",{...i,data:p}),{message:p.message||"Contact linked to matter successfully"}}else throw new Error("Received non-JSON response from server")}catch(c){throw s.error("Error linking contact to matter:",c,i),c}}function tn(){const r=w.useContext(K_);if(!r)throw new Error("usePlatform must be used within a PlatformProvider");if(!r.services)throw new Error("Platform services are not available. Services may still be loading or failed to initialize.");return r}const Ul=()=>tn().services.storage,sd=()=>tn().services.data,NT=()=>tn().services.auth,f8=()=>tn().services.messaging,h8=()=>tn().services.tabs,p8=()=>tn().services.lifecycle,m8=()=>tn().services.logging,g8=({children:r})=>{const[e,t]=w.useState(!0),[n,s]=w.useState(!1),[i,c]=w.useState(!1),[u,p]=w.useState(null),[m,g]=w.useState("loading"),[x,b]=w.useState(null),[E,N]=w.useState(0),S=m8(),{platform:T}=tn(),R=Ul(),A=w.useCallback(async()=>{if(T!=="chrome"){t(!1),g("disconnected"),b(new Date);return}c(!0),g("loading"),p(null);try{const $=await zy(S);t($),g($?"connected":"disconnected"),b(new Date),$&&(N(0),n||(s(!0),R&&R.setLocalItem("wasEverConnectedGmail",!0).catch(Y=>{S.error("Failed to save wasEverConnected to storage",Y,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}))),S.debug("Gmail connection status checked",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",connected:$,status:$?"connected":"disconnected"})}catch($){const Y=$ instanceof Error?$.message:"Unknown error occurred";p(Y),t(!1),g("error"),b(new Date),S.error("Error checking Gmail connection",$,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}finally{c(!1)}},[S,T,n,R]),j=w.useCallback(async()=>{try{N(ie=>ie+1),g("loading"),p(null);const{initiateIntegration:$,findIntegrationById:Y}=await Nw(async()=>{const{initiateIntegration:ie,findIntegrationById:se}=await Promise.resolve().then(()=>v9);return{initiateIntegration:ie,findIntegrationById:se}},void 0),{GMAIL_INTEGRATION_PAGE_URI:J,GMAIL_INTEGRATION_REDIRECT_URI:he}=await Nw(async()=>{const{GMAIL_INTEGRATION_PAGE_URI:ie,GMAIL_INTEGRATION_REDIRECT_URI:se}=await Promise.resolve().then(()=>mU);return{GMAIL_INTEGRATION_PAGE_URI:ie,GMAIL_INTEGRATION_REDIRECT_URI:se}},void 0),te=J(he),ue=await Y("gmail");if(!ue)throw new Error("Gmail integration not found");const we=await $(S,ue,te);return we?await A():g("disconnected"),we}catch($){const Y=$ instanceof Error?$.message:"Failed to reconnect Gmail";throw p(Y),g("error"),S.error("Failed to reconnect Gmail:",$,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",attemptNumber:E+1}),$}},[S,A,E]),P=w.useCallback(()=>{p(null),m==="error"&&g(e?"connected":"disconnected")},[m,e]),U=w.useCallback(async()=>{await A()},[A]);w.useEffect(()=>{if(T!=="chrome")return;const $=setInterval(()=>{A()},36e5);return()=>clearInterval($)},[A,T]),w.useEffect(()=>{if(T!=="chrome")return;const Y=(async()=>{try{const he=(await On.createServices()).storage;if(he.onChanged){const te=ue=>{if(ue.gmailConnectionStatus){const we=ue.gmailConnectionStatus.newValue;S.debug("Gmail connection status changed via storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",newStatus:we,oldStatus:ue.gmailConnectionStatus.oldValue}),we!==void 0&&(t(we),g(we?"connected":"disconnected"),b(new Date),we&&u&&p(null))}};return he.onChanged(te),()=>{he.removeChangeListener&&he.removeChangeListener(te)}}}catch(J){S.error("Failed to set up Gmail connection storage listener:",J,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})();return()=>{Y.then(J=>J==null?void 0:J())}},[T,S,u]),w.useEffect(()=>{(async()=>{if(!(T!=="chrome"||!R))try{const Y=await R.getLocalItem("wasEverConnectedGmail");Y!==null&&(s(Y),S.debug("Loaded wasEverConnected from storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",wasEverConnected:Y}))}catch(Y){S.error("Failed to load wasEverConnected from storage",Y,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})()},[T,R,S]),w.useEffect(()=>{A()},[A]);const B={isConnected:e,wasEverConnected:n,isLoading:i,error:u,status:m,lastChecked:x,reconnectAttempts:E,checkConnection:A,initiateReconnection:j,clearError:P,forceRefresh:U};return d.jsx(dT.Provider,{value:B,children:r})},TT=w.createContext(void 0),RT=()=>{const r=w.useContext(TT);if(!r)throw new Error("useActiveSection must be used within an ActiveSectionProvider");return r},v8=({children:r})=>{const[e,t]=w.useState("main");return d.jsx(TT.Provider,{value:{activeSection:e,setActiveSection:t},children:r})};var _e=typeof window<"u"?window:void 0,is=typeof globalThis<"u"?globalThis:_e;typeof self>"u"&&(is.self=is),typeof File>"u"&&(is.File=function(){});var AT=Array.prototype,SC=AT.forEach,CC=AT.indexOf,Mo=is==null?void 0:is.navigator,Ve=is==null?void 0:is.document,ss=is==null?void 0:is.location,zw=is==null?void 0:is.fetch,Hw=is!=null&&is.XMLHttpRequest&&"withCredentials"in new is.XMLHttpRequest?is.XMLHttpRequest:void 0,kC=is==null?void 0:is.AbortController,vo=Mo==null?void 0:Mo.userAgent,yt=_e??{},Nl={DEBUG:!1,LIB_VERSION:"1.343.2"};function NC(r,e,t,n,s,i,c){try{var u=r[i](c),p=u.value}catch(m){return void t(m)}u.done?e(p):Promise.resolve(p).then(n,s)}function Hf(r){return function(){var e=this,t=arguments;return new Promise((function(n,s){var i=r.apply(e,t);function c(p){NC(i,n,s,c,u,"next",p)}function u(p){NC(i,n,s,c,u,"throw",p)}c(void 0)}))}}function Qe(){return Qe=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Qe.apply(null,arguments)}function IT(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}var y8=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],TC=function(r,e){if(e===void 0&&(e=[]),!r)return!1;var t=r.toLowerCase();return y8.concat(e).some((n=>{var s=n.toLowerCase();return t.indexOf(s)!==-1}))},x8=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function rr(r,e){return r.indexOf(e)!==-1}var By=function(r){return r.trim()},Bw=function(r){return r.replace(/^\$/,"")},w8=Array.isArray,PT=Object.prototype,FT=PT.hasOwnProperty,Gy=PT.toString,Rr=w8||function(r){return Gy.call(r)==="[object Array]"},Lc=r=>typeof r=="function",Fn=r=>r===Object(r)&&!Rr(r),Bf=r=>{if(Fn(r)){for(var e in r)if(FT.call(r,e))return!1;return!0}return!1},qe=r=>r===void 0,jn=r=>Gy.call(r)=="[object String]",Gw=r=>jn(r)&&r.trim().length===0,Vi=r=>r===null,or=r=>qe(r)||Vi(r),Ol=r=>Gy.call(r)=="[object Number]"&&r==r,$f=r=>Ol(r)&&r>0,Fl=r=>Gy.call(r)==="[object Boolean]",b8=r=>r instanceof FormData,_8=r=>rr(x8,r);function Ww(r){return r===null||typeof r!="object"}function ry(r,e){return Object.prototype.toString.call(r)==="[object "+e+"]"}function jT(r){return!qe(Event)&&(function(e,t){try{return e instanceof t}catch{return!1}})(r,Event)}var E8=[!0,"true",1,"1","yes"],Px=r=>rr(E8,r),S8=[!1,"false",0,"0","no"];function $a(r,e,t,n,s){return e>t&&(n.warn("min cannot be greater than max."),e=t),Ol(r)?r>t?(n.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):r<e?(n.warn(" cannot be less than min: "+e+". Using min value instead."),e):r:(n.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+s),$a(s||t,e,t,n))}class C8{constructor(e){this.t={},this.i=e.i,this.o=$a(e.bucketSize,0,100,e.h),this.m=$a(e.refillRate,0,this.o,e.h),this.$=$a(e.refillInterval,0,864e5,e.h)}S(e,t){var n=t-e.lastAccess,s=Math.floor(n/this.$);if(s>0){var i=s*this.m;e.tokens=Math.min(e.tokens+i,this.o),e.lastAccess=e.lastAccess+s*this.$}}consumeRateLimit(e){var t,n=Date.now(),s=String(e),i=this.t[s];return i?this.S(i,n):(i={tokens:this.o,lastAccess:n},this.t[s]=i),i.tokens===0||(i.tokens--,i.tokens===0&&((t=this.i)==null||t.call(this,e)),i.tokens===0)}stop(){this.t={}}}var ui="Mobile",ny="iOS",Il="Android",Am="Tablet",OT=Il+" "+Am,DT="iPad",LT="Apple",MT=LT+" Watch",Im="Safari",nh="BlackBerry",$T="Samsung",UT=$T+"Browser",zT=$T+" Internet",Zu="Chrome",k8=Zu+" OS",HT=Zu+" "+ny,X_="Internet Explorer",BT=X_+" "+ui,Q_="Opera",N8=Q_+" Mini",Z_="Edge",GT="Microsoft "+Z_,Kf="Firefox",WT=Kf+" "+ny,Pm="Nintendo",Fm="PlayStation",Yf="Xbox",VT=Il+" "+ui,qT=ui+" "+Im,rm="Windows",Vw=rm+" Phone",RC="Nokia",qw="Ouya",KT="Generic",T8=KT+" "+ui.toLowerCase(),YT=KT+" "+Am.toLowerCase(),Kw="Konqueror",Gs="(\\d+(\\.\\d+)?)",Fx=new RegExp("Version/"+Gs),R8=new RegExp(Yf,"i"),A8=new RegExp(Fm+" \\w+","i"),I8=new RegExp(Pm+" \\w+","i"),eE=new RegExp(nh+"|PlayBook|BB10","i"),P8={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},yv,AC,jx,F8=(r,e)=>e&&rr(e,LT)||(function(t){return rr(t,Im)&&!rr(t,Zu)&&!rr(t,Il)})(r),JT=function(r,e){return e=e||"",rr(r," OPR/")&&rr(r,"Mini")?N8:rr(r," OPR/")?Q_:eE.test(r)?nh:rr(r,"IE"+ui)||rr(r,"WPDesktop")?BT:rr(r,UT)?zT:rr(r,Z_)||rr(r,"Edg/")?GT:rr(r,"FBIOS")?"Facebook "+ui:rr(r,"UCWEB")||rr(r,"UCBrowser")?"UC Browser":rr(r,"CriOS")?HT:rr(r,"CrMo")||rr(r,Zu)?Zu:rr(r,Il)&&rr(r,Im)?VT:rr(r,"FxiOS")?WT:rr(r.toLowerCase(),Kw.toLowerCase())?Kw:F8(r,e)?rr(r,ui)?qT:Im:rr(r,Kf)?Kf:rr(r,"MSIE")||rr(r,"Trident/")?X_:rr(r,"Gecko")?Kf:""},j8={[BT]:[new RegExp("rv:"+Gs)],[GT]:[new RegExp(Z_+"?\\/"+Gs)],[Zu]:[new RegExp("("+Zu+"|CrMo)\\/"+Gs)],[HT]:[new RegExp("CriOS\\/"+Gs)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+Gs)],[Im]:[Fx],[qT]:[Fx],[Q_]:[new RegExp("(Opera|OPR)\\/"+Gs)],[Kf]:[new RegExp(Kf+"\\/"+Gs)],[WT]:[new RegExp("FxiOS\\/"+Gs)],[Kw]:[new RegExp("Konqueror[:/]?"+Gs,"i")],[nh]:[new RegExp(nh+" "+Gs),Fx],[VT]:[new RegExp("android\\s"+Gs,"i")],[zT]:[new RegExp(UT+"\\/"+Gs)],[X_]:[new RegExp("(rv:|MSIE )"+Gs)],Mozilla:[new RegExp("rv:"+Gs)]},O8=function(r,e){var t=JT(r,e),n=j8[t];if(qe(n))return null;for(var s=0;s<n.length;s++){var i=n[s],c=r.match(i);if(c)return parseFloat(c[c.length-2])}return null},IC=[[new RegExp(Yf+"; "+Yf+" (.*?)[);]","i"),r=>[Yf,r&&r[1]||""]],[new RegExp(Pm,"i"),[Pm,""]],[new RegExp(Fm,"i"),[Fm,""]],[eE,[nh,""]],[new RegExp(rm,"i"),(r,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[Vw,""];if(new RegExp(ui).test(e)&&!/IEMobile\b/.test(e))return[rm+" "+ui,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var n=t[1],s=P8[n]||"";return/arm/i.test(e)&&(s="RT"),[rm,s]}return[rm,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,r=>{if(r&&r[3]){var e=[r[3],r[4],r[5]||"0"];return[ny,e.join(".")]}return[ny,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,r=>{var e="";return r&&r.length>=3&&(e=qe(r[2])?r[3]:r[2]),["watchOS",e]}],[new RegExp("("+Il+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Il+")","i"),r=>{if(r&&r[2]){var e=[r[2],r[3],r[4]||"0"];return[Il,e.join(".")]}return[Il,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,r=>{var e=["Mac OS X",""];if(r&&r[1]){var t=[r[1],r[2],r[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[k8,""]],[/Linux|debian/i,["Linux",""]]],PC=function(r){return I8.test(r)?Pm:A8.test(r)?Fm:R8.test(r)?Yf:new RegExp(qw,"i").test(r)?qw:new RegExp("("+Vw+"|WPDesktop)","i").test(r)?Vw:/iPad/.test(r)?DT:/iPod/.test(r)?"iPod Touch":/iPhone/.test(r)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(r)?MT:eE.test(r)?nh:/(kobo)\s(ereader|touch)/i.test(r)?"Kobo":new RegExp(RC,"i").test(r)?RC:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(r)||/(kf[a-z]+)( bui|\)).+silk\//i.test(r)?"Kindle Fire":/(Android|ZTE)/i.test(r)?new RegExp(ui).test(r)&&!/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(r)||/pixel[\daxl ]{1,6}/i.test(r)&&!/pixel c/i.test(r)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(r)||/lmy47v/i.test(r)&&!/QTAQZ3/i.test(r)?Il:OT:new RegExp("(pda|"+ui+")","i").test(r)?T8:new RegExp(Am,"i").test(r)&&!new RegExp(Am+" pc","i").test(r)?YT:""},D8=r=>r instanceof Error;function L8(r){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return jx&&t.length===AC||(AC=t.length,jx=t.reduce(((n,s)=>{yv||(yv={});var i=yv[s];if(i)n[i[0]]=i[1];else for(var c=r(s),u=c.length-1;u>=0;u--){var p=c[u],m=p==null?void 0:p.filename,g=e[s];if(m&&g){n[m]=g,yv[s]=[m,g];break}}return n}),{})),jx}}class M8{constructor(e,t,n){n===void 0&&(n=[]),this.coercers=e,this.stackParser=t,this.modifiers=n}buildFromUnknown(e,t){t===void 0&&(t={});var n=t&&t.mechanism||{handled:!0,type:"generic"},s=this.buildCoercingContext(n,t,0).apply(e),i=this.buildParsingContext(t),c=this.parseStacktrace(s,i);return{$exception_list:this.convertToExceptionList(c,n),$exception_level:"error"}}modifyFrames(e){var t=this;return Hf((function*(){for(var n of e)n.stacktrace&&n.stacktrace.frames&&Rr(n.stacktrace.frames)&&(n.stacktrace.frames=yield t.applyModifiers(n.stacktrace.frames));return e}))()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var n,s;return e.cause!=null&&(n=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(s=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?t.skipFirstLines:0),t.chunkIdMap)),Qe({},e,{cause:n,stack:s})}applyChunkIds(e,t){return e.map((n=>(n.filename&&t&&(n.chunk_id=t[n.filename]),n)))}applyCoercers(e,t){for(var n of this.coercers)if(n.match(e))return n.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Hf((function*(){var n=e;for(var s of t.modifiers)n=yield s(n);return n}))()}convertToExceptionList(e,t){var n,s,i,c={type:e.type,value:e.value,mechanism:{type:(n=t.type)!==null&&n!==void 0?n:"generic",handled:(s=t.handled)===null||s===void 0||s,synthetic:(i=e.synthetic)!==null&&i!==void 0&&i}};e.stack&&(c.stacktrace={type:"raw",frames:e.stack});var u=[c];return e.cause!=null&&u.push(...this.convertToExceptionList(e.cause,Qe({},t,{handled:!0}))),u}buildParsingContext(e){var t;return{chunkIdMap:L8(this.stackParser),skipFirstLines:(t=e.skipFirstLines)!==null&&t!==void 0?t:1}}buildCoercingContext(e,t,n){n===void 0&&(n=0);var s=(i,c)=>{if(c<=4){var u=this.buildCoercingContext(e,t,c);return this.applyCoercers(i,u)}};return Qe({},t,{syntheticException:n==0?t.syntheticException:void 0,mechanism:e,apply:i=>s(i,n),next:i=>s(i,n+1)})}}var sh="?";function Yw(r,e,t,n,s){var i={platform:r,filename:e,function:t==="<anonymous>"?sh:t,in_app:!0};return qe(n)||(i.lineno=n),qe(s)||(i.colno=s),i}var XT=(r,e)=>{var t=r.indexOf("safari-extension")!==-1,n=r.indexOf("safari-web-extension")!==-1;return t||n?[r.indexOf("@")!==-1?r.split("@")[0]:sh,t?"safari-extension:"+e:"safari-web-extension:"+e]:[r,e]},$8=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,U8=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,z8=/\((\S*)(?::(\d+))(?::(\d+))\)/,H8=(r,e)=>{var t=$8.exec(r);if(t){var[,n,s,i]=t;return Yw(e,n,sh,+s,+i)}var c=U8.exec(r);if(c){if(c[2]&&c[2].indexOf("eval")===0){var u=z8.exec(c[2]);u&&(c[2]=u[1],c[3]=u[2],c[4]=u[3])}var[p,m]=XT(c[1]||sh,c[2]);return Yw(e,m,p,c[3]?+c[3]:void 0,c[4]?+c[4]:void 0)}},B8=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,G8=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,W8=(r,e)=>{var t=B8.exec(r);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var n=G8.exec(t[3]);n&&(t[1]=t[1]||"eval",t[3]=n[1],t[4]=n[2],t[5]="")}var s=t[3],i=t[1]||sh;return[i,s]=XT(i,s),Yw(e,s,i,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},FC=/\(error: (.*)\)/,jC=50;function V8(){return(function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(s,i){i===void 0&&(i=0);for(var c=[],u=s.split(`
`),p=i;p<u.length;p++){var m=u[p];if(!(m.length>1024)){var g=FC.test(m)?m.replace(FC,"$1"):m;if(!g.match(/\S*Error: /)){for(var x of t){var b=x(g,r);if(b){c.push(b);break}}if(c.length>=jC)break}}}return(function(E){if(!E.length)return[];var N=Array.from(E);return N.reverse(),N.slice(0,jC).map((S=>{return Qe({},S,{filename:S.filename||(T=N,T[T.length-1]||{}).filename,function:S.function||sh});var T}))})(c)}})("web:javascript",H8,W8)}class q8{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var n=jn(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:n?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return ry(e,"DOMException")}isDOMError(e){return ry(e,"DOMError")}}class K8{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var n=e.message;return n.error&&typeof n.error.message=="string"?String(n.error.message):String(n)}getStack(e){return e.stacktrace||e.stack||void 0}}class Y8{constructor(){}match(e){return ry(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var n,s=t.apply(e.error);return s||{type:"ErrorEvent",value:e.message,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}var J8=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class X8{match(e){return typeof e=="string"}coerce(e,t){var n,[s,i]=this.getInfos(e);return{type:s??"Error",value:i??e,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}getInfos(e){var t="Error",n=e,s=e.match(J8);return s&&(t=s[1],n=s[2]),[t,n]}}var Q8=["fatal","error","warning","log","info","debug"];function QT(r,e){e===void 0&&(e=40);var t=Object.keys(r);if(t.sort(),!t.length)return"[object has no keys]";for(var n=t.length;n>0;n--){var s=t.slice(0,n).join(", ");if(!(s.length>e))return n===t.length||s.length<=e?s:s.slice(0,e)+"..."}return""}class Z8{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var n,s=this.getErrorPropertyFromObject(e);return s?t.apply(s):{type:this.getType(e),value:this.getValue(e),stack:(n=t.syntheticException)==null?void 0:n.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return jT(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var n=this.getObjectClassName(e);return(n&&n!=="Object"?"'"+n+"'":"Object")+" captured as exception with keys: "+QT(e)}isSeverityLevel(e){return jn(e)&&!Gw(e)&&Q8.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if(D8(n))return n}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}}class ez{match(e){return jT(e)}coerce(e,t){var n,s=e.constructor.name;return{type:s,value:s+" captured as exception with keys: "+QT(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class tz{match(e){return Ww(e)}coerce(e,t){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class rz{match(e){return ry(e,"PromiseRejectionEvent")}coerce(e,t){var n,s=this.getUnhandledRejectionReason(e);return Ww(s)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(s),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}:t.apply(s)}getUnhandledRejectionReason(e){if(Ww(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}}var ZT=function(r,e){var{debugEnabled:t}=e===void 0?{}:e,n={k:function(s){if(_e&&(Nl.DEBUG||yt.POSTHOG_DEBUG||t)&&!qe(_e.console)&&_e.console){for(var i=("__rrweb_original__"in _e.console[s])?_e.console[s].__rrweb_original__:_e.console[s],c=arguments.length,u=new Array(c>1?c-1:0),p=1;p<c;p++)u[p-1]=arguments[p];i(r,...u)}},info:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("log",...i)},warn:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("warn",...i)},error:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("error",...i)},critical:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];console.error(r,...i)},uninitializedWarning:s=>{n.error("You must initialize PostHog before calling "+s)},createLogger:(s,i)=>ZT(r+" "+s,i)};return n},Je=ZT("[PostHog.js]"),dn=Je.createLogger,nz=dn("[ExternalScriptsLoader]"),OC=(r,e,t)=>{if(r.config.disable_external_dependency_loading)return nz.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var n=Ve==null?void 0:Ve.querySelectorAll("script");if(n){for(var s,i=function(){if(n[c].src===e){var p=n[c];return p.__posthog_loading_callback_fired?{v:t()}:(p.addEventListener("load",(m=>{p.__posthog_loading_callback_fired=!0,t(void 0,m)})),p.onerror=m=>t(m),{v:void 0})}},c=0;c<n.length;c++)if(s=i())return s.v}var u=()=>{if(!Ve)return t("document not found");var p=Ve.createElement("script");if(p.type="text/javascript",p.crossOrigin="anonymous",p.src=e,p.onload=x=>{p.__posthog_loading_callback_fired=!0,t(void 0,x)},p.onerror=x=>t(x),r.config.prepare_external_dependency_script&&(p=r.config.prepare_external_dependency_script(p)),!p)return t("prepare_external_dependency_script returned null");if(r.config.external_scripts_inject_target==="head")Ve.head.appendChild(p);else{var m,g=Ve.querySelectorAll("body > script");g.length>0?(m=g[0].parentNode)==null||m.insertBefore(p,g[0]):Ve.body.appendChild(p)}};Ve!=null&&Ve.body?u():Ve==null||Ve.addEventListener("DOMContentLoaded",u)};yt.__PosthogExtensions__=yt.__PosthogExtensions__||{},yt.__PosthogExtensions__.loadExternalDependency=(r,e,t)=>{var n="/static/"+e+".js?v="+r.version;if(e==="remote-config"&&(n="/array/"+r.config.token+"/config.js"),e==="toolbar"){var s=3e5;n=n+"&t="+Math.floor(Date.now()/s)*s}var i=r.requestRouter.endpointFor("assets",n);OC(r,i,t)},yt.__PosthogExtensions__.loadSiteApp=(r,e,t)=>{var n=r.requestRouter.endpointFor("api",e);OC(r,n,t)};var sy={};function Mc(r,e,t){if(Rr(r)){if(SC&&r.forEach===SC)r.forEach(e,t);else if("length"in r&&r.length===+r.length){for(var n=0,s=r.length;n<s;n++)if(n in r&&e.call(t,r[n],n)===sy)return}}}function Vr(r,e,t){if(!or(r)){if(Rr(r))return Mc(r,e,t);if(b8(r)){for(var n of r.entries())if(e.call(t,n[1],n[0])===sy)return}else for(var s in r)if(FT.call(r,s)&&e.call(t,r[s],s)===sy)return}}var yn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Mc(t,(function(s){for(var i in s)s[i]!==void 0&&(r[i]=s[i])})),r},dh=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Mc(t,(function(s){Mc(s,(function(i){r.push(i)}))})),r};function Hv(r){for(var e=Object.keys(r),t=e.length,n=new Array(t);t--;)n[t]=[e[t],r[e[t]]];return n}var DC=function(r){try{return r()}catch{return}},sz=function(r){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}catch(s){Je.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),Je.critical(s)}}},tE=function(r){var e={};return Vr(r,(function(t,n){(jn(t)&&t.length>0||Ol(t))&&(e[n]=t)})),e};function oz(r,e){return t=r,n=i=>jn(i)&&!Vi(e)?i.slice(0,e):i,s=new Set,(function i(c,u){return c!==Object(c)?n?n(c,u):c:s.has(c)?void 0:(s.add(c),Rr(c)?(p=[],Mc(c,(m=>{p.push(i(m))}))):(p={},Vr(c,((m,g)=>{s.has(m)||(p[g]=i(m,g))}))),p);var p})(t);var t,n,s}var iz=["herokuapp.com","vercel.app","netlify.app"];function az(r){var e=r==null?void 0:r.hostname;if(!jn(e))return!1;var t=e.split(".").slice(-2).join(".");for(var n of iz)if(t===n)return!1;return!0}function eR(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return r[t]}function kn(r,e,t,n){var{capture:s=!1,passive:i=!0}=n??{};r==null||r.addEventListener(e,t,{capture:s,passive:i})}var tR="$people_distinct_id",nm="__alias",sm="__timers",LC="$autocapture_disabled_server_side",Jw="$heatmaps_enabled_server_side",MC="$exception_capture_enabled_server_side",Xw="$error_tracking_suppression_rules",$C="$error_tracking_capture_extension_exceptions",UC="$web_vitals_enabled_server_side",rR="$dead_clicks_enabled_server_side",zC="$product_tours_enabled_server_side",HC="$web_vitals_allowed_metrics",Ox="$session_recording_remote_config",oy="$sesid",nR="$session_is_sampled",Gf="$enabled_feature_flags",om="$early_access_features",Qw="$feature_flag_details",im="$stored_person_properties",Vu="$stored_group_properties",Zw="$surveys",iy="$flag_call_reported",Tl="$user_state",eb="$client_session_props",tb="$capture_rate_limit",rb="$initial_campaign_params",nb="$initial_referrer_info",ay="$initial_person_info",ly="$epp",sR="__POSTHOG_TOOLBAR__",Mp="$posthog_cookieless",lz=[tR,nm,"__cmpns",sm,"$session_recording_enabled_server_side",Jw,oy,Gf,Xw,Tl,om,Qw,Vu,im,Zw,iy,eb,tb,rb,nb,ly,ay,"$conversations_widget_session_id","$conversations_ticket_id","$conversations_widget_state","$conversations_user_traits"];function BC(r){return r instanceof Element&&(r.id===sR||!(r.closest==null||!r.closest(".toolbar-global-fade-container")))}function Wy(r){return!!r&&r.nodeType===1}function $c(r,e){return!!r&&!!r.tagName&&r.tagName.toLowerCase()===e.toLowerCase()}function oR(r){return!!r&&r.nodeType===3}function iR(r){return!!r&&r.nodeType===11}function rE(r){return r?By(r).split(/\s+/):[]}function GC(r){var e=_e==null?void 0:_e.location.href;return!!(e&&r&&r.some((t=>e.match(t))))}function cy(r){var e="";switch(typeof r.className){case"string":e=r.className;break;case"object":e=(r.className&&"baseVal"in r.className?r.className.baseVal:null)||r.getAttribute("class")||"";break;default:e=""}return rE(e)}function aR(r){return or(r)?null:By(r).split(/(\s+)/).filter((e=>jm(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function Wm(r){var e="";return sb(r)&&!fR(r)&&r.childNodes&&r.childNodes.length&&Vr(r.childNodes,(function(t){var n;oR(t)&&t.textContent&&(e+=(n=aR(t.textContent))!==null&&n!==void 0?n:"")})),By(e)}function lR(r){return qe(r.target)?r.srcElement||null:(e=r.target)!=null&&e.shadowRoot?r.composedPath()[0]||null:r.target||null;var e}var nE=["a","button","form","input","select","textarea","label"];function cR(r,e){if(qe(e))return!0;var t,n=function(i){if(e.some((c=>i.matches(c))))return{v:!0}};for(var s of r)if(t=n(s))return t.v;return!1}function uR(r){var e=r.parentNode;return!(!e||!Wy(e))&&e}var cz=["next","previous","prev",">","<"],WC=10,VC=[".ph-no-rageclick",".ph-no-capture"];function uz(r,e){if(!_e||sE(r))return!1;var t,n,s;if(Fl(e)?(t=!!e&&VC,n=void 0):(t=(s=e==null?void 0:e.css_selector_ignorelist)!==null&&s!==void 0?s:VC,n=e==null?void 0:e.content_ignorelist),t===!1)return!1;var{targetElementList:i}=dR(r,!1);return!(function(c,u){if(c===!1||qe(c))return!1;var p;if(c===!0)p=cz;else{if(!Rr(c))return!1;if(c.length>WC)return Je.error("[PostHog] content_ignorelist array cannot exceed "+WC+" items. Use css_selector_ignorelist for more complex matching."),!1;p=c.map((m=>m.toLowerCase()))}return u.some((m=>{var{safeText:g,ariaLabel:x}=m;return p.some((b=>g.includes(b)||x.includes(b)))}))})(n,i.map((c=>{var u;return{safeText:Wm(c).toLowerCase(),ariaLabel:((u=c.getAttribute("aria-label"))==null?void 0:u.toLowerCase().trim())||""}})))&&!cR(i,t)}var sE=r=>!r||$c(r,"html")||!Wy(r),dR=(r,e)=>{if(!_e||sE(r))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,n=[r],s=r;s.parentNode&&!$c(s,"body");)if(iR(s.parentNode))n.push(s.parentNode.host),s=s.parentNode.host;else{var i=uR(s);if(!i)break;if(e||nE.indexOf(i.tagName.toLowerCase())>-1)t=!0;else{var c=_e.getComputedStyle(i);c&&c.getPropertyValue("cursor")==="pointer"&&(t=!0)}n.push(i),s=i}return{parentIsUsefulElement:t,targetElementList:n}};function dz(r,e,t,n,s){var i,c,u,p;if(t===void 0&&(t=void 0),!_e||sE(r)||(i=t)!=null&&i.url_allowlist&&!GC(t.url_allowlist)||(c=t)!=null&&c.url_ignorelist&&GC(t.url_ignorelist))return!1;if((u=t)!=null&&u.dom_event_allowlist){var m=t.dom_event_allowlist;if(m&&!m.some((N=>e.type===N)))return!1}var{parentIsUsefulElement:g,targetElementList:x}=dR(r,n);if(!(function(N,S){var T=S==null?void 0:S.element_allowlist;if(qe(T))return!0;var R,A=function(P){if(T.some((U=>P.tagName.toLowerCase()===U)))return{v:!0}};for(var j of N)if(R=A(j))return R.v;return!1})(x,t)||!cR(x,(p=t)==null?void 0:p.css_selector_allowlist))return!1;var b=_e.getComputedStyle(r);if(b&&b.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var E=r.tagName.toLowerCase();switch(E){case"html":return!1;case"form":return(s||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(e.type)>=0;default:return g?(s||["click"]).indexOf(e.type)>=0:(s||["click"]).indexOf(e.type)>=0&&(nE.indexOf(E)>-1||r.getAttribute("contenteditable")==="true")}}function sb(r){for(var e=r;e.parentNode&&!$c(e,"body");e=e.parentNode){var t=cy(e);if(rr(t,"ph-sensitive")||rr(t,"ph-no-capture"))return!1}if(rr(cy(r),"ph-include"))return!0;var n=r.type||"";if(jn(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var s=r.name||r.id||"";return!(jn(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function fR(r){return!!($c(r,"input")&&!["button","checkbox","submit","reset"].includes(r.type)||$c(r,"select")||$c(r,"textarea")||r.getAttribute("contenteditable")==="true")}var hR="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",fz=new RegExp("^(?:"+hR+")$"),hz=new RegExp(hR),pR="\\d{3}-?\\d{2}-?\\d{4}",pz=new RegExp("^("+pR+")$"),mz=new RegExp("("+pR+")");function jm(r,e){return e===void 0&&(e=!0),!(or(r)||jn(r)&&(r=By(r),(e?fz:hz).test((r||"").replace(/[- ]/g,""))||(e?pz:mz).test(r)))}function mR(r){var e=Wm(r);return jm(e=(e+" "+gR(r)).trim())?e:""}function gR(r){var e="";return r&&r.childNodes&&r.childNodes.length&&Vr(r.childNodes,(function(t){var n;if(t&&((n=t.tagName)==null?void 0:n.toLowerCase())==="span")try{var s=Wm(t);e=(e+" "+s).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+gR(t)).trim())}catch(i){Je.error("[AutoCapture]",i)}})),e}function gz(r){return(function(e){var t=e.map((n=>{var s,i,c="";if(n.tag_name&&(c+=n.tag_name),n.attr_class)for(var u of(n.attr_class.sort(),n.attr_class))c+="."+u.replace(/"/g,"");var p=Qe({},n.text?{text:n.text}:{},{"nth-child":(s=n.nth_child)!==null&&s!==void 0?s:0,"nth-of-type":(i=n.nth_of_type)!==null&&i!==void 0?i:0},n.href?{href:n.href}:{},n.attr_id?{attr_id:n.attr_id}:{},n.attributes),m={};return Hv(p).sort(((g,x)=>{var[b]=g,[E]=x;return b.localeCompare(E)})).forEach((g=>{var[x,b]=g;return m[qC(x.toString())]=qC(b.toString())})),c+=":",c+=Hv(m).map((g=>{var[x,b]=g;return x+'="'+b+'"'})).join("")}));return t.join(";")})((function(e){return e.map((t=>{var n,s,i={text:(n=t.$el_text)==null?void 0:n.slice(0,400),tag_name:t.tag_name,href:(s=t.attr__href)==null?void 0:s.slice(0,2048),attr_class:vz(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Hv(t).filter((c=>{var[u]=c;return u.indexOf("attr__")===0})).forEach((c=>{var[u,p]=c;return i.attributes[u]=p})),i}))})(r))}function qC(r){return r.replace(/"|\\"/g,'\\"')}function vz(r){var e=r.attr__class;return e?Rr(e)?e:rE(e):void 0}class vR{constructor(e){this.disabled=e===!1;var t=Fn(e)?e:{};this.thresholdPx=t.threshold_px||30,this.timeoutMs=t.timeout_ms||1e3,this.clickCount=t.click_count||3,this.clicks=[]}isRageClick(e,t,n){if(this.disabled)return!1;var s=this.clicks[this.clicks.length-1];if(s&&Math.abs(e-s.x)+Math.abs(t-s.y)<this.thresholdPx&&n-s.timestamp<this.timeoutMs){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===this.clickCount)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}var uy=r=>{var e=Ve==null?void 0:Ve.createElement("a");return qe(e)?null:(e.href=r,e)},yz=function(r,e){var t,n;e===void 0&&(e="&");var s=[];return Vr(r,(function(i,c){qe(i)||qe(c)||c==="undefined"||(t=encodeURIComponent((u=>u instanceof File)(i)?i.name:i.toString()),n=encodeURIComponent(c),s[s.length]=n+"="+t)})),s.join(e)},dy=function(r,e){for(var t,n=((r.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<n.length;s++){var i=n[s].split("=");if(i[0]===e){t=i;break}}if(!Rr(t)||t.length<2)return"";var c=t[1];try{c=decodeURIComponent(c)}catch{Je.error("Skipping decoding for malformed query param: "+c)}return c.replace(/\+/g," ")},Vm=function(r,e,t){if(!r||!e||!e.length)return r;for(var n=r.split("#"),s=n[0]||"",i=n[1],c=s.split("?"),u=c[1],p=c[0],m=(u||"").split("&"),g=[],x=0;x<m.length;x++){var b=m[x].split("=");Rr(b)&&(e.includes(b[0])?g.push(b[0]+"="+t):g.push(m[x]))}var E=p;return u!=null&&(E+="?"+g.join("&")),i!=null&&(E+="#"+i),E},fy=function(r,e){var t=r.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Dx="$copy_autocapture",KC=dn("[AutoCapture]");function Lx(r,e){return e.length>r?e.slice(0,r)+"...":e}function xz(r){if(r.previousElementSibling)return r.previousElementSibling;var e=r;do e=e.previousSibling;while(e&&!Wy(e));return e}function wz(r,e,t,n){var s=r.tagName.toLowerCase(),i={tag_name:s};nE.indexOf(s)>-1&&!t&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?i.$el_text=Lx(1024,mR(r)):i.$el_text=Lx(1024,Wm(r)));var c=cy(r);c.length>0&&(i.classes=c.filter((function(g){return g!==""}))),Vr(r.attributes,(function(g){var x;if((!fR(r)||["name","id","class","aria-label"].indexOf(g.name)!==-1)&&(n==null||!n.includes(g.name))&&!e&&jm(g.value)&&(x=g.name,!jn(x)||x.substring(0,10)!=="_ngcontent"&&x.substring(0,7)!=="_nghost")){var b=g.value;g.name==="class"&&(b=rE(b).join(" ")),i["attr__"+g.name]=Lx(1024,b)}}));for(var u=1,p=1,m=r;m=xz(m);)u++,m.tagName===r.tagName&&p++;return i.nth_child=u,i.nth_of_type=p,i}function bz(r,e){for(var t,n,{e:s,maskAllElementAttributes:i,maskAllText:c,elementAttributeIgnoreList:u,elementsChainAsString:p}=e,m=[r],g=r;g.parentNode&&!$c(g,"body");)iR(g.parentNode)?(m.push(g.parentNode.host),g=g.parentNode.host):(m.push(g.parentNode),g=g.parentNode);var x,b=[],E={},N=!1,S=!1;if(Vr(m,(P=>{var U=sb(P);P.tagName.toLowerCase()==="a"&&(N=P.getAttribute("href"),N=U&&N&&jm(N)&&N),rr(cy(P),"ph-no-capture")&&(S=!0),b.push(wz(P,i,c,u));var B=(function($){if(!sb($))return{};var Y={};return Vr($.attributes,(function(J){if(J.name&&J.name.indexOf("data-ph-capture-attribute")===0){var he=J.name.replace("data-ph-capture-attribute-",""),te=J.value;he&&te&&jm(te)&&(Y[he]=te)}})),Y})(P);yn(E,B)})),S)return{props:{},explicitNoCapture:S};if(c||(r.tagName.toLowerCase()==="a"||r.tagName.toLowerCase()==="button"?b[0].$el_text=mR(r):b[0].$el_text=Wm(r)),N){var T,R;b[0].attr__href=N;var A=(T=uy(N))==null?void 0:T.host,j=_e==null||(R=_e.location)==null?void 0:R.host;A&&j&&A!==j&&(x=N)}return{props:yn({$event_type:s.type,$ce_version:1},p?{}:{$elements:b},{$elements_chain:gz(b)},(t=b[0])!=null&&t.$el_text?{$el_text:(n=b[0])==null?void 0:n.$el_text}:{},x&&s.type==="click"?{$external_click_url:x}:{},E)}}class _z{constructor(e){this.P=!1,this.T=null,this.I=!1,this.instance=e,this.rageclicks=new vR(e.config.rageclick),this.C=null}get R(){var e,t,n=Fn(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=(e=n.url_allowlist)==null?void 0:e.map((s=>new RegExp(s))),n.url_ignorelist=(t=n.url_ignorelist)==null?void 0:t.map((s=>new RegExp(s))),n}F(){if(this.isBrowserSupported()){if(_e&&Ve){var e=n=>{n=n||(_e==null?void 0:_e.event);try{this.O(n)}catch(s){KC.error("Failed to capture event",s)}};if(kn(Ve,"submit",e,{capture:!0}),kn(Ve,"change",e,{capture:!0}),kn(Ve,"click",e,{capture:!0}),this.R.capture_copied_text){var t=n=>{n=n||(_e==null?void 0:_e.event),this.O(n,Dx)};kn(Ve,"copy",t,{capture:!0}),kn(Ve,"cut",t,{capture:!0})}}}else KC.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.F(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.I=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[LC]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.C=e}getElementSelectors(e){var t,n=[];return(t=this.C)==null||t.forEach((s=>{var i=Ve==null?void 0:Ve.querySelectorAll(s);i==null||i.forEach((c=>{e===c&&n.push(s)}))})),n}get isEnabled(){var e,t,n=(e=this.instance.persistence)==null?void 0:e.props[LC],s=this.T;if(Vi(s)&&!Fl(n)&&!this.instance.M())return!1;var i=(t=this.T)!==null&&t!==void 0?t:!!n;return!!this.instance.config.autocapture&&!i}O(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var n,s=lR(e);oR(s)&&(s=s.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,e.timeStamp||new Date().getTime())&&uz(s,this.instance.config.rageclick)&&this.O(e,"$rageclick");var i=t===Dx;if(s&&dz(s,e,this.R,i,i?["copy","cut"]:void 0)){var{props:c,explicitNoCapture:u}=bz(s,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.R.element_attribute_ignorelist,elementsChainAsString:this.I});if(u)return!1;var p=this.getElementSelectors(s);if(p&&p.length>0&&(c.$element_selectors=p),t===Dx){var m,g=aR(_e==null||(m=_e.getSelection())==null?void 0:m.toString()),x=e.type||"clipboard";if(!g)return!1;c.$selected_content=g,c.$copy_type=x}return this.instance.capture(t,c),!0}}}isBrowserSupported(){return Lc(Ve==null?void 0:Ve.querySelectorAll)}}Math.trunc||(Math.trunc=function(r){return r<0?Math.ceil(r):Math.floor(r)}),Number.isInteger||(Number.isInteger=function(r){return Ol(r)&&isFinite(r)&&Math.floor(r)===r});var YC="0123456789abcdef";class hy{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(s)||e<0||t<0||n<0||s<0||e>0xffffffffffff||t>4095||n>1073741823||s>4294967295)throw new RangeError("invalid field value");var i=new Uint8Array(16);return i[0]=e/Math.pow(2,40),i[1]=e/Math.pow(2,32),i[2]=e/Math.pow(2,24),i[3]=e/Math.pow(2,16),i[4]=e/Math.pow(2,8),i[5]=e,i[6]=112|t>>>8,i[7]=t,i[8]=128|n>>>24,i[9]=n>>>16,i[10]=n>>>8,i[11]=n,i[12]=s>>>24,i[13]=s>>>16,i[14]=s>>>8,i[15]=s,new hy(i)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+YC.charAt(this.bytes[t]>>>4)+YC.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new hy(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}}class Ez{constructor(){this.A=0,this.j=0,this.D=new Sz}generate(){var e=this.generateOrAbort();if(qe(e)){this.A=0;var t=this.generateOrAbort();if(qe(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.j++,this.j>4398046511103&&(this.A++,this.L())}return hy.fromFieldsV7(this.A,Math.trunc(this.j/Math.pow(2,30)),this.j&Math.pow(2,30)-1,this.D.nextUint32())}L(){this.j=1024*this.D.nextUint32()+(1023&this.D.nextUint32())}}var JC,yR=r=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<r.length;e++)r[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return r};_e&&!qe(_e.crypto)&&crypto.getRandomValues&&(yR=r=>crypto.getRandomValues(r));class Sz{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(yR(this.N),this.U=0),this.N[this.U++]}}var Oc=()=>Cz().toString(),Cz=()=>(JC||(JC=new Ez)).generate(),$p="",kz=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Nz(r,e){if(e){var t=(function(s,i){if(i===void 0&&(i=Ve),$p)return $p;if(!i||["localhost","127.0.0.1"].includes(s))return"";for(var c=s.split("."),u=Math.min(c.length,8),p="dmn_chk_"+Oc();!$p&&u--;){var m=c.slice(u).join("."),g=p+"=1;domain=."+m+";path=/";i.cookie=g+";max-age=3",i.cookie.includes(p)&&(i.cookie=g+";max-age=0",$p=m)}return $p})(r);if(!t){var n=(s=>{var i=s.match(kz);return i?i[0]:""})(r);n!==t&&Je.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var Da={H:()=>!!Ve,B:function(r){Je.error("cookieStore error: "+r)},q:function(r){if(Ve){try{for(var e=r+"=",t=Ve.cookie.split(";").filter((i=>i.length)),n=0;n<t.length;n++){for(var s=t[n];s.charAt(0)==" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return decodeURIComponent(s.substring(e.length,s.length))}}catch{}return null}},W:function(r){var e;try{e=JSON.parse(Da.q(r))||{}}catch{}return e},G:function(r,e,t,n,s){if(Ve)try{var i="",c="",u=Nz(Ve.location.hostname,n);if(t){var p=new Date;p.setTime(p.getTime()+24*t*60*60*1e3),i="; expires="+p.toUTCString()}s&&(c="; secure");var m=r+"="+encodeURIComponent(JSON.stringify(e))+i+"; SameSite=Lax; path=/"+u+c;return m.length>3686.4&&Je.warn("cookieStore warning: large cookie, len="+m.length),Ve.cookie=m,m}catch{return}},V:function(r,e){if(Ve!=null&&Ve.cookie)try{Da.G(r,"",-1,e)}catch{return}}},Mx=null,on={H:function(){if(!Vi(Mx))return Mx;var r=!0;if(qe(_e))r=!1;else try{var e="__mplssupport__";on.G(e,"xyz"),on.q(e)!=='"xyz"'&&(r=!1),on.V(e)}catch{r=!1}return r||Je.error("localStorage unsupported; falling back to cookie store"),Mx=r,r},B:function(r){Je.error("localStorage error: "+r)},q:function(r){try{return _e==null?void 0:_e.localStorage.getItem(r)}catch(e){on.B(e)}return null},W:function(r){try{return JSON.parse(on.q(r))||{}}catch{}return null},G:function(r,e){try{_e==null||_e.localStorage.setItem(r,JSON.stringify(e))}catch(t){on.B(t)}},V:function(r){try{_e==null||_e.localStorage.removeItem(r)}catch(e){on.B(e)}}},Tz=["$device_id","distinct_id",oy,nR,ly,ay],xv={},Rz={H:function(){return!0},B:function(r){Je.error("memoryStorage error: "+r)},q:function(r){return xv[r]||null},W:function(r){return xv[r]||null},G:function(r,e){xv[r]=e},V:function(r){delete xv[r]}},zu=null,rs={H:function(){if(!Vi(zu))return zu;if(zu=!0,qe(_e))zu=!1;else try{var r="__support__";rs.G(r,"xyz"),rs.q(r)!=='"xyz"'&&(zu=!1),rs.V(r)}catch{zu=!1}return zu},B:function(r){Je.error("sessionStorage error: ",r)},q:function(r){try{return _e==null?void 0:_e.sessionStorage.getItem(r)}catch(e){rs.B(e)}return null},W:function(r){try{return JSON.parse(rs.q(r))||null}catch{}return null},G:function(r,e){try{_e==null||_e.sessionStorage.setItem(r,JSON.stringify(e))}catch(t){rs.B(t)}},V:function(r){try{_e==null||_e.sessionStorage.removeItem(r)}catch(e){rs.B(e)}}},Rl=(function(r){return r[r.PENDING=-1]="PENDING",r[r.DENIED=0]="DENIED",r[r.GRANTED=1]="GRANTED",r})({});class Az{constructor(e){this._instance=e}get R(){return this._instance.config}get consent(){return this.J()?Rl.DENIED:this.K}isOptedOut(){return this.R.cookieless_mode==="always"||this.consent===Rl.DENIED||this.consent===Rl.PENDING&&(this.R.opt_out_capturing_by_default||this.R.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===Rl.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.R.cookie_expiration,this.R.cross_subdomain_cookie,this.R.secure_cookie)}reset(){this.Y.V(this.X,this.R.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:n}=this._instance.config;return n||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return Px(e)?Rl.GRANTED:rr(S8,e)?Rl.DENIED:Rl.PENDING}get Y(){if(!this.Z){var e=this.R.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?on:Da;var t=e==="localStorage"?Da:on;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(Px(t.q(this.X))),t.V(this.X,this.R.cross_subdomain_cookie))}return this.Z}J(){return!!this.R.respect_dnt&&!!eR([Mo==null?void 0:Mo.doNotTrack,Mo==null?void 0:Mo.msDoNotTrack,yt.doNotTrack],(e=>Px(e)))}}var wv=dn("[Dead Clicks]"),Iz=()=>!0,Pz=r=>{var e,t=!((e=r.instance.persistence)==null||!e.get_property(rR)),n=r.instance.config.capture_dead_clicks;return Fl(n)?n:!!Fn(n)||t};class xR{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[rR]:e==null?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it((()=>{this.et()}))}it(e){var t,n;(t=yt.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(n=yt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"dead-clicks-autocapture",(s=>{s?wv.error("failed to load script",s):e()}))}et(){var e;if(Ve){if(!this.tt&&(e=yt.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=Fn(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=yt.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(Ve),wv.info("starting...")}}else wv.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,wv.info("stopping..."))}}var Up=dn("[ExceptionAutocapture]");class Fz{constructor(e){var t,n,s;this.rt=()=>{var i;if(_e&&this.isEnabled&&(i=yt.__PosthogExtensions__)!=null&&i.errorWrappingFunctions){var c=yt.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,u=yt.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,p=yt.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.R.capture_unhandled_errors&&(this.st=c(this.captureException.bind(this))),!this.nt&&this.R.capture_unhandled_rejections&&(this.nt=u(this.captureException.bind(this))),!this.ot&&this.R.capture_console_errors&&(this.ot=p(this.captureException.bind(this)))}catch(m){Up.error("failed to start",m),this.ut()}}},this._instance=e,this.ht=!((t=this._instance.persistence)==null||!t.props[MC]),this.dt=new C8({refillRate:(n=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&n!==void 0?n:1,bucketSize:(s=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&s!==void 0?s:10,refillInterval:1e4,h:Up}),this.R=this.vt(),this.startIfEnabledOrStop()}vt(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return Fn(e)?t=Qe({},t,e):(qe(e)?this.ht:e)&&(t=Qe({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.R.capture_console_errors||this.R.capture_unhandled_errors||this.R.capture_unhandled_rejections}startIfEnabledOrStop(){this.isEnabled?(Up.info("enabled"),this.ut(),this.it(this.rt)):this.ut()}it(e){var t,n;(t=yt.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(n=yt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"exception-autocapture",(s=>{if(s)return Up.error("failed to load script",s);e()}))}ut(){var e,t,n;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(n=this.ot)==null||n.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ht=!!t||!1,this._instance.persistence&&this._instance.persistence.register({[MC]:this.ht}),this.R=this.vt(),this.startIfEnabledOrStop()}onConfigChange(){this.R=this.vt()}captureException(e){var t,n,s=(t=e==null||(n=e.$exception_list)==null||(n=n[0])==null?void 0:n.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(s)?Up.info("Skipping exception capture because of client rate limiting.",{exception:s}):this._instance.exceptions.sendExceptionEvent(e)}}function XC(r,e,t){try{if(!(e in r))return()=>{};var n=r[e],s=t(n);return Lc(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),r[e]=s,()=>{r[e]=n}}catch{return()=>{}}}class jz{constructor(e){var t;this._instance=e,this.ct=(_e==null||(t=_e.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(Je.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ft&&this.ft(),this.ft=void 0,Je.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(_e&&_e.history){var n=this;(e=_e.history.pushState)!=null&&e.__posthog_wrapped__||XC(_e.history,"pushState",(s=>function(i,c,u){s.call(this,i,c,u),n._t("pushState")})),(t=_e.history.replaceState)!=null&&t.__posthog_wrapped__||XC(_e.history,"replaceState",(s=>function(i,c,u){s.call(this,i,c,u),n._t("replaceState")})),this.bt()}}_t(e){try{var t,n=_e==null||(t=_e.location)==null?void 0:t.pathname;if(!n)return;n!==this.ct&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ct=n}catch(s){Je.error("Error capturing "+e+" pageview",s)}}bt(){if(!this.ft){var e=()=>{this._t("popstate")};kn(_e,"popstate",e),this.ft=()=>{_e&&_e.removeEventListener("popstate",e)}}}}var $x=dn("[SegmentIntegration]");function Oz(r,e){var t=r.config.segment;if(!t)return e();(function(n,s){var i=n.config.segment;if(!i)return s();var c=p=>{var m=()=>p.anonymousId()||Oc();n.config.get_device_id=m,p.id()&&(n.register({distinct_id:p.id(),$device_id:m()}),n.persistence.set_property(Tl,"identified")),s()},u=i.user();"then"in u&&Lc(u.then)?u.then(c):c(u)})(r,(()=>{t.register((n=>{Promise&&Promise.resolve||$x.warn("This browser does not have Promise support, and can not use the segment integration");var s=(i,c)=>{if(!c)return i;i.event.userId||i.event.anonymousId===n.get_distinct_id()||($x.info("No userId set, resetting PostHog"),n.reset()),i.event.userId&&i.event.userId!==n.get_distinct_id()&&($x.info("UserId set, identifying with PostHog"),n.identify(i.event.userId));var u=n.calculateEventProperties(c,i.event.properties);return i.event.properties=Object.assign({},u,i.event.properties),i};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:i=>s(i,i.event.event),page:i=>s(i,"$pageview"),identify:i=>s(i,"$identify"),screen:i=>s(i,"$screen")}})(r)).then((()=>{e()}))}))}var wR="posthog-js";function bR(r,e){var{organization:t,projectId:n,prefix:s,severityAllowList:i=["error"],sendExceptionsToPostHog:c=!0}=e===void 0?{}:e;return u=>{var p,m,g,x,b;if(!(i==="*"||i.includes(u.level))||!r.__loaded)return u;u.tags||(u.tags={});var E=r.requestRouter.endpointFor("ui","/project/"+r.config.token+"/person/"+r.get_distinct_id());u.tags["PostHog Person URL"]=E,r.sessionRecordingStarted()&&(u.tags["PostHog Recording URL"]=r.get_session_replay_url({withTimestamp:!0}));var N=((p=u.exception)==null?void 0:p.values)||[],S=N.map((R=>Qe({},R,{stacktrace:R.stacktrace?Qe({},R.stacktrace,{type:"raw",frames:(R.stacktrace.frames||[]).map((A=>Qe({},A,{platform:"web:javascript"})))}):void 0}))),T={$exception_message:((m=N[0])==null?void 0:m.value)||u.message,$exception_type:(g=N[0])==null?void 0:g.type,$exception_level:u.level,$exception_list:S,$sentry_event_id:u.event_id,$sentry_exception:u.exception,$sentry_exception_message:((x=N[0])==null?void 0:x.value)||u.message,$sentry_exception_type:(b=N[0])==null?void 0:b.type,$sentry_tags:u.tags};return t&&n&&(T.$sentry_url=(s||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+u.event_id),c&&r.exceptions.sendExceptionEvent(T),u}}class Dz{constructor(e,t,n,s,i,c){this.name=wR,this.setupOnce=function(u){u(bR(e,{organization:t,projectId:n,prefix:s,severityAllowList:i,sendExceptionsToPostHog:c==null||c}))}}}var Lz=_e!=null&&_e.location?fy(_e.location.hash,"__posthog")||fy(location.hash,"state"):null,QC="_postHogToolbarParams",ZC=dn("[Toolbar]"),Ac=(function(r){return r[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED",r})(Ac||{});class Mz{constructor(e){this.instance=e}yt(e){yt.ph_toolbar_state=e}wt(){var e;return(e=yt.ph_toolbar_state)!==null&&e!==void 0?e:Ac.UNINITIALIZED}maybeLoadToolbar(e,t,n){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),!_e||!Ve)return!1;e=e??_e.location,n=n??_e.history;try{if(!t){try{_e.localStorage.setItem("test","test"),_e.localStorage.removeItem("test")}catch{return!1}t=_e==null?void 0:_e.localStorage}var s,i=Lz||fy(e.hash,"__posthog")||fy(e.hash,"state"),c=i?DC((()=>JSON.parse(atob(decodeURIComponent(i)))))||DC((()=>JSON.parse(decodeURIComponent(i)))):null;return c&&c.action==="ph_authorize"?((s=c).source="url",s&&Object.keys(s).length>0&&(c.desiredHash?e.hash=c.desiredHash:n?n.replaceState(n.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(t.getItem(QC)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch{return!1}}xt(e){var t=yt.ph_load_toolbar||yt.ph_load_editor;!or(t)&&Lc(t)?t(e,this.instance):ZC.warn("No toolbar load function found")}loadToolbar(e){var t=!(Ve==null||!Ve.getElementById(sR));if(!_e||t)return!1;var n=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=Qe({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(_e.localStorage.setItem(QC,JSON.stringify(Qe({},s,{source:void 0}))),this.wt()===Ac.LOADED)this.xt(s);else if(this.wt()===Ac.UNINITIALIZED){var i;this.yt(Ac.LOADING),(i=yt.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"toolbar",(c=>{if(c)return ZC.error("[Toolbar] Failed to load",c),void this.yt(Ac.UNINITIALIZED);this.yt(Ac.LOADED),this.xt(s)})),kn(_e,"turbolinks:load",(()=>{this.yt(Ac.UNINITIALIZED),this.loadToolbar(s)}))}return!0}Et(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,n){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),this.maybeLoadToolbar(e,t,n)}}var $z=dn("[TracingHeaders]");class Uz{constructor(e){this.$t=void 0,this.St=void 0,this.rt=()=>{var t,n;qe(this.$t)&&((t=yt.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),qe(this.St)&&((n=yt.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,n;(t=yt.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(n=yt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"tracing-headers",(s=>{if(s)return $z.error("failed to load script",s);e()}))}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.$t)==null||e.call(this),(t=this.St)==null||t.call(this),this.$t=void 0,this.St=void 0)}}var bv="https?://(.*)",fh=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],zz=dh(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],fh),qm="<masked>",Hz=["li_fat_id"];function _R(r,e,t){if(!Ve)return{};var n,s=e?dh([],fh,t||[]):[],i=ER(Vm(Ve.URL,s,qm),r),c=(n={},Vr(Hz,(function(u){var p=Da.q(u);n[u]=p||null})),n);return yn(c,i)}function ER(r,e){var t=zz.concat(e||[]),n={};return Vr(t,(function(s){var i=dy(r,s);n[s]=i||null})),n}function SR(r){var e=(function(i){return i?i.search(bv+"google.([^/?]*)")===0?"google":i.search(bv+"bing.com")===0?"bing":i.search(bv+"yahoo.com")===0?"yahoo":i.search(bv+"duckduckgo.com")===0?"duckduckgo":null:null})(r),t=e!="yahoo"?"q":"p",n={};if(!Vi(e)){n.$search_engine=e;var s=Ve?dy(Ve.referrer,t):"";s.length&&(n.ph_keyword=s)}return n}function ek(){return navigator.language||navigator.userLanguage}function CR(){return(Ve==null?void 0:Ve.referrer)||"$direct"}function kR(r,e){var t=r?dh([],fh,e||[]):[],n=ss==null?void 0:ss.href.substring(0,1e3);return{r:CR().substring(0,1e3),u:n?Vm(n,t,qm):void 0}}function NR(r){var e,{r:t,u:n}=r,s={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=uy(t))==null?void 0:e.host};if(n){s.$current_url=n;var i=uy(n);s.$host=i==null?void 0:i.host,s.$pathname=i==null?void 0:i.pathname;var c=ER(n);yn(s,c)}if(t){var u=SR(t);yn(s,u)}return s}function TR(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function Bz(){try{return new Date().getTimezoneOffset()}catch{return}}function Gz(r,e){if(!vo)return{};var t,n,s,i=r?dh([],fh,e||[]):[],[c,u]=(function(p){for(var m=0;m<IC.length;m++){var[g,x]=IC[m],b=g.exec(p),E=b&&(Lc(x)?x(b,p):x);if(E)return E}return["",""]})(vo);return yn(tE({$os:c,$os_version:u,$browser:JT(vo,navigator.vendor),$device:PC(vo),$device_type:(n=vo,s=PC(n),s===DT||s===OT||s==="Kobo"||s==="Kindle Fire"||s===YT?Am:s===Pm||s===Yf||s===Fm||s===qw?"Console":s===MT?"Wearable":s?ui:"Desktop"),$timezone:TR(),$timezone_offset:Bz()}),{$current_url:Vm(ss==null?void 0:ss.href,i,qm),$host:ss==null?void 0:ss.host,$pathname:ss==null?void 0:ss.pathname,$raw_user_agent:vo.length>1e3?vo.substring(0,997)+"...":vo,$browser_version:O8(vo,navigator.vendor),$browser_language:ek(),$browser_language_prefix:(t=ek(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:_e==null?void 0:_e.screen.height,$screen_width:_e==null?void 0:_e.screen.width,$viewport_height:_e==null?void 0:_e.innerHeight,$viewport_width:_e==null?void 0:_e.innerWidth,$lib:"web",$lib_version:Nl.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var kc=dn("[Web Vitals]"),tk=9e5;class Wz{constructor(e){var t;this.kt=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Pt=()=>{clearTimeout(this.Tt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce(((n,s)=>Qe({},n,{["$web_vitals_"+s.name+"_event"]:Qe({},s),["$web_vitals_"+s.name+"_value"]:s.value})),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.It=n=>{var s,i=(s=this._instance.sessionManager)==null?void 0:s.checkAndGetSessionAndWindowId(!0);if(qe(i))kc.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var c=this.Ct();qe(c)||(or(n==null?void 0:n.name)||or(n==null?void 0:n.value)?kc.error("Invalid metric received",n):this.Rt&&n.value>=this.Rt?kc.error("Ignoring metric with value >= "+this.Rt,n):(this.N.url!==c&&(this.Pt(),this.Tt=setTimeout(this.Pt,this.flushToCaptureTimeoutMs)),qe(this.N.url)&&(this.N.url=c),this.N.firstMetricTimestamp=qe(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,n.attribution&&n.attribution.interactionTargetElement&&(n.attribution.interactionTargetElement=void 0),this.N.metrics.push(Qe({},n,{$current_url:c,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.Pt()))}},this.rt=()=>{if(!this.P){var n,s,i,c,u=yt.__PosthogExtensions__;qe(u)||qe(u.postHogWebVitalsCallbacks)||({onLCP:n,onCLS:s,onFCP:i,onINP:c}=u.postHogWebVitalsCallbacks),n&&s&&i&&c?(this.allowedMetrics.indexOf("LCP")>-1&&n(this.It.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this.It.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this.It.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&c(this.It.bind(this)),this.P=!0):kc.error("web vitals callbacks not loaded - not starting")}},this._instance=e,this.kt=!((t=this._instance.persistence)==null||!t.props[UC]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=Fn(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return or(n)?((t=this._instance.persistence)==null?void 0:t.props[HC])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(Fn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get useAttribution(){var e=Fn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_attribution:void 0;return e!=null&&e}get Rt(){var e=Fn(this._instance.config.capture_performance)&&Ol(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:tk;return 0<e&&e<=6e4?tk:e}get isEnabled(){var e=ss==null?void 0:ss.protocol;if(e!=="http:"&&e!=="https:")return kc.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=Fn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Fl(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Fl(t)?t:this.kt}startIfEnabled(){this.isEnabled&&!this.P&&(kc.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=Fn(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=Fn(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[UC]:t}),this._instance.persistence.register({[HC]:n})),this.kt=t,this.startIfEnabled()}it(e){var t,n;if((t=yt.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks)e();else{var s=this.useAttribution?"web-vitals-with-attribution":"web-vitals";(n=yt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,s,(i=>{i?kc.error("failed to load script",i):e()}))}}Ct(){var e=_e?_e.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,n=this._instance.config.custom_personal_data_properties,s=t?dh([],fh,n||[]):[];return Vm(e,s,qm)}kc.error("Could not determine current URL")}}var Vz=dn("[Heatmaps]");function rk(r){return Fn(r)&&"clientX"in r&&"clientY"in r&&Ol(r.clientX)&&Ol(r.clientY)}class qz{constructor(e){var t;this.kt=!1,this.P=!1,this.Ft=null,this.instance=e,this.kt=!((t=this.instance.persistence)==null||!t.props[Jw]),this.rageclicks=new vR(e.config.rageclick)}get flushIntervalMilliseconds(){var e=5e3;return Fn(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return or(this.instance.config.capture_heatmaps)?or(this.instance.config.enable_heatmaps)?this.kt:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;Vz.info("starting..."),this.Ot(),this.Mt()}else{var e;clearInterval((e=this.Ft)!==null&&e!==void 0?e:void 0),this.At(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Jw]:t}),this.kt=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}jt(e){this.Dt(e.originalEvent,"deadclick")}Mt(){this.Ft&&clearInterval(this.Ft),this.Ft=(function(e){return(e==null?void 0:e.visibilityState)==="visible"})(Ve)?setInterval(this.Lt.bind(this),this.flushIntervalMilliseconds):null}Ot(){_e&&Ve&&(this.Nt=this.Lt.bind(this),kn(_e,"beforeunload",this.Nt),this.Ut=e=>this.Dt(e||(_e==null?void 0:_e.event)),kn(Ve,"click",this.Ut,{capture:!0}),this.zt=e=>this.Ht(e||(_e==null?void 0:_e.event)),kn(Ve,"mousemove",this.zt,{capture:!0}),this.Bt=new xR(this.instance,Iz,this.jt.bind(this)),this.Bt.startIfEnabled(),this.qt=this.Mt.bind(this),kn(Ve,"visibilitychange",this.qt),this.P=!0)}At(){var e;_e&&Ve&&(this.Nt&&_e.removeEventListener("beforeunload",this.Nt),this.Ut&&Ve.removeEventListener("click",this.Ut,{capture:!0}),this.zt&&Ve.removeEventListener("mousemove",this.zt,{capture:!0}),this.qt&&Ve.removeEventListener("visibilitychange",this.qt),clearTimeout(this.Wt),(e=this.Bt)==null||e.stop(),this.P=!1)}Gt(e,t){var n=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),i=this.instance.scrollManager.scrollElement(),c=(function(u,p,m){for(var g=u;g&&Wy(g)&&!$c(g,"body");){if(g===m)return!1;if(rr(p,_e==null?void 0:_e.getComputedStyle(g).position))return!0;g=uR(g)}return!1})(lR(e),["fixed","sticky"],i);return{x:e.clientX+(c?0:s),y:e.clientY+(c?0:n),target_fixed:c,type:t}}Dt(e,t){var n;if(t===void 0&&(t="click"),!BC(e.target)&&rk(e)){var s=this.Gt(e,t);(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Vt(Qe({},s,{type:"rageclick"})),this.Vt(s)}}Ht(e){!BC(e.target)&&rk(e)&&(clearTimeout(this.Wt),this.Wt=setTimeout((()=>{this.Vt(this.Gt(e,"mousemove"))}),500))}Vt(e){if(_e){var t=_e.location.href,n=this.instance.config.mask_personal_data_properties,s=this.instance.config.custom_personal_data_properties,i=n?dh([],fh,s||[]):[],c=Vm(t,i,qm);this.N=this.N||{},this.N[c]||(this.N[c]=[]),this.N[c].push(e)}}Lt(){this.N&&!Bf(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class nk{constructor(e){this.Jt=(t,n,s)=>{s&&(s.noSessionId||s.activityTimeout||s.sessionPastMaximumLength)&&(Je.info("[PageViewManager] Session rotated, clearing pageview state",{sessionId:t,changeReason:s}),this.Kt=void 0,this._instance.scrollManager.resetContext())},this._instance=e,this.Yt()}Yt(){var e;this.Xt=(e=this._instance.sessionManager)==null?void 0:e.onSessionId(this.Jt)}destroy(){var e;(e=this.Xt)==null||e.call(this),this.Xt=void 0}doPageView(e,t){var n,s=this.Qt(e,t);return this.Kt={pathname:(n=_e==null?void 0:_e.location.pathname)!==null&&n!==void 0?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(e){var t;return this.Qt(e,(t=this.Kt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Kt)==null?void 0:e.pageViewId}}Qt(e,t){var n=this.Kt;if(!n)return{$pageview_id:t};var s={$pageview_id:t,$prev_pageview_id:n.pageViewId},i=this._instance.scrollManager.getContext();if(i&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:c,lastScrollY:u,maxScrollY:p,maxContentHeight:m,lastContentY:g,maxContentY:x}=i;if(!(qe(c)||qe(u)||qe(p)||qe(m)||qe(g)||qe(x))){c=Math.ceil(c),u=Math.ceil(u),p=Math.ceil(p),m=Math.ceil(m),g=Math.ceil(g),x=Math.ceil(x);var b=c<=1?1:$a(u/c,0,1,Je),E=c<=1?1:$a(p/c,0,1,Je),N=m<=1?1:$a(g/m,0,1,Je),S=m<=1?1:$a(x/m,0,1,Je);s=yn(s,{$prev_pageview_last_scroll:u,$prev_pageview_last_scroll_percentage:b,$prev_pageview_max_scroll:p,$prev_pageview_max_scroll_percentage:E,$prev_pageview_last_content:g,$prev_pageview_last_content_percentage:N,$prev_pageview_max_content:x,$prev_pageview_max_content_percentage:S})}}return n.pathname&&(s.$prev_pageview_pathname=n.pathname),n.timestamp&&(s.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),s}}var Al=(function(r){return r.GZipJS="gzip-js",r.Base64="base64",r})({}),di=Uint8Array,yo=Uint16Array,oh=Uint32Array,oE=new di([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),iE=new di([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),sk=new di([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),RR=function(r,e){for(var t=new yo(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];var s=new oh(t[30]);for(n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)s[i]=i-t[n]<<5|n;return[t,s]},AR=RR(oE,2),Kz=AR[0],ob=AR[1];Kz[28]=258,ob[258]=28;for(var ok=RR(iE,0)[1],IR=new yo(32768),Zr=0;Zr<32768;++Zr){var Hu=(43690&Zr)>>>1|(21845&Zr)<<1;Hu=(61680&(Hu=(52428&Hu)>>>2|(13107&Hu)<<2))>>>4|(3855&Hu)<<4,IR[Zr]=((65280&Hu)>>>8|(255&Hu)<<8)>>>1}var mm=function(r,e,t){for(var n=r.length,s=0,i=new yo(e);s<n;++s)++i[r[s]-1];var c,u=new yo(e);for(s=0;s<e;++s)u[s]=u[s-1]+i[s-1]<<1;for(c=new yo(n),s=0;s<n;++s)c[s]=IR[u[r[s]-1]++]>>>15-r[s];return c},ed=new di(288);for(Zr=0;Zr<144;++Zr)ed[Zr]=8;for(Zr=144;Zr<256;++Zr)ed[Zr]=9;for(Zr=256;Zr<280;++Zr)ed[Zr]=7;for(Zr=280;Zr<288;++Zr)ed[Zr]=8;var py=new di(32);for(Zr=0;Zr<32;++Zr)py[Zr]=5;var Yz=mm(ed,9),Jz=mm(py,5),PR=function(r){return(r/8>>0)+(7&r&&1)},FR=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var n=new(r instanceof yo?yo:r instanceof oh?oh:di)(t-e);return n.set(r.subarray(e,t)),n},El=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8},zp=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8,r[n+2]|=t>>>16},Ux=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,i=t.slice();if(!s)return[new di(0),0];if(s==1){var c=new di(t[0].s+1);return c[t[0].s]=1,[c,1]}t.sort((function(U,B){return U.f-B.f})),t.push({s:-1,f:25001});var u=t[0],p=t[1],m=0,g=1,x=2;for(t[0]={s:-1,f:u.f+p.f,l:u,r:p};g!=s-1;)u=t[t[m].f<t[x].f?m++:x++],p=t[m!=g&&t[m].f<t[x].f?m++:x++],t[g++]={s:-1,f:u.f+p.f,l:u,r:p};var b=i[0].s;for(n=1;n<s;++n)i[n].s>b&&(b=i[n].s);var E=new yo(b+1),N=ib(t[g-1],E,0);if(N>e){n=0;var S=0,T=N-e,R=1<<T;for(i.sort((function(U,B){return E[B.s]-E[U.s]||U.f-B.f}));n<s;++n){var A=i[n].s;if(!(E[A]>e))break;S+=R-(1<<N-E[A]),E[A]=e}for(S>>>=T;S>0;){var j=i[n].s;E[j]<e?S-=1<<e-E[j]++-1:++n}for(;n>=0&&S;--n){var P=i[n].s;E[P]==e&&(--E[P],++S)}N=e}return[new di(E),N]},ib=function(r,e,t){return r.s==-1?Math.max(ib(r.l,e,t+1),ib(r.r,e,t+1)):e[r.s]=t},ik=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new yo(++e),n=0,s=r[0],i=1,c=function(p){t[n++]=p},u=1;u<=e;++u)if(r[u]==s&&u!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)c(32754);i>2&&(c(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(c(s),--i;i>6;i-=6)c(8304);i>2&&(c(i-3<<5|8208),i=0)}for(;i--;)c(s);i=1,s=r[u]}return[t.subarray(0,n),e]},Hp=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},ab=function(r,e,t){var n=t.length,s=PR(e+2);r[s]=255&n,r[s+1]=n>>>8,r[s+2]=255^r[s],r[s+3]=255^r[s+1];for(var i=0;i<n;++i)r[s+i+4]=t[i];return 8*(s+4+n)},ak=function(r,e,t,n,s,i,c,u,p,m,g){El(e,g++,t),++s[256];for(var x=Ux(s,15),b=x[0],E=x[1],N=Ux(i,15),S=N[0],T=N[1],R=ik(b),A=R[0],j=R[1],P=ik(S),U=P[0],B=P[1],$=new yo(19),Y=0;Y<A.length;++Y)$[31&A[Y]]++;for(Y=0;Y<U.length;++Y)$[31&U[Y]]++;for(var J=Ux($,7),he=J[0],te=J[1],ue=19;ue>4&&!he[sk[ue-1]];--ue);var we,ie,se,pe,ee=m+5<<3,G=Hp(s,ed)+Hp(i,py)+c,z=Hp(s,b)+Hp(i,S)+c+14+3*ue+Hp($,he)+(2*$[16]+3*$[17]+7*$[18]);if(ee<=G&&ee<=z)return ab(e,g,r.subarray(p,p+m));if(El(e,g,1+(z<G)),g+=2,z<G){we=mm(b,E),ie=b,se=mm(S,T),pe=S;var K=mm(he,te);for(El(e,g,j-257),El(e,g+5,B-1),El(e,g+10,ue-4),g+=14,Y=0;Y<ue;++Y)El(e,g+3*Y,he[sk[Y]]);g+=3*ue;for(var D=[A,U],M=0;M<2;++M){var oe=D[M];for(Y=0;Y<oe.length;++Y){var Ee=31&oe[Y];El(e,g,K[Ee]),g+=he[Ee],Ee>15&&(El(e,g,oe[Y]>>>5&127),g+=oe[Y]>>>12)}}}else we=Yz,ie=ed,se=Jz,pe=py;for(Y=0;Y<u;++Y)if(n[Y]>255){Ee=n[Y]>>>18&31,zp(e,g,we[Ee+257]),g+=ie[Ee+257],Ee>7&&(El(e,g,n[Y]>>>23&31),g+=oE[Ee]);var V=31&n[Y];zp(e,g,se[V]),g+=pe[V],V>3&&(zp(e,g,n[Y]>>>5&8191),g+=iE[V])}else zp(e,g,we[n[Y]]),g+=ie[n[Y]];return zp(e,g,we[256]),g+ie[256]},Xz=new oh([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Qz=(function(){for(var r=new oh(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;r[e]=t}return r})(),Zz=function(r,e,t,n,s){return(function(i,c,u,p,m,g){var x=i.length,b=new di(p+x+5*(1+Math.floor(x/7e3))+m),E=b.subarray(p,b.length-m),N=0;if(!c||x<8)for(var S=0;S<=x;S+=65535){var T=S+65535;T<x?N=ab(E,N,i.subarray(S,T)):(E[S]=g,N=ab(E,N,i.subarray(S,x)))}else{for(var R=Xz[c-1],A=R>>>13,j=8191&R,P=(1<<u)-1,U=new yo(32768),B=new yo(P+1),$=Math.ceil(u/3),Y=2*$,J=function(ot){return(i[ot]^i[ot+1]<<$^i[ot+2]<<Y)&P},he=new oh(25e3),te=new yo(288),ue=new yo(32),we=0,ie=0,se=(S=0,0),pe=0,ee=0;S<x;++S){var G=J(S),z=32767&S,K=B[G];if(U[z]=K,B[G]=z,pe<=S){var D=x-S;if((we>7e3||se>24576)&&D>423){N=ak(i,E,0,he,te,ue,ie,se,ee,S-ee,N),se=we=ie=0,ee=S;for(var M=0;M<286;++M)te[M]=0;for(M=0;M<30;++M)ue[M]=0}var oe=2,Ee=0,V=j,ce=z-K&32767;if(D>2&&G==J(S-ce))for(var xe=Math.min(A,D)-1,ve=Math.min(32767,S),le=Math.min(258,D);ce<=ve&&--V&&z!=K;){if(i[S+oe]==i[S+oe-ce]){for(var Ne=0;Ne<le&&i[S+Ne]==i[S+Ne-ce];++Ne);if(Ne>oe){if(oe=Ne,Ee=ce,Ne>xe)break;var He=Math.min(ce,Ne-2),Ue=0;for(M=0;M<He;++M){var Me=S-ce+M+32768&32767,Te=Me-U[Me]+32768&32767;Te>Ue&&(Ue=Te,K=Me)}}}ce+=(z=K)-(K=U[z])+32768&32767}if(Ee){he[se++]=268435456|ob[oe]<<18|ok[Ee];var gt=31&ob[oe],jt=31&ok[Ee];ie+=oE[gt]+iE[jt],++te[257+gt],++ue[jt],pe=S+oe,++we}else he[se++]=i[S],++te[i[S]]}}N=ak(i,E,g,he,te,ue,ie,se,ee,S-ee,N)}return FR(b,0,p+PR(N)+m)})(r,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+e.mem,t,n,!0)},zx=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8};function eH(r,e){e===void 0&&(e={});var t=(function(){var u=4294967295;return{p:function(p){for(var m=u,g=0;g<p.length;++g)m=Qz[255&m^p[g]]^m>>>8;u=m},d:function(){return 4294967295^u}}})(),n=r.length;t.p(r);var s,i=Zz(r,e,10+((s=e).filename&&s.filename.length+1||0),8),c=i.length;return(function(u,p){var m=p.filename;if(u[0]=31,u[1]=139,u[2]=8,u[8]=p.level<2?4:p.level==9?2:0,u[9]=3,p.mtime!=0&&zx(u,4,Math.floor(new Date(p.mtime||Date.now())/1e3)),m){u[3]=8;for(var g=0;g<=m.length;++g)u[g+10]=m.charCodeAt(g)}})(i,e),zx(i,c-8,t.d()),zx(i,c-4,n),i}var tH=function(r){var e,t,n,s,i="";for(e=t=0,n=(r=(r+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,s=0;s<n;s++){var c=r.charCodeAt(s),u=null;c<128?t++:u=c>127&&c<2048?String.fromCharCode(c>>6|192,63&c|128):String.fromCharCode(c>>12|224,c>>6&63|128,63&c|128),Vi(u)||(t>e&&(i+=r.substring(e,t)),i+=u,e=t=s+1)}return t>e&&(i+=r.substring(e,r.length)),i},rH=!!Hw||!!zw,lk="text/plain",my=function(r,e,t){var n;t===void 0&&(t=!0);var[s,i]=r.split("?"),c=Qe({},e),u=(n=i==null?void 0:i.split("&").map((m=>{var g,[x,b]=m.split("="),E=t&&(g=c[x])!==null&&g!==void 0?g:b;return delete c[x],x+"="+E})))!==null&&n!==void 0?n:[],p=yz(c);return p&&u.push(p),s+"?"+u.join("&")},am=(r,e)=>JSON.stringify(r,((t,n)=>typeof n=="bigint"?n.toString():n),e),Hx=r=>{var{data:e,compression:t}=r;if(e){if(t===Al.GZipJS){var n=eH((function(p,m){var g=p.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(p);for(var x=new di(p.length+(p.length>>>1)),b=0,E=function(R){x[b++]=R},N=0;N<g;++N){if(b+5>x.length){var S=new di(b+8+(g-N<<1));S.set(x),x=S}var T=p.charCodeAt(N);T<128||m?E(T):T<2048?(E(192|T>>>6),E(128|63&T)):T>55295&&T<57344?(E(240|(T=65536+(1047552&T)|1023&p.charCodeAt(++N))>>>18),E(128|T>>>12&63),E(128|T>>>6&63),E(128|63&T)):(E(224|T>>>12),E(128|T>>>6&63),E(128|63&T))}return FR(x,0,b)})(am(e)),{mtime:0}),s=new Blob([n],{type:lk});return{contentType:lk,body:s,estimatedSize:s.size}}if(t===Al.Base64){var i=(function(p){var m,g,x,b,E,N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",S=0,T=0,R="",A=[];if(!p)return p;p=tH(p);do m=(E=p.charCodeAt(S++)<<16|p.charCodeAt(S++)<<8|p.charCodeAt(S++))>>18&63,g=E>>12&63,x=E>>6&63,b=63&E,A[T++]=N.charAt(m)+N.charAt(g)+N.charAt(x)+N.charAt(b);while(S<p.length);switch(R=A.join(""),p.length%3){case 1:R=R.slice(0,-2)+"==";break;case 2:R=R.slice(0,-1)+"="}return R})(am(e)),c=(p=>"data="+encodeURIComponent(typeof p=="string"?p:am(p)))(i);return{contentType:"application/x-www-form-urlencoded",body:c,estimatedSize:new Blob([c]).size}}var u=am(e);return{contentType:"application/json",body:u,estimatedSize:new Blob([u]).size}}},Bv=[];zw&&Bv.push({transport:"fetch",method:r=>{var e,t,{contentType:n,body:s,estimatedSize:i}=(e=Hx(r))!==null&&e!==void 0?e:{},c=new Headers;Vr(r.headers,(function(g,x){c.append(x,g)})),n&&c.append("Content-Type",n);var u=r.url,p=null;if(kC){var m=new kC;p={signal:m.signal,timeout:setTimeout((()=>m.abort()),r.timeout)}}zw(u,Qe({method:(r==null?void 0:r.method)||"GET",headers:c,keepalive:r.method==="POST"&&(i||0)<52428.8,body:s,signal:(t=p)==null?void 0:t.signal},r.fetchOptions)).then((g=>g.text().then((x=>{var b={statusCode:g.status,text:x};if(g.status===200)try{b.json=JSON.parse(x)}catch(E){Je.error(E)}r.callback==null||r.callback(b)})))).catch((g=>{Je.error(g),r.callback==null||r.callback({statusCode:0,text:g})})).finally((()=>p?clearTimeout(p.timeout):null))}}),Hw&&Bv.push({transport:"XHR",method:r=>{var e,t=new Hw;t.open(r.method||"GET",r.url,!0);var{contentType:n,body:s}=(e=Hx(r))!==null&&e!==void 0?e:{};Vr(r.headers,(function(i,c){t.setRequestHeader(c,i)})),n&&t.setRequestHeader("Content-Type",n),r.timeout&&(t.timeout=r.timeout),r.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var i={statusCode:t.status,text:t.responseText};if(t.status===200)try{i.json=JSON.parse(t.responseText)}catch{}r.callback==null||r.callback(i)}},t.send(s)}}),Mo!=null&&Mo.sendBeacon&&Bv.push({transport:"sendBeacon",method:r=>{var e=my(r.url,{beacon:"1"});try{var t,{contentType:n,body:s}=(t=Hx(r))!==null&&t!==void 0?t:{},i=typeof s=="string"?new Blob([s],{type:n}):s;Mo.sendBeacon(e,i)}catch{}}});var gy=function(r,e){if(!(function(t){try{new RegExp(t)}catch{return!1}return!0})(e))return!1;try{return new RegExp(e).test(r)}catch{return!1}};function ck(r,e,t){return am({distinct_id:r,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var jR={exact:(r,e)=>e.some((t=>r.some((n=>t===n)))),is_not:(r,e)=>e.every((t=>r.every((n=>t!==n)))),regex:(r,e)=>e.some((t=>r.some((n=>gy(t,n))))),not_regex:(r,e)=>e.every((t=>r.every((n=>!gy(t,n))))),icontains:(r,e)=>e.map(_v).some((t=>r.map(_v).some((n=>t.includes(n))))),not_icontains:(r,e)=>e.map(_v).every((t=>r.map(_v).every((n=>!t.includes(n))))),gt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n>parseFloat(s)))})),lt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n<parseFloat(s)))}))},_v=r=>r.toLowerCase();function OR(r,e){return!r||Object.entries(r).every((t=>{var[n,s]=t,i=e==null?void 0:e[n];if(qe(i)||Vi(i))return!1;var c=[String(i)],u=jR[s.operator];return!!u&&u(s.values,c)}))}var Bx=dn("[Error tracking]");class nH{constructor(e){var t,n;this.Zt=[],this.ti=new M8([new q8,new rz,new Y8,new K8,new ez,new Z8,new X8,new tz],V8()),this._instance=e,this.Zt=(t=(n=this._instance.persistence)==null?void 0:n.get_property(Xw))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,n,s,i=(t=(n=e.errorTracking)==null?void 0:n.suppressionRules)!==null&&t!==void 0?t:[],c=(s=e.errorTracking)==null?void 0:s.captureExtensionExceptions;this.Zt=i,this._instance.persistence&&this._instance.persistence.register({[Xw]:this.Zt,[$C]:c})}get ii(){var e,t=!!this._instance.get_property($C),n=this._instance.config.error_tracking.captureExtensionExceptions;return(e=n??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.ti.buildFromUnknown(e,{syntheticException:t==null?void 0:t.syntheticException,mechanism:{handled:t==null?void 0:t.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.ei(t)){if(this.ri(t))return void Bx.info("Skipping exception capture because a suppression rule matched");if(!this.ii&&this.si(t))return void Bx.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ni(t))return void Bx.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}ri(e){if(e.length===0)return!1;var t=e.reduce(((n,s)=>{var{type:i,value:c}=s;return jn(i)&&i.length>0&&n.$exception_types.push(i),jn(c)&&c.length>0&&n.$exception_values.push(c),n}),{$exception_types:[],$exception_values:[]});return this.Zt.some((n=>{var s=n.values.map((i=>{var c,u=jR[i.operator],p=Rr(i.value)?i.value:[i.value],m=(c=t[i.key])!==null&&c!==void 0?c:[];return p.length>0&&u(p,m)}));return n.type==="OR"?s.some(Boolean):s.every(Boolean)}))}si(e){return e.flatMap((t=>{var n,s;return(n=(s=t.stacktrace)==null?void 0:s.frames)!==null&&n!==void 0?n:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}ni(e){if(e.length>0){var t,n,s,i,c=(t=(n=e[0].stacktrace)==null?void 0:n.frames)!==null&&t!==void 0?t:[],u=c[c.length-1];return(s=u==null||(i=u.filename)==null?void 0:i.includes("posthog.com/static"))!==null&&s!==void 0&&s}return!1}ei(e){return!or(e)&&Rr(e)}}var jo=dn("[FeatureFlags]"),Bp=dn("[FeatureFlags]",{debugEnabled:!0}),Gx="$active_feature_flags",Pf="$override_feature_flags",uk="$feature_flag_payloads",Gp="$override_feature_flag_payloads",dk="$feature_flag_request_id",fk="$feature_flag_evaluated_at",hk=r=>{var e={};for(var[t,n]of Hv(r||{}))n&&(e[t]=n);return e},sH=r=>{var e=r.flags;return e?(r.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var n;return[t,(n=e[t].variant)!==null&&n!==void 0?n:e[t].enabled]}))),r.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var n;return(n=e[t].metadata)==null?void 0:n.payload})).map((t=>{var n;return[t,(n=e[t].metadata)==null?void 0:n.payload]})))):jo.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),r},oH=(function(r){return r.FeatureFlags="feature_flags",r.Recordings="recordings",r})({});class iH{constructor(e){this.oi=!1,this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.ci=!1,this._instance=e,this.featureFlagEventHandlers=[]}fi(){var e,t=(e=this._instance.config.evaluation_contexts)!==null&&e!==void 0?e:this._instance.config.evaluation_environments;return!this._instance.config.evaluation_environments||this._instance.config.evaluation_contexts||this.ci||(jo.warn("evaluation_environments is deprecated. Use evaluation_contexts instead. evaluation_environments will be removed in a future version."),this.ci=!0),t!=null&&t.length?t.filter((n=>{var s=n&&typeof n=="string"&&n.trim().length>0;return s||jo.error("Invalid evaluation context found:",n,"Expected non-empty string"),s})):[]}pi(){return this.fi().length>0}flags(){if(this._instance.config.__preview_remote_config)this.di=!0;else{var e=!this.gi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.mi({disableFlags:e})}}get hasLoadedFlags(){return this.ai}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(Qw),t=this._instance.get_property(Pf),n=this._instance.get_property(Gp);if(!n&&!t)return e||{};var s=yn({},e||{}),i=[...new Set([...Object.keys(n||{}),...Object.keys(t||{})])];for(var c of i){var u,p,m=s[c],g=t==null?void 0:t[c],x=qe(g)?(u=m==null?void 0:m.enabled)!==null&&u!==void 0&&u:!!g,b=qe(g)?m.variant:typeof g=="string"?g:void 0,E=n==null?void 0:n[c],N=Qe({},m,{enabled:x,variant:x?b??(m==null?void 0:m.variant):void 0});x!==(m==null?void 0:m.enabled)&&(N.original_enabled=m==null?void 0:m.enabled),b!==(m==null?void 0:m.variant)&&(N.original_variant=m==null?void 0:m.variant),E&&(N.metadata=Qe({},m==null?void 0:m.metadata,{payload:E,original_payload:m==null||(p=m.metadata)==null?void 0:p.payload})),s[c]=N}return this.oi||(jo.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:n,finalDetails:s}),this.oi=!0),s}getFlagVariants(){var e=this._instance.get_property(Gf),t=this._instance.get_property(Pf);if(!t)return e||{};for(var n=yn({},e),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(jo.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this.oi=!0),n}getFlagPayloads(){var e=this._instance.get_property(uk),t=this._instance.get_property(Gp);if(!t)return e||{};for(var n=yn({},e||{}),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(jo.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:n}),this.oi=!0),n}reloadFeatureFlags(){this.ui||this._instance.config.advanced_disable_feature_flags||this.gi||(this._instance.bi.emit("featureFlagsReloading",!0),this.gi=setTimeout((()=>{this.mi()}),5))}yi(){clearTimeout(this.gi),this.gi=void 0}ensureFlagsLoaded(){this.ai||this.li||this.gi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.ui=e}mi(e){var t;if(this.yi(),!this._instance.M())if(this.li)this.hi=!0;else{var n=this._instance.config.token,s=this._instance.get_property("$device_id"),i={token:n,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:Qe({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(im)||{}),group_properties:this._instance.get_property(Vu)};Vi(s)||qe(s)||(i.$device_id=s),(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0),this.pi()&&(i.evaluation_contexts=this.fi());var c=this._instance.config.__preview_remote_config,u=c?"/flags/?v=2":"/flags/?v=2&config=true",p=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",m=this._instance.requestRouter.endpointFor("flags",u+p);c&&(i.timezone=TR()),this.li=!0,this._instance._send_request({method:"POST",url:m,data:i,compression:this._instance.config.disable_compression?void 0:Al.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:g=>{var x,b,E=!0;if(g.statusCode===200&&(this.hi||(this.$anon_distinct_id=void 0),E=!1),this.li=!1,this.di||(this.di=!0,this._instance.wi((b=g.json)!==null&&b!==void 0?b:{})),!i.disable_flags||this.hi)if(this.vi=!E,g.json&&(x=g.json.quotaLimited)!=null&&x.includes(oH.FeatureFlags))jo.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var N;i.disable_flags||this.receivedFeatureFlags((N=g.json)!==null&&N!==void 0?N:{},E),this.hi&&(this.hi=!1,this.mi())}}})}}getFeatureFlag(e,t){var n;if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var s=this.getFeatureFlagResult(e,t);return(n=s==null?void 0:s.variant)!==null&&n!==void 0?n:s==null?void 0:s.enabled}jo.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){var t=this.getFeatureFlagResult(e,{send_event:!1});return t==null?void 0:t.payload}getFeatureFlagResult(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFlagVariants(),s=e in n,i=n[e],c=this.getFlagPayloads()[e],u=String(i),p=this._instance.get_property(dk)||void 0,m=this._instance.get_property(fk)||void 0,g=this._instance.get_property(iy)||{};if((t.send_event||!("send_event"in t))&&(!(e in g)||!g[e].includes(u))){var x,b,E,N,S,T,R,A,j;Rr(g[e])?g[e].push(u):g[e]=[u],(x=this._instance.persistence)==null||x.register({[iy]:g});var P=this.getFeatureFlagDetails(e),U={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:c||null,$feature_flag_request_id:p,$feature_flag_evaluated_at:m,$feature_flag_bootstrapped_response:((b=this._instance.config.bootstrap)==null||(b=b.featureFlags)==null?void 0:b[e])||null,$feature_flag_bootstrapped_payload:((E=this._instance.config.bootstrap)==null||(E=E.featureFlagPayloads)==null?void 0:E[e])||null,$used_bootstrap_value:!this.vi};qe(P==null||(N=P.metadata)==null?void 0:N.version)||(U.$feature_flag_version=P.metadata.version);var B,$=(S=P==null||(T=P.reason)==null?void 0:T.description)!==null&&S!==void 0?S:P==null||(R=P.reason)==null?void 0:R.code;$&&(U.$feature_flag_reason=$),P!=null&&(A=P.metadata)!=null&&A.id&&(U.$feature_flag_id=P.metadata.id),qe(P==null?void 0:P.original_variant)&&qe(P==null?void 0:P.original_enabled)||(U.$feature_flag_original_response=qe(P.original_variant)?P.original_enabled:P.original_variant),P!=null&&(j=P.metadata)!=null&&j.original_payload&&(U.$feature_flag_original_payload=P==null||(B=P.metadata)==null?void 0:B.original_payload),this._instance.capture("$feature_flag_called",U)}if(s){var Y=c;if(!qe(c))try{Y=JSON.parse(c)}catch{}return{key:e,enabled:!!i,variant:typeof i=="string"?i:void 0,payload:Y}}}else jo.warn('getFeatureFlagResult for key "'+e+`" failed. Feature flags didn't load in time.`)}getRemoteConfigPayload(e,t){var n=this._instance.config.token,s={distinct_id:this._instance.get_distinct_id(),token:n};this.pi()&&(s.evaluation_contexts=this.fi()),this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:s,compression:this._instance.config.disable_compression?void 0:Al.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var c,u=(c=i.json)==null?void 0:c.featureFlagPayloads;t((u==null?void 0:u[e])||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFeatureFlag(e,t);return qe(n)?void 0:!!n}jo.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ai=!0;var n=this.getFlagVariants(),s=this.getFlagPayloads(),i=this.getFlagsWithDetails();(function(c,u,p,m,g){p===void 0&&(p={}),m===void 0&&(m={}),g===void 0&&(g={});var x=sH(c),b=x.flags,E=x.featureFlags,N=x.featureFlagPayloads;if(E){var S=c.requestId,T=c.evaluatedAt;if(Rr(E)){jo.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var R={};if(E)for(var A=0;A<E.length;A++)R[E[A]]=!0;u&&u.register({[Gx]:E,[Gf]:R})}else{var j=E,P=N,U=b;if(c.errorsWhileComputingFlags)if(b){var B=new Set(Object.keys(b).filter(($=>{var Y;return!((Y=b[$])!=null&&Y.failed)})));j=Qe({},p,Object.fromEntries(Object.entries(j).filter(($=>{var[Y]=$;return B.has(Y)})))),P=Qe({},m,Object.fromEntries(Object.entries(P||{}).filter(($=>{var[Y]=$;return B.has(Y)})))),U=Qe({},g,Object.fromEntries(Object.entries(U||{}).filter(($=>{var[Y]=$;return B.has(Y)}))))}else j=Qe({},p,j),P=Qe({},m,P),U=Qe({},g,U);u&&u.register(Qe({[Gx]:Object.keys(hk(j)),[Gf]:j||{},[uk]:P||{},[Qw]:U||{}},S?{[dk]:S}:{},T?{[fk]:T}:{}))}}})(e,this._instance.persistence,n,s,i),this.xi(t)}}override(e,t){t===void 0&&(t=!1),jo.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return jo.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(Pf),this._instance.persistence.unregister(Gp),this.xi(),Bp.info("All overrides cleared");if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,n=e;if(this.oi=!!((t=n.suppressWarning)!==null&&t!==void 0&&t),"flags"in n){if(n.flags===!1)this._instance.persistence.unregister(Pf),Bp.info("Flag overrides cleared");else if(n.flags){if(Rr(n.flags)){for(var s={},i=0;i<n.flags.length;i++)s[n.flags[i]]=!0;this._instance.persistence.register({[Pf]:s})}else this._instance.persistence.register({[Pf]:n.flags});Bp.info("Flag overrides set",{flags:n.flags})}}return"payloads"in n&&(n.payloads===!1?(this._instance.persistence.unregister(Gp),Bp.info("Payload overrides cleared")):n.payloads&&(this._instance.persistence.register({[Gp]:n.payloads}),Bp.info("Payload overrides set",{payloads:n.payloads}))),void this.xi()}this.xi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ai){var{flags:t,flagVariants:n}=this.Ei();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,n){var s,i=(this._instance.get_property(om)||[]).find((m=>m.flagKey===e)),c={["$feature_enrollment/"+e]:t},u={$feature_flag:e,$feature_enrollment:t,$set:c};i&&(u.$early_access_feature_name=i.name),n&&(u.$feature_enrollment_stage=n),this._instance.capture("$feature_enrollment_update",u),this.setPersonPropertiesForFlags(c,!1);var p=Qe({},this.getFlagVariants(),{[e]:t});(s=this._instance.persistence)==null||s.register({[Gx]:Object.keys(hk(p)),[Gf]:p}),this.xi()}getEarlyAccessFeatures(e,t,n){t===void 0&&(t=!1);var s=this._instance.get_property(om),i=n?"&"+n.map((c=>"stage="+c)).join("&"):"";if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+i),method:"GET",callback:c=>{var u,p;if(c.json){var m=c.json.earlyAccessFeatures;return(u=this._instance.persistence)==null||u.unregister(om),(p=this._instance.persistence)==null||p.register({[om]:m}),e(m)}}})}Ei(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((n=>t[n])),flagVariants:Object.keys(t).filter((n=>t[n])).reduce(((n,s)=>(n[s]=t[s],n)),{})}}xi(e){var{flags:t,flagVariants:n}=this.Ei();this.featureFlagEventHandlers.forEach((s=>s(t,n,{errorsLoading:e})))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(im)||{};this._instance.register({[im]:Qe({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(im)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(Vu)||{};Object.keys(n).length!==0&&Object.keys(n).forEach((s=>{n[s]=Qe({},n[s],e[s]),delete e[s]})),this._instance.register({[Vu]:Qe({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(Vu)||{};this._instance.register({[Vu]:Qe({},t,{[e]:{}})})}else this._instance.unregister(Vu)}reset(){this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.$anon_distinct_id=void 0,this.yi(),this.oi=!1}}var aH=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Wx{constructor(e,t){this.R=e,this.props={},this.$i=!1,this.Si=(n=>{var s="";return n.token&&(s=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+s+"_posthog"})(e),this.Y=this.ki(e),this.load(),e.debug&&Je.info("Persistence loaded",e.persistence,Qe({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.Pi}ki(e){aH.indexOf(e.persistence.toLowerCase())===-1&&(Je.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=(function(s){s===void 0&&(s=[]);var i=[...Tz,...s];return Qe({},on,{W:function(c){try{var u={};try{u=Da.W(c)||{}}catch{}var p=yn(u,JSON.parse(on.q(c)||"{}"));return on.G(c,p),p}catch{}return null},G:function(c,u,p,m,g,x){try{on.G(c,u,void 0,void 0,x);var b={};i.forEach((E=>{u[E]&&(b[E]=u[E])})),Object.keys(b).length&&Da.G(c,b,p,m,g,x)}catch(E){on.B(E)}},V:function(c,u){try{_e==null||_e.localStorage.removeItem(c),Da.V(c,u)}catch(p){on.B(p)}}})})(e.cookie_persisted_properties||[]),n=e.persistence.toLowerCase();return n==="localstorage"&&on.H()?on:n==="localstorage+cookie"&&t.H()?t:n==="sessionstorage"&&rs.H()?rs:n==="memory"?Rz:n==="cookie"?Da:t.H()?t:Da}properties(){var e={};return Vr(this.props,(function(t,n){if(n===Gf&&Fn(t))for(var s=Object.keys(t),i=0;i<s.length;i++)e["$feature/"+s[i]]=t[s[i]];else u=n,p=!1,(Vi(c=lz)?p:CC&&c.indexOf===CC?c.indexOf(u)!=-1:(Vr(c,(function(m){if(p||(p=m===u))return sy})),p))||(e[n]=t);var c,u,p})),e}load(){if(!this.Pi){var e=this.Y.W(this.Si);e&&(this.props=yn({},e))}}save(){this.Pi||this.Y.G(this.Si,this.props,this.Ti,this.Ii,this.Ci,this.R.debug)}remove(){this.Y.V(this.Si,!1),this.Y.V(this.Si,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(Fn(e)){qe(t)&&(t="None"),this.Ti=qe(n)?this.Ri:n;var s=!1;if(Vr(e,((i,c)=>{this.props.hasOwnProperty(c)&&this.props[c]!==t||(this.props[c]=i,s=!0)})),s)return this.save(),!0}return!1}register(e,t){if(Fn(e)){this.Ti=qe(t)?this.Ri:t;var n=!1;if(Vr(e,((s,i)=>{e.hasOwnProperty(i)&&this.props[i]!==s&&(this.props[i]=s,n=!0)})),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.$i){var e=_R(this.R.custom_campaign_params,this.R.mask_personal_data_properties,this.R.custom_personal_data_properties);Bf(tE(e))||this.register(e),this.$i=!0}}update_search_keyword(){var e;this.register((e=Ve==null?void 0:Ve.referrer)?SR(e):{})}update_referrer_info(){var e;this.register_once({$referrer:CR(),$referring_domain:Ve!=null&&Ve.referrer&&((e=uy(Ve.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[rb]||this.props[nb]||this.register_once({[ay]:kR(this.R.mask_personal_data_properties,this.R.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};Vr([nb,rb],(c=>{var u=this.props[c];u&&Vr(u,(function(p,m){e["$initial_"+Bw(m)]=p}))}));var t,n,s=this.props[ay];if(s){var i=(t=NR(s),n={},Vr(t,(function(c,u){n["$initial_"+Bw(u)]=c})),n);yn(e,i)}return e}safe_merge(e){return Vr(this.props,(function(t,n){n in e||(e[n]=t)})),e}update_config(e,t,n){if(this.Ri=this.Ti=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!n),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence||!((c,u)=>{if(c.length!==u.length)return!1;var p=[...c].sort(),m=[...u].sort();return p.every(((g,x)=>g===m[x]))})(e.cookie_persisted_properties||[],t.cookie_persisted_properties||[])){var s=this.ki(e),i=this.props;this.clear(),this.Y=s,this.props=i,this.save()}}set_disabled(e){this.Pi=e,this.Pi?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ii&&(this.Ii=e,this.remove(),this.save())}set_secure(e){e!==this.Ci&&(this.Ci=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[sm]||{};n[e]=t,this.props[sm]=n,this.save()}remove_event_timer(e){var t=(this.props[sm]||{})[e];return qe(t)||(delete this.props[sm][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}var pk=dn("[Product Tours]"),Vx="ph_product_tours";class lH{constructor(e){this.Fi=null,this.Oi=null,this._instance=e}onRemoteConfig(e){this._instance.persistence&&this._instance.persistence.register({[zC]:!(e==null||!e.productTours)}),this.loadIfEnabled()}loadIfEnabled(){var e,t;this.Fi||(e=this._instance).config.disable_product_tours||(t=e.persistence)==null||!t.get_property(zC)||this.it((()=>this.Mi()))}it(e){var t,n;(t=yt.__PosthogExtensions__)!=null&&t.generateProductTours?e():(n=yt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"product-tours",(s=>{s?pk.error("Could not load product tours script",s):e()}))}Mi(){var e;!this.Fi&&(e=yt.__PosthogExtensions__)!=null&&e.generateProductTours&&(this.Fi=yt.__PosthogExtensions__.generateProductTours(this._instance,!0))}getProductTours(e,t){if(t===void 0&&(t=!1),!Rr(this.Oi)||t){var n=this._instance.persistence;if(n){var s=n.props[Vx];if(Rr(s)&&!t)return this.Oi=s,void e(s,{isLoaded:!0})}this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/product_tours/?token="+this._instance.config.token),method:"GET",callback:i=>{var c=i.statusCode;if(c!==200||!i.json){var u="Product Tours API could not be loaded, status: "+c;return pk.error(u),void e([],{isLoaded:!1,error:u})}var p=Rr(i.json.product_tours)?i.json.product_tours:[];this.Oi=p,n&&n.register({[Vx]:p}),e(p,{isLoaded:!0})}})}else e(this.Oi,{isLoaded:!0})}getActiveProductTours(e){or(this.Fi)?e([],{isLoaded:!1,error:"Product tours not loaded"}):this.Fi.getActiveProductTours(e)}showProductTour(e){var t;(t=this.Fi)==null||t.showTourById(e)}previewTour(e){this.Fi?this.Fi.previewTour(e):this.it((()=>{var t;this.Mi(),(t=this.Fi)==null||t.previewTour(e)}))}dismissProductTour(){var e;(e=this.Fi)==null||e.dismissTour("user_clicked_skip")}nextStep(){var e;(e=this.Fi)==null||e.nextStep()}previousStep(){var e;(e=this.Fi)==null||e.previousStep()}clearCache(){var e;this.Oi=null,(e=this._instance.persistence)==null||e.unregister(Vx)}resetTour(e){var t;(t=this.Fi)==null||t.resetTour(e)}resetAllTours(){var e;(e=this.Fi)==null||e.resetAllTours()}cancelPendingTour(e){var t;(t=this.Fi)==null||t.cancelPendingTour(e)}}var Wp=(function(r){return r.Activation="events",r.Cancellation="cancelEvents",r})({});(function(r){return r.Button="button",r.Tab="tab",r.Selector="selector",r})({});(function(r){return r.TopLeft="top_left",r.TopRight="top_right",r.TopCenter="top_center",r.MiddleLeft="middle_left",r.MiddleRight="middle_right",r.MiddleCenter="middle_center",r.Left="left",r.Center="center",r.Right="right",r.NextToTrigger="next_to_trigger",r})({});(function(r){return r.Top="top",r.Left="left",r.Right="right",r.Bottom="bottom",r})({});var qx=(function(r){return r.Popover="popover",r.API="api",r.Widget="widget",r.ExternalSurvey="external_survey",r})({});(function(r){return r.Open="open",r.MultipleChoice="multiple_choice",r.SingleChoice="single_choice",r.Rating="rating",r.Link="link",r})({});(function(r){return r.NextQuestion="next_question",r.End="end",r.ResponseBased="response_based",r.SpecificQuestion="specific_question",r})({});(function(r){return r.Once="once",r.Recurring="recurring",r.Always="always",r})({});var lm=(function(r){return r.SHOWN="survey shown",r.DISMISSED="survey dismissed",r.SENT="survey sent",r.ABANDONED="survey abandoned",r})({}),Kx=(function(r){return r.SURVEY_ID="$survey_id",r.SURVEY_NAME="$survey_name",r.SURVEY_RESPONSE="$survey_response",r.SURVEY_ITERATION="$survey_iteration",r.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",r.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",r.SURVEY_SUBMISSION_ID="$survey_submission_id",r.SURVEY_QUESTIONS="$survey_questions",r.SURVEY_COMPLETED="$survey_completed",r.PRODUCT_TOUR_ID="$product_tour_id",r.SURVEY_LAST_SEEN_DATE="$survey_last_seen_date",r})({}),lb=(function(r){return r.Popover="popover",r.Inline="inline",r})({}),Ur=dn("[Surveys]"),DR="seenSurvey_",cH=(r,e)=>{var t="$survey_"+e+"/"+r.id;return r.current_iteration&&r.current_iteration>0&&(t="$survey_"+e+"/"+r.id+"/"+r.current_iteration),t},mk=r=>((e,t)=>{var n=""+e+t.id;return t.current_iteration&&t.current_iteration>0&&(n=""+e+t.id+"_"+t.current_iteration),n})(DR,r),uH=[qx.Popover,qx.Widget,qx.API],dH={ignoreConditions:!1,ignoreDelay:!1,displayType:lb.Popover};class aE{constructor(){this.Ai={},this.Ai={}}on(e,t){return this.Ai[e]||(this.Ai[e]=[]),this.Ai[e].push(t),()=>{this.Ai[e]=this.Ai[e].filter((n=>n!==t))}}emit(e,t){for(var n of this.Ai[e]||[])n(t);for(var s of this.Ai["*"]||[])s(e,t)}}function Ff(r,e,t){if(or(r))return!1;switch(t){case"exact":return r===e;case"contains":var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/_/g,".").replace(/%/g,".*");return new RegExp(n,"i").test(r);case"regex":try{return new RegExp(e).test(r)}catch{return!1}default:return!1}}class fH{constructor(e){this.ji=new aE,this.Di=(t,n)=>this.Li(t,n)&&this.Ni(t,n)&&this.Ui(t,n)&&this.zi(t,n),this.Li=(t,n)=>n==null||!n.event||(t==null?void 0:t.event)===(n==null?void 0:n.event),this._instance=e,this.Hi=new Set,this.Bi=new Set}init(){var e;if(!qe((e=this._instance)==null?void 0:e._addCaptureHook)){var t;(t=this._instance)==null||t._addCaptureHook(((n,s)=>{this.on(n,s)}))}}register(e){var t,n;if(!qe((t=this._instance)==null?void 0:t._addCaptureHook)&&(e.forEach((c=>{var u,p;(u=this.Bi)==null||u.add(c),(p=c.steps)==null||p.forEach((m=>{var g;(g=this.Hi)==null||g.add((m==null?void 0:m.event)||"")}))})),(n=this._instance)!=null&&n.autocapture)){var s,i=new Set;e.forEach((c=>{var u;(u=c.steps)==null||u.forEach((p=>{p!=null&&p.selector&&i.add(p==null?void 0:p.selector)}))})),(s=this._instance)==null||s.autocapture.setElementSelectors(i)}}on(e,t){var n;t!=null&&e.length!=0&&(this.Hi.has(e)||this.Hi.has(t==null?void 0:t.event))&&this.Bi&&((n=this.Bi)==null?void 0:n.size)>0&&this.Bi.forEach((s=>{this.qi(t,s)&&this.ji.emit("actionCaptured",s.name)}))}Wi(e){this.onAction("actionCaptured",(t=>e(t)))}qi(e,t){if((t==null?void 0:t.steps)==null)return!1;for(var n of t.steps)if(this.Di(e,n))return!0;return!1}onAction(e,t){return this.ji.on(e,t)}Ni(e,t){if(t!=null&&t.url){var n,s=e==null||(n=e.properties)==null?void 0:n.$current_url;if(!s||typeof s!="string"||!Ff(s,t.url,t.url_matching||"contains"))return!1}return!0}Ui(e,t){return!!this.Gi(e,t)&&!!this.Vi(e,t)&&!!this.Ji(e,t)}Gi(e,t){var n;if(t==null||!t.href)return!0;var s=this.Ki(e);if(s.length>0)return s.some((u=>Ff(u.href,t.href,t.href_matching||"exact")));var i,c=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!c&&Ff((i=c.match(/(?::|")href="(.*?)"/))?i[1]:"",t.href,t.href_matching||"exact")}Vi(e,t){var n;if(t==null||!t.text)return!0;var s=this.Ki(e);if(s.length>0)return s.some((m=>Ff(m.text,t.text,t.text_matching||"exact")||Ff(m.$el_text,t.text,t.text_matching||"exact")));var i,c,u,p=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!p&&(i=(function(m){for(var g,x=[],b=/(?::|")text="(.*?)"/g;!or(g=b.exec(m));)x.includes(g[1])||x.push(g[1]);return x})(p),c=t.text,u=t.text_matching||"exact",i.some((m=>Ff(m,c,u))))}Ji(e,t){var n,s;if(t==null||!t.selector)return!0;var i=e==null||(n=e.properties)==null?void 0:n.$element_selectors;if(i!=null&&i.includes(t.selector))return!0;var c=(e==null||(s=e.properties)==null?void 0:s.$elements_chain)||"";if(t.selector_regex&&c)try{return new RegExp(t.selector_regex).test(c)}catch{return!1}return!1}Ki(e){var t;return(e==null||(t=e.properties)==null?void 0:t.$elements)==null?[]:e==null?void 0:e.properties.$elements}zi(e,t){return t==null||!t.properties||t.properties.length===0||OR(t.properties.reduce(((n,s)=>{var i=Rr(s.value)?s.value.map(String):s.value!=null?[String(s.value)]:[];return n[s.key]={values:i,operator:s.operator||"exact"},n}),{}),e==null?void 0:e.properties)}}class hH{constructor(e){this._instance=e,this.Yi=new Map,this.Xi=new Map,this.Qi=new Map}Zi(e,t){return!!e&&OR(e.propertyFilters,t==null?void 0:t.properties)}te(e,t){var n=new Map;return e.forEach((s=>{var i;(i=s.conditions)==null||(i=i[t])==null||(i=i.values)==null||i.forEach((c=>{if(c!=null&&c.name){var u=n.get(c.name)||[];u.push(s.id),n.set(c.name,u)}}))})),n}ie(e,t,n){var s=(n===Wp.Activation?this.Yi:this.Xi).get(e),i=[];return this.ee((c=>{i=c.filter((u=>s==null?void 0:s.includes(u.id)))})),i.filter((c=>{var u,p=(u=c.conditions)==null||(u=u[n])==null||(u=u.values)==null?void 0:u.find((m=>m.name===e));return this.Zi(p,t)}))}register(e){var t;qe((t=this._instance)==null?void 0:t._addCaptureHook)||(this.re(e),this.se(e))}se(e){var t=e.filter((n=>{var s,i;return((s=n.conditions)==null?void 0:s.actions)&&((i=n.conditions)==null||(i=i.actions)==null||(i=i.values)==null?void 0:i.length)>0}));t.length!==0&&(this.ne==null&&(this.ne=new fH(this._instance),this.ne.init(),this.ne.Wi((n=>{this.onAction(n)}))),t.forEach((n=>{var s,i,c,u,p;n.conditions&&(s=n.conditions)!=null&&s.actions&&(i=n.conditions)!=null&&(i=i.actions)!=null&&i.values&&((c=n.conditions)==null||(c=c.actions)==null||(c=c.values)==null?void 0:c.length)>0&&((u=this.ne)==null||u.register(n.conditions.actions.values),(p=n.conditions)==null||(p=p.actions)==null||(p=p.values)==null||p.forEach((m=>{if(m&&m.name){var g=this.Qi.get(m.name);g&&g.push(n.id),this.Qi.set(m.name,g||[n.id])}})))})))}re(e){var t,n=e.filter((i=>{var c,u;return((c=i.conditions)==null?void 0:c.events)&&((u=i.conditions)==null||(u=u.events)==null||(u=u.values)==null?void 0:u.length)>0})),s=e.filter((i=>{var c,u;return((c=i.conditions)==null?void 0:c.cancelEvents)&&((u=i.conditions)==null||(u=u.cancelEvents)==null||(u=u.values)==null?void 0:u.length)>0}));(n.length!==0||s.length!==0)&&((t=this._instance)==null||t._addCaptureHook(((i,c)=>{this.onEvent(i,c)})),this.Yi=this.te(e,Wp.Activation),this.Xi=this.te(e,Wp.Cancellation))}onEvent(e,t){var n,s=this.oe(),i=this.ae(),c=this.le(),u=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[i])||[];if(c===e&&t&&u.length>0){var p,m;s.info("event matched, removing item from activated items",{event:e,eventPayload:t,existingActivatedItems:u});var g=(t==null||(p=t.properties)==null?void 0:p.$survey_id)||(t==null||(m=t.properties)==null?void 0:m.$product_tour_id);if(g){var x=u.indexOf(g);x>=0&&(u.splice(x,1),this.ue(u))}}else{if(this.Xi.has(e)){var b=this.ie(e,t,Wp.Cancellation);b.length>0&&(s.info("cancel event matched, cancelling items",{event:e,itemsToCancel:b.map((N=>N.id))}),b.forEach((N=>{var S=u.indexOf(N.id);S>=0&&u.splice(S,1),this.he(N.id)})),this.ue(u))}if(this.Yi.has(e)){s.info("event name matched",{event:e,eventPayload:t,items:this.Yi.get(e)});var E=this.ie(e,t,Wp.Activation);this.ue(u.concat(E.map((N=>N.id))||[]))}}}onAction(e){var t,n=this.ae(),s=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[n])||[];this.Qi.has(e)&&this.ue(s.concat(this.Qi.get(e)||[]))}ue(e){var t,n=this.oe(),s=this.ae(),i=[...new Set(e)].filter((c=>!this.de(c)));n.info("updating activated items",{activatedItems:i}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[s]:i})}getActivatedIds(){var e,t=this.ae(),n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[t];return n||[]}getEventToItemsMap(){return this.Yi}ve(){return this.ne}}class pH extends hH{constructor(e){super(e)}ae(){return"$surveys_activated"}le(){return lm.SHOWN}ee(e){var t;(t=this._instance)==null||t.getSurveys(e)}he(e){var t;(t=this._instance)==null||t.cancelPendingSurvey(e)}oe(){return Ur}de(){return!1}getSurveys(){return this.getActivatedIds()}getEventToSurveys(){return this.getEventToItemsMap()}}class mH{constructor(e){this.ce=void 0,this._surveyManager=null,this.fe=!1,this.pe=[],this.ge=null,this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(or(t))return Ur.warn("Flags not loaded yet. Not loading surveys.");var n=Rr(t);this.ce=n?t.length>0:t,Ur.info("flags response received, isSurveysEnabled: "+this.ce),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n!=null&&n.startsWith(DR)||n!=null&&n.startsWith("inProgressSurvey_"))&&e.push(n)}e.forEach((s=>localStorage.removeItem(s)))}loadIfEnabled(){if(!this._surveyManager)if(this.fe)Ur.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Ur.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())Ur.info("Not loading surveys in cookieless mode without consent.");else{var e=yt==null?void 0:yt.__PosthogExtensions__;if(e){if(!qe(this.ce)||this._instance.config.advanced_enable_surveys){var t=this.ce||this._instance.config.advanced_enable_surveys;this.fe=!0;try{var n=e.generateSurveys;if(n)return void this._e(n,t);var s=e.loadExternalDependency;if(!s)return void this.me("PostHog loadExternalDependency extension not found.");s(this._instance,"surveys",(i=>{i||!e.generateSurveys?this.me("Could not load surveys script",i):this._e(e.generateSurveys,t)}))}catch(i){throw this.me("Error initializing surveys",i),i}finally{this.fe=!1}}}else Ur.error("PostHog Extensions not found.")}}_e(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new pH(this._instance),Ur.info("Surveys loaded successfully"),this.be({isLoaded:!0})}me(e,t){Ur.error(e,t),this.be({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.pe.push(e),this._surveyManager&&this.be({isLoaded:!0}),()=>{this.pe=this.pe.filter((t=>t!==e))}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return Ur.info("Disabled. Not loading surveys."),e([]);var n,s=this._instance.get_property(Zw);if(s&&!t)return e(s,{isLoaded:!0});typeof Promise<"u"&&this.ge?this.ge.then((i=>{var{surveys:c,context:u}=i;return e(c,u)})):(typeof Promise<"u"&&(this.ge=new Promise((i=>{n=i}))),this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:i=>{var c;this.ge=null;var u=i.statusCode;if(u!==200||!i.json){var p="Surveys API could not be loaded, status: "+u;Ur.error(p);var m={isLoaded:!1,error:p};return e([],m),void(n==null||n({surveys:[],context:m}))}var g,x=i.json.surveys||[],b=x.filter((N=>(function(S){return!(!S.start_date||S.end_date)})(N)&&((function(S){var T;return!((T=S.conditions)==null||(T=T.events)==null||(T=T.values)==null||!T.length)})(N)||(function(S){var T;return!((T=S.conditions)==null||(T=T.actions)==null||(T=T.values)==null||!T.length)})(N))));b.length>0&&((g=this._surveyEventReceiver)==null||g.register(b)),(c=this._instance.persistence)==null||c.register({[Zw]:x});var E={isLoaded:!0};e(x,E),n==null||n({surveys:x,context:E})}}))}be(e){for(var t of this.pe)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(n){Ur.error("Error in survey callback",n)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!or(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);Ur.warn("init was not called")}ye(e){var t=null;return this.getSurveys((n=>{var s;t=(s=n.find((i=>i.id===e)))!==null&&s!==void 0?s:null})),t}we(e){if(or(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.ye(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(or(this._surveyManager))return Ur.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.we(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return or(this._surveyManager)?(Ur.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((n=>{this.getSurveys((s=>{var i,c=(i=s.find((p=>p.id===e)))!==null&&i!==void 0?i:null;if(c){var u=this.we(c);n({visible:u.eligible,disabledReason:u.reason})}else n({visible:!1,disabledReason:"Survey not found"})}),t)}))}renderSurvey(e,t,n){var s;if(or(this._surveyManager))Ur.warn("init was not called");else{var i=typeof e=="string"?this.ye(e):e;if(i!=null&&i.id)if(uH.includes(i.type)){var c=Ve==null?void 0:Ve.querySelector(t);if(c)return(s=i.appearance)!=null&&s.surveyPopupDelaySeconds?(Ur.info("Rendering survey "+i.id+" with delay of "+i.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var u,p;Ur.info("Rendering survey "+i.id+" with delay of "+((u=i.appearance)==null?void 0:u.surveyPopupDelaySeconds)+" seconds"),(p=this._surveyManager)==null||p.renderSurvey(i,c,n),Ur.info("Survey "+i.id+" rendered")}),1e3*i.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(i,c,n);Ur.warn("Survey element not found")}else Ur.warn("Surveys of type "+i.type+" cannot be rendered in the app");else Ur.warn("Survey not found")}}displaySurvey(e,t){var n;if(or(this._surveyManager))Ur.warn("init was not called");else{var s=this.ye(e);if(s){var i=s;if((n=s.appearance)!=null&&n.surveyPopupDelaySeconds&&t.ignoreDelay&&(i=Qe({},s,{appearance:Qe({},s.appearance,{surveyPopupDelaySeconds:0})})),t.displayType!==lb.Popover&&t.initialResponses&&Ur.warn("initialResponses is only supported for popover surveys. prefill will not be applied."),t.ignoreConditions===!1){var c=this.canRenderSurvey(s);if(!c.visible)return void Ur.warn("Survey is not eligible to be displayed: ",c.disabledReason)}t.displayType!==lb.Inline?this._surveyManager.handlePopoverSurvey(i,t):this.renderSurvey(i,t.selector,t.properties)}else Ur.warn("Survey not found")}}cancelPendingSurvey(e){or(this._surveyManager)?Ur.warn("init was not called"):this._surveyManager.cancelSurvey(e)}handlePageUnload(){var e;(e=this._surveyManager)==null||e.handlePageUnload()}}var Sl=dn("[Conversations]");class gH{constructor(e){this.xe=void 0,this._conversationsManager=null,this.Ee=!1,this.$e=null,this._instance=e}onRemoteConfig(e){if(!this._instance.config.disable_conversations){var t=e.conversations;or(t)||(Fl(t)?this.xe=t:(this.xe=t.enabled,this.$e=t),this.loadIfEnabled())}}reset(){var e;(e=this._conversationsManager)==null||e.reset(),this._conversationsManager=null,this.xe=void 0,this.$e=null}loadIfEnabled(){if(!this._conversationsManager&&!this.Ee&&!(this._instance.config.disable_conversations||this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())){var e=yt==null?void 0:yt.__PosthogExtensions__;if(e&&!qe(this.xe)&&this.xe)if(this.$e&&this.$e.token){this.Ee=!0;try{var t=e.initConversations;if(t)return this.Se(t),void(this.Ee=!1);var n=e.loadExternalDependency;if(!n)return void this.ke("PostHog loadExternalDependency extension not found.");n(this._instance,"conversations",(s=>{s||!e.initConversations?this.ke("Could not load conversations script",s):this.Se(e.initConversations),this.Ee=!1}))}catch(s){this.ke("Error initializing conversations",s),this.Ee=!1}}else Sl.error("Conversations enabled but missing token in remote config.")}}Se(e){if(this.$e)try{this._conversationsManager=e(this.$e,this._instance),Sl.info("Conversations loaded successfully")}catch(t){this.ke("Error completing conversations initialization",t)}else Sl.error("Cannot complete initialization: remote config is null")}ke(e,t){Sl.error(e,t),this._conversationsManager=null,this.Ee=!1}show(){this._conversationsManager?this._conversationsManager.show():Sl.warn("Conversations not loaded yet.")}hide(){this._conversationsManager&&this._conversationsManager.hide()}isAvailable(){return this.xe===!0&&!Vi(this._conversationsManager)}isVisible(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.isVisible())!==null&&e!==void 0&&e}sendMessage(e,t,n){var s=this;return Hf((function*(){return s._conversationsManager?s._conversationsManager.sendMessage(e,t,n):(Sl.warn("Conversations not available yet."),null)}))()}getMessages(e,t){var n=this;return Hf((function*(){return n._conversationsManager?n._conversationsManager.getMessages(e,t):(Sl.warn("Conversations not available yet."),null)}))()}markAsRead(e){var t=this;return Hf((function*(){return t._conversationsManager?t._conversationsManager.markAsRead(e):(Sl.warn("Conversations not available yet."),null)}))()}getTickets(e){var t=this;return Hf((function*(){return t._conversationsManager?t._conversationsManager.getTickets(e):(Sl.warn("Conversations not available yet."),null)}))()}getCurrentTicketId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getCurrentTicketId())!==null&&e!==void 0?e:null}getWidgetSessionId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getWidgetSessionId())!==null&&e!==void 0?e:null}}class vH{constructor(e){var t;this.Pe=!1,this.Te=!1,this._instance=e,this._instance&&(t=this._instance.config.logs)!=null&&t.captureConsoleLogs&&(this.Pe=!0)}onRemoteConfig(e){var t,n=(t=e.logs)==null?void 0:t.captureConsoleLogs;!or(n)&&n&&(this.Pe=!0,this.loadIfEnabled())}reset(){}loadIfEnabled(){if(this.Pe&&!this.Te){var e=dn("[logs]"),t=yt==null?void 0:yt.__PosthogExtensions__;if(t){var n=t.loadExternalDependency;n?n(this._instance,"logs",(s=>{var i;s||(i=t.logs)==null||!i.initializeLogs?e.error("Could not load logs script",s):(t.logs.initializeLogs(this._instance),this.Te=!0)})):e.error("PostHog loadExternalDependency extension not found.")}else e.error("PostHog Extensions not found.")}}}var gk=dn("[RateLimiter]");class yH{constructor(e){this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=t=>{var n=t.text;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach((s=>{gk.info((s||"events")+" is quota limited."),this.serverLimits[s]=new Date().getTime()+6e4}))}catch(s){return void gk.warn('could not rate limit - continuing. Error: "'+(s==null?void 0:s.message)+'"',{text:n})}},this.instance=e,this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}get captureEventsPerSecond(){var e;return((e=this.instance.config.rate_limiting)==null?void 0:e.events_per_second)||10}get captureEventsBurstLimit(){var e;return Math.max(((e=this.instance.config.rate_limiting)==null?void 0:e.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond)}clientRateLimitContext(e){var t,n,s;e===void 0&&(e=!1);var{captureEventsBurstLimit:i,captureEventsPerSecond:c}=this,u=new Date().getTime(),p=(t=(n=this.instance.persistence)==null?void 0:n.get_property(tb))!==null&&t!==void 0?t:{tokens:i,last:u};p.tokens+=(u-p.last)/1e3*c,p.last=u,p.tokens>i&&(p.tokens=i);var m=p.tokens<1;return m||e||(p.tokens=Math.max(0,p.tokens-1)),!m||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+c+" events per second and "+i+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=m,(s=this.instance.persistence)==null||s.set_property(tb,p),{isRateLimited:m,remainingTokens:p.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var Bu=dn("[RemoteConfig]");class xH{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=yt._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}Ie(e){var t,n;(t=yt.__PosthogExtensions__)!=null&&t.loadExternalDependency?(n=yt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"remote-config",(()=>e(this.remoteConfig))):(Bu.error("PostHog Extensions not found. Cannot load remote config."),e())}Ce(e){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Bu.info("Using preloaded remote config",this.remoteConfig),void this.wi(this.remoteConfig);if(this._instance.M())return void Bu.warn("Remote config is disabled. Falling back to local config.");this.Ie((e=>{if(!e)return Bu.info("No config found after loading remote JS config. Falling back to JSON."),void this.Ce((t=>{this.wi(t)}));this.wi(e)}))}catch(e){Bu.error("Error loading remote config",e)}}wi(e){e?this._instance.config.__preview_remote_config?(this._instance.wi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):Bu.info("__preview_remote_config is disabled. Logging config instead",e):Bu.error("Failed to fetch remote config from PostHog.")}}var cb=3e3;class wH{constructor(e,t){this.Re=!0,this.Fe=[],this.Oe=$a((t==null?void 0:t.flush_interval_ms)||cb,250,5e3,Je.createLogger("flush interval"),cb),this.Me=e}enqueue(e){this.Fe.push(e),this.Ae||this.je()}unload(){this.De();var e=this.Fe.length>0?this.Le():{},t=Object.values(e);[...t.filter((n=>n.url.indexOf("/e")===0)),...t.filter((n=>n.url.indexOf("/e")!==0))].map((n=>{this.Me(Qe({},n,{transport:"sendBeacon"}))}))}enable(){this.Re=!1,this.je()}je(){var e=this;this.Re||(this.Ae=setTimeout((()=>{if(this.De(),this.Fe.length>0){var t=this.Le(),n=function(){var i=t[s],c=new Date().getTime();i.data&&Rr(i.data)&&Vr(i.data,(u=>{u.offset=Math.abs(u.timestamp-c),delete u.timestamp})),e.Me(i)};for(var s in t)n()}}),this.Oe))}De(){clearTimeout(this.Ae),this.Ae=void 0}Le(){var e={};return Vr(this.Fe,(t=>{var n,s=t,i=(s?s.batchKey:null)||s.url;qe(e[i])&&(e[i]=Qe({},s,{data:[]})),(n=e[i].data)==null||n.push(s.data)})),this.Fe=[],e}}var bH=["retriesPerformedSoFar"];class _H{constructor(e){this.Ne=!1,this.Ue=3e3,this.Fe=[],this._instance=e,this.Fe=[],this.ze=!0,!qe(_e)&&"onLine"in _e.navigator&&(this.ze=_e.navigator.onLine,this.He=()=>{this.ze=!0,this.Lt()},this.Be=()=>{this.ze=!1},kn(_e,"online",this.He),kn(_e,"offline",this.Be))}get length(){return this.Fe.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=IT(e,bH);$f(t)&&(n.url=my(n.url,{retry_count:t})),this._instance._send_request(Qe({},n,{callback:s=>{s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(t??0)<10?this.qe(Qe({retriesPerformedSoFar:t},n)):n.callback==null||n.callback(s)}}))}qe(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=(function(c){var u=3e3*Math.pow(2,c),p=u/2,m=Math.min(18e5,u),g=(Math.random()-.5)*(m-p);return Math.ceil(m+g)})(t),s=Date.now()+n;this.Fe.push({retryAt:s,requestOptions:e});var i="Enqueued failed request for retry in "+n;navigator.onLine||(i+=" (Browser is offline)"),Je.warn(i),this.Ne||(this.Ne=!0,this.We())}We(){if(this.Ge&&clearTimeout(this.Ge),this.Fe.length===0)return this.Ne=!1,void(this.Ge=void 0);this.Ge=setTimeout((()=>{this.ze&&this.Fe.length>0&&this.Lt(),this.We()}),this.Ue)}Lt(){var e=Date.now(),t=[],n=this.Fe.filter((i=>i.retryAt<e||(t.push(i),!1)));if(this.Fe=t,n.length>0)for(var{requestOptions:s}of n)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this.Ge&&(clearTimeout(this.Ge),this.Ge=void 0),this.Ne=!1,qe(_e)||(this.He&&(_e.removeEventListener("online",this.He),this.He=void 0),this.Be&&(_e.removeEventListener("offline",this.Be),this.Be=void 0)),this.Fe))try{this._instance._send_request(Qe({},e,{transport:"sendBeacon"}))}catch(t){Je.error(t)}this.Fe=[]}}class EH{constructor(e){this.Ve=()=>{var t,n,s,i;this.Je||(this.Je={});var c=this.scrollElement(),u=this.scrollY(),p=c?Math.max(0,c.scrollHeight-c.clientHeight):0,m=u+((c==null?void 0:c.clientHeight)||0),g=(c==null?void 0:c.scrollHeight)||0;this.Je.lastScrollY=Math.ceil(u),this.Je.maxScrollY=Math.max(u,(t=this.Je.maxScrollY)!==null&&t!==void 0?t:0),this.Je.maxScrollHeight=Math.max(p,(n=this.Je.maxScrollHeight)!==null&&n!==void 0?n:0),this.Je.lastContentY=m,this.Je.maxContentY=Math.max(m,(s=this.Je.maxContentY)!==null&&s!==void 0?s:0),this.Je.maxContentHeight=Math.max(g,(i=this.Je.maxContentHeight)!==null&&i!==void 0?i:0)},this._instance=e}getContext(){return this.Je}resetContext(){var e=this.Je;return setTimeout(this.Ve,0),e}startMeasuringScrollPosition(){kn(_e,"scroll",this.Ve,{capture:!0}),kn(_e,"scrollend",this.Ve,{capture:!0}),kn(_e,"resize",this.Ve)}scrollElement(){if(!this._instance.config.scroll_root_selector)return _e==null?void 0:_e.document.documentElement;var e=Rr(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var n=_e==null?void 0:_e.document.querySelector(t);if(n)return n}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return _e&&(_e.scrollY||_e.pageYOffset||_e.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return _e&&(_e.scrollX||_e.pageXOffset||_e.document.documentElement.scrollLeft)||0}}var SH=r=>kR(r==null?void 0:r.config.mask_personal_data_properties,r==null?void 0:r.config.custom_personal_data_properties);class vk{constructor(e,t,n,s){this.Ke=i=>{var c=this.Ye();if(!c||c.sessionId!==i){var u={sessionId:i,props:this.Xe(this._instance)};this.Qe.register({[eb]:u})}},this._instance=e,this.Ze=t,this.Qe=n,this.Xe=s||SH,this.Ze.onSessionId(this.Ke)}Ye(){return this.Qe.props[eb]}getSetOnceProps(){var e,t=(e=this.Ye())==null?void 0:e.props;return t?"r"in t?NR(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return Vr(tE(this.getSetOnceProps()),((t,n)=>{n==="$current_url"&&(n="url"),e["$session_entry_"+Bw(n)]=t})),e}}var Yx=dn("[SessionId]");class yk{on(e,t){return this.tr.on(e,t)}constructor(e,t,n){var s;if(this.ir=[],this.er=void 0,this.tr=new aE,this.rr=(g,x)=>!(!$f(g)||!$f(x))&&Math.abs(g-x)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.R=e.config,this.Qe=e.persistence,this.sr=void 0,this.nr=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.ar=t||Oc,this.lr=n||Oc;var i=this.R.persistence_name||this.R.token,c=this.R.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*$a(c,60,36e3,Yx.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.ur(),this.hr="ph_"+i+"_window_id",this.dr="ph_"+i+"_primary_window_exists",this.vr()){var u=rs.W(this.hr),p=rs.W(this.dr);u&&!p?this.sr=u:rs.V(this.hr),rs.G(this.dr,!0)}if((s=this.R.bootstrap)!=null&&s.sessionID)try{var m=(g=>{var x=g.replace(/-/g,"");if(x.length!==32)throw new Error("Not a valid UUID");if(x[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(x.substring(0,12),16)})(this.R.bootstrap.sessionID);this.cr(this.R.bootstrap.sessionID,new Date().getTime(),m)}catch(g){Yx.error("Invalid sessionID in bootstrap",g)}this.pr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return qe(this.ir)&&(this.ir=[]),this.ir.push(e),this.nr&&e(this.nr,this.sr),()=>{this.ir=this.ir.filter((t=>t!==e))}}vr(){return this.R.persistence!=="memory"&&!this.Qe.Pi&&rs.H()}gr(e){e!==this.sr&&(this.sr=e,this.vr()&&rs.G(this.hr,e))}_r(){return this.sr?this.sr:this.vr()?rs.W(this.hr):null}cr(e,t,n){e===this.nr&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this.nr=e,this.Qe.register({[oy]:[t,e,n]}))}mr(){var e=this.Qe.props[oy];return Rr(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.cr(null,null,null)}destroy(){clearTimeout(this.br),this.br=void 0,this.er&&_e&&(_e.removeEventListener("beforeunload",this.er,{capture:!1}),this.er=void 0),this.ir=[]}pr(){this.er=()=>{this.vr()&&rs.V(this.dr)},kn(_e,"beforeunload",this.er,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.R.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var n=t||new Date().getTime(),[s,i,c]=this.mr(),u=this._r(),p=$f(c)&&Math.abs(n-c)>864e5,m=!1,g=!i,x=!g&&!e&&this.rr(n,s);g||x||p?(i=this.ar(),u=this.lr(),Yx.info("new session ID generated",{sessionId:i,windowId:u,changeReason:{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}}),c=n,m=!0):u||(u=this.lr(),m=!0);var b=$f(s)&&e&&!p?s:n,E=$f(c)?c:new Date().getTime();return this.gr(u),this.cr(i,b,E),e||this.ur(),m&&this.ir.forEach((N=>N(i,u,m?{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}:void 0))),{sessionId:i,windowId:u,sessionStartTimestamp:E,changeReason:m?{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}:void 0,lastActivityTimestamp:s}}ur(){clearTimeout(this.br),this.br=setTimeout((()=>{var[e]=this.mr();if(this.rr(new Date().getTime(),e)){var t=this.nr;this.resetSessionId(),this.tr.emit("forcedIdleReset",{idleSessionId:t})}}),1.1*this.sessionTimeoutMs)}}var CH=["$set_once","$set"],Nc=dn("[SiteApps]");class kH{constructor(e){this._instance=e,this.yr=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}wr(e,t){if(t){var n=this.globalsForEvent(t);this.yr.push(n),this.yr.length>1e3&&(this.yr=this.yr.slice(10))}}get siteAppLoaders(){var e;return(e=yt._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance._addCaptureHook(this.wr.bind(this));this.Er=()=>{e(),this.yr=[],this.Er=void 0}}}globalsForEvent(e){var t,n,s,i,c,u,p;if(!e)throw new Error("Event payload is required");var m={},g=this._instance.get_property("$groups")||[],x=this._instance.get_property("$stored_group_properties")||{};for(var[b,E]of Object.entries(x))m[b]={id:g[b],type:b,properties:E};var{$set_once:N,$set:S}=e;return{event:Qe({},IT(e,CH),{properties:Qe({},e.properties,S?{$set:Qe({},(t=(n=e.properties)==null?void 0:n.$set)!==null&&t!==void 0?t:{},S)}:{},N?{$set_once:Qe({},(s=(i=e.properties)==null?void 0:i.$set_once)!==null&&s!==void 0?s:{},N)}:{}),elements_chain:(c=(u=e.properties)==null?void 0:u.$elements_chain)!==null&&c!==void 0?c:"",distinct_id:(p=e.properties)==null?void 0:p.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:m}}setupSiteApp(e){var t=this.apps[e.id],n=()=>{var u;!t.errored&&this.yr.length&&(Nc.info("Processing "+this.yr.length+" events for site app with id "+e.id),this.yr.forEach((p=>t.processEvent==null?void 0:t.processEvent(p))),t.processedBuffer=!0),Object.values(this.apps).every((p=>p.processedBuffer||p.errored))&&((u=this.Er)==null||u.call(this))},s=!1,i=u=>{t.errored=!u,t.loaded=!0,Nc.info("Site app with id "+e.id+" "+(u?"loaded":"errored")),s&&n()};try{var{processEvent:c}=e.init({posthog:this._instance,callback:u=>{i(u)}});c&&(t.processEvent=c),s=!0}catch(u){Nc.error("Error while initializing PostHog app with config id "+e.id,u),i(!1)}if(s&&t.loaded)try{n()}catch(u){Nc.error("Error while processing buffered events PostHog app with config id "+e.id,u),t.errored=!0}}$r(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var n of e)this.setupSiteApp(n)}Sr(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{n.processEvent==null||n.processEvent(t)}catch(s){Nc.error("Error while processing event "+e.event+" for site app "+n.id,s)}}}onRemoteConfig(e){var t,n,s,i=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.$r(),void this._instance.on("eventCaptured",(m=>this.Sr(m)))):void Nc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((n=this.Er)==null||n.call(this),(s=e.siteApps)!=null&&s.length)if(this.isEnabled){var c=function(m){var g;yt["__$$ph_site_app_"+m]=i._instance,(g=yt.__PosthogExtensions__)==null||g.loadSiteApp==null||g.loadSiteApp(i._instance,p,(x=>{if(x)return Nc.error("Error while initializing PostHog app with config id "+m,x)}))};for(var{id:u,url:p}of e.siteApps)c(u)}else Nc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var LR=function(r,e){if(!r)return!1;var t=r.userAgent;if(t&&TC(t,e))return!0;try{var n=r==null?void 0:r.userAgentData;if(n!=null&&n.brands&&n.brands.some((s=>TC(s==null?void 0:s.brand,e))))return!0}catch{}return!!r.webdriver},cm=(function(r){return r.US="us",r.EU="eu",r.CUSTOM="custom",r})({}),xk="i.posthog.com";class NH{constructor(e){this.kr={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get flagsApiHost(){var e=this.instance.config.flags_api_host;return e?e.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+xk,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.kr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=cm.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=cm.EU:this.kr[this.apiHost]=cm.CUSTOM),this.kr[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(e==="flags")return this.flagsApiHost+t;if(this.region===cm.CUSTOM)return this.apiHost+t;var n=xk+t;switch(e){case"assets":return"https://"+this.region+"-assets."+n;case"api":return"https://"+this.region+"."+n}}}var TH={icontains:(r,e)=>!!_e&&e.href.toLowerCase().indexOf(r.toLowerCase())>-1,not_icontains:(r,e)=>!!_e&&e.href.toLowerCase().indexOf(r.toLowerCase())===-1,regex:(r,e)=>!!_e&&gy(e.href,r),not_regex:(r,e)=>!!_e&&!gy(e.href,r),exact:(r,e)=>e.href===r,is_not:(r,e)=>e.href!==r};class bs{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(n){n===void 0&&(n=!1),t.getWebExperiments((s=>{bs.Pr("retrieved web experiments from the server"),t.Tr=new Map,s.forEach((i=>{if(i.feature_flag_key){var c;t.Tr&&(bs.Pr("setting flag key ",i.feature_flag_key," to web experiment ",i),(c=t.Tr)==null||c.set(i.feature_flag_key,i));var u=t._instance.getFeatureFlag(i.feature_flag_key);jn(u)&&i.variants[u]&&t.Ir(i.name,u,i.variants[u].transforms)}else if(i.variants)for(var p in i.variants){var m=i.variants[p];bs.Cr(m)&&t.Ir(i.name,p,m.transforms)}}))}),n)},this._instance=e,this._instance.onFeatureFlags((n=>{this.onFeatureFlags(n)}))}onFeatureFlags(e){if(this._is_bot())bs.Pr("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(or(this.Tr))return this.Tr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();bs.Pr("applying feature flags",e),e.forEach((t=>{var n;if(this.Tr&&(n=this.Tr)!=null&&n.has(t)){var s,i=this._instance.getFeatureFlag(t),c=(s=this.Tr)==null?void 0:s.get(t);i&&c!=null&&c.variants[i]&&this.Ir(c.name,i,c.variants[i].transforms)}}))}}previewWebExperiment(){var e=bs.getWindowLocation();if(e!=null&&e.search){var t=dy(e==null?void 0:e.search,"__experiment_id"),n=dy(e==null?void 0:e.search,"__experiment_variant");t&&n&&(bs.Pr("previewing web experiments "+t+" && "+n),this.getWebExperiments((s=>{this.Rr(parseInt(t),n,s)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this._instance.config.disable_web_experiments&&!n)return e([]);var s=this._instance.get_property("$web_experiments");if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:i=>{if(i.statusCode!==200||!i.json)return e([]);var c=i.json.experiments||[];return e(c)}})}Rr(e,t,n){var s=n.filter((i=>i.id===e));s&&s.length>0&&(bs.Pr("Previewing web experiment ["+s[0].name+"] with variant ["+t+"]"),this.Ir(s[0].name,t,s[0].variants[t].transforms))}static Cr(e){return!or(e.conditions)&&bs.Fr(e)&&bs.Or(e)}static Fr(e){var t;if(or(e.conditions)||or((t=e.conditions)==null?void 0:t.url))return!0;var n,s,i,c=bs.getWindowLocation();return!!c&&((n=e.conditions)==null||!n.url||TH[(s=(i=e.conditions)==null?void 0:i.urlMatchType)!==null&&s!==void 0?s:"icontains"](e.conditions.url,c))}static getWindowLocation(){return _e==null?void 0:_e.location}static Or(e){var t;if(or(e.conditions)||or((t=e.conditions)==null?void 0:t.utm))return!0;var n=_R();if(n.utm_source){var s,i,c,u,p,m,g,x,b=(s=e.conditions)==null||(s=s.utm)==null||!s.utm_campaign||((i=e.conditions)==null||(i=i.utm)==null?void 0:i.utm_campaign)==n.utm_campaign,E=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_source||((u=e.conditions)==null||(u=u.utm)==null?void 0:u.utm_source)==n.utm_source,N=(p=e.conditions)==null||(p=p.utm)==null||!p.utm_medium||((m=e.conditions)==null||(m=m.utm)==null?void 0:m.utm_medium)==n.utm_medium,S=(g=e.conditions)==null||(g=g.utm)==null||!g.utm_term||((x=e.conditions)==null||(x=x.utm)==null?void 0:x.utm_term)==n.utm_term;return b&&N&&S&&E}return!1}static Pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];Je.info("[WebExperiments] "+e,n)}Ir(e,t,n){this._is_bot()?bs.Pr("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?n.forEach((s=>{if(s.selector){var i;bs.Pr("applying transform of variant "+t+" for experiment "+e+" ",s);var c=(i=document)==null?void 0:i.querySelectorAll(s.selector);c==null||c.forEach((u=>{var p=u;s.html&&(p.innerHTML=s.html),s.css&&p.setAttribute("style",s.css)}))}})):bs.Pr("Control variants leave the page unmodified.")}_is_bot(){return Mo&&this._instance?LR(Mo,this._instance.config.custom_blocked_useragents):void 0}}var RH=dn("[PostHog ExternalIntegrations]"),AH={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class IH{constructor(e){this._instance=e}it(e,t){var n;(n=yt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,e,(s=>{if(s)return RH.error("failed to load script",s);t()}))}startIfEnabledOrStop(){var e=this,t=function(c){var u,p,m;!s||(u=yt.__PosthogExtensions__)!=null&&(u=u.integrations)!=null&&u[c]||e.it(AH[c],(()=>{var g;(g=yt.__PosthogExtensions__)==null||(g=g.integrations)==null||(g=g[c])==null||g.start(e._instance)})),!s&&(p=yt.__PosthogExtensions__)!=null&&(p=p.integrations)!=null&&p[c]&&((m=yt.__PosthogExtensions__)==null||(m=m.integrations)==null||(m=m[c])==null||m.stop())};for(var[n,s]of Object.entries((i=this._instance.config.integrations)!==null&&i!==void 0?i:{})){var i;t(n)}}}var ub="[SessionRecording]",Vp=dn(ub);class wk{get started(){var e;return!((e=this.Mr)==null||!e.isStarted)}get status(){return this.Mr?this.Mr.status:this.Ar&&!this.jr?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.Ar=!1,this.Dr=void 0,this._instance=e,!this._instance.sessionManager)throw Vp.error("started without valid sessionManager"),new Error(ub+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(ub+' cannot be used with cookieless_mode="always"')}get jr(){var e,t=!((e=this._instance.get_property(Ox))==null||!e.enabled),n=!this._instance.config.disable_session_recording,s=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return _e&&t&&n&&!s}startIfEnabledOrStop(e){var t;if(!this.jr||(t=this.Mr)==null||!t.isStarted){var n=!qe(Object.assign)&&!qe(Array.from);this.jr&&n?(this.Lr(e),Vp.info("starting")):this.stopRecording()}}Lr(e){var t,n,s;this.jr&&(yt!=null&&(t=yt.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(n=yt.__PosthogExtensions__)!=null&&n.initSessionRecording?this.Nr(e):(s=yt.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,this.Ur,(i=>{if(i)return Vp.error("could not load recorder",i);this.Nr(e)})))}stopRecording(){var e,t;(e=this.Dr)==null||e.call(this),this.Dr=void 0,(t=this.Mr)==null||t.stop()}zr(){var e;(e=this._instance.persistence)==null||e.unregister(nR)}Hr(e){if(this._instance.persistence){var t,n,s=this._instance.persistence,i=()=>{var c=e.sessionRecording===!1?void 0:e.sessionRecording,u=c==null?void 0:c.sampleRate,p=or(u)?null:parseFloat(u);or(p)&&this.zr();var m=c==null?void 0:c.minimumDurationMilliseconds;s.register({[Ox]:Qe({cache_timestamp:Date.now(),enabled:!!c},c,{networkPayloadCapture:Qe({capturePerformance:e.capturePerformance},c==null?void 0:c.networkPayloadCapture),canvasRecording:{enabled:c==null?void 0:c.recordCanvas,fps:c==null?void 0:c.canvasFps,quality:c==null?void 0:c.canvasQuality},sampleRate:p,minimumDurationMilliseconds:qe(m)?null:m,endpoint:c==null?void 0:c.endpoint,triggerMatchType:c==null?void 0:c.triggerMatchType,masking:c==null?void 0:c.masking,urlTriggers:c==null?void 0:c.urlTriggers})})};i(),(t=this.Dr)==null||t.call(this),this.Dr=(n=this._instance.sessionManager)==null?void 0:n.onSessionId(i)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.Hr(e),this.Ar=!0,this.startIfEnabledOrStop()):this.Ar=!0:Vp.info("skipping remote config with no sessionRecording",e)}log(e,t){var n;t===void 0&&(t="log"),(n=this.Mr)!=null&&n.log?this.Mr.log(e,t):Vp.warn("log called before recorder was ready")}get Ur(){var e,t,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(Ox);return(n==null||(t=n.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}Nr(e){var t,n;if((t=yt.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.Mr||(this.Mr=(n=yt.__PosthogExtensions__)==null?void 0:n.initSessionRecording(this._instance),this.Mr._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.Mr.start(e)}onRRwebEmit(e){var t;(t=this.Mr)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_linked_flag:!0}),(e=this.Mr)==null||e.overrideLinkedFlag()}overrideSampling(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_sampling:!0}),(e=this.Mr)==null||e.overrideSampling()}overrideTrigger(e){var t,n;this.Mr||(n=this._instance.persistence)==null||n.register({[e==="url"?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),(t=this.Mr)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.Mr)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var n;return!((n=this.Mr)==null||!n.tryAddCustomEvent(e,t))}}var gm={},db=()=>{},Uf="posthog",MR=!rH&&(vo==null?void 0:vo.indexOf("MSIE"))===-1&&(vo==null?void 0:vo.indexOf("Mozilla"))===-1,bk=r=>{var e;return Qe({api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,cross_subdomain_cookie:az(Ve==null?void 0:Ve.location),persistence:"localStorage+cookie",persistence_name:"",cookie_persisted_properties:[],loaded:db,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageleave:"if_capture_pageview",defaults:r??"unset",__preview_deferred_init_extensions:!1,debug:ss&&jn(ss==null?void 0:ss.search)&&ss.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_conversations:!1,disable_product_tours:!0,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(_e==null||(e=_e.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var n="Bad HTTP status: "+t.statusCode+" "+t.text;Je.error(n)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:cb},error_tracking:{},_onCapture:db,__preview_eager_load_replay:!1},(t=>({rageclick:!(t&&t>="2025-11-30")||{content_ignorelist:!0},capture_pageview:!(t&&t>="2025-05-24")||"history_change",session_recording:t&&t>="2025-11-30"?{strictMinimumDuration:!0}:{},external_scripts_inject_target:t&&t>="2026-01-30"?"head":"body",internal_or_test_user_hostname:t&&t>="2026-01-30"?/^(localhost|127\.0\.0\.1)$/:void 0}))(r))},_k=r=>{var e={};qe(r.process_person)||(e.person_profiles=r.process_person),qe(r.xhr_headers)||(e.request_headers=r.xhr_headers),qe(r.cookie_name)||(e.persistence_name=r.cookie_name),qe(r.disable_cookie)||(e.disable_persistence=r.disable_cookie),qe(r.store_google)||(e.save_campaign_params=r.store_google),qe(r.verbose)||(e.debug=r.verbose);var t=yn({},e,r);return Rr(r.property_blacklist)&&(qe(r.property_denylist)?t.property_denylist=r.property_blacklist:Rr(r.property_denylist)?t.property_denylist=[...r.property_blacklist,...r.property_denylist]:Je.error("Invalid value for property_denylist config: "+r.property_denylist)),t};class PH{constructor(){this.__forceAllowLocalhost=!1}get Br(){return this.__forceAllowLocalhost}set Br(e){Je.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class Vy{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new PH,this.qr=!1,this.version=Nl.LIB_VERSION,this.bi=new aE,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=bk(),this.SentryIntegration=Dz,this.sentryIntegration=e=>(function(t,n){var s=bR(t,n);return{name:wR,processEvent:i=>s(i)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.Wr=!1,this.Gr=null,this.Vr=null,this.Jr=null,this.featureFlags=new iH(this),this.toolbar=new Mz(this),this.scrollManager=new EH(this),this.pageViewManager=new nk(this),this.surveys=new mH(this),this.conversations=new gH(this),this.logs=new vH(this),this.experiments=new bs(this),this.exceptions=new nH(this),this.rateLimiter=new yH(this),this.requestRouter=new NH(this),this.consent=new Az(this),this.externalIntegrations=new IH(this),this.people={set:(e,t,n)=>{var s=jn(e)?{[e]:t}:e;this.setPersonProperties(s),n==null||n({})},set_once:(e,t,n)=>{var s=jn(e)?{[e]:t}:e;this.setPersonProperties(void 0,s),n==null||n({})}},this.on("eventCaptured",(e=>Je.info('send "'+(e==null?void 0:e.event)+'"',e)))}init(e,t,n){if(n&&n!==Uf){var s,i=(s=gm[n])!==null&&s!==void 0?s:new Vy;return i._init(e,t,n),gm[n]=i,gm[Uf][n]=i,i}return this._init(e,t,n)}_init(e,t,n){var s;if(t===void 0&&(t={}),qe(e)||Gw(e))return Je.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},t.debug=this.Kr(t.debug),this.Yr=t,this.Xr=[],t.person_profiles&&(this.Vr=t.person_profiles),this.set_config(yn({},bk(t.defaults),_k(t),{name:n,token:e})),this.config.on_xhr_error&&Je.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:Al.GZipJS;var i=this.Qr();this.persistence=new Wx(this.config,i),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Wx(Qe({},this.config,{persistence:"sessionStorage"}),i);var c=Qe({},this.persistence.props),u=Qe({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Zr=new wH((A=>this.ts(A)),this.config.request_queue_config),this.es=new _H(this),this.__request_queue=[];var p=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(p||(this.sessionManager=new yk(this),this.sessionPropsManager=new vk(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(Je.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this.rs(p)}),0)):(Je.info("Initializing extensions synchronously"),this.rs(p)),Nl.DEBUG=Nl.DEBUG||this.config.debug,Nl.DEBUG&&Je.info("Starting in debug mode",{this:this,config:t,thisC:Qe({},this.config),p:c,s:u}),((s=t.bootstrap)==null?void 0:s.distinctID)!==void 0){var m,g,x=this.config.get_device_id(Oc()),b=(m=t.bootstrap)!=null&&m.isIdentifiedID?x:t.bootstrap.distinctID;this.persistence.set_property(Tl,(g=t.bootstrap)!=null&&g.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:b})}if(this.ss()){var E,N,S=Object.keys(((E=t.bootstrap)==null?void 0:E.featureFlags)||{}).filter((A=>{var j;return!((j=t.bootstrap)==null||(j=j.featureFlags)==null||!j[A])})).reduce(((A,j)=>{var P;return A[j]=((P=t.bootstrap)==null||(P=P.featureFlags)==null?void 0:P[j])||!1,A}),{}),T=Object.keys(((N=t.bootstrap)==null?void 0:N.featureFlagPayloads)||{}).filter((A=>S[A])).reduce(((A,j)=>{var P,U;return(P=t.bootstrap)!=null&&(P=P.featureFlagPayloads)!=null&&P[j]&&(A[j]=(U=t.bootstrap)==null||(U=U.featureFlagPayloads)==null?void 0:U[j]),A}),{});this.featureFlags.receivedFeatureFlags({featureFlags:S,featureFlagPayloads:T})}if(p)this.register_once({distinct_id:Mp,$device_id:null},"");else if(!this.get_distinct_id()){var R=this.config.get_device_id(Oc());this.register_once({distinct_id:R,$device_id:R},""),this.persistence.set_property(Tl,"anonymous")}return kn(_e,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?Oz(this,(()=>this.ns())):this.ns(),Lc(this.config._onCapture)&&this.config._onCapture!==db&&(Je.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(A=>this.config._onCapture(A.event,A)))),this.config.ip&&Je.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}rs(e){var t=performance.now();this.historyAutocapture=new jz(this),this.historyAutocapture.startIfEnabled();var n=[];n.push((()=>{new Uz(this).startIfEnabledOrStop()})),n.push((()=>{var s;this.siteApps=new kH(this),(s=this.siteApps)==null||s.init()})),e||n.push((()=>{this.sessionRecording=new wk(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||n.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),n.push((()=>{this.autocapture=new _z(this),this.autocapture.startIfEnabled()})),n.push((()=>{this.surveys.loadIfEnabled()})),n.push((()=>{this.logs.loadIfEnabled()})),n.push((()=>{this.conversations.loadIfEnabled()})),n.push((()=>{this.productTours=new lH(this),this.productTours.loadIfEnabled()})),n.push((()=>{this.heatmaps=new qz(this),this.heatmaps.startIfEnabled()})),n.push((()=>{this.webVitalsAutocapture=new Wz(this)})),n.push((()=>{this.exceptionObserver=new Fz(this),this.exceptionObserver.startIfEnabledOrStop()})),n.push((()=>{this.deadClicksAutocapture=new xR(this,Pz),this.deadClicksAutocapture.startIfEnabled()})),n.push((()=>{if(this.os){var s=this.os;this.os=void 0,this.wi(s)}})),this.ls(n,t)}ls(e,t){for(;e.length>0;){if(this.config.__preview_deferred_init_extensions&&performance.now()-t>=30&&e.length>0)return void setTimeout((()=>{this.ls(e,t)}),0);var n=e.shift();if(n)try{n()}catch(i){Je.error("Error initializing extension:",i)}}var s=Math.round(performance.now()-t);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:s}),this.config.__preview_deferred_init_extensions&&Je.info("PostHog extensions initialized ("+s+"ms)")}wi(e){var t,n,s,i,c,u,p,m,g;if(!Ve||!Ve.body)return Je.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.wi(e)}),500);this.config.__preview_deferred_init_extensions&&(this.os=e),this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=rr(e.supportedCompression,Al.GZipJS)?Al.GZipJS:rr(e.supportedCompression,Al.Base64)?Al.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.Vr?this.Vr:"identified_only"}),(n=this.siteApps)==null||n.onRemoteConfig(e),(s=this.sessionRecording)==null||s.onRemoteConfig(e),(i=this.autocapture)==null||i.onRemoteConfig(e),(c=this.heatmaps)==null||c.onRemoteConfig(e),this.surveys.onRemoteConfig(e),this.logs.onRemoteConfig(e),this.conversations.onRemoteConfig(e),(u=this.productTours)==null||u.onRemoteConfig(e),(p=this.webVitalsAutocapture)==null||p.onRemoteConfig(e),(m=this.exceptionObserver)==null||m.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(g=this.deadClicksAutocapture)==null||g.onRemoteConfig(e)}ns(){try{this.config.loaded(this)}catch(n){Je.critical("`loaded` function failed",n)}if(this.us(),this.config.internal_or_test_user_hostname&&ss!=null&&ss.hostname){var e=ss.hostname,t=this.config.internal_or_test_user_hostname;(typeof t=="string"?e===t:t.test(e))&&this.setInternalOrTestUser()}this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.hs()}),1),new xH(this).load(),this.featureFlags.flags()}us(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Zr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&Mc(this.__request_queue,(e=>this.ts(e))),this.__request_queue=[],this.us()}_handle_unload(){var e,t;this.surveys.handlePageUnload(),this.config.request_batching?(this.ds()&&this.capture("$pageleave"),(e=this.Zr)==null||e.unload(),(t=this.es)==null||t.unload()):this.ds()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(MR?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=my(e.url,{ip:this.config.ip?1:0}),e.headers=Qe({},this.config.request_headers,e.headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var n,s,i,c=Qe({},t);c.timeout=c.timeout||6e4,c.url=my(c.url,{_:new Date().getTime().toString(),ver:Nl.LIB_VERSION,compression:c.compression});var u=(n=c.transport)!==null&&n!==void 0?n:"fetch",p=Bv.filter((g=>!c.disableTransport||!g.transport||!c.disableTransport.includes(g.transport))),m=(s=(i=eR(p,(g=>g.transport===u)))==null?void 0:i.method)!==null&&s!==void 0?s:p[0].method;if(!m)throw new Error("No available transport method");m(c)})(Qe({},e,{callback:t=>{var n,s;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((n=(s=this.config).on_request_error)==null||n.call(s,t)),e.callback==null||e.callback(t)}}))))}ts(e){this.es?this.es.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,n=[],s=[],i=[];Mc(e,(u=>{u&&(t=u[0],Rr(t)?i.push(u):Lc(u)?u.call(this):Rr(u)&&t==="alias"?n.push(u):Rr(u)&&t.indexOf("capture")!==-1&&Lc(this[t])?i.push(u):s.push(u))}));var c=function(u,p){Mc(u,(function(m){if(Rr(m[0])){var g=p;Vr(m,(function(x){g=g[x[0]].apply(g,x.slice(1))}))}else this[m[0]].apply(this,m.slice(1))}),p)};c(n,this),c(s,this),c(i,this)}ss(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var s;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Zr){if(this.is_capturing())if(!qe(e)&&jn(e)){var i=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(i&&!this.config.__preview_capture_bot_pageviews)){var c=n!=null&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(c==null||!c.isRateLimited){t!=null&&t.$current_url&&!jn(t==null?void 0:t.$current_url)&&(Je.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var u=new Date,p=(n==null?void 0:n.timestamp)||u,m=Oc(),g={uuid:m,event:e,properties:this.calculateEventProperties(e,t||{},p,m)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&i&&(g.event="$bot_pageview",g.properties.$browser_type="bot"),c&&(g.properties.$lib_rate_limit_remaining_tokens=c.remainingTokens),n!=null&&n.$set&&(g.$set=n==null?void 0:n.$set);var x,b=e!=="$groupidentify",E=this.vs(n==null?void 0:n.$set_once,b);if(E&&(g.$set_once=E),(g=oz(g,n!=null&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=p,qe(n==null?void 0:n.timestamp)||(g.properties.$event_time_override_provided=!0,g.properties.$event_time_override_system_time=u),e===lm.DISMISSED||e===lm.SENT){var N=t==null?void 0:t[Kx.SURVEY_ID],S=t==null?void 0:t[Kx.SURVEY_ITERATION];x={id:N,current_iteration:S},localStorage.getItem(mk(x))||localStorage.setItem(mk(x),"true"),g.$set=Qe({},g.$set,{[cH({id:N,current_iteration:S},e===lm.SENT?"responded":"dismissed")]:!0})}else e===lm.SHOWN&&(g.$set=Qe({},g.$set,{[Kx.SURVEY_LAST_SEEN_DATE]:new Date().toISOString()}));var T=Qe({},g.properties.$set,g.$set);if(Bf(T)||this.setPersonPropertiesForFlags(T),!or(this.config.before_send)){var R=this.cs(g);if(!R)return;g=R}this.bi.emit("eventCaptured",g);var A={method:"POST",url:(s=n==null?void 0:n._url)!==null&&s!==void 0?s:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:g,compression:"best-available",batchKey:n==null?void 0:n._batchKey};return!this.config.request_batching||n&&(n==null||!n._batchKey)||n!=null&&n.send_instantly?this.ts(A):this.Zr.enqueue(A),g}Je.critical("This capture call is ignored due to client rate limiting.")}}else Je.error("No event name provided to posthog.capture")}else Je.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",(t=>e(t.event,t)))}calculateEventProperties(e,t,n,s,i){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var c=i?void 0:this.persistence.remove_event_timer(e),u=Qe({},t);if(u.token=this.config.token,u.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(u.$cookieless_mode=!0),e==="$snapshot"){var p=Qe({},this.persistence.properties(),this.sessionPersistence.properties());return u.distinct_id=p.distinct_id,(!jn(u.distinct_id)&&!Ol(u.distinct_id)||Gw(u.distinct_id))&&Je.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),u}var m,g=Gz(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:x,windowId:b}=this.sessionManager.checkAndGetSessionAndWindowId(i,n.getTime());u.$session_id=x,u.$window_id=b}this.sessionPropsManager&&yn(u,this.sessionPropsManager.getSessionProps());try{var E;this.sessionRecording&&yn(u,this.sessionRecording.sdkDebugProperties),u.$sdk_debug_retry_queue_size=(E=this.es)==null?void 0:E.length}catch(R){u.$sdk_debug_error_capturing_properties=String(R)}if(this.requestRouter.region===cm.CUSTOM&&(u.$lib_custom_api_host=this.config.api_host),m=e!=="$pageview"||i?e!=="$pageleave"||i?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(n):this.pageViewManager.doPageView(n,s),u=yn(u,m),e==="$pageview"&&Ve&&(u.title=Ve.title),!qe(c)){var N=n.getTime()-c;u.$duration=parseFloat((N/1e3).toFixed(3))}vo&&this.config.opt_out_useragent_filter&&(u.$browser_type=this._is_bot()?"bot":"browser"),(u=yn({},g,this.persistence.properties(),this.sessionPersistence.properties(),u)).$is_identified=this._isIdentified(),Rr(this.config.property_denylist)?Vr(this.config.property_denylist,(function(R){delete u[R]})):Je.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var S=this.config.sanitize_properties;S&&(Je.error("sanitize_properties is deprecated. Use before_send instead"),u=S(u,e));var T=this.fs();return u.$process_person_profile=T,T&&!i&&this.ps("_calculate_event_properties"),u}vs(e,t){var n;if(t===void 0&&(t=!0),!this.persistence||!this.fs()||this.qr)return e;var s=this.persistence.get_initial_props(),i=(n=this.sessionPropsManager)==null?void 0:n.getSetOnceProps(),c=yn({},s,i||{},e||{}),u=this.config.sanitize_properties;return u&&(Je.error("sanitize_properties is deprecated. Use before_send instead"),c=u(c,"$set_once")),t&&(this.qr=!0),Bf(c)?void 0:c}register(e,t){var n;(n=this.persistence)==null||n.register(e,t)}register_once(e,t,n){var s;(s=this.persistence)==null||s.register_once(e,t,n)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}gs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){return this.featureFlags.getFeatureFlagPayload(e)}getFeatureFlagResult(e,t){return this.featureFlags.getFeatureFlagResult(e,t)}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateFlags(e,t,n){var s=n!=null&&n.merge?this.featureFlags.getFlagVariants():{},i=n!=null&&n.merge?this.featureFlags.getFlagPayloads():{},c=Qe({},s,e),u=Qe({},i,t),p={};for(var[m,g]of Object.entries(c)){var x=typeof g=="string";p[m]={key:m,enabled:!!x||!!g,variant:x?g:void 0,reason:void 0,metadata:qe(u==null?void 0:u[m])?void 0:{id:0,version:void 0,description:void 0,payload:u[m]}}}this.featureFlags.receivedFeatureFlags({flags:p})}updateEarlyAccessFeatureEnrollment(e,t,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,n)}getEarlyAccessFeatures(e,t,n){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,n)}on(e,t){return this.bi.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,n;return(t=(n=this.sessionManager)==null?void 0:n.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=dH),this.surveys.displaySurvey(e,t)}cancelPendingSurvey(e){this.surveys.cancelPendingSurvey(e)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,n){if(!this.__loaded||!this.persistence)return Je.uninitializedWarning("posthog.identify");if(Ol(e)&&(e=e.toString(),Je.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))Je.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==Mp){if(this.ps("posthog.identify")){var s=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var i=s;this.register_once({$had_persisted_distinct_id:!0,$device_id:i},"")}e!==s&&e!==this.get_property(nm)&&(this.unregister(nm),this.register({distinct_id:e}));var c=(this.persistence.get_property(Tl)||"anonymous")==="anonymous";e!==s&&c?(this.persistence.set_property(Tl,"identified"),this.setPersonPropertiesForFlags(Qe({},n||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:s},{$set:t||{},$set_once:n||{}}),this.Jr=ck(e,t,n),this.featureFlags.setAnonymousDistinctId(s)):(t||n)&&this.setPersonProperties(t,n),e!==s&&(this.reloadFeatureFlags(),this.unregister(iy))}}else Je.critical('The string "'+Mp+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else Je.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.ps("posthog.setPersonProperties")){var n=ck(this.get_distinct_id(),e,t);this.Jr!==n?(this.setPersonPropertiesForFlags(Qe({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Jr=n):Je.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,n){if(e&&t){var s=this.getGroups();s[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:Qe({},s,{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),s[e]===t||n||this.reloadFeatureFlags()}else Je.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.ps("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,s,i;if(Je.info("reset"),!this.__loaded)return Je.uninitializedWarning("posthog.reset");var c=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(n=this.sessionPersistence)==null||n.clear(),this.surveys.reset(),this.featureFlags.reset(),(s=this.persistence)==null||s.set_property(Tl,"anonymous"),(i=this.sessionManager)==null||i.resetSessionId(),this.Jr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:Mp,$device_id:null},"");else{var u=this.config.get_device_id(Oc());this.register_once({distinct_id:u,$device_id:e?u:c},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),s=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&n){var i,c=(i=e.timestampLookBack)!==null&&i!==void 0?i:10;if(!n)return s;s+="?t="+Math.max(Math.floor((new Date().getTime()-n)/1e3)-c,0)}return s}alias(e,t){return e===this.get_property(tR)?(Je.critical("Attempting to create alias for existing People user - aborting."),-2):this.ps("posthog.alias")?(qe(t)&&(t=this.get_distinct_id()),e!==t?(this.gs(nm,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(Je.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=Qe({},this.config);if(Fn(e)){var n,s,i,c,u,p,m;yn(this.config,_k(e));var g=this.Qr();(n=this.persistence)==null||n.update_config(this.config,t,g),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Wx(Qe({},this.config,{persistence:"sessionStorage"}),g);var x=this.Kr(this.config.debug);Fl(x)&&(this.config.debug=x),Fl(this.config.debug)&&(this.config.debug?(Nl.DEBUG=!0,on.H()&&on.G("ph_debug","true"),Je.info("set_config",{config:e,oldConfig:t,newConfig:Qe({},this.config)})):(Nl.DEBUG=!1,on.H()&&on.V("ph_debug"))),(s=this.exceptionObserver)==null||s.onConfigChange(),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(c=this.autocapture)==null||c.startIfEnabled(),(u=this.heatmaps)==null||u.startIfEnabled(),(p=this.exceptionObserver)==null||p.startIfEnabledOrStop(),this.surveys.loadIfEnabled(),this._s(),(m=this.externalIntegrations)==null||m.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,n={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(n).some(Boolean)){var s,i,c,u,p;(s=this.sessionManager)==null||s.checkAndGetSessionAndWindowId(),n.sampling&&((i=this.sessionRecording)==null||i.overrideSampling()),n.linked_flag&&((c=this.sessionRecording)==null||c.overrideLinkedFlag()),n.url_trigger&&((u=this.sessionRecording)==null||u.overrideTrigger("url")),n.event_trigger&&((p=this.sessionRecording)==null||p.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var n=new Error("PostHog syntheticException"),s=this.exceptions.buildProperties(e,{handled:!0,syntheticException:n});return this.exceptions.sendExceptionEvent(Qe({},s,t))}startExceptionAutocapture(e){this.set_config({capture_exceptions:e==null||e})}stopExceptionAutocapture(){this.set_config({capture_exceptions:!1})}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:Uf;return t!==Uf&&(t=Uf+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(Tl))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(Tl))==="identified"}fs(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Bf(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[nm])&&((t=this.persistence)==null||(t=t.props)==null||!t[ly]))}ds(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.fs()||this.ps("posthog.createPersonProfile")&&this.setPersonProperties({},{})}setInternalOrTestUser(){this.ps("posthog.setInternalOrTestUser")&&this.setPersonProperties({$internal_or_test_user:!0})}ps(e){return this.config.person_profiles==="never"?(Je.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.gs(ly,!0),!0)}Qr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}_s(){var e,t,n,s,i=this.Qr();return((e=this.persistence)==null?void 0:e.Pi)!==i&&((n=this.persistence)==null||n.set_disabled(i)),((t=this.sessionPersistence)==null?void 0:t.Pi)!==i&&((s=this.sessionPersistence)==null||s.set_disabled(i)),i}opt_in_capturing(e){var t;if(this.config.cookieless_mode!=="always"){var n,s,i;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(n=this.sessionManager)==null||n.destroy(),(s=this.pageViewManager)==null||s.destroy(),this.sessionManager=new yk(this),this.pageViewManager=new nk(this),this.persistence&&(this.sessionPropsManager=new vk(this,this.sessionManager,this.persistence)),this.sessionRecording=new wk(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this._s(),this.us(),(t=this.sessionRecording)==null||t.startIfEnabledOrStop(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(qe(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((i=e==null?void 0:e.captureEventName)!==null&&i!==void 0?i:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.hs()}else Je.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t,n;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this._s(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:Mp,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),(t=this.pageViewManager)==null||t.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(n=this.sessionRecording)==null||n.stopRecording(),this.sessionRecording=void 0,this.hs())):Je.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===Rl.GRANTED?"granted":e===Rl.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this._s()}_is_bot(){return Mo?LR(Mo,this.config.custom_blocked_useragents):void 0}hs(){Ve&&(Ve.visibilityState==="visible"?this.Wr||(this.Wr=!0,this.capture("$pageview",{title:Ve.title},{send_instantly:!0}),this.Gr&&(Ve.removeEventListener("visibilitychange",this.Gr),this.Gr=null)):this.Gr||(this.Gr=this.hs.bind(this),kn(Ve,"visibilitychange",this.Gr)))}debug(e){e===!1?(_e==null||_e.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(_e==null||_e.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}M(){var e,t,n,s,i,c,u,p=this.Yr||{};return"advanced_disable_flags"in p?!!p.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(Je.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(n="advanced_disable_decide",s=!1,i=Je,c=(t="advanced_disable_flags")in(e=p)&&!or(e[t]),u=n in e&&!or(e[n]),c?e[t]:u?(i&&i.warn("Config field '"+n+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[n]):s)}cs(e){if(or(this.config.before_send))return e;var t=Rr(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var s of t){if(n=s(n),or(n)){var i="Event '"+e.event+"' was rejected in beforeSend function";return _8(e.event)?Je.warn(i+". This can cause unexpected behavior."):Je.info(i),null}n.properties&&!Bf(n.properties)||Je.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return n}getPageViewId(){var e;return(e=this.pageViewManager.Kt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(n)})}Kr(e){var t=Fl(e)&&!e,n=on.H()&&on.q("ph_debug")==="true";return!t&&(!!n||e)}}(function(r,e){for(var t=0;t<e.length;t++)r.prototype[e[t]]=sz(r.prototype[e[t]])})(Vy,["identify"]);var Ek,La=(Ek=gm[Uf]=new Vy,(function(){function r(){r.done||(r.done=!0,MR=!1,Vr(gm,(function(e){e._dom_loaded()})))}Ve!=null&&Ve.addEventListener?Ve.readyState==="complete"?r():kn(Ve,"DOMContentLoaded",r,{capture:!1}):_e&&Je.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")})(),Ek),$R=w.createContext({client:La,bootstrap:void 0});function UR(r,e,t){if(t===void 0&&(t=new WeakMap),r===e)return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(t.has(r)&&t.get(r)===e)return!0;t.set(r,e);var n=Object.keys(r),s=Object.keys(e);if(n.length!==s.length)return!1;for(var i=0,c=n;i<c.length;i++){var u=c[i];if(!s.includes(u)||!UR(r[u],e[u],t))return!1}return!0}function FH(r){var e,t,n=r.children,s=r.client,i=r.apiKey,c=r.options,u=w.useRef(null),p=w.useMemo(function(){return s?(i&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),c&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),s):(i||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),La)},[s,i,JSON.stringify(c)]);return w.useEffect(function(){if(!s){var m=u.current;m?(i!==m.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),c&&!UR(c,m.options)&&La.set_config(c),u.current={apiKey:i,options:c??{}}):(La.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),La.init(i,c),u.current={apiKey:i,options:c??{}})}},[s,i,JSON.stringify(c)]),nr.createElement($R.Provider,{value:{client:p,bootstrap:(e=c==null?void 0:c.bootstrap)!==null&&e!==void 0?e:(t=s==null?void 0:s.config)===null||t===void 0?void 0:t.bootstrap}},n)}var Jx=function(r){return typeof r=="function"},fb=function(r,e){return fb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},fb(r,e)};function jH(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");fb(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var OH={componentStack:null,exceptionEvent:null,error:null},DH={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(r){jH(e,r);function e(t){var n=r.call(this,t)||this;return n.state=OH,n}return e.prototype.componentDidCatch=function(t,n){var s=this.props.additionalProperties,i;Jx(s)?i=s(t):typeof s=="object"&&(i=s);var c=this.context.client,u=c.captureException(t,i),p=n.componentStack;this.setState({error:t,componentStack:p??null,exceptionEvent:u})},e.prototype.render=function(){var t=this.props,n=t.children,s=t.fallback,i=this.state;if(i.componentStack==null)return Jx(n)?n():n;var c=Jx(s)?nr.createElement(s,{error:i.error,componentStack:i.componentStack,exceptionEvent:i.exceptionEvent}):s;return nr.isValidElement(c)?c:(console.warn(DH.INVALID_FALLBACK),nr.createElement(nr.Fragment,null))},e.contextType=$R,e})(nr.Component);function Or(){var e;const r=w.useContext(K_);if(r.isLoading)return{debug:async()=>{},info:async()=>{},warn:async()=>{},error:async()=>{}};if(!((e=r.services)!=null&&e.logging))throw new Error("Logging provider not available. Make sure PlatformProvider is wrapping your component.");return r.services.logging}function Sk(r){try{const e=r.split(".")[1];return JSON.parse(atob(e.replace(/-/g,"+").replace(/_/g,"/"))).email??null}catch{return null}}const LH=({children:r})=>{const e=Ul(),t=Or();return w.useEffect(()=>{if(typeof window>"u"||!jw){console.warn(" PostHog: Not initialized - missing or invalid key");return}(async()=>{const s=await Nm(t),i=s!=null&&s.id_token?Sk(s.id_token):null;La.init(jw,{api_host:XN,autocapture:!0,capture_pageview:!0,capture_pageleave:!0,capture_dead_clicks:!1,disable_session_recording:!0,loaded:c=>{i&&c.identify(i,{email:i}),console.log("PostHog: Initialized successfully")},debug:BN==="dev"})})()},[]),w.useEffect(()=>{var s;const n=i=>{"token"in i&&(i.token.newValue?Nm(t).then(c=>{const u=c!=null&&c.id_token?Sk(c.id_token):null;u&&La.identify(u,{email:u})}):La.reset())};return(s=e==null?void 0:e.onChanged)==null||s.call(e,n),()=>{var i;(i=e==null?void 0:e.removeChangeListener)==null||i.call(e,n)}},[e,t]),d.jsx(FH,{client:La,children:r})},Qr=w.forwardRef(({className:r,type:e,...t},n)=>d.jsx("input",{type:e,className:_r("flex h-10 w-full rounded-md border border-neutral-200 bg-white px-3 py-2 text-base text-neutral-950 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-neutral-950 placeholder:text-neutral-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-border dark:bg-card dark:text-gray-100 dark:ring-offset-neutral-950 dark:file:text-neutral-50 dark:placeholder:text-neutral-400 dark:focus-visible:ring-primary",r),ref:n,...t}));Qr.displayName="Input";const Ck=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,kk=xT,lE=(r,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return kk(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,c=Object.keys(s).map(m=>{const g=t==null?void 0:t[m],x=i==null?void 0:i[m];if(g===null)return null;const b=Ck(g)||Ck(x);return s[m][b]}),u=t&&Object.entries(t).reduce((m,g)=>{let[x,b]=g;return b===void 0||(m[x]=b),m},{}),p=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((m,g)=>{let{class:x,className:b,...E}=g;return Object.entries(E).every(N=>{let[S,T]=N;return Array.isArray(T)?T.includes({...i,...u}[S]):{...i,...u}[S]===T})?[...m,x,b]:m},[]);return kk(r,c,p,t==null?void 0:t.class,t==null?void 0:t.className)},MH=lE("rounded-lg border border-neutral-200 bg-white text-neutral-950 shadow-sm dark:border-border dark:bg-card dark:text-card-foreground",{variants:{variant:{default:"",TemplateCard:"",ReferenceSourcesCard:"",IntegrationsCard:""}},defaultVariants:{variant:"default"}}),li=w.forwardRef(({className:r,variant:e,...t},n)=>d.jsx("div",{ref:n,className:_r(MH({variant:e,className:r})),...t}));li.displayName="Card";const $i=w.forwardRef(({className:r,cardVariant:e,...t},n)=>d.jsx("div",{ref:n,className:_r(e==="TemplateCard"?"flex flex-col space-y-1 p-4":"flex flex-col space-y-1.5 p-6",r),...t}));$i.displayName="CardHeader";const Ui=w.forwardRef(({className:r,...e},t)=>d.jsx("h3",{ref:t,className:_r("font-semibold leading-none tracking-tight",r),...e}));Ui.displayName="CardTitle";const $H=w.forwardRef(({className:r,...e},t)=>d.jsx("p",{ref:t,className:_r("text-sm text-neutral-500 dark:text-neutral-400",r),...e}));$H.displayName="CardDescription";const ci=w.forwardRef(({className:r,cardVariant:e,...t},n)=>d.jsx("div",{ref:n,className:_r(e==="TemplateCard"?"p-0 pt-0":"p-6 pt-0",r),...t}));ci.displayName="CardContent";const UH=w.forwardRef(({className:r,...e},t)=>d.jsx("div",{ref:t,className:_r("flex items-center p-6 pt-0",r),...e}));UH.displayName="CardFooter";function Nk(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function qc(...r){return e=>{let t=!1;const n=r.map(s=>{const i=Nk(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():Nk(r[s],null)}}}}function Nn(...r){return w.useCallback(qc(...r),r)}var zH=Symbol.for("react.lazy"),vy=Tb[" use ".trim().toString()];function HH(r){return typeof r=="object"&&r!==null&&"then"in r}function zR(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===zH&&"_payload"in r&&HH(r._payload)}function BH(r){const e=WH(r),t=w.forwardRef((n,s)=>{let{children:i,...c}=n;zR(i)&&typeof vy=="function"&&(i=vy(i._payload));const u=w.Children.toArray(i),p=u.find(qH);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}var GH=BH("Slot");function WH(r){const e=w.forwardRef((t,n)=>{let{children:s,...i}=t;if(zR(s)&&typeof vy=="function"&&(s=vy(s._payload)),w.isValidElement(s)){const c=YH(s),u=KH(i,s.props);return s.type!==w.Fragment&&(u.ref=n?qc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var VH=Symbol("radix.slottable");function qH(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===VH}function KH(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function YH(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}const JH=lE("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-neutral-950 dark:focus-visible:ring-primary",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 dark:bg-primary dark:text-primary-foreground dark:hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 dark:bg-destructive dark:text-destructive-foreground dark:hover:bg-destructive/90",outline:"border border-neutral-200 bg-background hover:bg-accent hover:text-accent-foreground dark:border-neutral-800 dark:bg-background dark:hover:bg-accent dark:hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 dark:bg-secondary dark:text-secondary-foreground dark:hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent dark:hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline dark:text-primary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ze=w.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const c=n?GH:"button";return d.jsx(c,{className:_r(JH({variant:e,size:t,className:r})),ref:i,...s})});ze.displayName="Button";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XH=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),HR=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var QH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZH=w.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:c,...u},p)=>w.createElement("svg",{ref:p,...QH,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:HR("lucide",s),...u},[...c.map(([m,g])=>w.createElement(m,g)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=(r,e)=>{const t=w.forwardRef(({className:n,...s},i)=>w.createElement(ZH,{ref:i,iconNode:e,className:HR(`lucide-${XH(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=qt("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=qt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=qt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=qt("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=qt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=qt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=qt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=qt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=qt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ev=qt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=qt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uc=qt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=qt("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=qt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=qt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=qt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=qt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=qt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=qt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jf=qt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=qt("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qx=qt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=qt("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=qt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=qt("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=qt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=qt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=qt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=qt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=qt("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=qt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=qt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=qt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=qt("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=qt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=qt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=qt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xy=qt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=qt("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=qt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Ct(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r==null||r(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function gB(r,e){const t=w.createContext(e),n=i=>{const{children:c,...u}=i,p=w.useMemo(()=>u,Object.values(u));return d.jsx(t.Provider,{value:p,children:c})};n.displayName=r+"Provider";function s(i){const c=w.useContext(t);if(c)return c;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,s]}function Ba(r,e=[]){let t=[];function n(i,c){const u=w.createContext(c),p=t.length;t=[...t,c];const m=x=>{var R;const{scope:b,children:E,...N}=x,S=((R=b==null?void 0:b[r])==null?void 0:R[p])||u,T=w.useMemo(()=>N,Object.values(N));return d.jsx(S.Provider,{value:T,children:E})};m.displayName=i+"Provider";function g(x,b){var S;const E=((S=b==null?void 0:b[r])==null?void 0:S[p])||u,N=w.useContext(E);if(N)return N;if(c!==void 0)return c;throw new Error(`\`${x}\` must be used within \`${i}\``)}return[m,g]}const s=()=>{const i=t.map(c=>w.createContext(c));return function(u){const p=(u==null?void 0:u[r])||i;return w.useMemo(()=>({[`__scope${r}`]:{...u,[r]:p}}),[u,p])}};return s.scopeName=r,[n,vB(s,...e)]}function vB(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const c=n.reduce((u,{useScope:p,scopeName:m})=>{const x=p(i)[`__scope${m}`];return{...u,...x}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:c}),[c])}};return t.scopeName=e.scopeName,t}var Dl=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},yB=Tb[" useInsertionEffect ".trim().toString()]||Dl;function Kc({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[s,i,c]=xB({defaultProp:e,onChange:t}),u=r!==void 0,p=u?r:s;{const g=w.useRef(r!==void 0);w.useEffect(()=>{const x=g.current;x!==u&&console.warn(`${n} is changing from ${x?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=u},[u,n])}const m=w.useCallback(g=>{var x;if(u){const b=wB(g)?g(r):g;b!==r&&((x=c.current)==null||x.call(c,b))}else i(g)},[u,r,i,c]);return[p,m]}function xB({defaultProp:r,onChange:e}){const[t,n]=w.useState(r),s=w.useRef(t),i=w.useRef(e);return yB(()=>{i.current=e},[e]),w.useEffect(()=>{var c;s.current!==t&&((c=i.current)==null||c.call(i,t),s.current=t)},[t,s]),[t,n,i]}function wB(r){return typeof r=="function"}const bB=["top","right","bottom","left"],Gc=Math.min,Lo=Math.max,wy=Math.round,Cv=Math.floor,za=r=>({x:r,y:r}),_B={left:"right",right:"left",bottom:"top",top:"bottom"},EB={start:"end",end:"start"};function hb(r,e,t){return Lo(r,Gc(e,t))}function Ll(r,e){return typeof r=="function"?r(e):r}function Ml(r){return r.split("-")[0]}function hh(r){return r.split("-")[1]}function cE(r){return r==="x"?"y":"x"}function uE(r){return r==="y"?"height":"width"}const SB=new Set(["top","bottom"]);function Ua(r){return SB.has(Ml(r))?"y":"x"}function dE(r){return cE(Ua(r))}function CB(r,e,t){t===void 0&&(t=!1);const n=hh(r),s=dE(r),i=uE(s);let c=s==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(c=by(c)),[c,by(c)]}function kB(r){const e=by(r);return[pb(r),e,pb(e)]}function pb(r){return r.replace(/start|end/g,e=>EB[e])}const Ak=["left","right"],Ik=["right","left"],NB=["top","bottom"],TB=["bottom","top"];function RB(r,e,t){switch(r){case"top":case"bottom":return t?e?Ik:Ak:e?Ak:Ik;case"left":case"right":return e?NB:TB;default:return[]}}function AB(r,e,t,n){const s=hh(r);let i=RB(Ml(r),t==="start",n);return s&&(i=i.map(c=>c+"-"+s),e&&(i=i.concat(i.map(pb)))),i}function by(r){return r.replace(/left|right|bottom|top/g,e=>_B[e])}function IB(r){return{top:0,right:0,bottom:0,left:0,...r}}function VR(r){return typeof r!="number"?IB(r):{top:r,right:r,bottom:r,left:r}}function _y(r){const{x:e,y:t,width:n,height:s}=r;return{width:n,height:s,top:t,left:e,right:e+n,bottom:t+s,x:e,y:t}}function Pk(r,e,t){let{reference:n,floating:s}=r;const i=Ua(e),c=dE(e),u=uE(c),p=Ml(e),m=i==="y",g=n.x+n.width/2-s.width/2,x=n.y+n.height/2-s.height/2,b=n[u]/2-s[u]/2;let E;switch(p){case"top":E={x:g,y:n.y-s.height};break;case"bottom":E={x:g,y:n.y+n.height};break;case"right":E={x:n.x+n.width,y:x};break;case"left":E={x:n.x-s.width,y:x};break;default:E={x:n.x,y:n.y}}switch(hh(e)){case"start":E[c]-=b*(t&&m?-1:1);break;case"end":E[c]+=b*(t&&m?-1:1);break}return E}async function PB(r,e){var t;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:c,elements:u,strategy:p}=r,{boundary:m="clippingAncestors",rootBoundary:g="viewport",elementContext:x="floating",altBoundary:b=!1,padding:E=0}=Ll(e,r),N=VR(E),T=u[b?x==="floating"?"reference":"floating":x],R=_y(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(T)))==null||t?T:T.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(u.floating)),boundary:m,rootBoundary:g,strategy:p})),A=x==="floating"?{x:n,y:s,width:c.floating.width,height:c.floating.height}:c.reference,j=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u.floating)),P=await(i.isElement==null?void 0:i.isElement(j))?await(i.getScale==null?void 0:i.getScale(j))||{x:1,y:1}:{x:1,y:1},U=_y(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:A,offsetParent:j,strategy:p}):A);return{top:(R.top-U.top+N.top)/P.y,bottom:(U.bottom-R.bottom+N.bottom)/P.y,left:(R.left-U.left+N.left)/P.x,right:(U.right-R.right+N.right)/P.x}}const FB=async(r,e,t)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:c}=t,u=i.filter(Boolean),p=await(c.isRTL==null?void 0:c.isRTL(e));let m=await c.getElementRects({reference:r,floating:e,strategy:s}),{x:g,y:x}=Pk(m,n,p),b=n,E={},N=0;for(let T=0;T<u.length;T++){var S;const{name:R,fn:A}=u[T],{x:j,y:P,data:U,reset:B}=await A({x:g,y:x,initialPlacement:n,placement:b,strategy:s,middlewareData:E,rects:m,platform:{...c,detectOverflow:(S=c.detectOverflow)!=null?S:PB},elements:{reference:r,floating:e}});g=j??g,x=P??x,E={...E,[R]:{...E[R],...U}},B&&N<=50&&(N++,typeof B=="object"&&(B.placement&&(b=B.placement),B.rects&&(m=B.rects===!0?await c.getElementRects({reference:r,floating:e,strategy:s}):B.rects),{x:g,y:x}=Pk(m,b,p)),T=-1)}return{x:g,y:x,placement:b,strategy:s,middlewareData:E}},jB=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:s,rects:i,platform:c,elements:u,middlewareData:p}=e,{element:m,padding:g=0}=Ll(r,e)||{};if(m==null)return{};const x=VR(g),b={x:t,y:n},E=dE(s),N=uE(E),S=await c.getDimensions(m),T=E==="y",R=T?"top":"left",A=T?"bottom":"right",j=T?"clientHeight":"clientWidth",P=i.reference[N]+i.reference[E]-b[E]-i.floating[N],U=b[E]-i.reference[E],B=await(c.getOffsetParent==null?void 0:c.getOffsetParent(m));let $=B?B[j]:0;(!$||!await(c.isElement==null?void 0:c.isElement(B)))&&($=u.floating[j]||i.floating[N]);const Y=P/2-U/2,J=$/2-S[N]/2-1,he=Gc(x[R],J),te=Gc(x[A],J),ue=he,we=$-S[N]-te,ie=$/2-S[N]/2+Y,se=hb(ue,ie,we),pe=!p.arrow&&hh(s)!=null&&ie!==se&&i.reference[N]/2-(ie<ue?he:te)-S[N]/2<0,ee=pe?ie<ue?ie-ue:ie-we:0;return{[E]:b[E]+ee,data:{[E]:se,centerOffset:ie-se-ee,...pe&&{alignmentOffset:ee}},reset:pe}}}),OB=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:s,middlewareData:i,rects:c,initialPlacement:u,platform:p,elements:m}=e,{mainAxis:g=!0,crossAxis:x=!0,fallbackPlacements:b,fallbackStrategy:E="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:S=!0,...T}=Ll(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const R=Ml(s),A=Ua(u),j=Ml(u)===u,P=await(p.isRTL==null?void 0:p.isRTL(m.floating)),U=b||(j||!S?[by(u)]:kB(u)),B=N!=="none";!b&&B&&U.push(...AB(u,S,N,P));const $=[u,...U],Y=await p.detectOverflow(e,T),J=[];let he=((n=i.flip)==null?void 0:n.overflows)||[];if(g&&J.push(Y[R]),x){const ie=CB(s,c,P);J.push(Y[ie[0]],Y[ie[1]])}if(he=[...he,{placement:s,overflows:J}],!J.every(ie=>ie<=0)){var te,ue;const ie=(((te=i.flip)==null?void 0:te.index)||0)+1,se=$[ie];if(se&&(!(x==="alignment"?A!==Ua(se):!1)||he.every(G=>Ua(G.placement)===A?G.overflows[0]>0:!0)))return{data:{index:ie,overflows:he},reset:{placement:se}};let pe=(ue=he.filter(ee=>ee.overflows[0]<=0).sort((ee,G)=>ee.overflows[1]-G.overflows[1])[0])==null?void 0:ue.placement;if(!pe)switch(E){case"bestFit":{var we;const ee=(we=he.filter(G=>{if(B){const z=Ua(G.placement);return z===A||z==="y"}return!0}).map(G=>[G.placement,G.overflows.filter(z=>z>0).reduce((z,K)=>z+K,0)]).sort((G,z)=>G[1]-z[1])[0])==null?void 0:we[0];ee&&(pe=ee);break}case"initialPlacement":pe=u;break}if(s!==pe)return{reset:{placement:pe}}}return{}}}};function Fk(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function jk(r){return bB.some(e=>r[e]>=0)}const DB=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t,platform:n}=e,{strategy:s="referenceHidden",...i}=Ll(r,e);switch(s){case"referenceHidden":{const c=await n.detectOverflow(e,{...i,elementContext:"reference"}),u=Fk(c,t.reference);return{data:{referenceHiddenOffsets:u,referenceHidden:jk(u)}}}case"escaped":{const c=await n.detectOverflow(e,{...i,altBoundary:!0}),u=Fk(c,t.floating);return{data:{escapedOffsets:u,escaped:jk(u)}}}default:return{}}}}},qR=new Set(["left","top"]);async function LB(r,e){const{placement:t,platform:n,elements:s}=r,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),c=Ml(t),u=hh(t),p=Ua(t)==="y",m=qR.has(c)?-1:1,g=i&&p?-1:1,x=Ll(e,r);let{mainAxis:b,crossAxis:E,alignmentAxis:N}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return u&&typeof N=="number"&&(E=u==="end"?N*-1:N),p?{x:E*g,y:b*m}:{x:b*m,y:E*g}}const MB=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:s,y:i,placement:c,middlewareData:u}=e,p=await LB(e,r);return c===((t=u.offset)==null?void 0:t.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:s+p.x,y:i+p.y,data:{...p,placement:c}}}}},$B=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:s,platform:i}=e,{mainAxis:c=!0,crossAxis:u=!1,limiter:p={fn:R=>{let{x:A,y:j}=R;return{x:A,y:j}}},...m}=Ll(r,e),g={x:t,y:n},x=await i.detectOverflow(e,m),b=Ua(Ml(s)),E=cE(b);let N=g[E],S=g[b];if(c){const R=E==="y"?"top":"left",A=E==="y"?"bottom":"right",j=N+x[R],P=N-x[A];N=hb(j,N,P)}if(u){const R=b==="y"?"top":"left",A=b==="y"?"bottom":"right",j=S+x[R],P=S-x[A];S=hb(j,S,P)}const T=p.fn({...e,[E]:N,[b]:S});return{...T,data:{x:T.x-t,y:T.y-n,enabled:{[E]:c,[b]:u}}}}}},UB=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:s,rects:i,middlewareData:c}=e,{offset:u=0,mainAxis:p=!0,crossAxis:m=!0}=Ll(r,e),g={x:t,y:n},x=Ua(s),b=cE(x);let E=g[b],N=g[x];const S=Ll(u,e),T=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(p){const j=b==="y"?"height":"width",P=i.reference[b]-i.floating[j]+T.mainAxis,U=i.reference[b]+i.reference[j]-T.mainAxis;E<P?E=P:E>U&&(E=U)}if(m){var R,A;const j=b==="y"?"width":"height",P=qR.has(Ml(s)),U=i.reference[x]-i.floating[j]+(P&&((R=c.offset)==null?void 0:R[x])||0)+(P?0:T.crossAxis),B=i.reference[x]+i.reference[j]+(P?0:((A=c.offset)==null?void 0:A[x])||0)-(P?T.crossAxis:0);N<U?N=U:N>B&&(N=B)}return{[b]:E,[x]:N}}}},zB=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:s,rects:i,platform:c,elements:u}=e,{apply:p=()=>{},...m}=Ll(r,e),g=await c.detectOverflow(e,m),x=Ml(s),b=hh(s),E=Ua(s)==="y",{width:N,height:S}=i.floating;let T,R;x==="top"||x==="bottom"?(T=x,R=b===(await(c.isRTL==null?void 0:c.isRTL(u.floating))?"start":"end")?"left":"right"):(R=x,T=b==="end"?"top":"bottom");const A=S-g.top-g.bottom,j=N-g.left-g.right,P=Gc(S-g[T],A),U=Gc(N-g[R],j),B=!e.middlewareData.shift;let $=P,Y=U;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(Y=j),(n=e.middlewareData.shift)!=null&&n.enabled.y&&($=A),B&&!b){const he=Lo(g.left,0),te=Lo(g.right,0),ue=Lo(g.top,0),we=Lo(g.bottom,0);E?Y=N-2*(he!==0||te!==0?he+te:Lo(g.left,g.right)):$=S-2*(ue!==0||we!==0?ue+we:Lo(g.top,g.bottom))}await p({...e,availableWidth:Y,availableHeight:$});const J=await c.getDimensions(u.floating);return N!==J.width||S!==J.height?{reset:{rects:!0}}:{}}}};function qy(){return typeof window<"u"}function ph(r){return KR(r)?(r.nodeName||"").toLowerCase():"#document"}function $o(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Ga(r){var e;return(e=(KR(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function KR(r){return qy()?r instanceof Node||r instanceof $o(r).Node:!1}function Bi(r){return qy()?r instanceof Element||r instanceof $o(r).Element:!1}function Ha(r){return qy()?r instanceof HTMLElement||r instanceof $o(r).HTMLElement:!1}function Ok(r){return!qy()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof $o(r).ShadowRoot}const HB=new Set(["inline","contents"]);function Km(r){const{overflow:e,overflowX:t,overflowY:n,display:s}=Gi(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!HB.has(s)}const BB=new Set(["table","td","th"]);function GB(r){return BB.has(ph(r))}const WB=[":popover-open",":modal"];function Ky(r){return WB.some(e=>{try{return r.matches(e)}catch{return!1}})}const VB=["transform","translate","scale","rotate","perspective"],qB=["transform","translate","scale","rotate","perspective","filter"],KB=["paint","layout","strict","content"];function fE(r){const e=hE(),t=Bi(r)?Gi(r):r;return VB.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||qB.some(n=>(t.willChange||"").includes(n))||KB.some(n=>(t.contain||"").includes(n))}function YB(r){let e=Wc(r);for(;Ha(e)&&!ih(e);){if(fE(e))return e;if(Ky(e))return null;e=Wc(e)}return null}function hE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const JB=new Set(["html","body","#document"]);function ih(r){return JB.has(ph(r))}function Gi(r){return $o(r).getComputedStyle(r)}function Yy(r){return Bi(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Wc(r){if(ph(r)==="html")return r;const e=r.assignedSlot||r.parentNode||Ok(r)&&r.host||Ga(r);return Ok(e)?e.host:e}function YR(r){const e=Wc(r);return ih(e)?r.ownerDocument?r.ownerDocument.body:r.body:Ha(e)&&Km(e)?e:YR(e)}function Om(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=YR(r),i=s===((n=r.ownerDocument)==null?void 0:n.body),c=$o(s);if(i){const u=mb(c);return e.concat(c,c.visualViewport||[],Km(s)?s:[],u&&t?Om(u):[])}return e.concat(s,Om(s,[],t))}function mb(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function JR(r){const e=Gi(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Ha(r),i=s?r.offsetWidth:t,c=s?r.offsetHeight:n,u=wy(t)!==i||wy(n)!==c;return u&&(t=i,n=c),{width:t,height:n,$:u}}function pE(r){return Bi(r)?r:r.contextElement}function Qf(r){const e=pE(r);if(!Ha(e))return za(1);const t=e.getBoundingClientRect(),{width:n,height:s,$:i}=JR(e);let c=(i?wy(t.width):t.width)/n,u=(i?wy(t.height):t.height)/s;return(!c||!Number.isFinite(c))&&(c=1),(!u||!Number.isFinite(u))&&(u=1),{x:c,y:u}}const XB=za(0);function XR(r){const e=$o(r);return!hE()||!e.visualViewport?XB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function QB(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==$o(r)?!1:e}function td(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=r.getBoundingClientRect(),i=pE(r);let c=za(1);e&&(n?Bi(n)&&(c=Qf(n)):c=Qf(r));const u=QB(i,t,n)?XR(i):za(0);let p=(s.left+u.x)/c.x,m=(s.top+u.y)/c.y,g=s.width/c.x,x=s.height/c.y;if(i){const b=$o(i),E=n&&Bi(n)?$o(n):n;let N=b,S=mb(N);for(;S&&n&&E!==N;){const T=Qf(S),R=S.getBoundingClientRect(),A=Gi(S),j=R.left+(S.clientLeft+parseFloat(A.paddingLeft))*T.x,P=R.top+(S.clientTop+parseFloat(A.paddingTop))*T.y;p*=T.x,m*=T.y,g*=T.x,x*=T.y,p+=j,m+=P,N=$o(S),S=mb(N)}}return _y({width:g,height:x,x:p,y:m})}function Jy(r,e){const t=Yy(r).scrollLeft;return e?e.left+t:td(Ga(r)).left+t}function QR(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-Jy(r,t),s=t.top+e.scrollTop;return{x:n,y:s}}function ZB(r){let{elements:e,rect:t,offsetParent:n,strategy:s}=r;const i=s==="fixed",c=Ga(n),u=e?Ky(e.floating):!1;if(n===c||u&&i)return t;let p={scrollLeft:0,scrollTop:0},m=za(1);const g=za(0),x=Ha(n);if((x||!x&&!i)&&((ph(n)!=="body"||Km(c))&&(p=Yy(n)),Ha(n))){const E=td(n);m=Qf(n),g.x=E.x+n.clientLeft,g.y=E.y+n.clientTop}const b=c&&!x&&!i?QR(c,p):za(0);return{width:t.width*m.x,height:t.height*m.y,x:t.x*m.x-p.scrollLeft*m.x+g.x+b.x,y:t.y*m.y-p.scrollTop*m.y+g.y+b.y}}function eG(r){return Array.from(r.getClientRects())}function tG(r){const e=Ga(r),t=Yy(r),n=r.ownerDocument.body,s=Lo(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Lo(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let c=-t.scrollLeft+Jy(r);const u=-t.scrollTop;return Gi(n).direction==="rtl"&&(c+=Lo(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:c,y:u}}const Dk=25;function rG(r,e){const t=$o(r),n=Ga(r),s=t.visualViewport;let i=n.clientWidth,c=n.clientHeight,u=0,p=0;if(s){i=s.width,c=s.height;const g=hE();(!g||g&&e==="fixed")&&(u=s.offsetLeft,p=s.offsetTop)}const m=Jy(n);if(m<=0){const g=n.ownerDocument,x=g.body,b=getComputedStyle(x),E=g.compatMode==="CSS1Compat"&&parseFloat(b.marginLeft)+parseFloat(b.marginRight)||0,N=Math.abs(n.clientWidth-x.clientWidth-E);N<=Dk&&(i-=N)}else m<=Dk&&(i+=m);return{width:i,height:c,x:u,y:p}}const nG=new Set(["absolute","fixed"]);function sG(r,e){const t=td(r,!0,e==="fixed"),n=t.top+r.clientTop,s=t.left+r.clientLeft,i=Ha(r)?Qf(r):za(1),c=r.clientWidth*i.x,u=r.clientHeight*i.y,p=s*i.x,m=n*i.y;return{width:c,height:u,x:p,y:m}}function Lk(r,e,t){let n;if(e==="viewport")n=rG(r,t);else if(e==="document")n=tG(Ga(r));else if(Bi(e))n=sG(e,t);else{const s=XR(r);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return _y(n)}function ZR(r,e){const t=Wc(r);return t===e||!Bi(t)||ih(t)?!1:Gi(t).position==="fixed"||ZR(t,e)}function oG(r,e){const t=e.get(r);if(t)return t;let n=Om(r,[],!1).filter(u=>Bi(u)&&ph(u)!=="body"),s=null;const i=Gi(r).position==="fixed";let c=i?Wc(r):r;for(;Bi(c)&&!ih(c);){const u=Gi(c),p=fE(c);!p&&u.position==="fixed"&&(s=null),(i?!p&&!s:!p&&u.position==="static"&&!!s&&nG.has(s.position)||Km(c)&&!p&&ZR(r,c))?n=n.filter(g=>g!==c):s=u,c=Wc(c)}return e.set(r,n),n}function iG(r){let{element:e,boundary:t,rootBoundary:n,strategy:s}=r;const c=[...t==="clippingAncestors"?Ky(e)?[]:oG(e,this._c):[].concat(t),n],u=c[0],p=c.reduce((m,g)=>{const x=Lk(e,g,s);return m.top=Lo(x.top,m.top),m.right=Gc(x.right,m.right),m.bottom=Gc(x.bottom,m.bottom),m.left=Lo(x.left,m.left),m},Lk(e,u,s));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function aG(r){const{width:e,height:t}=JR(r);return{width:e,height:t}}function lG(r,e,t){const n=Ha(e),s=Ga(e),i=t==="fixed",c=td(r,!0,i,e);let u={scrollLeft:0,scrollTop:0};const p=za(0);function m(){p.x=Jy(s)}if(n||!n&&!i)if((ph(e)!=="body"||Km(s))&&(u=Yy(e)),n){const E=td(e,!0,i,e);p.x=E.x+e.clientLeft,p.y=E.y+e.clientTop}else s&&m();i&&!n&&s&&m();const g=s&&!n&&!i?QR(s,u):za(0),x=c.left+u.scrollLeft-p.x-g.x,b=c.top+u.scrollTop-p.y-g.y;return{x,y:b,width:c.width,height:c.height}}function Zx(r){return Gi(r).position==="static"}function Mk(r,e){if(!Ha(r)||Gi(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Ga(r)===t&&(t=t.ownerDocument.body),t}function eA(r,e){const t=$o(r);if(Ky(r))return t;if(!Ha(r)){let s=Wc(r);for(;s&&!ih(s);){if(Bi(s)&&!Zx(s))return s;s=Wc(s)}return t}let n=Mk(r,e);for(;n&&GB(n)&&Zx(n);)n=Mk(n,e);return n&&ih(n)&&Zx(n)&&!fE(n)?t:n||YB(r)||t}const cG=async function(r){const e=this.getOffsetParent||eA,t=this.getDimensions,n=await t(r.floating);return{reference:lG(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function uG(r){return Gi(r).direction==="rtl"}const dG={convertOffsetParentRelativeRectToViewportRelativeRect:ZB,getDocumentElement:Ga,getClippingRect:iG,getOffsetParent:eA,getElementRects:cG,getClientRects:eG,getDimensions:aG,getScale:Qf,isElement:Bi,isRTL:uG};function tA(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function fG(r,e){let t=null,n;const s=Ga(r);function i(){var u;clearTimeout(n),(u=t)==null||u.disconnect(),t=null}function c(u,p){u===void 0&&(u=!1),p===void 0&&(p=1),i();const m=r.getBoundingClientRect(),{left:g,top:x,width:b,height:E}=m;if(u||e(),!b||!E)return;const N=Cv(x),S=Cv(s.clientWidth-(g+b)),T=Cv(s.clientHeight-(x+E)),R=Cv(g),j={rootMargin:-N+"px "+-S+"px "+-T+"px "+-R+"px",threshold:Lo(0,Gc(1,p))||1};let P=!0;function U(B){const $=B[0].intersectionRatio;if($!==p){if(!P)return c();$?c(!1,$):n=setTimeout(()=>{c(!1,1e-7)},1e3)}$===1&&!tA(m,r.getBoundingClientRect())&&c(),P=!1}try{t=new IntersectionObserver(U,{...j,root:s.ownerDocument})}catch{t=new IntersectionObserver(U,j)}t.observe(r)}return c(!0),i}function hG(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:p=!1}=n,m=pE(r),g=s||i?[...m?Om(m):[],...Om(e)]:[];g.forEach(R=>{s&&R.addEventListener("scroll",t,{passive:!0}),i&&R.addEventListener("resize",t)});const x=m&&u?fG(m,t):null;let b=-1,E=null;c&&(E=new ResizeObserver(R=>{let[A]=R;A&&A.target===m&&E&&(E.unobserve(e),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var j;(j=E)==null||j.observe(e)})),t()}),m&&!p&&E.observe(m),E.observe(e));let N,S=p?td(r):null;p&&T();function T(){const R=td(r);S&&!tA(S,R)&&t(),S=R,N=requestAnimationFrame(T)}return t(),()=>{var R;g.forEach(A=>{s&&A.removeEventListener("scroll",t),i&&A.removeEventListener("resize",t)}),x==null||x(),(R=E)==null||R.disconnect(),E=null,p&&cancelAnimationFrame(N)}}const pG=MB,mG=$B,gG=OB,vG=zB,yG=DB,$k=jB,xG=UB,wG=(r,e,t)=>{const n=new Map,s={platform:dG,...t},i={...s.platform,_c:n};return FB(r,e,{...s,platform:i})};var mE=y1();const bG=kb(mE);var _G=typeof document<"u",EG=function(){},Wv=_G?w.useLayoutEffect:EG;function Ey(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,s;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Ey(r[n],e[n]))return!1;return!0}if(s=Object.keys(r),t=s.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=t;n--!==0;){const i=s[n];if(!(i==="_owner"&&r.$$typeof)&&!Ey(r[i],e[i]))return!1}return!0}return r!==r&&e!==e}function rA(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function Uk(r,e){const t=rA(r);return Math.round(e*t)/t}function ew(r){const e=w.useRef(r);return Wv(()=>{e.current=r}),e}function SG(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:c}={},transform:u=!0,whileElementsMounted:p,open:m}=r,[g,x]=w.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[b,E]=w.useState(n);Ey(b,n)||E(n);const[N,S]=w.useState(null),[T,R]=w.useState(null),A=w.useCallback(G=>{G!==B.current&&(B.current=G,S(G))},[]),j=w.useCallback(G=>{G!==$.current&&($.current=G,R(G))},[]),P=i||N,U=c||T,B=w.useRef(null),$=w.useRef(null),Y=w.useRef(g),J=p!=null,he=ew(p),te=ew(s),ue=ew(m),we=w.useCallback(()=>{if(!B.current||!$.current)return;const G={placement:e,strategy:t,middleware:b};te.current&&(G.platform=te.current),wG(B.current,$.current,G).then(z=>{const K={...z,isPositioned:ue.current!==!1};ie.current&&!Ey(Y.current,K)&&(Y.current=K,mE.flushSync(()=>{x(K)}))})},[b,e,t,te,ue]);Wv(()=>{m===!1&&Y.current.isPositioned&&(Y.current.isPositioned=!1,x(G=>({...G,isPositioned:!1})))},[m]);const ie=w.useRef(!1);Wv(()=>(ie.current=!0,()=>{ie.current=!1}),[]),Wv(()=>{if(P&&(B.current=P),U&&($.current=U),P&&U){if(he.current)return he.current(P,U,we);we()}},[P,U,we,he,J]);const se=w.useMemo(()=>({reference:B,floating:$,setReference:A,setFloating:j}),[A,j]),pe=w.useMemo(()=>({reference:P,floating:U}),[P,U]),ee=w.useMemo(()=>{const G={position:t,left:0,top:0};if(!pe.floating)return G;const z=Uk(pe.floating,g.x),K=Uk(pe.floating,g.y);return u?{...G,transform:"translate("+z+"px, "+K+"px)",...rA(pe.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:z,top:K}},[t,u,pe.floating,g.x,g.y]);return w.useMemo(()=>({...g,update:we,refs:se,elements:pe,floatingStyles:ee}),[g,we,se,pe,ee])}const CG=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:s}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?$k({element:n.current,padding:s}).fn(t):{}:n?$k({element:n,padding:s}).fn(t):{}}}},kG=(r,e)=>({...pG(r),options:[r,e]}),NG=(r,e)=>({...mG(r),options:[r,e]}),TG=(r,e)=>({...xG(r),options:[r,e]}),RG=(r,e)=>({...gG(r),options:[r,e]}),AG=(r,e)=>({...vG(r),options:[r,e]}),IG=(r,e)=>({...yG(r),options:[r,e]}),PG=(r,e)=>({...CG(r),options:[r,e]});function FG(r){const e=jG(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,u=w.Children.toArray(i),p=u.find(DG);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function jG(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=MG(s),u=LG(i,s.props);return s.type!==w.Fragment&&(u.ref=n?qc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var OG=Symbol("radix.slottable");function DG(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===OG}function LG(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function MG(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var $G=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ar=$G.reduce((r,e)=>{const t=FG(`Primitive.${e}`),n=w.forwardRef((s,i)=>{const{asChild:c,...u}=s,p=c?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(p,{...u,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function nA(r,e){r&&mE.flushSync(()=>r.dispatchEvent(e))}var UG="Arrow",sA=w.forwardRef((r,e)=>{const{children:t,width:n=10,height:s=5,...i}=r;return d.jsx(Ar.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:d.jsx("polygon",{points:"0,0 30,0 15,10"})})});sA.displayName=UG;var zG=sA;function $l(r){const e=w.useRef(r);return w.useEffect(()=>{e.current=r}),w.useMemo(()=>(...t)=>{var n;return(n=e.current)==null?void 0:n.call(e,...t)},[])}function HG(r){const[e,t]=w.useState(void 0);return Dl(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let c,u;if("borderBoxSize"in i){const p=i.borderBoxSize,m=Array.isArray(p)?p[0]:p;c=m.inlineSize,u=m.blockSize}else c=r.offsetWidth,u=r.offsetHeight;t({width:c,height:u})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var gE="Popper",[oA,Xy]=Ba(gE),[BG,iA]=oA(gE),aA=r=>{const{__scopePopper:e,children:t}=r,[n,s]=w.useState(null);return d.jsx(BG,{scope:e,anchor:n,onAnchorChange:s,children:t})};aA.displayName=gE;var lA="PopperAnchor",cA=w.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...s}=r,i=iA(lA,t),c=w.useRef(null),u=Nn(e,c),p=w.useRef(null);return w.useEffect(()=>{const m=p.current;p.current=(n==null?void 0:n.current)||c.current,m!==p.current&&i.onAnchorChange(p.current)}),n?null:d.jsx(Ar.div,{...s,ref:u})});cA.displayName=lA;var vE="PopperContent",[GG,WG]=oA(vE),uA=w.forwardRef((r,e)=>{var xe,ve,le,Ne,He,Ue;const{__scopePopper:t,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:c=0,arrowPadding:u=0,avoidCollisions:p=!0,collisionBoundary:m=[],collisionPadding:g=0,sticky:x="partial",hideWhenDetached:b=!1,updatePositionStrategy:E="optimized",onPlaced:N,...S}=r,T=iA(vE,t),[R,A]=w.useState(null),j=Nn(e,Me=>A(Me)),[P,U]=w.useState(null),B=HG(P),$=(B==null?void 0:B.width)??0,Y=(B==null?void 0:B.height)??0,J=n+(i!=="center"?"-"+i:""),he=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},te=Array.isArray(m)?m:[m],ue=te.length>0,we={padding:he,boundary:te.filter(qG),altBoundary:ue},{refs:ie,floatingStyles:se,placement:pe,isPositioned:ee,middlewareData:G}=SG({strategy:"fixed",placement:J,whileElementsMounted:(...Me)=>hG(...Me,{animationFrame:E==="always"}),elements:{reference:T.anchor},middleware:[kG({mainAxis:s+Y,alignmentAxis:c}),p&&NG({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?TG():void 0,...we}),p&&RG({...we}),AG({...we,apply:({elements:Me,rects:Te,availableWidth:gt,availableHeight:jt})=>{const{width:ot,height:Ut}=Te.reference,Zt=Me.floating.style;Zt.setProperty("--radix-popper-available-width",`${gt}px`),Zt.setProperty("--radix-popper-available-height",`${jt}px`),Zt.setProperty("--radix-popper-anchor-width",`${ot}px`),Zt.setProperty("--radix-popper-anchor-height",`${Ut}px`)}}),P&&PG({element:P,padding:u}),KG({arrowWidth:$,arrowHeight:Y}),b&&IG({strategy:"referenceHidden",...we})]}),[z,K]=hA(pe),D=$l(N);Dl(()=>{ee&&(D==null||D())},[ee,D]);const M=(xe=G.arrow)==null?void 0:xe.x,oe=(ve=G.arrow)==null?void 0:ve.y,Ee=((le=G.arrow)==null?void 0:le.centerOffset)!==0,[V,ce]=w.useState();return Dl(()=>{R&&ce(window.getComputedStyle(R).zIndex)},[R]),d.jsx("div",{ref:ie.setFloating,"data-radix-popper-content-wrapper":"",style:{...se,transform:ee?se.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:V,"--radix-popper-transform-origin":[(Ne=G.transformOrigin)==null?void 0:Ne.x,(He=G.transformOrigin)==null?void 0:He.y].join(" "),...((Ue=G.hide)==null?void 0:Ue.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:d.jsx(GG,{scope:t,placedSide:z,onArrowChange:U,arrowX:M,arrowY:oe,shouldHideArrow:Ee,children:d.jsx(Ar.div,{"data-side":z,"data-align":K,...S,ref:j,style:{...S.style,animation:ee?void 0:"none"}})})})});uA.displayName=vE;var dA="PopperArrow",VG={top:"bottom",right:"left",bottom:"top",left:"right"},fA=w.forwardRef(function(e,t){const{__scopePopper:n,...s}=e,i=WG(dA,n),c=VG[i.placedSide];return d.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:d.jsx(zG,{...s,ref:t,style:{...s.style,display:"block"}})})});fA.displayName=dA;function qG(r){return r!==null}var KG=r=>({name:"transformOrigin",options:r,fn(e){var T,R,A;const{placement:t,rects:n,middlewareData:s}=e,c=((T=s.arrow)==null?void 0:T.centerOffset)!==0,u=c?0:r.arrowWidth,p=c?0:r.arrowHeight,[m,g]=hA(t),x={start:"0%",center:"50%",end:"100%"}[g],b=(((R=s.arrow)==null?void 0:R.x)??0)+u/2,E=(((A=s.arrow)==null?void 0:A.y)??0)+p/2;let N="",S="";return m==="bottom"?(N=c?x:`${b}px`,S=`${-p}px`):m==="top"?(N=c?x:`${b}px`,S=`${n.floating.height+p}px`):m==="right"?(N=`${-p}px`,S=c?x:`${E}px`):m==="left"&&(N=`${n.floating.width+p}px`,S=c?x:`${E}px`),{data:{x:N,y:S}}}});function hA(r){const[e,t="center"]=r.split("-");return[e,t]}var pA=aA,mA=cA,gA=uA,vA=fA,YG="Portal",yE=w.forwardRef((r,e)=>{var u;const{container:t,...n}=r,[s,i]=w.useState(!1);Dl(()=>i(!0),[]);const c=t||s&&((u=globalThis==null?void 0:globalThis.document)==null?void 0:u.body);return c?bG.createPortal(d.jsx(Ar.div,{...n,ref:e}),c):null});yE.displayName=YG;function JG(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var qi=r=>{const{present:e,children:t}=r,n=XG(e),s=typeof t=="function"?t({present:n.isPresent}):w.Children.only(t),i=Nn(n.ref,QG(s));return typeof t=="function"||n.isPresent?w.cloneElement(s,{ref:i}):null};qi.displayName="Presence";function XG(r){const[e,t]=w.useState(),n=w.useRef(null),s=w.useRef(r),i=w.useRef("none"),c=r?"mounted":"unmounted",[u,p]=JG(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const m=kv(n.current);i.current=u==="mounted"?m:"none"},[u]),Dl(()=>{const m=n.current,g=s.current;if(g!==r){const b=i.current,E=kv(m);r?p("MOUNT"):E==="none"||(m==null?void 0:m.display)==="none"?p("UNMOUNT"):p(g&&b!==E?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,p]),Dl(()=>{if(e){let m;const g=e.ownerDocument.defaultView??window,x=E=>{const S=kv(n.current).includes(CSS.escape(E.animationName));if(E.target===e&&S&&(p("ANIMATION_END"),!s.current)){const T=e.style.animationFillMode;e.style.animationFillMode="forwards",m=g.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=T)})}},b=E=>{E.target===e&&(i.current=kv(n.current))};return e.addEventListener("animationstart",b),e.addEventListener("animationcancel",x),e.addEventListener("animationend",x),()=>{g.clearTimeout(m),e.removeEventListener("animationstart",b),e.removeEventListener("animationcancel",x),e.removeEventListener("animationend",x)}}else p("ANIMATION_END")},[e,p]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:w.useCallback(m=>{n.current=m?getComputedStyle(m):null,t(m)},[])}}function kv(r){return(r==null?void 0:r.animationName)||"none"}function QG(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function ZG(r,e=globalThis==null?void 0:globalThis.document){const t=$l(r);w.useEffect(()=>{const n=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var e7="DismissableLayer",gb="dismissableLayer.update",t7="dismissableLayer.pointerDownOutside",r7="dismissableLayer.focusOutside",zk,yA=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Qy=w.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,onDismiss:u,...p}=r,m=w.useContext(yA),[g,x]=w.useState(null),b=(g==null?void 0:g.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,E]=w.useState({}),N=Nn(e,$=>x($)),S=Array.from(m.layers),[T]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),R=S.indexOf(T),A=g?S.indexOf(g):-1,j=m.layersWithOutsidePointerEventsDisabled.size>0,P=A>=R,U=o7($=>{const Y=$.target,J=[...m.branches].some(he=>he.contains(Y));!P||J||(s==null||s($),c==null||c($),$.defaultPrevented||u==null||u())},b),B=i7($=>{const Y=$.target;[...m.branches].some(he=>he.contains(Y))||(i==null||i($),c==null||c($),$.defaultPrevented||u==null||u())},b);return ZG($=>{A===m.layers.size-1&&(n==null||n($),!$.defaultPrevented&&u&&($.preventDefault(),u()))},b),w.useEffect(()=>{if(g)return t&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(zk=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(g)),m.layers.add(g),Hk(),()=>{t&&m.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=zk)}},[g,b,t,m]),w.useEffect(()=>()=>{g&&(m.layers.delete(g),m.layersWithOutsidePointerEventsDisabled.delete(g),Hk())},[g,m]),w.useEffect(()=>{const $=()=>E({});return document.addEventListener(gb,$),()=>document.removeEventListener(gb,$)},[]),d.jsx(Ar.div,{...p,ref:N,style:{pointerEvents:j?P?"auto":"none":void 0,...r.style},onFocusCapture:Ct(r.onFocusCapture,B.onFocusCapture),onBlurCapture:Ct(r.onBlurCapture,B.onBlurCapture),onPointerDownCapture:Ct(r.onPointerDownCapture,U.onPointerDownCapture)})});Qy.displayName=e7;var n7="DismissableLayerBranch",s7=w.forwardRef((r,e)=>{const t=w.useContext(yA),n=w.useRef(null),s=Nn(e,n);return w.useEffect(()=>{const i=n.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),d.jsx(Ar.div,{...r,ref:s})});s7.displayName=n7;function o7(r,e=globalThis==null?void 0:globalThis.document){const t=$l(r),n=w.useRef(!1),s=w.useRef(()=>{});return w.useEffect(()=>{const i=u=>{if(u.target&&!n.current){let p=function(){xA(t7,t,m,{discrete:!0})};const m={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=p,e.addEventListener("click",s.current,{once:!0})):p()}else e.removeEventListener("click",s.current);n.current=!1},c=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(c),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function i7(r,e=globalThis==null?void 0:globalThis.document){const t=$l(r),n=w.useRef(!1);return w.useEffect(()=>{const s=i=>{i.target&&!n.current&&xA(r7,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Hk(){const r=new CustomEvent(gb);document.dispatchEvent(r)}function xA(r,e,t,{discrete:n}){const s=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?nA(s,i):s.dispatchEvent(i)}var tw,Zy="HoverCard",[wA]=Ba(Zy,[Xy]),e0=Xy(),[a7,xE]=wA(Zy),bA=r=>{const{__scopeHoverCard:e,children:t,open:n,defaultOpen:s,onOpenChange:i,openDelay:c=700,closeDelay:u=300}=r,p=e0(e),m=w.useRef(0),g=w.useRef(0),x=w.useRef(!1),b=w.useRef(!1),[E,N]=Kc({prop:n,defaultProp:s??!1,onChange:i,caller:Zy}),S=w.useCallback(()=>{clearTimeout(g.current),m.current=window.setTimeout(()=>N(!0),c)},[c,N]),T=w.useCallback(()=>{clearTimeout(m.current),!x.current&&!b.current&&(g.current=window.setTimeout(()=>N(!1),u))},[u,N]),R=w.useCallback(()=>N(!1),[N]);return w.useEffect(()=>()=>{clearTimeout(m.current),clearTimeout(g.current)},[]),d.jsx(a7,{scope:e,open:E,onOpenChange:N,onOpen:S,onClose:T,onDismiss:R,hasSelectionRef:x,isPointerDownOnContentRef:b,children:d.jsx(pA,{...p,children:t})})};bA.displayName=Zy;var _A="HoverCardTrigger",EA=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=xE(_A,t),i=e0(t);return d.jsx(mA,{asChild:!0,...i,children:d.jsx(Ar.a,{"data-state":s.open?"open":"closed",...n,ref:e,onPointerEnter:Ct(r.onPointerEnter,Cy(s.onOpen)),onPointerLeave:Ct(r.onPointerLeave,Cy(s.onClose)),onFocus:Ct(r.onFocus,s.onOpen),onBlur:Ct(r.onBlur,s.onClose),onTouchStart:Ct(r.onTouchStart,c=>c.preventDefault())})})});EA.displayName=_A;var l7="HoverCardPortal",[TK,c7]=wA(l7,{forceMount:void 0}),Sy="HoverCardContent",SA=w.forwardRef((r,e)=>{const t=c7(Sy,r.__scopeHoverCard),{forceMount:n=t.forceMount,...s}=r,i=xE(Sy,r.__scopeHoverCard);return d.jsx(qi,{present:n||i.open,children:d.jsx(u7,{"data-state":i.open?"open":"closed",...s,onPointerEnter:Ct(r.onPointerEnter,Cy(i.onOpen)),onPointerLeave:Ct(r.onPointerLeave,Cy(i.onClose)),ref:e})})});SA.displayName=Sy;var u7=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,...u}=r,p=xE(Sy,t),m=e0(t),g=w.useRef(null),x=Nn(e,g),[b,E]=w.useState(!1);return w.useEffect(()=>{if(b){const N=document.body;return tw=N.style.userSelect||N.style.webkitUserSelect,N.style.userSelect="none",N.style.webkitUserSelect="none",()=>{N.style.userSelect=tw,N.style.webkitUserSelect=tw}}},[b]),w.useEffect(()=>{if(g.current){const N=()=>{E(!1),p.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var T;((T=document.getSelection())==null?void 0:T.toString())!==""&&(p.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",N),()=>{document.removeEventListener("pointerup",N),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!1}}},[p.isPointerDownOnContentRef,p.hasSelectionRef]),w.useEffect(()=>{g.current&&f7(g.current).forEach(S=>S.setAttribute("tabindex","-1"))}),d.jsx(Qy,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:c,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:Ct(i,N=>{N.preventDefault()}),onDismiss:p.onDismiss,children:d.jsx(gA,{...m,...u,onPointerDown:Ct(u.onPointerDown,N=>{N.currentTarget.contains(N.target)&&E(!0),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!0}),ref:x,style:{...u.style,userSelect:b?"text":void 0,WebkitUserSelect:b?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),d7="HoverCardArrow",CA=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=e0(t);return d.jsx(vA,{...s,...n,ref:e})});CA.displayName=d7;function Cy(r){return e=>e.pointerType==="touch"?void 0:r()}function f7(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;t.nextNode();)e.push(t.currentNode);return e}var h7=bA,p7=EA,m7=SA,g7=CA;const vb="src/lib/utils/emailUtils.tsx";async function kA(r,e){try{await(await On.createServices()).contentScript.insertContentIntoComposeBox(r)}catch(t){e.error("Error inserting content into compose box",t,{sourceFile:vb,functionName:"insertHtmlIntoComposeBox"}),v7(r,e)}}function v7(r,e){const t=r.replace(/<([^>]+)class="ql-align-([^"]+)"([^>]*)>/g,'<$1style="text-align: $2"$3>');chrome.tabs.query({active:!0,currentWindow:!0},n=>{const s=n[0];if(!(s!=null&&s.id)){e.error("No active tab found or tab ID is undefined",void 0,{sourceFile:vb,functionName:"insertHtmlIntoComposeBoxLegacy"});return}chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{console.debug("Script executing in tab context");function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function u(m,g){document.execCommand("insertHTML",!1,g),console.debug("Inserted using execCommand fallback")}const p=c();if(p)console.debug("found composeBox: ",p);else{console.error("Compose box not found");return}try{p.focus(),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste"),console.debug("Pasted using Clipboard API")}).catch(m=>{console.warn("Clipboard API failed, using fallback:",m),u(p,i)}):u(p,i)}catch(m){console.error("Error during paste operation:",m)}},args:[t]}).catch(i=>{e.error("Error executing script",i,{sourceFile:vb,functionName:"insertHtmlIntoComposeBoxLegacy"})})})}const y7="src/lib/types/Template.ts",Bk=async(r,e)=>{const t="GetTemplateWithContentFromServerTemplate";try{const n=r.source;if(!n)throw new Error("Source value is undefined");const s={...r,source:n};return{id:s.template_id,timeStamp:Date.now(),title:s.templateName,description:s.templateDescription,tags:s.tags||[],source:s.source==="SCOPE_USER"?"personal":"org",content:s.templateBody}}catch(n){throw e.error("Error getting template content",n,{sourceFile:y7,functionName:t,templateId:r.template_id}),n}},kl="src/lib/utils/templateUtils.tsx",Gk=async(r,e=!0)=>{const t="getAllTemplatesWithContent";try{const n=await q6(r);r.debug("Templates from server",{sourceFile:kl,functionName:t,userCount:n.user_templates.length,orgCount:n.org_templates.length});const s=async g=>{const x="fetchPersonalTemplateWithErrorHandling";try{const b={...g,source:g.source||"SCOPE_USER"};return r.debug("Fetching personal template",{sourceFile:kl,functionName:x,templateId:b.template_id,scope:b.source}),await Bk(b,r)}catch(b){return r.error("Failed to load personal template",b,{sourceFile:kl,functionName:x,templateId:g.template_id}),null}},i=async g=>{const x="fetchOrgTemplateWithErrorHandling";try{const b={...g,source:g.source||"SCOPE_TENANT"};return r.debug("Fetching org template",{sourceFile:kl,functionName:x,templateId:b.template_id,scope:b.source}),await Bk(b,r)}catch(b){return r.error("Failed to load org template",b,{sourceFile:kl,functionName:x,templateId:g.template_id}),null}};let c=[];e&&(c=await Promise.all(n.user_templates.map(s)));const u=c.filter(Boolean),m=(await Promise.all(n.org_templates.map(i))).filter(Boolean);return r.info("Loaded templates",{sourceFile:kl,functionName:t,personalLoaded:u.length,personalTotal:n.user_templates.length,orgLoaded:m.length,orgTotal:n.org_templates.length}),e&&await CU(r,u),await kU(r,m),[...u,...m]}catch(n){r.error("Error in getAllTemplatesWithContent",n,{sourceFile:kl,functionName:t}),r.info("Falling back to cached templates from local storage",{sourceFile:kl,functionName:t});const s=await eT(r),i=await tT(r);return[...s,...i]}},x7=async r=>{const e="getTemplatesFromLocalStorage";try{const[t,n]=await Promise.all([eT(r),tT(r)]);return[...t,...n]}catch(t){return r.error("Error getting templates from local storage",t,{sourceFile:kl,functionName:e}),[]}};async function Wk(r,{signalType:e,signalValue:t}){localStorage.setItem(e,t);try{const s=(await On.createServices()).tabs;s.openOptionsPage?await s.openOptionsPage():r.error("Tabs provider does not support options page",new Error("Tabs provider does not support options page"),{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}catch(n){r.error("Error opening options page",n,{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}}const wE=({feature:r,description:e,benefits:t=[],className:n="",variant:s="card"})=>{const{isConnected:i,isLoading:c,error:u,status:p,initiateReconnection:m}=Wi(),{platform:g}=tn();if(g!=="chrome"||i)return null;const x=async()=>{try{await m()}catch(N){console.error("Failed to reconnect Gmail:",N)}},b=()=>p==="loading"?d.jsx(wo,{className:"h-5 w-5 text-blue-600 animate-spin"}):p==="error"?d.jsx(Xf,{className:"h-5 w-5 text-red-600"}):d.jsx(Bc,{className:"h-5 w-5 text-amber-600"}),E=()=>p==="loading"?"Checking Gmail connection...":p==="error"?u||"Gmail connection error occurred":"Gmail connection required";return s==="banner"?d.jsxs("div",{className:`flex items-center justify-between bg-amber-50 border border-amber-200 px-4 py-3 rounded-lg ${n}`,children:[d.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[b(),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-amber-800",children:E()}),d.jsx("p",{className:"text-sm text-amber-700 mt-1",children:e||`Connect Gmail to access ${r} features.`})]})]}),d.jsx(ze,{onClick:x,disabled:c,variant:"outline",size:"sm",className:"bg-amber-100 border-amber-300 text-amber-800 hover:bg-amber-200 hover:border-amber-400 whitespace-nowrap ml-4",children:c?d.jsxs(d.Fragment,{children:[d.jsx(wo,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):"Connect Gmail"})]}):s==="inline"?d.jsxs("div",{className:`flex items-center gap-2 text-amber-700 ${n}`,children:[b(),d.jsx("span",{className:"text-sm",children:E()}),d.jsx(ze,{onClick:x,disabled:c,variant:"link",size:"sm",className:"h-auto p-0 text-amber-700 hover:text-amber-800",children:"Connect Gmail"})]}):d.jsx(li,{className:`${n}`,children:d.jsx(ci,{className:"p-6",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:b()}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-2",children:"Gmail Connection Required"}),d.jsx("p",{className:"text-gray-600 mb-4",children:e||`To access ${r}, you need to connect your Gmail account first.`}),t.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"What you'll get with Gmail connected:"}),d.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:t.map((N,S)=>d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(Uc,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),d.jsx("span",{children:N})]},S))})]}),u&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:d.jsx("p",{className:"text-sm text-red-800",children:u})}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsx(ze,{onClick:x,disabled:c,className:"bg-blue-600 hover:bg-blue-700",children:c?d.jsxs(d.Fragment,{children:[d.jsx(wo,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Bc,{className:"h-4 w-4 mr-2"}),"Connect Gmail"]})})})]})]})})})},Hs="src/sidepanel/panels/TemplatesPanel.tsx",w7=({clientEmail:r,isAuthenticated:e})=>{const t=Or(),{platform:n}=tn(),{isConnected:s}=Wi(),[i,c]=w.useState(""),[u,p]=w.useState([]),[m,g]=w.useState(!1),[x,b]=w.useState([]),[E,N]=w.useState([]),[S,T]=w.useState("all"),[R,A]=w.useState([]),[j,P]=w.useState(!0),[U,B]=w.useState(!1),[$,Y]=w.useState(null),J=w.useRef(null),he=w.useRef(null);w.useEffect(()=>{function M(oe){m&&J.current&&!J.current.contains(oe.target)&&he.current&&!he.current.contains(oe.target)&&g(!1)}return document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}},[m]),w.useEffect(()=>{function M(oe){$&&!oe.target.closest("[data-radix-hover-card-content]")&&Y(null)}return $&&document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}},[$]),w.useEffect(()=>{if(R.length>0){const M=R.filter(oe=>{var Ee,V,ce,xe,ve;return(S==="all"||S==="org"&&oe.source==="org"||S==="personal"&&oe.source!=="org")&&(((Ee=oe.title)==null?void 0:Ee.toLowerCase().includes(i.toLowerCase()))||((V=oe.content)==null?void 0:V.toLowerCase().includes(i.toLowerCase()))||((ce=oe.tags)==null?void 0:ce.some(le=>le.toLowerCase().includes(i.toLowerCase())))||((xe=oe.description)==null?void 0:xe.toLowerCase().includes(i.toLowerCase())))&&(x.length===0||((ve=oe.tags)==null?void 0:ve.some(le=>x.includes(le))))});if(i.trim()){const oe=M.sort((Ee,V)=>{const ce=i.toLowerCase(),xe=Ne=>{var He,Ue,Me,Te;return(He=Ne.tags)!=null&&He.some(gt=>gt.toLowerCase().includes(ce))?1:(Ue=Ne.title)!=null&&Ue.toLowerCase().includes(ce)?2:(Me=Ne.description)!=null&&Me.toLowerCase().includes(ce)?3:(Te=Ne.content)!=null&&Te.toLowerCase().includes(ce)?4:5},ve=xe(Ee),le=xe(V);return ve!==le?ve-le:(Ee.title||"").localeCompare(V.title||"")});p(oe)}else p(M)}},[R,i,x,S]),w.useEffect(()=>{if(!e){t.debug("Skipping template loading - user not authenticated",{sourceFile:Hs,isAuthenticated:e});return}const M=async()=>{P(!0);const oe="loadTemplatesDirectly";try{t.info("Loading templates directly from server (like options page)",{sourceFile:Hs,functionName:oe});const Ee=await Gk(t,!0);if(Ee.length>0){t.info("Templates loaded successfully",{sourceFile:Hs,functionName:oe,count:Ee.length}),A(Ee);const V=await ey(t);let ce=[];V.id!==""&&(ce=V.templateConfiguration.tags||[]);const xe=new Set(ce);Ee.forEach(ve=>{ve.tags&&Array.isArray(ve.tags)&&ve.tags.forEach(le=>xe.add(le))}),N(Array.from(xe))}else t.info("No templates found!",{sourceFile:Hs,functionName:oe}),A([])}catch(Ee){t.error("Error loading templates directly from server",Ee,{sourceFile:Hs,functionName:oe});try{const V=await x7(t);t.info("Fallback to local storage successful",{sourceFile:Hs,functionName:oe,count:V.length}),A(V)}catch(V){t.error("Fallback to local storage also failed",V,{sourceFile:Hs,functionName:oe}),A([])}}finally{P(!1)}};t.info("TemplatesPanel initialized, loading templates directly from server",{sourceFile:Hs,isAuthenticated:e}),M()},[t,e]);const te=w.useCallback(async()=>{if(U)return;B(!0);const M="refreshTemplates";t.info("Starting template refresh from server",{sourceFile:Hs,functionName:M});try{const oe=await ey(t);let Ee=[];oe.id!==""?(t.debug("configuration loaded from storage",{sourceFile:Hs,functionName:M,config:oe}),Ee=oe.templateConfiguration.tags||[]):t.warn("No configuration found in storage",{sourceFile:Hs,functionName:M}),t.info("Calling getAllTemplatesWithContent",{sourceFile:Hs,functionName:M});const V=await Gk(t,!0);t.info("getAllTemplatesWithContent completed",{sourceFile:Hs,functionName:M,templateCount:V.length});const ce=new Set(Ee);V.forEach(ve=>{ve.tags&&Array.isArray(ve.tags)&&ve.tags.forEach(le=>ce.add(le))});const xe=Array.from(ce);t.info("Template refresh successful",{sourceFile:Hs,functionName:M,templateCount:V.length,tagsCount:xe.length,templates:V.map(ve=>({title:ve.title,tags:ve.tags,source:ve.source}))}),N(xe),A(V)}catch(oe){t.error("Error refreshing templates from server",oe,{sourceFile:Hs,functionName:M}),console.error("Template loading failed:",oe)}finally{B(!1)}},[U,t]),ue=()=>{g(!m)},we=M=>{b(oe=>oe.includes(M)?oe.filter(Ee=>Ee!==M):[...oe,M])},ie=M=>{Y(oe=>oe===M?null:M)},[se,pe]=w.useState(!1),ee=w.useRef(null),G=w.useRef(null);w.useEffect(()=>{function M(oe){se&&ee.current&&!ee.current.contains(oe.target)&&G.current&&!G.current.contains(oe.target)&&pe(!1)}return document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}},[se]);const z=()=>{pe(!se)},K=M=>{T(M),pe(!1)};return n==="chrome"&&!s?d.jsx("div",{className:"p-4",children:d.jsx(wE,{feature:"Templates",description:"Connect your Gmail account to access and insert email templates",benefits:["Access all your personal and organization templates","Insert template content directly into compose box","Search and filter templates by tags and content"]})}):d.jsxs("div",{className:"space-y-4 h-full",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Qr,{type:"text",placeholder:"Search templates...",value:i,onChange:M=>c(M.target.value),className:"pl-10 pr-12"}),d.jsx(qs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),d.jsx(ze,{ref:he,variant:"outline",className:"absolute right-0 top-1/2 transform -translate-y-1/2",onClick:ue,children:d.jsx(Qx,{})}),m&&d.jsx("div",{ref:J,className:"absolute right-0 mt-2 w-48 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:E.length>0?E.map(M=>d.jsxs("label",{className:"block px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer text-gray-900 dark:text-gray-200",children:[d.jsx("input",{type:"checkbox",className:"mr-2",checked:x.includes(M),onChange:()=>we(M)}),M]},M)):d.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No tags available"})})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"relative",children:[d.jsxs(ze,{ref:G,variant:"outline",size:"sm",onClick:z,className:"flex items-center hover:bg-blue-50",children:[S==="all"&&d.jsxs(d.Fragment,{children:[d.jsx(Qx,{className:"mr-2 h-4 w-4"}),"All Templates (",u.length,")"]}),S==="personal"&&d.jsxs(d.Fragment,{children:[d.jsx(xy,{className:"mr-2 h-4 w-4"}),"Personal Only (",u.length,")"]}),S==="org"&&d.jsxs(d.Fragment,{children:[d.jsx(Xx,{className:"mr-2 h-4 w-4"}),"Org Only (",u.length,")"]})]}),se&&d.jsxs("div",{ref:ee,className:"absolute left-0 mt-1 w-40 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:[S!=="all"&&d.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>K("all"),children:[d.jsx(Qx,{className:"mr-2 h-4 w-4"}),"All Templates"]}),S!=="personal"&&d.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>K("personal"),children:[d.jsx(xy,{className:"mr-2 h-4 w-4"}),"Personal Only"]}),S!=="org"&&R.filter(M=>M.source==="org").length>0&&d.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>K("org"),children:[d.jsx(Xx,{className:"mr-2 h-4 w-4"}),"Org Only"]})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(ze,{size:"icon",className:"rounded-lg bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 border border-blue-600 dark:border-blue-600",title:"Add Template",onClick:()=>{Wk(t,{signalType:"openCreateTemplate",signalValue:"true"})},children:d.jsx(rB,{className:"w-5 h-5"})}),d.jsx(ze,{variant:"outline",size:"icon",className:"rounded-lg hover:bg-blue-50",title:"Refresh Templates",onClick:te,disabled:U||j,children:d.jsx(wo,{className:`w-5 h-5 ${U?"animate-spin":""}`})})]})]}),j?d.jsxs("div",{className:"flex justify-center items-center py-12",children:[d.jsx(Hi,{className:"h-8 w-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading templates..."})]}):d.jsxs("div",{className:"overflow-y-auto h-full pb-2",children:[u.map(M=>d.jsxs(li,{className:"animate-fadeIn relative mb-2",children:[d.jsxs($i,{children:[d.jsx(Ui,{className:"text-sm flex items-center",children:M.title}),M.tags&&M.tags.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:M.tags.map((oe,Ee)=>d.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:oe},Ee))})]}),d.jsxs(ci,{children:[d.jsx("p",{className:"text-xs mb-2 overflow-hidden text-ellipsis max-h-[50px]",children:M.description}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx(ze,{className:"flex-1 text-xs py-1 bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 w-1/2 border border-blue-600 dark:border-blue-600",onClick:()=>{kA(M.content,t)},children:d.jsxs("span",{className:"flex items-center justify-center w-full",children:[d.jsx(BR,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),d.jsx("span",{className:"hide-text-when-narrow",children:"Insert"})]})}),d.jsxs(h7,{open:$===M.id?!0:void 0,onOpenChange:oe=>{!oe&&$===M.id&&Y(null)},openDelay:0,closeDelay:100,children:[d.jsx(p7,{asChild:!0,children:d.jsx(ze,{variant:"outline",className:`text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted hover:text-blue-600 dark:hover:text-blue-400 w-1/4 ${$===M.id?"bg-gray-100 dark:bg-muted text-blue-600 dark:text-blue-400":""}`,onClick:oe=>{oe.preventDefault(),ie(M.id)},children:d.jsxs("span",{className:"flex items-center justify-center w-full",children:[d.jsx(oB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),d.jsx("span",{className:"hide-text-when-narrow",children:"View"})]})})}),d.jsxs(m7,{className:"bg-white dark:bg-card border-2 mt-8 mr-8 border-gray-200 dark:border-border rounded-md text-gray-700 dark:text-gray-200 p-4 z-50 overflow-auto",align:"center",side:"top",style:{maxHeight:"40vh",maxWidth:"80vw",width:"auto",height:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[d.jsx("div",{dangerouslySetInnerHTML:{__html:M.content}}),d.jsx(g7,{className:"fill-blue-500"})]})]}),M.source==="org"?d.jsx("div",{className:"w-1/4 flex items-center",title:"Organization templates can only be edited by an admin.",children:d.jsxs("span",{className:"text-xs py-1 px-2 bg-blue-100 text-blue-800 border border-blue-300 flex items-center justify-center w-full rounded-full",children:[d.jsx(Xx,{className:"w-4 h-4 flex-shrink-0 mr-1"}),d.jsx("span",{className:"hide-text-when-narrow",children:"Org"})]})}):d.jsx(ze,{variant:"outline",className:"text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted w-1/4",title:"Edit Template",onClick:()=>{Wk(t,{signalType:"editTemplateId",signalValue:M.id})},children:d.jsxs("span",{className:"flex items-center justify-center w-full",children:[d.jsx(hB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),d.jsx("span",{className:"hide-text-when-narrow",children:"Edit"})]})})]})]})]},M.id)),u.length===0&&d.jsxs("div",{className:"mt-8 text-center text-gray-500",children:[d.jsx("p",{children:"No templates found matching your criteria."}),d.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your filters or search terms."})]})]})]})},Fc=({src:r,width:e,height:t,alt:n,className:s})=>{const i=r.startsWith("/")?`${GN}${r}`:r;return d.jsx("img",{src:i,width:e,height:t,alt:n,className:s})},rw=({options:r,value:e,onChange:t})=>d.jsx("div",{className:"flex rounded-md shadow-sm",children:r.map(n=>d.jsx(ze,{variant:e===n?"default":"outline",className:`flex-1 text-xs ${e===n?"":"text-muted-foreground"}`,onClick:()=>t(n),children:n},n))});/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:NA,setPrototypeOf:Vk,isFrozen:b7,getPrototypeOf:_7,getOwnPropertyDescriptor:E7}=Object;let{freeze:Ks,seal:pi,create:yb}=Object,{apply:xb,construct:wb}=typeof Reflect<"u"&&Reflect;Ks||(Ks=function(e){return e});pi||(pi=function(e){return e});xb||(xb=function(e,t){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];return e.apply(t,s)});wb||(wb=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return new e(...n)});const Nv=Ys(Array.prototype.forEach),S7=Ys(Array.prototype.lastIndexOf),qk=Ys(Array.prototype.pop),qp=Ys(Array.prototype.push),C7=Ys(Array.prototype.splice),Vv=Ys(String.prototype.toLowerCase),nw=Ys(String.prototype.toString),sw=Ys(String.prototype.match),Kp=Ys(String.prototype.replace),k7=Ys(String.prototype.indexOf),N7=Ys(String.prototype.trim),Mi=Ys(Object.prototype.hasOwnProperty),Bs=Ys(RegExp.prototype.test),Yp=T7(TypeError);function Ys(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return xb(r,e,n)}}function T7(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return wb(r,t)}}function Xt(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Vv;Vk&&Vk(r,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const i=t(s);i!==s&&(b7(e)||(e[n]=i),s=i)}r[s]=!0}return r}function R7(r){for(let e=0;e<r.length;e++)Mi(r,e)||(r[e]=null);return r}function Fa(r){const e=yb(null);for(const[t,n]of NA(r))Mi(r,t)&&(Array.isArray(n)?e[t]=R7(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=Fa(n):e[t]=n);return e}function Jp(r,e){for(;r!==null;){const n=E7(r,e);if(n){if(n.get)return Ys(n.get);if(typeof n.value=="function")return Ys(n.value)}r=_7(r)}function t(){return null}return t}const Kk=Ks(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ow=Ks(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),iw=Ks(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),A7=Ks(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),aw=Ks(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),I7=Ks(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Yk=Ks(["#text"]),Jk=Ks(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),lw=Ks(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Xk=Ks(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Tv=Ks(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),P7=pi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),F7=pi(/<%[\w\W]*|[\w\W]*%>/gm),j7=pi(/\$\{[\w\W]*/gm),O7=pi(/^data-[\-\w.\u00B7-\uFFFF]+$/),D7=pi(/^aria-[\-\w]+$/),TA=pi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),L7=pi(/^(?:\w+script|data):/i),M7=pi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),RA=pi(/^html$/i),$7=pi(/^[a-z][.\w]*(-[.\w]+)+$/i);var Qk=Object.freeze({__proto__:null,ARIA_ATTR:D7,ATTR_WHITESPACE:M7,CUSTOM_ELEMENT:$7,DATA_ATTR:O7,DOCTYPE_NAME:RA,ERB_EXPR:F7,IS_ALLOWED_URI:TA,IS_SCRIPT_OR_DATA:L7,MUSTACHE_EXPR:P7,TMPLIT_EXPR:j7});const Xp={element:1,text:3,progressingInstruction:7,comment:8,document:9},U7=function(){return typeof window>"u"?null:window},z7=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Zk=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function AA(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:U7();const e=it=>AA(it);if(e.version="3.3.1",e.removed=[],!r||!r.document||r.document.nodeType!==Xp.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,s=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:c,Node:u,Element:p,NodeFilter:m,NamedNodeMap:g=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:x,DOMParser:b,trustedTypes:E}=r,N=p.prototype,S=Jp(N,"cloneNode"),T=Jp(N,"remove"),R=Jp(N,"nextSibling"),A=Jp(N,"childNodes"),j=Jp(N,"parentNode");if(typeof c=="function"){const it=t.createElement("template");it.content&&it.content.ownerDocument&&(t=it.content.ownerDocument)}let P,U="";const{implementation:B,createNodeIterator:$,createDocumentFragment:Y,getElementsByTagName:J}=t,{importNode:he}=n;let te=Zk();e.isSupported=typeof NA=="function"&&typeof j=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ue,ERB_EXPR:we,TMPLIT_EXPR:ie,DATA_ATTR:se,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:ee,ATTR_WHITESPACE:G,CUSTOM_ELEMENT:z}=Qk;let{IS_ALLOWED_URI:K}=Qk,D=null;const M=Xt({},[...Kk,...ow,...iw,...aw,...Yk]);let oe=null;const Ee=Xt({},[...Jk,...lw,...Xk,...Tv]);let V=Object.seal(yb(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ce=null,xe=null;const ve=Object.seal(yb(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let le=!0,Ne=!0,He=!1,Ue=!0,Me=!1,Te=!0,gt=!1,jt=!1,ot=!1,Ut=!1,Zt=!1,er=!1,et=!0,It=!1;const hr="user-content-";let Ae=!0,Xe=!1,pt={},tt=null;const Pt=Xt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Er=null;const Dr=Xt({},["audio","video","img","source","image","track"]);let lt=null;const kt=Xt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),de="http://www.w3.org/1998/Math/MathML",Ie="http://www.w3.org/2000/svg",Ge="http://www.w3.org/1999/xhtml";let ut=Ge,Ft=!1,cr=null;const ft=Xt({},[de,Ie,Ge],nw);let Nt=Xt({},["mi","mo","mn","ms","mtext"]),Sr=Xt({},["annotation-xml"]);const as=Xt({},["title","style","font","a","script"]);let Vn=null;const As=["application/xhtml+xml","text/html"],Ji="text/html";let Ir=null,ls=null;const gi=t.createElement("form"),Xi=function(Q){return Q instanceof RegExp||Q instanceof Function},Xs=function(){let Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ls&&ls===Q)){if((!Q||typeof Q!="object")&&(Q={}),Q=Fa(Q),Vn=As.indexOf(Q.PARSER_MEDIA_TYPE)===-1?Ji:Q.PARSER_MEDIA_TYPE,Ir=Vn==="application/xhtml+xml"?nw:Vv,D=Mi(Q,"ALLOWED_TAGS")?Xt({},Q.ALLOWED_TAGS,Ir):M,oe=Mi(Q,"ALLOWED_ATTR")?Xt({},Q.ALLOWED_ATTR,Ir):Ee,cr=Mi(Q,"ALLOWED_NAMESPACES")?Xt({},Q.ALLOWED_NAMESPACES,nw):ft,lt=Mi(Q,"ADD_URI_SAFE_ATTR")?Xt(Fa(kt),Q.ADD_URI_SAFE_ATTR,Ir):kt,Er=Mi(Q,"ADD_DATA_URI_TAGS")?Xt(Fa(Dr),Q.ADD_DATA_URI_TAGS,Ir):Dr,tt=Mi(Q,"FORBID_CONTENTS")?Xt({},Q.FORBID_CONTENTS,Ir):Pt,ce=Mi(Q,"FORBID_TAGS")?Xt({},Q.FORBID_TAGS,Ir):Fa({}),xe=Mi(Q,"FORBID_ATTR")?Xt({},Q.FORBID_ATTR,Ir):Fa({}),pt=Mi(Q,"USE_PROFILES")?Q.USE_PROFILES:!1,le=Q.ALLOW_ARIA_ATTR!==!1,Ne=Q.ALLOW_DATA_ATTR!==!1,He=Q.ALLOW_UNKNOWN_PROTOCOLS||!1,Ue=Q.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Me=Q.SAFE_FOR_TEMPLATES||!1,Te=Q.SAFE_FOR_XML!==!1,gt=Q.WHOLE_DOCUMENT||!1,Ut=Q.RETURN_DOM||!1,Zt=Q.RETURN_DOM_FRAGMENT||!1,er=Q.RETURN_TRUSTED_TYPE||!1,ot=Q.FORCE_BODY||!1,et=Q.SANITIZE_DOM!==!1,It=Q.SANITIZE_NAMED_PROPS||!1,Ae=Q.KEEP_CONTENT!==!1,Xe=Q.IN_PLACE||!1,K=Q.ALLOWED_URI_REGEXP||TA,ut=Q.NAMESPACE||Ge,Nt=Q.MATHML_TEXT_INTEGRATION_POINTS||Nt,Sr=Q.HTML_INTEGRATION_POINTS||Sr,V=Q.CUSTOM_ELEMENT_HANDLING||{},Q.CUSTOM_ELEMENT_HANDLING&&Xi(Q.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=Q.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Q.CUSTOM_ELEMENT_HANDLING&&Xi(Q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=Q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Q.CUSTOM_ELEMENT_HANDLING&&typeof Q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(V.allowCustomizedBuiltInElements=Q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Me&&(Ne=!1),Zt&&(Ut=!0),pt&&(D=Xt({},Yk),oe=[],pt.html===!0&&(Xt(D,Kk),Xt(oe,Jk)),pt.svg===!0&&(Xt(D,ow),Xt(oe,lw),Xt(oe,Tv)),pt.svgFilters===!0&&(Xt(D,iw),Xt(oe,lw),Xt(oe,Tv)),pt.mathMl===!0&&(Xt(D,aw),Xt(oe,Xk),Xt(oe,Tv))),Q.ADD_TAGS&&(typeof Q.ADD_TAGS=="function"?ve.tagCheck=Q.ADD_TAGS:(D===M&&(D=Fa(D)),Xt(D,Q.ADD_TAGS,Ir))),Q.ADD_ATTR&&(typeof Q.ADD_ATTR=="function"?ve.attributeCheck=Q.ADD_ATTR:(oe===Ee&&(oe=Fa(oe)),Xt(oe,Q.ADD_ATTR,Ir))),Q.ADD_URI_SAFE_ATTR&&Xt(lt,Q.ADD_URI_SAFE_ATTR,Ir),Q.FORBID_CONTENTS&&(tt===Pt&&(tt=Fa(tt)),Xt(tt,Q.FORBID_CONTENTS,Ir)),Q.ADD_FORBID_CONTENTS&&(tt===Pt&&(tt=Fa(tt)),Xt(tt,Q.ADD_FORBID_CONTENTS,Ir)),Ae&&(D["#text"]=!0),gt&&Xt(D,["html","head","body"]),D.table&&(Xt(D,["tbody"]),delete ce.tbody),Q.TRUSTED_TYPES_POLICY){if(typeof Q.TRUSTED_TYPES_POLICY.createHTML!="function")throw Yp('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Q.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Yp('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');P=Q.TRUSTED_TYPES_POLICY,U=P.createHTML("")}else P===void 0&&(P=z7(E,s)),P!==null&&typeof U=="string"&&(U=P.createHTML(""));Ks&&Ks(Q),ls=Q}},bo=Xt({},[...ow,...iw,...A7]),Qs=Xt({},[...aw,...I7]),Qi=function(Q){let De=j(Q);(!De||!De.tagName)&&(De={namespaceURI:ut,tagName:"template"});const We=Vv(Q.tagName),xr=Vv(De.tagName);return cr[Q.namespaceURI]?Q.namespaceURI===Ie?De.namespaceURI===Ge?We==="svg":De.namespaceURI===de?We==="svg"&&(xr==="annotation-xml"||Nt[xr]):!!bo[We]:Q.namespaceURI===de?De.namespaceURI===Ge?We==="math":De.namespaceURI===Ie?We==="math"&&Sr[xr]:!!Qs[We]:Q.namespaceURI===Ge?De.namespaceURI===Ie&&!Sr[xr]||De.namespaceURI===de&&!Nt[xr]?!1:!Qs[We]&&(as[We]||!bo[We]):!!(Vn==="application/xhtml+xml"&&cr[Q.namespaceURI]):!1},xn=function(Q){qp(e.removed,{element:Q});try{j(Q).removeChild(Q)}catch{T(Q)}},cs=function(Q,De){try{qp(e.removed,{attribute:De.getAttributeNode(Q),from:De})}catch{qp(e.removed,{attribute:null,from:De})}if(De.removeAttribute(Q),Q==="is")if(Ut||Zt)try{xn(De)}catch{}else try{De.setAttribute(Q,"")}catch{}},Ho=function(Q){let De=null,We=null;if(ot)Q="<remove></remove>"+Q;else{const Pr=sw(Q,/^[\r\n\t ]+/);We=Pr&&Pr[0]}Vn==="application/xhtml+xml"&&ut===Ge&&(Q='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Q+"</body></html>");const xr=P?P.createHTML(Q):Q;if(ut===Ge)try{De=new b().parseFromString(xr,Vn)}catch{}if(!De||!De.documentElement){De=B.createDocument(ut,"template",null);try{De.documentElement.innerHTML=Ft?U:xr}catch{}}const Dt=De.body||De.documentElement;return Q&&We&&Dt.insertBefore(t.createTextNode(We),Dt.childNodes[0]||null),ut===Ge?J.call(De,gt?"html":"body")[0]:gt?De.documentElement:Dt},vi=function(Q){return $.call(Q.ownerDocument||Q,Q,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},Zi=function(Q){return Q instanceof x&&(typeof Q.nodeName!="string"||typeof Q.textContent!="string"||typeof Q.removeChild!="function"||!(Q.attributes instanceof g)||typeof Q.removeAttribute!="function"||typeof Q.setAttribute!="function"||typeof Q.namespaceURI!="string"||typeof Q.insertBefore!="function"||typeof Q.hasChildNodes!="function")},Wa=function(Q){return typeof u=="function"&&Q instanceof u};function us(it,Q,De){Nv(it,We=>{We.call(e,Q,De,ls)})}const Is=function(Q){let De=null;if(us(te.beforeSanitizeElements,Q,null),Zi(Q))return xn(Q),!0;const We=Ir(Q.nodeName);if(us(te.uponSanitizeElement,Q,{tagName:We,allowedTags:D}),Te&&Q.hasChildNodes()&&!Wa(Q.firstElementChild)&&Bs(/<[/\w!]/g,Q.innerHTML)&&Bs(/<[/\w!]/g,Q.textContent)||Q.nodeType===Xp.progressingInstruction||Te&&Q.nodeType===Xp.comment&&Bs(/<[/\w]/g,Q.data))return xn(Q),!0;if(!(ve.tagCheck instanceof Function&&ve.tagCheck(We))&&(!D[We]||ce[We])){if(!ce[We]&&ta(We)&&(V.tagNameCheck instanceof RegExp&&Bs(V.tagNameCheck,We)||V.tagNameCheck instanceof Function&&V.tagNameCheck(We)))return!1;if(Ae&&!tt[We]){const xr=j(Q)||Q.parentNode,Dt=A(Q)||Q.childNodes;if(Dt&&xr){const Pr=Dt.length;for(let Hr=Pr-1;Hr>=0;--Hr){const fn=S(Dt[Hr],!0);fn.__removalCount=(Q.__removalCount||0)+1,xr.insertBefore(fn,R(Q))}}}return xn(Q),!0}return Q instanceof p&&!Qi(Q)||(We==="noscript"||We==="noembed"||We==="noframes")&&Bs(/<\/no(script|embed|frames)/i,Q.innerHTML)?(xn(Q),!0):(Me&&Q.nodeType===Xp.text&&(De=Q.textContent,Nv([ue,we,ie],xr=>{De=Kp(De,xr," ")}),Q.textContent!==De&&(qp(e.removed,{element:Q.cloneNode()}),Q.textContent=De)),us(te.afterSanitizeElements,Q,null),!1)},ea=function(Q,De,We){if(et&&(De==="id"||De==="name")&&(We in t||We in gi))return!1;if(!(Ne&&!xe[De]&&Bs(se,De))){if(!(le&&Bs(pe,De))){if(!(ve.attributeCheck instanceof Function&&ve.attributeCheck(De,Q))){if(!oe[De]||xe[De]){if(!(ta(Q)&&(V.tagNameCheck instanceof RegExp&&Bs(V.tagNameCheck,Q)||V.tagNameCheck instanceof Function&&V.tagNameCheck(Q))&&(V.attributeNameCheck instanceof RegExp&&Bs(V.attributeNameCheck,De)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(De,Q))||De==="is"&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&Bs(V.tagNameCheck,We)||V.tagNameCheck instanceof Function&&V.tagNameCheck(We))))return!1}else if(!lt[De]){if(!Bs(K,Kp(We,G,""))){if(!((De==="src"||De==="xlink:href"||De==="href")&&Q!=="script"&&k7(We,"data:")===0&&Er[Q])){if(!(He&&!Bs(ee,Kp(We,G,"")))){if(We)return!1}}}}}}}return!0},ta=function(Q){return Q!=="annotation-xml"&&sw(Q,z)},ra=function(Q){us(te.beforeSanitizeAttributes,Q,null);const{attributes:De}=Q;if(!De||Zi(Q))return;const We={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:oe,forceKeepAttr:void 0};let xr=De.length;for(;xr--;){const Dt=De[xr],{name:Pr,namespaceURI:Hr,value:fn}=Dt,wn=Ir(Pr),yi=fn;let qr=Pr==="value"?yi:N7(yi);if(We.attrName=wn,We.attrValue=qr,We.keepAttr=!0,We.forceKeepAttr=void 0,us(te.uponSanitizeAttribute,Q,We),qr=We.attrValue,It&&(wn==="id"||wn==="name")&&(cs(Pr,Q),qr=hr+qr),Te&&Bs(/((--!?|])>)|<\/(style|title|textarea)/i,qr)){cs(Pr,Q);continue}if(wn==="attributename"&&sw(qr,"href")){cs(Pr,Q);continue}if(We.forceKeepAttr)continue;if(!We.keepAttr){cs(Pr,Q);continue}if(!Ue&&Bs(/\/>/i,qr)){cs(Pr,Q);continue}Me&&Nv([ue,we,ie],qn=>{qr=Kp(qr,qn," ")});const xi=Ir(Q.nodeName);if(!ea(xi,wn,qr)){cs(Pr,Q);continue}if(P&&typeof E=="object"&&typeof E.getAttributeType=="function"&&!Hr)switch(E.getAttributeType(xi,wn)){case"TrustedHTML":{qr=P.createHTML(qr);break}case"TrustedScriptURL":{qr=P.createScriptURL(qr);break}}if(qr!==yi)try{Hr?Q.setAttributeNS(Hr,Pr,qr):Q.setAttribute(Pr,qr),Zi(Q)?xn(Q):qk(e.removed)}catch{cs(Pr,Q)}}us(te.afterSanitizeAttributes,Q,null)},na=function it(Q){let De=null;const We=vi(Q);for(us(te.beforeSanitizeShadowDOM,Q,null);De=We.nextNode();)us(te.uponSanitizeShadowNode,De,null),Is(De),ra(De),De.content instanceof i&&it(De.content);us(te.afterSanitizeShadowDOM,Q,null)};return e.sanitize=function(it){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},De=null,We=null,xr=null,Dt=null;if(Ft=!it,Ft&&(it="<!-->"),typeof it!="string"&&!Wa(it))if(typeof it.toString=="function"){if(it=it.toString(),typeof it!="string")throw Yp("dirty is not a string, aborting")}else throw Yp("toString is not a function");if(!e.isSupported)return it;if(jt||Xs(Q),e.removed=[],typeof it=="string"&&(Xe=!1),Xe){if(it.nodeName){const fn=Ir(it.nodeName);if(!D[fn]||ce[fn])throw Yp("root node is forbidden and cannot be sanitized in-place")}}else if(it instanceof u)De=Ho("<!---->"),We=De.ownerDocument.importNode(it,!0),We.nodeType===Xp.element&&We.nodeName==="BODY"||We.nodeName==="HTML"?De=We:De.appendChild(We);else{if(!Ut&&!Me&&!gt&&it.indexOf("<")===-1)return P&&er?P.createHTML(it):it;if(De=Ho(it),!De)return Ut?null:er?U:""}De&&ot&&xn(De.firstChild);const Pr=vi(Xe?it:De);for(;xr=Pr.nextNode();)Is(xr),ra(xr),xr.content instanceof i&&na(xr.content);if(Xe)return it;if(Ut){if(Zt)for(Dt=Y.call(De.ownerDocument);De.firstChild;)Dt.appendChild(De.firstChild);else Dt=De;return(oe.shadowroot||oe.shadowrootmode)&&(Dt=he.call(n,Dt,!0)),Dt}let Hr=gt?De.outerHTML:De.innerHTML;return gt&&D["!doctype"]&&De.ownerDocument&&De.ownerDocument.doctype&&De.ownerDocument.doctype.name&&Bs(RA,De.ownerDocument.doctype.name)&&(Hr="<!DOCTYPE "+De.ownerDocument.doctype.name+`>
`+Hr),Me&&Nv([ue,we,ie],fn=>{Hr=Kp(Hr,fn," ")}),P&&er?P.createHTML(Hr):Hr},e.setConfig=function(){let it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xs(it),jt=!0},e.clearConfig=function(){ls=null,jt=!1},e.isValidAttribute=function(it,Q,De){ls||Xs({});const We=Ir(it),xr=Ir(Q);return ea(We,xr,De)},e.addHook=function(it,Q){typeof Q=="function"&&qp(te[it],Q)},e.removeHook=function(it,Q){if(Q!==void 0){const De=S7(te[it],Q);return De===-1?void 0:C7(te[it],De,1)[0]}return qk(te[it])},e.removeHooks=function(it){te[it]=[]},e.removeAllHooks=function(){te=Zk()},e}AA();const cw=r=>{var s;const e=r.replace(/^```html\s*/,""),t=document.createElement("div");return t.innerHTML=e.replace(/style="[^"]*"/g,""),(((s=t.textContent)==null?void 0:s.replace(/(\n{2,}|[ \t]+\n+|\n+[ \t]+)/g,`
`))||"").trim()},bb=r=>r.replace(/&quot;/g,'"').replace(/\\"/g,'"').replace(/\\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/\\n/g,`
`).replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\\\/g,"\\").replace(/```html/g,"").replace(/```/g,"").replace(/^"/,"").replace(/"$/,"").replace(/\u2019/g,"'").replace(/\u2018/g,"'").replace(/\u201A/g,"'").replace(/\u201B/g,"'"),H7=({htmlString:r})=>{const e=()=>{const t=bb(r);return{__html:new DOMParser().parseFromString(t,"text/html").body.innerHTML}};return d.jsx("div",{className:"rich-text-content text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6",fontFamily:"Arial, sans-serif"},dangerouslySetInnerHTML:e()})},IA=w.forwardRef(({value:r,onChange:e,className:t,...n},s)=>{const i=w.useRef(null);w.useImperativeHandle(s,()=>i.current);const c=()=>{const u=i.current;u&&(u.style.height="auto",u.style.height=`${u.scrollHeight}px`)};return w.useEffect(()=>{c()},[r]),d.jsx("textarea",{ref:i,value:r,onChange:u=>{e&&e(u)},className:`auto-resizing-textarea ${t||""}`,...n})});IA.displayName="AutoResizingTextarea";var B7=Tb[" useId ".trim().toString()]||(()=>{}),G7=0;function jl(r){const[e,t]=w.useState(B7());return Dl(()=>{t(n=>n??String(G7++))},[r]),e?`radix-${e}`:""}var uw="focusScope.autoFocusOnMount",dw="focusScope.autoFocusOnUnmount",e1={bubbles:!1,cancelable:!0},W7="FocusScope",bE=w.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...c}=r,[u,p]=w.useState(null),m=$l(s),g=$l(i),x=w.useRef(null),b=Nn(e,S=>p(S)),E=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let S=function(j){if(E.paused||!u)return;const P=j.target;u.contains(P)?x.current=P:Ic(x.current,{select:!0})},T=function(j){if(E.paused||!u)return;const P=j.relatedTarget;P!==null&&(u.contains(P)||Ic(x.current,{select:!0}))},R=function(j){if(document.activeElement===document.body)for(const U of j)U.removedNodes.length>0&&Ic(u)};document.addEventListener("focusin",S),document.addEventListener("focusout",T);const A=new MutationObserver(R);return u&&A.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",T),A.disconnect()}}},[n,u,E.paused]),w.useEffect(()=>{if(u){r1.add(E);const S=document.activeElement;if(!u.contains(S)){const R=new CustomEvent(uw,e1);u.addEventListener(uw,m),u.dispatchEvent(R),R.defaultPrevented||(V7(X7(PA(u)),{select:!0}),document.activeElement===S&&Ic(u))}return()=>{u.removeEventListener(uw,m),setTimeout(()=>{const R=new CustomEvent(dw,e1);u.addEventListener(dw,g),u.dispatchEvent(R),R.defaultPrevented||Ic(S??document.body,{select:!0}),u.removeEventListener(dw,g),r1.remove(E)},0)}}},[u,m,g,E]);const N=w.useCallback(S=>{if(!t&&!n||E.paused)return;const T=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,R=document.activeElement;if(T&&R){const A=S.currentTarget,[j,P]=q7(A);j&&P?!S.shiftKey&&R===P?(S.preventDefault(),t&&Ic(j,{select:!0})):S.shiftKey&&R===j&&(S.preventDefault(),t&&Ic(P,{select:!0})):R===A&&S.preventDefault()}},[t,n,E.paused]);return d.jsx(Ar.div,{tabIndex:-1,...c,ref:b,onKeyDown:N})});bE.displayName=W7;function V7(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if(Ic(n,{select:e}),document.activeElement!==t)return}function q7(r){const e=PA(r),t=t1(e,r),n=t1(e.reverse(),r);return[t,n]}function PA(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function t1(r,e){for(const t of r)if(!K7(t,{upTo:e}))return t}function K7(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function Y7(r){return r instanceof HTMLInputElement&&"select"in r}function Ic(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&Y7(r)&&e&&r.select()}}var r1=J7();function J7(){let r=[];return{add(e){const t=r[0];e!==t&&(t==null||t.pause()),r=n1(r,e),r.unshift(e)},remove(e){var t;r=n1(r,e),(t=r[0])==null||t.resume()}}}function n1(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function X7(r){return r.filter(e=>e.tagName!=="A")}var fw=0;function FA(){w.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??s1()),document.body.insertAdjacentElement("beforeend",r[1]??s1()),fw++,()=>{fw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),fw--}},[])}function s1(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var qv="right-scroll-bar-position",Kv="width-before-scroll-bar",Q7="with-scroll-bars-hidden",Z7="--removed-body-scroll-bar-size";function hw(r,e){return typeof r=="function"?r(e):r&&(r.current=e),r}function eW(r,e){var t=w.useState(function(){return{value:r,callback:e,facade:{get current(){return t.value},set current(n){var s=t.value;s!==n&&(t.value=n,t.callback(n,s))}}}})[0];return t.callback=e,t.facade}var tW=typeof window<"u"?w.useLayoutEffect:w.useEffect,o1=new WeakMap;function rW(r,e){var t=eW(null,function(n){return r.forEach(function(s){return hw(s,n)})});return tW(function(){var n=o1.get(t);if(n){var s=new Set(n),i=new Set(r),c=t.current;s.forEach(function(u){i.has(u)||hw(u,null)}),i.forEach(function(u){s.has(u)||hw(u,c)})}o1.set(t,r)},[r]),t}function nW(r){return r}function sW(r,e){e===void 0&&(e=nW);var t=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:r},useMedium:function(i){var c=e(i,n);return t.push(c),function(){t=t.filter(function(u){return u!==c})}},assignSyncMedium:function(i){for(n=!0;t.length;){var c=t;t=[],c.forEach(i)}t={push:function(u){return i(u)},filter:function(){return t}}},assignMedium:function(i){n=!0;var c=[];if(t.length){var u=t;t=[],u.forEach(i),c=t}var p=function(){var g=c;c=[],g.forEach(i)},m=function(){return Promise.resolve().then(p)};m(),t={push:function(g){c.push(g),m()},filter:function(g){return c=c.filter(g),t}}}};return s}function oW(r){r===void 0&&(r={});var e=sW(null);return e.options=Oa({async:!0,ssr:!1},r),e}var jA=function(r){var e=r.sideCar,t=TN(r,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,Oa({},t))};jA.isSideCarExport=!0;function iW(r,e){return r.useMedium(e),jA}var OA=oW(),pw=function(){},t0=w.forwardRef(function(r,e){var t=w.useRef(null),n=w.useState({onScrollCapture:pw,onWheelCapture:pw,onTouchMoveCapture:pw}),s=n[0],i=n[1],c=r.forwardProps,u=r.children,p=r.className,m=r.removeScrollBar,g=r.enabled,x=r.shards,b=r.sideCar,E=r.noRelative,N=r.noIsolation,S=r.inert,T=r.allowPinchZoom,R=r.as,A=R===void 0?"div":R,j=r.gapMode,P=TN(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),U=b,B=rW([t,e]),$=Oa(Oa({},P),s);return w.createElement(w.Fragment,null,g&&w.createElement(U,{sideCar:OA,removeScrollBar:m,shards:x,noRelative:E,noIsolation:N,inert:S,setCallbacks:i,allowPinchZoom:!!T,lockRef:t,gapMode:j}),c?w.cloneElement(w.Children.only(u),Oa(Oa({},$),{ref:B})):w.createElement(A,Oa({},$,{className:p,ref:B}),u))});t0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};t0.classNames={fullWidth:Kv,zeroRight:qv};var aW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function lW(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var e=aW();return e&&r.setAttribute("nonce",e),r}function cW(r,e){r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}function uW(r){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(r)}var dW=function(){var r=0,e=null;return{add:function(t){r==0&&(e=lW())&&(cW(e,t),uW(e)),r++},remove:function(){r--,!r&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},fW=function(){var r=dW();return function(e,t){w.useEffect(function(){return r.add(e),function(){r.remove()}},[e&&t])}},DA=function(){var r=fW(),e=function(t){var n=t.styles,s=t.dynamic;return r(n,s),null};return e},hW={left:0,top:0,right:0,gap:0},mw=function(r){return parseInt(r||"",10)||0},pW=function(r){var e=window.getComputedStyle(document.body),t=e[r==="padding"?"paddingLeft":"marginLeft"],n=e[r==="padding"?"paddingTop":"marginTop"],s=e[r==="padding"?"paddingRight":"marginRight"];return[mw(t),mw(n),mw(s)]},mW=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return hW;var e=pW(r),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},gW=DA(),Zf="data-scroll-locked",vW=function(r,e,t,n){var s=r.left,i=r.top,c=r.right,u=r.gap;return t===void 0&&(t="margin"),`
  .`.concat(Q7,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(u,"px ").concat(n,`;
  }
  body[`).concat(Zf,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(u,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(qv,` {
    right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(Kv,` {
    margin-right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(qv," .").concat(qv,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Kv," .").concat(Kv,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Zf,`] {
    `).concat(Z7,": ").concat(u,`px;
  }
`)},i1=function(){var r=parseInt(document.body.getAttribute(Zf)||"0",10);return isFinite(r)?r:0},yW=function(){w.useEffect(function(){return document.body.setAttribute(Zf,(i1()+1).toString()),function(){var r=i1()-1;r<=0?document.body.removeAttribute(Zf):document.body.setAttribute(Zf,r.toString())}},[])},xW=function(r){var e=r.noRelative,t=r.noImportant,n=r.gapMode,s=n===void 0?"margin":n;yW();var i=w.useMemo(function(){return mW(s)},[s]);return w.createElement(gW,{styles:vW(i,!e,s,t?"":"!important")})},_b=!1;if(typeof window<"u")try{var Rv=Object.defineProperty({},"passive",{get:function(){return _b=!0,!0}});window.addEventListener("test",Rv,Rv),window.removeEventListener("test",Rv,Rv)}catch{_b=!1}var Of=_b?{passive:!1}:!1,wW=function(r){return r.tagName==="TEXTAREA"},LA=function(r,e){if(!(r instanceof Element))return!1;var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!wW(r)&&t[e]==="visible")},bW=function(r){return LA(r,"overflowY")},_W=function(r){return LA(r,"overflowX")},a1=function(r,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=MA(r,n);if(s){var i=$A(r,n),c=i[1],u=i[2];if(c>u)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},EW=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},SW=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},MA=function(r,e){return r==="v"?bW(e):_W(e)},$A=function(r,e){return r==="v"?EW(e):SW(e)},CW=function(r,e){return r==="h"&&e==="rtl"?-1:1},kW=function(r,e,t,n,s){var i=CW(r,window.getComputedStyle(e).direction),c=i*n,u=t.target,p=e.contains(u),m=!1,g=c>0,x=0,b=0;do{if(!u)break;var E=$A(r,u),N=E[0],S=E[1],T=E[2],R=S-T-i*N;(N||R)&&MA(r,u)&&(x+=R,b+=N);var A=u.parentNode;u=A&&A.nodeType===Node.DOCUMENT_FRAGMENT_NODE?A.host:A}while(!p&&u!==document.body||p&&(e.contains(u)||e===u));return(g&&Math.abs(x)<1||!g&&Math.abs(b)<1)&&(m=!0),m},Av=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},l1=function(r){return[r.deltaX,r.deltaY]},c1=function(r){return r&&"current"in r?r.current:r},NW=function(r,e){return r[0]===e[0]&&r[1]===e[1]},TW=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},RW=0,Df=[];function AW(r){var e=w.useRef([]),t=w.useRef([0,0]),n=w.useRef(),s=w.useState(RW++)[0],i=w.useState(DA)[0],c=w.useRef(r);w.useEffect(function(){c.current=r},[r]),w.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(s));var S=DM([r.lockRef.current],(r.shards||[]).map(c1),!0).filter(Boolean);return S.forEach(function(T){return T.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),S.forEach(function(T){return T.classList.remove("allow-interactivity-".concat(s))})}}},[r.inert,r.lockRef.current,r.shards]);var u=w.useCallback(function(S,T){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!c.current.allowPinchZoom;var R=Av(S),A=t.current,j="deltaX"in S?S.deltaX:A[0]-R[0],P="deltaY"in S?S.deltaY:A[1]-R[1],U,B=S.target,$=Math.abs(j)>Math.abs(P)?"h":"v";if("touches"in S&&$==="h"&&B.type==="range")return!1;var Y=window.getSelection(),J=Y&&Y.anchorNode,he=J?J===B||J.contains(B):!1;if(he)return!1;var te=a1($,B);if(!te)return!0;if(te?U=$:(U=$==="v"?"h":"v",te=a1($,B)),!te)return!1;if(!n.current&&"changedTouches"in S&&(j||P)&&(n.current=U),!U)return!0;var ue=n.current||U;return kW(ue,T,S,ue==="h"?j:P)},[]),p=w.useCallback(function(S){var T=S;if(!(!Df.length||Df[Df.length-1]!==i)){var R="deltaY"in T?l1(T):Av(T),A=e.current.filter(function(U){return U.name===T.type&&(U.target===T.target||T.target===U.shadowParent)&&NW(U.delta,R)})[0];if(A&&A.should){T.cancelable&&T.preventDefault();return}if(!A){var j=(c.current.shards||[]).map(c1).filter(Boolean).filter(function(U){return U.contains(T.target)}),P=j.length>0?u(T,j[0]):!c.current.noIsolation;P&&T.cancelable&&T.preventDefault()}}},[]),m=w.useCallback(function(S,T,R,A){var j={name:S,delta:T,target:R,should:A,shadowParent:IW(R)};e.current.push(j),setTimeout(function(){e.current=e.current.filter(function(P){return P!==j})},1)},[]),g=w.useCallback(function(S){t.current=Av(S),n.current=void 0},[]),x=w.useCallback(function(S){m(S.type,l1(S),S.target,u(S,r.lockRef.current))},[]),b=w.useCallback(function(S){m(S.type,Av(S),S.target,u(S,r.lockRef.current))},[]);w.useEffect(function(){return Df.push(i),r.setCallbacks({onScrollCapture:x,onWheelCapture:x,onTouchMoveCapture:b}),document.addEventListener("wheel",p,Of),document.addEventListener("touchmove",p,Of),document.addEventListener("touchstart",g,Of),function(){Df=Df.filter(function(S){return S!==i}),document.removeEventListener("wheel",p,Of),document.removeEventListener("touchmove",p,Of),document.removeEventListener("touchstart",g,Of)}},[]);var E=r.removeScrollBar,N=r.inert;return w.createElement(w.Fragment,null,N?w.createElement(i,{styles:TW(s)}):null,E?w.createElement(xW,{noRelative:r.noRelative,gapMode:r.gapMode}):null)}function IW(r){for(var e=null;r!==null;)r instanceof ShadowRoot&&(e=r.host,r=r.host),r=r.parentNode;return e}const PW=iW(OA,AW);var _E=w.forwardRef(function(r,e){return w.createElement(t0,Oa({},r,{ref:e,sideCar:PW}))});_E.classNames=t0.classNames;var FW=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},Lf=new WeakMap,Iv=new WeakMap,Pv={},gw=0,UA=function(r){return r&&(r.host||UA(r.parentNode))},jW=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=UA(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},OW=function(r,e,t,n){var s=jW(e,Array.isArray(r)?r:[r]);Pv[t]||(Pv[t]=new WeakMap);var i=Pv[t],c=[],u=new Set,p=new Set(s),m=function(x){!x||u.has(x)||(u.add(x),m(x.parentNode))};s.forEach(m);var g=function(x){!x||p.has(x)||Array.prototype.forEach.call(x.children,function(b){if(u.has(b))g(b);else try{var E=b.getAttribute(n),N=E!==null&&E!=="false",S=(Lf.get(b)||0)+1,T=(i.get(b)||0)+1;Lf.set(b,S),i.set(b,T),c.push(b),S===1&&N&&Iv.set(b,!0),T===1&&b.setAttribute(t,"true"),N||b.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",b,R)}})};return g(e),u.clear(),gw++,function(){c.forEach(function(x){var b=Lf.get(x)-1,E=i.get(x)-1;Lf.set(x,b),i.set(x,E),b||(Iv.has(x)||x.removeAttribute(n),Iv.delete(x)),E||x.removeAttribute(t)}),gw--,gw||(Lf=new WeakMap,Lf=new WeakMap,Iv=new WeakMap,Pv={})}},zA=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),s=FW(r);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),OW(n,s,t,"aria-hidden")):function(){return null}};function DW(r){const e=LW(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,u=w.Children.toArray(i),p=u.find($W);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function LW(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=zW(s),u=UW(i,s.props);return s.type!==w.Fragment&&(u.ref=n?qc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var MW=Symbol("radix.slottable");function $W(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===MW}function UW(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function zW(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var r0="Dialog",[HA]=Ba(r0),[HW,Ki]=HA(r0),BA=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:s,onOpenChange:i,modal:c=!0}=r,u=w.useRef(null),p=w.useRef(null),[m,g]=Kc({prop:n,defaultProp:s??!1,onChange:i,caller:r0});return d.jsx(HW,{scope:e,triggerRef:u,contentRef:p,contentId:jl(),titleId:jl(),descriptionId:jl(),open:m,onOpenChange:g,onOpenToggle:w.useCallback(()=>g(x=>!x),[g]),modal:c,children:t})};BA.displayName=r0;var GA="DialogTrigger",BW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Ki(GA,t),i=Nn(e,s.triggerRef);return d.jsx(Ar.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":CE(s.open),...n,ref:i,onClick:Ct(r.onClick,s.onOpenToggle)})});BW.displayName=GA;var EE="DialogPortal",[GW,WA]=HA(EE,{forceMount:void 0}),VA=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:s}=r,i=Ki(EE,e);return d.jsx(GW,{scope:e,forceMount:t,children:w.Children.map(n,c=>d.jsx(qi,{present:t||i.open,children:d.jsx(yE,{asChild:!0,container:s,children:c})}))})};VA.displayName=EE;var ky="DialogOverlay",qA=w.forwardRef((r,e)=>{const t=WA(ky,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=Ki(ky,r.__scopeDialog);return i.modal?d.jsx(qi,{present:n||i.open,children:d.jsx(VW,{...s,ref:e})}):null});qA.displayName=ky;var WW=DW("DialogOverlay.RemoveScroll"),VW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Ki(ky,t);return d.jsx(_E,{as:WW,allowPinchZoom:!0,shards:[s.contentRef],children:d.jsx(Ar.div,{"data-state":CE(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),rd="DialogContent",KA=w.forwardRef((r,e)=>{const t=WA(rd,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=Ki(rd,r.__scopeDialog);return d.jsx(qi,{present:n||i.open,children:i.modal?d.jsx(qW,{...s,ref:e}):d.jsx(KW,{...s,ref:e})})});KA.displayName=rd;var qW=w.forwardRef((r,e)=>{const t=Ki(rd,r.__scopeDialog),n=w.useRef(null),s=Nn(e,t.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return zA(i)},[]),d.jsx(YA,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ct(r.onCloseAutoFocus,i=>{var c;i.preventDefault(),(c=t.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Ct(r.onPointerDownOutside,i=>{const c=i.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0;(c.button===2||u)&&i.preventDefault()}),onFocusOutside:Ct(r.onFocusOutside,i=>i.preventDefault())})}),KW=w.forwardRef((r,e)=>{const t=Ki(rd,r.__scopeDialog),n=w.useRef(!1),s=w.useRef(!1);return d.jsx(YA,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,u;(c=r.onCloseAutoFocus)==null||c.call(r,i),i.defaultPrevented||(n.current||(u=t.triggerRef.current)==null||u.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var p,m;(p=r.onInteractOutside)==null||p.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=i.target;((m=t.triggerRef.current)==null?void 0:m.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),YA=w.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...c}=r,u=Ki(rd,t),p=w.useRef(null),m=Nn(e,p);return FA(),d.jsxs(d.Fragment,{children:[d.jsx(bE,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:d.jsx(Qy,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":CE(u.open),...c,ref:m,onDismiss:()=>u.onOpenChange(!1)})}),d.jsxs(d.Fragment,{children:[d.jsx(YW,{titleId:u.titleId}),d.jsx(XW,{contentRef:p,descriptionId:u.descriptionId})]})]})}),SE="DialogTitle",JA=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Ki(SE,t);return d.jsx(Ar.h2,{id:s.titleId,...n,ref:e})});JA.displayName=SE;var XA="DialogDescription",QA=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Ki(XA,t);return d.jsx(Ar.p,{id:s.descriptionId,...n,ref:e})});QA.displayName=XA;var ZA="DialogClose",eI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Ki(ZA,t);return d.jsx(Ar.button,{type:"button",...n,ref:e,onClick:Ct(r.onClick,()=>s.onOpenChange(!1))})});eI.displayName=ZA;function CE(r){return r?"open":"closed"}var tI="DialogTitleWarning",[RK,rI]=gB(tI,{contentName:rd,titleName:SE,docsSlug:"dialog"}),YW=({titleId:r})=>{const e=rI(tI),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return w.useEffect(()=>{r&&(document.getElementById(r)||console.error(t))},[t,r]),null},JW="DialogDescriptionWarning",XW=({contentRef:r,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${rI(JW).contentName}}.`;return w.useEffect(()=>{var i;const s=(i=r.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,r,e]),null},QW=BA,ZW=VA,nI=qA,sI=KA,oI=JA,iI=QA,e9=eI;const t9=QW,r9=ZW,aI=w.forwardRef(({className:r,...e},t)=>d.jsx(nI,{ref:t,className:_r("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));aI.displayName=nI.displayName;const lI=w.forwardRef(({className:r,children:e,...t},n)=>d.jsxs(r9,{children:[d.jsx(aI,{}),d.jsxs(sI,{ref:n,className:_r("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,d.jsxs(e9,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[d.jsx(fi,{className:"h-4 w-4"}),d.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));lI.displayName=sI.displayName;const cI=({className:r,...e})=>d.jsx("div",{className:_r("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});cI.displayName="DialogHeader";const uI=({className:r,...e})=>d.jsx("div",{className:_r("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});uI.displayName="DialogFooter";const dI=w.forwardRef(({className:r,...e},t)=>d.jsx(oI,{ref:t,className:_r("text-lg font-semibold leading-none tracking-tight",r),...e}));dI.displayName=oI.displayName;const fI=w.forwardRef(({className:r,...e},t)=>d.jsx(iI,{ref:t,className:_r("text-sm text-muted-foreground",r),...e}));fI.displayName=iI.displayName;const n9=({isOpen:r,onClose:e,title:t="Gmail Connection Required",description:n="This feature requires an active Gmail connection. Please connect your Gmail account to continue.",actionText:s="the requested action"})=>{const[i,c]=w.useState(!1),{initiateReconnection:u,wasEverConnected:p}=Wi(),m=async()=>{c(!0);try{await u(),e()}catch(g){console.error("Failed to reconnect Gmail:",g)}finally{c(!1)}};return d.jsx(t9,{open:r,onOpenChange:e,children:d.jsxs(lI,{className:"sm:max-w-md",children:[d.jsxs(cI,{children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx(Bc,{className:"h-5 w-5 text-blue-600"})}),d.jsx(dI,{className:"text-lg font-semibold",children:t})]}),d.jsx(fI,{className:"text-sm text-gray-600 leading-relaxed",children:n})]}),d.jsx("div",{className:"bg-gray-50 rounded-lg p-4 my-4",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),d.jsxs("div",{className:"text-sm text-gray-700",children:[d.jsx("p",{className:"font-medium mb-1",children:"What happens next:"}),d.jsxs("p",{children:["You'll be redirected to Gmail's authorization page to ",p?"reconnect":"connect"," your account securely."]})]})]})}),d.jsxs(uI,{className:"flex gap-2 sm:gap-2",children:[d.jsx(ze,{variant:"outline",onClick:e,disabled:i,className:"flex-1",children:"Cancel"}),d.jsx(ze,{onClick:m,disabled:i,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:i?d.jsxs(d.Fragment,{children:[d.jsx(wo,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):p?"Reconnect Gmail":"Connect Gmail"})]})]})})},Xr="src/shared/components/sidepanel/panels/GenerateEmailDraftPanel.tsx",s9=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft. 
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),o9=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple amd use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},i9=({clientEmail:r})=>{const e=Or(),t=Ul(),n=sd(),s=tn().platform,{isConnected:i,wasEverConnected:c}=Wi(),[u,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState(""),E=w.useRef(null),[N,S]=w.useState(!0),[T,R]=w.useState(""),[A,j]=w.useState([]),[P,U]=w.useState(0),[B,$]=w.useState(""),[Y,J]=w.useState(!1),[he,te]=w.useState(!0),[ue,we]=w.useState(!0),[ie,se]=w.useState(!0),[pe,ee]=w.useState(null),[G,z]=w.useState(null),[K,D]=w.useState([]),M=w.useRef(null),[oe,Ee]=w.useState(""),[V,ce]=w.useState("Neutral"),[xe,ve]=w.useState("Neutral"),[le,Ne]=w.useState("Neutral"),He=w.useRef(null),[Ue,Me]=w.useState(!1),[Te,gt]=w.useState(!1),[jt,ot]=w.useState([]),[Ut,Zt]=w.useState(!0),[er,et]=w.useState(!1),It="25dc68db26595a7485917129d6993f96",hr="c1c8e460f2105029b2b4563f9222161c",Ae=["Analyzing email thread...","Pulling relevant information...","Structuring your response...","Preparing personalized reply...","Finalizing your draft..."],Xe=w.useCallback(async lt=>{const kt="fetchFromStorageProvider";if(!t)return"";try{const de=await t.getLocalItem(lt);return de&&e.debug("Loaded additional context from storage",{sourceFile:Xr,functionName:kt}),de||""}catch(de){return e.error("Error loading additional context from storage",de,{sourceFile:Xr,functionName:kt}),""}},[t,e]);w.useEffect(()=>{let lt;const kt=()=>{if(u){const de=Math.floor(Math.random()*2e3)+1e3;lt=setTimeout(()=>{U(Ie=>(Ie+1)%Ae.length),kt()},de)}};return u&&kt(),()=>{lt&&clearTimeout(lt)}},[u,Ae.length]),w.useEffect(()=>{const lt="useEffect[threadDataListener]";if(!n){e.debug("DataProvider not available yet",{sourceFile:Xr,functionName:lt});return}const kt=async Ie=>{const Ge=Ie!==null&&Ie.threadId!==M.current;if(Ie){if(e.debug("Thread changed via platform abstraction",{sourceFile:Xr,functionName:lt,threadId:Ie.threadId,isThreadChanged:Ge}),z(Ie.threadId),console.log("Thread changed via platform abstraction",{sourceFile:Xr,functionName:lt,thread:Ie}),D(Ie.participants||[]),Ie.messages&&Array.isArray(Ie.messages)&&Ie.messages.length>0&&Ie.messages[0]&&typeof Ie.messages[0]=="object"){const Ft=Ie.messages.map((ft,Nt)=>({body:ft.body||ft.html||"",html:ft.html||ft.body||"",from:ft.from||"",timestamp:ft.timestamp||"",subject:Nt===0&&Ie.subject||""}));ee(Ft);const cr=Ft.length>0?cw(Ft[0].body):"";$(cr)}Ge&&(R(""),j([]),ot([]),g(!1),p(!1)),M.current=Ie.threadId;const ut=`additionalContext_${Ie.threadId}`;Ee(await Xe(ut))}else{e.debug("Thread cleared via platform abstraction",{sourceFile:Xr,functionName:lt});const ut=M.current!==null;z(null),ee(null),D([]),$(""),R(""),j([]),ot([]),g(!1),p(!1),ut&&(Ee(""),M.current=null)}};return n.onThreadChanged(kt),(async()=>{try{const Ie=await n.getCurrentThread();await kt(Ie)}catch(Ie){e.error("Error loading current thread",Ie,{sourceFile:Xr,functionName:"loadCurrentThread"})}})(),()=>{n.removeThreadListener(kt)}},[n,e]),w.useEffect(()=>{const kt=setTimeout(async()=>{const de="useEffect[saveAdditionalContext]";if(!(!G||!t))try{const Ie=`additionalContext_${G}`;await t.setLocalItem(Ie,oe)}catch(Ie){e.error("Error saving additional context to storage",Ie,{sourceFile:Xr,functionName:de,threadId:G})}},500);return()=>clearTimeout(kt)},[oe,G,t,e]);const pt=w.useCallback(async lt=>{try{if(!G)return e.debug("No thread ID available for cache check",{sourceFile:Xr,functionName:lt}),!1;const kt=tt(G),de=await B5(kt,e);return de?(e.debug("Found cached response for thread",{sourceFile:Xr,functionName:lt,cacheKey:kt,threadId:G}),R(de.response),j(de.references),ot(de.cmsData),p(!1),g(!0),!0):(e.debug("No cached response found for thread",{sourceFile:Xr,functionName:lt,cacheKey:kt,threadId:G}),!1)}catch(kt){return e.warn("Error checking for cached response",{sourceFile:Xr,functionName:lt,error:kt}),!1}},[G,e]);w.useEffect(()=>{const kt=setTimeout(async()=>{const de="checkForCachedResponse";!G||T||u||await pt(de)},500);return()=>clearTimeout(kt)},[G,pt,T,u]),w.useEffect(()=>{(async()=>{const kt="checkCachedResponseOnReady";N||!G||!pe||T||u||(e.debug("Component ready, checking for cached response immediately",{sourceFile:Xr,functionName:kt,threadId:G,hasThreadData:!!pe,isLoading:N,hasResponse:!!T}),await pt(kt))})()},[N,G,pe,pt,T,u,e]),w.useEffect(()=>{if(m&&E.current){const lt=setTimeout(()=>{var kt;(kt=E.current)==null||kt.focus()},100);return()=>clearTimeout(lt)}},[m]),w.useEffect(()=>{const lt=async()=>{try{if(!t)return;const Ie=await t.getLocalItem("useUscis");Me(Ie??!1),e.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:Xr,functionName:"initializeUscisState",uscisEnabled:Ie??!1})}catch(Ie){e.error("Error loading USCIS state",Ie,{sourceFile:Xr,functionName:"initializeUscisState"})}},kt=async()=>{try{if(!t)return;const Ie=await t.getLocalItem("useOregon");gt(Ie??!1),e.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:Xr,functionName:"initializeOregonState",oregonEnabled:Ie??!1})}catch(Ie){e.error("Error loading Oregon state",Ie,{sourceFile:Xr,functionName:"initializeOregonState"})}},de=async Ie=>{try{Ie.useUscis!==void 0&&(Me(Ie.useUscis),e.debug("USCIS setting changed via platform abstraction",{sourceFile:Xr,functionName:"handleStorageChange",useUscis:Ie.useUscis})),Ie.useOregon!==void 0&&(gt(Ie.useOregon),e.debug("Oregon setting changed via platform abstraction",{sourceFile:Xr,functionName:"handleStorageChange",useOregon:Ie.useOregon}))}catch(Ge){e.error("Error handling storage changes",Ge,{sourceFile:Xr,functionName:"handleStorageChange"})}};return lt(),kt(),t!=null&&t.onChanged&&t.onChanged(de),S(!1),()=>{t!=null&&t.removeChangeListener&&de&&t.removeChangeListener(de)}},[t,e]),w.useEffect(()=>{if(T&&He.current){const lt=He.current,de=(lt.scrollHeight-lt.clientHeight)*.8;lt.scrollTo({top:de,behavior:"smooth"}),e.debug("Scrolling to 90% of bottom after response generation",{sourceFile:Xr,functionName:"useEffect[fullResponse]"})}},[T,e]);const tt=lt=>`response_${lt}`,Pt=async(lt,kt)=>{p(!0),R("Reformatting..."),g(!1);const de="regenerateResponse";try{if(!G){e.error("Thread ID is not set for regeneration",void 0,{sourceFile:Xr,functionName:de}),p(!1);return}const Ie=tt(G),Ge=await J6(kt,lt,e);R(Ge),p(!1),g(!0),await yC(Ie,Ge,[],[],e)}catch(Ie){e.error("Error regenerating response",Ie,{sourceFile:Xr,functionName:de}),p(!1),g(!0)}},Er=async()=>{if(s==="chrome"&&!i){et(!0);return}p(!0),g(!1);const lt="handleGenerateResponse";try{const kt=(pe==null?void 0:pe.map(Nt=>`From: ${Nt.from}
Timestamp: ${Nt.timestamp}
Body: ${cw(Nt.body)}

`).join(""))||"",de=[];if(Ue&&de.push(It),Te&&de.push(hr),!G){e.error("Thread ID is not set",void 0,{sourceFile:Xr,functionName:lt}),p(!1);return}const Ie=o9(V,xe,le),Ge=s9(),ut=tt(G);let Ft;s==="outlook"?Ft=await Y6(G,kt,oe,Ie,Ge,K,e):Ft=await K6(G,kt,oe,Ie,Ge,de,e);const cr=Ft.response,ft=bb(cr);R(ft),j(Ft.references),ot(Ft.cms_data||[]),p(!1),g(!0),await yC(ut,ft,Ft.references,Ft.cms_data||[],e)}catch(kt){e.error("Error generating response",kt,{sourceFile:Xr,functionName:lt}),p(!1)}};return s==="chrome"&&!i?d.jsx("div",{className:"p-4",children:d.jsx(wE,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):d.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:He,children:[d.jsxs(li,{className:"overflow-hidden shadow-sm mb-4",children:[d.jsx($i,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>we(!ue),children:d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Ui,{className:"text-sm font-semibold pr-1",children:"Current Email"}),d.jsxs("div",{className:"relative group",children:[d.jsx(Fc,{src:"/icons/info-circled.svg",width:16,height:16,alt:"Info",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert"}),d.jsx("div",{className:"absolute left-0 top-full mt-2 w-48 p-2 bg-white dark:bg-gray-800 text-black dark:text-white text-xs rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity z-50 border dark:border-border",children:"This is the email Candle AI is responding to."})]})]}),d.jsx(Fc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${ue?"transform rotate-180":""}`})]})}),ue&&d.jsx(ci,{className:"p-0.5",children:d.jsx("textarea",{value:N?"Loading...":pe?cw(pe[0].body):s==="chrome"&&!i?"Gmail disconnected. Connect Gmail to view email content.":"Please select an email thread",disabled:!0,className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-xs bg-white dark:bg-card text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400"})})]}),d.jsxs(li,{className:"overflow-hidden shadow-sm mb-4",children:[d.jsx($i,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>te(!he),children:d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsx(Ui,{className:"text-sm font-semibold",children:"Anything specific you want the response to include?"}),d.jsx(Fc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${he?"transform rotate-180":""}`})]})}),he&&d.jsx(ci,{className:"p-0.5",children:d.jsx("textarea",{className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-sm bg-white dark:bg-card text-gray-900 dark:text-gray-200 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",placeholder:`Examples: 'This client's visa is expiring soon. Suggest they renew it soon.'
'Respond in Spanish.'`,value:oe,onChange:lt=>Ee(lt.target.value)})})]}),d.jsxs(li,{className:"overflow-hidden shadow-sm mb-4",children:[d.jsx($i,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>J(!Y),children:d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsx(Ui,{className:"text-sm font-semibold",children:"Tone"}),d.jsx(Fc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${Y?"transform rotate-180":""}`})]})}),Y&&d.jsxs(ci,{className:"p-4 space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),d.jsx(rw,{options:["Casual","Neutral","Formal"],value:V,onChange:ce})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),d.jsx(rw,{options:["Low","Neutral","High"],value:xe,onChange:ve})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),d.jsx(rw,{options:["Simple","Neutral","Detailed"],value:le,onChange:Ne})]})]})]}),d.jsx(ze,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",onClick:Er,disabled:u||!G&&s!=="chrome"||s==="chrome"&&!i&&!G,children:u?"Generating...":s==="chrome"&&!i?"Connect Gmail to Generate Response":G?"Generate Response":"Select a thread"}),u&&d.jsxs("div",{className:"flex flex-col items-center justify-center",children:[d.jsx(Hi,{className:"h-8 w-8 animate-spin text-blue-600"}),d.jsx("p",{className:"mt-2 text-sm text-gray-500",children:Ae[P]})]}),d.jsxs("div",{className:"mb-24",children:[d.jsx(n9,{isOpen:er,onClose:()=>et(!1),title:"Gmail Connection Required",description:"Generate Response requires an active Gmail connection to analyze your email thread and create personalized responses.",actionText:"generate email responses"}),T&&!u&&d.jsxs(li,{className:"animate-slide-fade-in mb-2 origin-top",children:[d.jsx($i,{className:"p-3 border-b dark:border-border cursor-pointer",children:d.jsxs(Ui,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[d.jsx(Fc,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Generated Response",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),d.jsx("p",{className:"text-sm font-semibold",children:"Generated Response"}),d.jsxs(ze,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:()=>{kA(bb(T),e)},children:[d.jsx(BR,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),"Insert"]})]})}),d.jsx(ci,{className:"p-6",children:d.jsx(H7,{htmlString:T})})]}),m&&d.jsx("div",{className:"animate-fadeIn mb-2",children:d.jsxs("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:[d.jsx("div",{className:"p-3 bg-white dark:bg-card",children:d.jsx(IA,{ref:E,placeholder:"Customize this response",value:x,className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[40px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",onChange:lt=>b(lt.target.value),onKeyDown:lt=>{lt.key==="Enter"&&!lt.shiftKey&&x.trim()&&(lt.preventDefault(),Pt(x,T),b(""))}})}),d.jsx("div",{className:"h-[1px] bg-neutral-200 dark:bg-border"}),d.jsxs("div",{className:"flex gap-0 bg-white dark:bg-card border-t dark:border-border",children:[d.jsx(ze,{onClick:()=>{Pt("More empathetic",T)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"More empathetic"}),d.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),d.jsx(ze,{onClick:()=>{Pt("Make it shorter",T)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"Make it shorter"}),d.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),d.jsx(ze,{onClick:()=>{x&&(Pt(x,T),b(""))},disabled:!x.trim(),size:"icon",className:"h-auto w-12 rounded-none bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-600/50 disabled:text-white/90 disabled:cursor-not-allowed transition-all duration-200",children:d.jsx(eB,{className:"h-4 w-4"})})]})]})})]})]})},a9=()=>{const[r,e]=w.useState(!1),t=Ul(),n=Or(),s=NT();w.useEffect(()=>{n.info("LoginPanel component loaded",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"});const c=u=>{u.token&&(e(!1),n.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}))};return t!=null&&t.onChanged&&t.onChanged(c),()=>{t!=null&&t.removeChangeListener&&t.removeChangeListener(c)}},[t,n]);const i=async()=>{n.info("Login button clicked",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!0);try{await s.login(),n.info("Login completed successfully",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}catch(c){n.error("Login failed",c,{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}};return d.jsxs("div",{className:"flex flex-col items-center justify-center h-full px-6 bg-gradient-to-b from-blue-50/30 to-white dark:from-gray-900 dark:to-gray-950 animate-fade-in",children:[d.jsx("div",{className:"flex items-center justify-center max-w-md w-full mb-8",children:d.jsxs("svg",{width:"400",height:"200",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-auto max-h-[200px] drop-shadow-lg",children:[d.jsxs("defs",{children:[d.jsxs("linearGradient",{id:"emailGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#EEF2FF",stopOpacity:1}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#E0E7FF",stopOpacity:1}})]}),d.jsxs("linearGradient",{id:"glowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#818CF8",stopOpacity:.6}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#4F46E5",stopOpacity:.3}})]}),d.jsxs("filter",{id:"glow",children:[d.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),d.jsxs("feMerge",{children:[d.jsx("feMergeNode",{in:"coloredBlur"}),d.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),d.jsx("circle",{cx:"200",cy:"150",r:"120",fill:"url(#glowGradient)",opacity:"0.3",className:"animate-pulse-slow"}),d.jsx("circle",{cx:"200",cy:"150",r:"80",fill:"url(#glowGradient)",opacity:"0.2",className:"animate-pulse-slow",style:{animationDelay:"0.5s"}}),d.jsxs("g",{className:"animate-float",children:[d.jsx("rect",{x:"100",y:"80",width:"200",height:"140",rx:"8",fill:"url(#emailGradient)",stroke:"#6366F1",strokeWidth:"2"}),d.jsx("line",{x1:"120",y1:"110",x2:"240",y2:"110",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),d.jsx("line",{x1:"120",y1:"130",x2:"260",y2:"130",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),d.jsx("line",{x1:"120",y1:"150",x2:"230",y2:"150",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),d.jsx("line",{x1:"120",y1:"170",x2:"250",y2:"170",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),d.jsx("line",{x1:"120",y1:"190",x2:"210",y2:"190",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"})]}),d.jsxs("g",{className:"animate-sparkle",children:[d.jsx("circle",{cx:"80",cy:"60",r:"4",fill:"#818CF8",filter:"url(#glow)"}),d.jsx("path",{d:"M 80 50 L 82 58 L 90 60 L 82 62 L 80 70 L 78 62 L 70 60 L 78 58 Z",fill:"#818CF8",filter:"url(#glow)"})]}),d.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.7s"},children:[d.jsx("circle",{cx:"320",cy:"80",r:"3",fill:"#4F46E5",filter:"url(#glow)"}),d.jsx("path",{d:"M 320 72 L 321.5 78 L 328 80 L 321.5 82 L 320 88 L 318.5 82 L 312 80 L 318.5 78 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),d.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1.4s"},children:[d.jsx("circle",{cx:"310",cy:"230",r:"3.5",fill:"#818CF8",filter:"url(#glow)"}),d.jsx("path",{d:"M 310 221 L 311.8 227.5 L 319 230 L 311.8 232.5 L 310 239 L 308.2 232.5 L 301 230 L 308.2 227.5 Z",fill:"#818CF8",filter:"url(#glow)"})]}),d.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.3s"},children:[d.jsx("circle",{cx:"90",cy:"240",r:"3",fill:"#6366F1",filter:"url(#glow)"}),d.jsx("path",{d:"M 90 233 L 91.5 238 L 97 240 L 91.5 242 L 90 247 L 88.5 242 L 83 240 L 88.5 238 Z",fill:"#6366F1",filter:"url(#glow)"})]}),d.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1s"},children:[d.jsx("circle",{cx:"320",cy:"150",r:"5",fill:"#4F46E5",filter:"url(#glow)"}),d.jsx("path",{d:"M 320 138 L 323 147 L 333 150 L 323 153 L 320 162 L 317 153 L 307 150 L 317 147 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),d.jsx("circle",{cx:"85",cy:"150",r:"2.5",fill:"#818CF8",opacity:"0.6",className:"animate-sparkle"}),d.jsx("circle",{cx:"315",cy:"200",r:"2",fill:"#6366F1",opacity:"0.5",className:"animate-sparkle",style:{animationDelay:"0.5s"}}),d.jsx("circle",{cx:"280",cy:"70",r:"2",fill:"#4F46E5",opacity:"0.6",className:"animate-sparkle",style:{animationDelay:"1s"}})]})}),d.jsxs("div",{className:"text-center mb-6 space-y-3 animate-slide-up",children:[d.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:["Legal emails,",d.jsx("br",{}),"effortlessly handled"]}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-xs mx-auto",children:"AI-powered email assistant for legal professionals"})]}),d.jsx("div",{className:"w-full max-w-xs animate-slide-up",style:{animationDelay:"0.2s"},children:d.jsx(ze,{onClick:i,className:"w-full h-12 text-base font-medium shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02] bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:r,children:r?d.jsxs("span",{className:"flex items-center justify-center gap-2",children:[d.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Get Started"})})]})},l9=[{available:!0,id:"gmail",name:"Gmail",description:"Connect your Gmail account to access your email",authMethod:"oauth",authUrl:B_(H_),logo:"/gmail.svg",homeUrl:"https://mail.google.com",isConnected:!1,category:"email"},{available:!0,id:"filevine",name:"Filevine",description:"Connect your Filevine account to access case status",authMethod:"custom",authUrl:"https://identity.filevine.com/",customAuthFields:[{id:"clientId",displayName:"Client ID",type:"text"},{id:"clientSecret",displayName:"Client Secret",type:"text"},{id:"PAT",displayName:"Personal Access Token",type:"text"},{id:"organizationId",displayName:"Organization ID",type:"text"},{id:"userId",displayName:"User ID",type:"text"}],logo:"/filevine.svg",homeUrl:"https://identity.filevine.com/",isConnected:!1,category:"case_management"},{available:!0,id:"clio",name:"Clio",description:"Connect your Clio account to access case status",authMethod:"server",authUrl:G_+"clio",logo:"/clio.svg",homeUrl:"https://app.clio.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],hI=[{available:!0,id:"inszoom",name:"INSZoom",description:"Connect your INSZoom account to access case status",authMethod:"custom",authUrl:"https://global.inszoom.com/",logo:"/inszoom.ico",customAuthFields:[{id:"auth_key",displayName:"Authorization Key",type:"text"},{id:"subscription_key",displayName:"Subscription Key",type:"text"},{id:"case_status_report",displayName:"Latest Case Status Report",type:"file"}],homeUrl:"https://global.inszoom.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],vr="src/lib/utils/integrationUtils.tsx";async function kE(r){const e=l9.find(n=>n.id===r);return e||hI.find(n=>n.id===r)||null}async function c9(r){return hI.find(e=>e.id===r)||null}async function pI(r,e,t,n,s){if(e.authMethod==="server")throw new Error("Integration is a server integration which shouldn't be initiated by the extension");r.info("Initiating integration process for integration:",{sourceFile:vr,integrationId:e});try{let i;if(s&&Object.keys(s).length>0){r.info("Starting file serialization process",{sourceFile:vr,fileCount:Object.keys(s).length});const u=100*1024*1024;for(const[p,m]of Object.entries(s))if(m.size>u){const g=`File "${m.name}" exceeds 100MB limit. File size: ${(m.size/1048576).toFixed(2)}MB`;throw r.error("File size validation failed",new Error(g),{sourceFile:vr,fieldId:p,fileName:m.name,fileSize:m.size,maxSize:u}),new Error(g)}i={};for(const[p,m]of Object.entries(s)){const g=await Ax(m);r.info("Original file checksum calculated",{sourceFile:vr,fieldId:p,fileName:m.name,fileSize:m.size,fileType:m.type,originalChecksum:g});const x=await m.arrayBuffer(),b=new Uint8Array(x),E=await Ax(x);r.info("ArrayBuffer checksum calculated",{sourceFile:vr,fieldId:p,fileName:m.name,bufferChecksum:E,bufferSize:x.byteLength,checksumMatch:g===E});let N="";const S=8192;for(let U=0;U<b.length;U+=S){const B=b.slice(U,U+S);N+=String.fromCharCode(...B)}const T=btoa(N),R=atob(T),A=new ArrayBuffer(R.length),j=new Uint8Array(A);for(let U=0;U<R.length;U++)j[U]=R.charCodeAt(U);const P=await Ax(A);i[p]={name:m.name,type:m.type,size:m.size,data:T},r.info("File serialization completed",{sourceFile:vr,fieldId:p,fileName:m.name,fileSize:m.size,base64Length:T.length,originalChecksum:g,bufferChecksum:E,decodedChecksum:P,allChecksumsMatch:g===E&&E===P})}r.info("All files serialized successfully",{sourceFile:vr,serializedFileCount:Object.keys(i).length})}const c=await On.createServices();if(c.messaging.sendMessage){const u=await c.messaging.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!u.success)throw new Error(u.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:vr}),u.success}else{const u=await chrome.runtime.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!u.success)throw new Error(u.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:vr}),u.success}}catch(i){throw r.error("Integration failed:",i,{sourceFile:vr}),i}}async function u9(r,e){try{const t=await On.createServices();if(t.messaging.sendMessage){const n=await t.messaging.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:vr}),n.success}else{const n=await chrome.runtime.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:vr}),n.success}}catch(t){throw r.error("Disconnection failed:",t,{sourceFile:vr}),t}}async function mI(r){const e="isCaseManagementSystemIntegrationConnected";try{r.debug("Starting CMS integration check",{sourceFile:vr,functionName:e});const t=await zm(r);r.debug("Local integrations retrieved",{sourceFile:vr,functionName:e,count:t.length,integrations:t.map(m=>m.integration_type)});const n=t.some(m=>m.integration_type==="filevine"||m.integration_type==="clio"||m.integration_type==="inszoom");if(r.debug("Local CMS integration check result",{sourceFile:vr,functionName:e,isConnectedLocally:n}),n)return r.info("CMS integration found in local storage",{sourceFile:vr,functionName:e}),!0;const[s,i]=await Promise.all([Hc("user",r).catch(()=>[]),Hc("tenant",r).catch(()=>[])]),c=s.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"user"})),u=i.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"tenant"})),p=[...c,...u];return await Um(r,p),p.some(m=>m.integration_type==="filevine"||m.integration_type==="clio"||m.integration_type==="inszoom");return r.info("Final CMS integration check result",{sourceFile:vr,functionName:e,isConnectedOnServer}),isConnectedOnServer}catch(t){return r.error("Failed to check if CMS integration is connected",t,{sourceFile:vr,functionName:e}),!1}}async function d9(r,e){try{if((await zm(r)).some(m=>m.integration_type===e))return!0;const[s,i]=await Promise.all([Hc("user",r).catch(()=>[]),Hc("tenant",r).catch(()=>[])]),c=s.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"user"})),u=i.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"tenant"})),p=[...c,...u];return await Um(r,p),p.some(m=>m.integration_type===e)||!1}catch(t){return r.warn("Failed to check if integration is connected:",{sourceFile:vr,integrationId:e,error:t}),!1}}async function gI(r){try{r.info("Refreshing integrations from server",{sourceFile:vr}),await rT(r);const[e,t]=await Promise.all([Hc("user",r).catch(()=>[]),Hc("tenant",r).catch(()=>[])]),n=e.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"user"})),s=t.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"tenant"})),i=[...n,...s];return await Um(r,i),r.info("Refreshed integrations from server",{sourceFile:vr,userCount:n.length,tenantCount:s.length,totalCount:i.length}),!0}catch(e){return r.warn("Failed to refresh integrations:",{sourceFile:vr,error:e}),!1}}async function vI(r){try{const e=await zm(r);if(e.length>0)return e;const[t,n]=await Promise.all([Hc("user",r).catch(u=>(r.warn("Failed to fetch user integrations:",{sourceFile:vr,error:u}),[])),Hc("tenant",r).catch(u=>(r.warn("Failed to fetch tenant integrations:",{sourceFile:vr,error:u}),[]))]),s=t.map(u=>({...u,scope:"user"})),i=n.map(u=>({...u,scope:"tenant"})),c=[...s,...i];return await Um(r,c),r.info("Saved merged integrations to local storage",{sourceFile:vr,userCount:s.length,tenantCount:i.length,totalCount:c.length,integrations:c}),c}catch(e){return r.error("Failed to list integrations:",e,{sourceFile:vr}),[]}}async function f9(r,e){try{return(await zm(r)).find(n=>n.integration_type===e)||null}catch(t){return r.error("Failed to get integration details:",t,{sourceFile:vr}),null}}async function h9(r,e){var i;const t=await ey(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e.integration_type))||[];n.push(e);const s={...t,integrations:n};await ZN(r,s)}async function p9(r,e){var i;const t=await ey(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e))||[],s={...t,integrations:n};await ZN(r,s)}async function m9(r,e){if(!e)throw new Error("Integration not found");if(e.authMethod!=="server")throw new Error("Integration is not a server integration");try{const t=await Nm(r);if(!t)throw r.warn("Failed to get authentication token",{sourceFile:vr}),new Error("Authentication required. Please log in first.");const n=`${G_}${e.id}?token=${encodeURIComponent(t.id_token)}`;r.debug("Opening server auth page",{sourceFile:vr,integrationId:e.id}),window.open(n,"_blank")}catch(t){throw r.error("Failed to open server auth page:",t,{sourceFile:vr}),t}}async function g9(r){try{return await rT(r),await hT(r),!0}catch(e){return r.error("Failed to clear integration data:",e,{sourceFile:vr}),!1}}const v9=Object.freeze(Object.defineProperty({__proto__:null,clearIntegrationData:g9,disconnectIntegration:u9,findIntegrationById:kE,findOrgIntegrationById:c9,getIntegrationDetails:f9,initiateIntegration:pI,isCaseManagementSystemIntegrationConnected:mI,isIntegrationConnected:d9,listIntegrations:vI,openServerAuthPageForIntegration:m9,refreshIntegrations:gI,removeIntegrationDetails:p9,saveIntegrationDetails:h9},Symbol.toStringTag,{value:"Module"})),Qp="src/components/ui/DetailsTable.tsx",u1=r=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16",...r,className:`inline-block w-4 h-4 ${r.className||""}`,children:[d.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),d.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),Yc=({details:r,linkableFields:e})=>{const t=Or(),[n,s]=nr.useState(new Set),[i,c]=nr.useState(new Set),u=80;if(!r)return t.debug("No important details to render",{sourceFile:Qp}),null;if(Object.keys(r).length===0)return t.debug("No important details to render",{sourceFile:Qp}),null;const p=N=>{const S=document.createElement("textarea");S.value=N,S.style.position="fixed",S.style.opacity="0",document.body.appendChild(S),S.select();const T=document.execCommand("copy");return document.body.removeChild(S),T},m=(N,S)=>{navigator.clipboard.writeText(N).then(()=>{t.debug("Copied to clipboard",{sourceFile:Qp,copiedValue:N}),c(T=>new Set([...T,S])),setTimeout(()=>{c(T=>{const R=new Set(T);return R.delete(S),R})},2e3)}).catch(T=>{t.error("Failed to copy with navigator.clipboard.writeText",T,{sourceFile:Qp});try{p(N)&&(c(R=>new Set([...R,S])),setTimeout(()=>{c(R=>{const A=new Set(R);return A.delete(S),A})},2e3))}catch(R){t.error("Failed to copy with document.execCommand",R,{sourceFile:Qp})}})},g=N=>{const S=new Set(n);S.has(N)?S.delete(N):S.add(N),s(S)},x=N=>{if(!N)return"";try{return new Date(N).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return N}},b=N=>{try{const S=new URL(N);return S.protocol==="http:"||S.protocol==="https:"}catch{return!1}},E=N=>N.split(/(\[\[.*?\]\]|\(\(.*?\)\))/g).map((T,R)=>{if(T.startsWith("[[")&&T.endsWith("]]")){const A=T.slice(2,-2);return d.jsx("span",{className:"font-semibold",children:A},R)}else if(T.startsWith("((")&&T.endsWith("))")){const A=T.slice(2,-2);return/^\d{4}-\d{2}-\d{2}/.test(A)?d.jsx("span",{className:"text-base",children:x(A)},R):d.jsx("span",{className:"text-base",children:A},R)}return T});return d.jsx("div",{className:"p-1",children:d.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300 table-fixed",children:d.jsx("tbody",{children:Object.entries(r).map(([N,S],T)=>{let R;S===""||S===null||S===void 0?R="":typeof S=="string"||typeof S=="number"?R=String(S):R=JSON.stringify(S);const A=e==null?void 0:e.find($=>$.field===N),j=b(R),P=R.length>u,U=n.has(T),B=P&&!U?R.substring(0,u)+"...":R;return d.jsxs("tr",{className:"bg-card",children:[d.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-2/5 text-gray-800 dark:text-gray-200",children:A?d.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline whitespace-normal hover:text-blue-800 dark:hover:text-blue-300 flex items-center gap-1",children:[N,d.jsx(u1,{})]}):N}),d.jsx("td",{className:`py-2 px-3 whitespace-pre-wrap break-words ${j?"":"hover:bg-gray-100 dark:hover:bg-muted"}`,style:j?{}:{cursor:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>') 10 10, copy`},onClick:()=>!j&&!P&&m(R,T),title:j?"Click to open link":P?"":"Click to copy",children:j?d.jsxs("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline break-words flex items-center gap-1",children:[E(R),d.jsx(u1,{className:"flex-shrink-0"})]}):d.jsxs("div",{children:[d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"break-words text-gray-700 dark:text-gray-300",onClick:()=>!P&&m(R,T),children:E(B)}),i.has(T)&&d.jsx("span",{className:"absolute -top-1 -right-1 bg-white dark:bg-gray-700 text-black dark:text-white text-xs px-2 py-1 rounded-full shadow-lg border border-gray-300 dark:border-gray-600",children:"Copied!"})]}),P&&d.jsx("div",{className:"mt-1",children:d.jsx("button",{onClick:$=>{$.stopPropagation(),g(T)},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline text-sm",children:U?"show less":"show more"})})]})})]},T)})})})})},vn="src/shared/components/sidepanel/mainPanelContent/EmailSummaryBox.tsx",y9=()=>{const[r,e]=w.useState(""),[t,n]=w.useState(null),[s,i]=w.useState(null),[c,u]=w.useState(!1),[p,m]=w.useState(!0),[g,x]=w.useState(!1),[b,E]=w.useState("summary"),[N,S]=w.useState(null),[T,R]=w.useState(null),[A,j]=w.useState(0),{platform:P}=tn(),U=sd(),B=Or(),$=w.useRef(null),Y=w.useRef(null),J=w.useRef(!1),he=["Analyzing email content...","Extracting key information...","Identifying important details...","Generating summary...","Finalizing insights..."];w.useEffect(()=>{let ee;const G=()=>{if(c){const z=Math.floor(Math.random()*1500)+500;ee=setTimeout(()=>{j(K=>(K+1)%he.length),G()},z)}};return c&&G(),()=>{ee&&clearTimeout(ee)}},[c,he.length]);const te=w.useCallback(async ee=>{if(J.current&&$.current===ee){B.debug("Already loading summary for thread:",{threadId:ee,sourceFile:vn});return}$.current=ee,u(!0),J.current=!0;try{const G=await X6(ee,B);$.current===ee?(B.debug("Summary response:",{summaryResponse:G,sourceFile:vn}),e(G.summary),S(G.importantDetails),u(!1),J.current=!1):B.debug("Ignoring summary response for outdated thread:",{threadId:ee,sourceFile:vn})}catch(G){B.error("Error fetching email summary:",G,{sourceFile:vn}),$.current===ee&&(u(!1),J.current=!1)}},[B]),ue=w.useCallback(async(ee,G)=>{if(J.current&&$.current===ee){B.debug("Already loading summary for thread:",{threadId:ee,sourceFile:vn});return}$.current=ee,u(!0),J.current=!0;const z=await O5(ee,B);if(z){B.debug("Using cached summary for thread:",{threadId:ee,sourceFile:vn}),e(z.summary),S(z.importantDetails),u(!1),J.current=!1;return}try{if(!G){B.warn("No thread data found",{sourceFile:vn,functionName:"fetchEmailSummaryForOutlook"}),u(!1),J.current=!1;return}const K=await Q6(G,B);$.current===ee?(B.debug("Summary response:",{summaryResponse:K,sourceFile:vn}),await j5(ee,K.summary,K.importantDetails,B),e(K.summary),S(K.importantDetails),u(!1),J.current=!1):B.debug("Ignoring summary response for outdated thread:",{threadId:ee,sourceFile:vn})}catch(K){B.error("Error fetching email summary for Outlook:",K,{sourceFile:vn}),$.current===ee&&(u(!1),J.current=!1,e("Error fetching email summary. Please try again."))}},[B]);w.useEffect(()=>{const ee=async()=>{B.info("Checking if Gmail is connected",{sourceFile:vn});const z=await zy(B);B.info("Gmail connection check result",{connected:z,sourceFile:vn}),m(z)},G=async()=>{try{const K=(await On.createServices()).storage;if(K.onChanged){const D=M=>{if(M.gmailConnectionStatus){const oe=M.gmailConnectionStatus.newValue;B.info("Gmail connection status changed via storage",{sourceFile:vn,newStatus:oe,oldStatus:M.gmailConnectionStatus.oldValue}),m(!0)}};return K.onChanged(D),()=>{K.removeChangeListener&&K.removeChangeListener(D)}}}catch(z){B.error("Failed to set up storage listener:",z,{sourceFile:vn})}};if(P==="chrome"){const K=(async()=>(await ee(),await G()))();return()=>{K.then(D=>D==null?void 0:D())}}else P==="outlook"&&(m(!1),console.log("Not calling checkGmailConnection for Outlook"))},[P,B]),w.useEffect(()=>{if(U!=null&&U.onThreadChanged){const ee=z=>{if(B.debug("Thread change received",{sourceFile:vn,functionName:"handleThreadChange",hasThread:!!z,threadId:z==null?void 0:z.threadId,platform:P}),!z){B.debug("No thread provided, keeping current state",{sourceFile:vn}),n(null),i(null);return}if(n(z.threadId||null),B.debug("Thread ID set",{sourceFile:vn,threadId:z.threadId}),z.messages&&Array.isArray(z.messages)&&z.messages.length>0&&z.messages[0]&&typeof z.messages[0]=="object"){const K=z.messages.map((D,M)=>({body:D.body||D.html||"",html:D.html||D.body||"",from:D.from||"",timestamp:D.timestamp||"",subject:M===0&&z.subject||""}));i(JSON.stringify(K)),B.debug("Thread data converted and set",{sourceFile:vn,messageCount:K.length})}};return U.onThreadChanged(ee),(async()=>{try{const z=await U.getCurrentThread();ee(z)}catch(z){B.error("Error loading current thread",z,{sourceFile:vn,functionName:"loadCurrentThread"})}})(),()=>{U.removeThreadListener&&U.removeThreadListener(ee)}}},[U,P,B]),w.useEffect(()=>{t&&p&&P==="chrome"?(t!==$.current||!J.current)&&te(t):!p&&P==="chrome"?(e("Connect to Gmail to enable email summaries"),S(null),E("summary"),$.current=null,J.current=!1,u(!1)):!p&&P==="outlook"&&s&&t?(t!==$.current||!J.current)&&ue(t||"",s):(e("Select a thread to summarize"),S(null),E("summary"),$.current=null,J.current=!1,u(!1))},[t,p,te,ue,P,s]);const we=async()=>{try{x(!0);const ee=B_(H_),G=await kE("gmail");if(!G){B.error("Gmail integration not found",new Error("Gmail integration not found"),{sourceFile:vn});return}await pI(B,G,ee)&&(m(!0),t&&te(t))}catch(ee){B.error("Failed to connect to Gmail:",ee,{sourceFile:vn}),e("Failed to connect to Gmail. Please try again.")}finally{x(!1)}},ie=()=>N?d.jsx(Yc,{details:N}):null,se=()=>{b==="summary"&&Y.current&&(R(Y.current.offsetHeight),E("details"))},pe=N!==null&&Object.keys(N).length>0;return w.useEffect(()=>{pe||E("summary")},[pe]),w.useEffect(()=>{T&&document.documentElement.style.setProperty("--content-height",`${T}px`)},[T]),d.jsxs("div",{className:"w-full max-w-full min-h-[4rem] border rounded-lg shadow-md bg-white mx-2 mt-2 mb-6 overflow-hidden box-border border-b-0",title:"Email Summary",style:{maxWidth:"calc(100% - 1rem)"},children:[d.jsx("div",{className:"flex items-center justify-center p-2 border-b bg-gray-150 min-w-0",children:d.jsxs("div",{className:"flex items-center gap-1 bg-gray-150 p-1 rounded-full",children:[d.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-1.5 ${b==="summary"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>E("summary"),children:[d.jsx(Bc,{className:"w-3.5 h-3.5"}),"Summary"]}),pe&&d.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors flex items-center gap-1.5 whitespace-nowrap ${b==="details"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:se,children:[d.jsx(Fc,{src:"/icons/info-circled.svg",width:14,height:14,alt:"Info",className:"w-3.5 h-3.5"}),"Key Points"]})]})}),d.jsx("div",{className:"w-full min-w-0",children:c?d.jsxs("div",{className:"w-full border rounded flex flex-col items-center justify-center bg-gray-50 p-4",children:[d.jsx(Hi,{className:"h-8 w-8 animate-spin text-blue-600"}),d.jsx("div",{className:"text-center text-sm text-gray-500",children:he[A]})]}):!p&&P==="chrome"?d.jsxs("div",{className:"w-full p-4 flex flex-col items-center justify-center",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Connect to Gmail to enable email summaries"}),d.jsx(ze,{onClick:we,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",disabled:g,children:g?"Connecting...":"Connect Gmail"})]}):d.jsx("div",{className:"w-full min-w-0 overflow-hidden",children:b==="summary"?d.jsx("div",{ref:Y,className:"p-3 text-sm text-gray-600 whitespace-pre-wrap break-words overflow-wrap-anywhere",children:r}):d.jsx("div",{className:"overflow-y-auto",children:ie()})})})]})};function d1(r){const e=x9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,u=w.Children.toArray(i),p=u.find(b9);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function x9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=E9(s),u=_9(i,s.props);return s.type!==w.Fragment&&(u.ref=n?qc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var w9=Symbol("radix.slottable");function b9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===w9}function _9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function E9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function NE(r){const e=r+"CollectionProvider",[t,n]=Ba(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),c=S=>{const{scope:T,children:R}=S,A=nr.useRef(null),j=nr.useRef(new Map).current;return d.jsx(s,{scope:T,itemMap:j,collectionRef:A,children:R})};c.displayName=e;const u=r+"CollectionSlot",p=d1(u),m=nr.forwardRef((S,T)=>{const{scope:R,children:A}=S,j=i(u,R),P=Nn(T,j.collectionRef);return d.jsx(p,{ref:P,children:A})});m.displayName=u;const g=r+"CollectionItemSlot",x="data-radix-collection-item",b=d1(g),E=nr.forwardRef((S,T)=>{const{scope:R,children:A,...j}=S,P=nr.useRef(null),U=Nn(T,P),B=i(g,R);return nr.useEffect(()=>(B.itemMap.set(P,{ref:P,...j}),()=>void B.itemMap.delete(P))),d.jsx(b,{[x]:"",ref:U,children:A})});E.displayName=g;function N(S){const T=i(r+"CollectionConsumer",S);return nr.useCallback(()=>{const A=T.collectionRef.current;if(!A)return[];const j=Array.from(A.querySelectorAll(`[${x}]`));return Array.from(T.itemMap.values()).sort((B,$)=>j.indexOf(B.ref.current)-j.indexOf($.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:c,Slot:m,ItemSlot:E},N,n]}var S9=w.createContext(void 0);function n0(r){const e=w.useContext(S9);return r||e||"ltr"}var vw="rovingFocusGroup.onEntryFocus",C9={bubbles:!1,cancelable:!0},Ym="RovingFocusGroup",[Eb,yI,k9]=NE(Ym),[N9,s0]=Ba(Ym,[k9]),[T9,R9]=N9(Ym),xI=w.forwardRef((r,e)=>d.jsx(Eb.Provider,{scope:r.__scopeRovingFocusGroup,children:d.jsx(Eb.Slot,{scope:r.__scopeRovingFocusGroup,children:d.jsx(A9,{...r,ref:e})})}));xI.displayName=Ym;var A9=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:c,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:p,onEntryFocus:m,preventScrollOnEntryFocus:g=!1,...x}=r,b=w.useRef(null),E=Nn(e,b),N=n0(i),[S,T]=Kc({prop:c,defaultProp:u??null,onChange:p,caller:Ym}),[R,A]=w.useState(!1),j=$l(m),P=yI(t),U=w.useRef(!1),[B,$]=w.useState(0);return w.useEffect(()=>{const Y=b.current;if(Y)return Y.addEventListener(vw,j),()=>Y.removeEventListener(vw,j)},[j]),d.jsx(T9,{scope:t,orientation:n,dir:N,loop:s,currentTabStopId:S,onItemFocus:w.useCallback(Y=>T(Y),[T]),onItemShiftTab:w.useCallback(()=>A(!0),[]),onFocusableItemAdd:w.useCallback(()=>$(Y=>Y+1),[]),onFocusableItemRemove:w.useCallback(()=>$(Y=>Y-1),[]),children:d.jsx(Ar.div,{tabIndex:R||B===0?-1:0,"data-orientation":n,...x,ref:E,style:{outline:"none",...r.style},onMouseDown:Ct(r.onMouseDown,()=>{U.current=!0}),onFocus:Ct(r.onFocus,Y=>{const J=!U.current;if(Y.target===Y.currentTarget&&J&&!R){const he=new CustomEvent(vw,C9);if(Y.currentTarget.dispatchEvent(he),!he.defaultPrevented){const te=P().filter(pe=>pe.focusable),ue=te.find(pe=>pe.active),we=te.find(pe=>pe.id===S),se=[ue,we,...te].filter(Boolean).map(pe=>pe.ref.current);_I(se,g)}}U.current=!1}),onBlur:Ct(r.onBlur,()=>A(!1))})})}),wI="RovingFocusGroupItem",bI=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,children:c,...u}=r,p=jl(),m=i||p,g=R9(wI,t),x=g.currentTabStopId===m,b=yI(t),{onFocusableItemAdd:E,onFocusableItemRemove:N,currentTabStopId:S}=g;return w.useEffect(()=>{if(n)return E(),()=>N()},[n,E,N]),d.jsx(Eb.ItemSlot,{scope:t,id:m,focusable:n,active:s,children:d.jsx(Ar.span,{tabIndex:x?0:-1,"data-orientation":g.orientation,...u,ref:e,onMouseDown:Ct(r.onMouseDown,T=>{n?g.onItemFocus(m):T.preventDefault()}),onFocus:Ct(r.onFocus,()=>g.onItemFocus(m)),onKeyDown:Ct(r.onKeyDown,T=>{if(T.key==="Tab"&&T.shiftKey){g.onItemShiftTab();return}if(T.target!==T.currentTarget)return;const R=F9(T,g.orientation,g.dir);if(R!==void 0){if(T.metaKey||T.ctrlKey||T.altKey||T.shiftKey)return;T.preventDefault();let j=b().filter(P=>P.focusable).map(P=>P.ref.current);if(R==="last")j.reverse();else if(R==="prev"||R==="next"){R==="prev"&&j.reverse();const P=j.indexOf(T.currentTarget);j=g.loop?j9(j,P+1):j.slice(P+1)}setTimeout(()=>_I(j))}}),children:typeof c=="function"?c({isCurrentTabStop:x,hasTabStop:S!=null}):c})})});bI.displayName=wI;var I9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function P9(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function F9(r,e,t){const n=P9(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return I9[n]}function _I(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function j9(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var EI=xI,SI=bI,o0="Tabs",[O9]=Ba(o0,[s0]),CI=s0(),[D9,TE]=O9(o0),kI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:c="horizontal",dir:u,activationMode:p="automatic",...m}=r,g=n0(u),[x,b]=Kc({prop:n,onChange:s,defaultProp:i??"",caller:o0});return d.jsx(D9,{scope:t,baseId:jl(),value:x,onValueChange:b,orientation:c,dir:g,activationMode:p,children:d.jsx(Ar.div,{dir:g,"data-orientation":c,...m,ref:e})})});kI.displayName=o0;var NI="TabsList",TI=w.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=TE(NI,t),c=CI(t);return d.jsx(EI,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:n,children:d.jsx(Ar.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});TI.displayName=NI;var RI="TabsTrigger",AI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,c=TE(RI,t),u=CI(t),p=FI(c.baseId,n),m=jI(c.baseId,n),g=n===c.value;return d.jsx(SI,{asChild:!0,...u,focusable:!s,active:g,children:d.jsx(Ar.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":m,"data-state":g?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:p,...i,ref:e,onMouseDown:Ct(r.onMouseDown,x=>{!s&&x.button===0&&x.ctrlKey===!1?c.onValueChange(n):x.preventDefault()}),onKeyDown:Ct(r.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&c.onValueChange(n)}),onFocus:Ct(r.onFocus,()=>{const x=c.activationMode!=="manual";!g&&!s&&x&&c.onValueChange(n)})})})});AI.displayName=RI;var II="TabsContent",PI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...c}=r,u=TE(II,t),p=FI(u.baseId,n),m=jI(u.baseId,n),g=n===u.value,x=w.useRef(g);return w.useEffect(()=>{const b=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(b)},[]),d.jsx(qi,{present:s||g,children:({present:b})=>d.jsx(Ar.div,{"data-state":g?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":p,hidden:!b,id:m,tabIndex:0,...c,ref:e,style:{...r.style,animationDuration:x.current?"0s":void 0},children:b&&i})})});PI.displayName=II;function FI(r,e){return`${r}-trigger-${e}`}function jI(r,e){return`${r}-content-${e}`}var L9=kI,OI=TI,DI=AI,LI=PI;const M9=L9,MI=w.forwardRef(({className:r,...e},t)=>d.jsx(OI,{ref:t,className:_r("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));MI.displayName=OI.displayName;const Yv=w.forwardRef(({className:r,...e},t)=>d.jsx(DI,{ref:t,className:_r("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm overflow-x-hidden",r),...e}));Yv.displayName=DI.displayName;const Jv=w.forwardRef(({className:r,...e},t)=>d.jsx(LI,{ref:t,className:_r("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));Jv.displayName=LI.displayName;const $9="https://rubypowerslaw.filevineapp.com",Tr="src/sidepanel/panels/DocViewerPanel.tsx",$I=({documentId:r,documentName:e,onBack:t})=>{const n=Or();n.info(`[DocViewerPanel] Initializing with documentId: ${r}, documentName: ${e}`,{sourceFile:Tr});const[s,i]=w.useState(null),[c,u]=w.useState(!0),[p,m]=w.useState(null),[g,x]=w.useState("other"),[b,E]=w.useState(!0),[N,S]=w.useState(!1),[T,R]=w.useState(0),[A,j]=w.useState(!1),P=w.useRef(null),U=w.useCallback(ue=>{n.info(`[DocViewerPanel] getDocumentType called with extension: ${ue}`,{sourceFile:Tr});const we=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],ie=["pdf"],se=["doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf"],pe=["txt","md","csv","json","xml","html","htm"];let ee="other";return we.includes(ue)?ee="image":ie.includes(ue)?ee="pdf":se.includes(ue)?ee="office":pe.includes(ue)&&(ee="text"),n.info(`[DocViewerPanel] Document type determined: ${ee} for extension: ${ue}`,{sourceFile:Tr}),ee},[n]);w.useEffect(()=>{(async()=>{var we;if(n.info(`[DocViewerPanel] Starting fetchDocumentUrl for documentId: ${r}`,{sourceFile:Tr}),!r){n.warn("[DocViewerPanel] No document ID provided",{sourceFile:Tr,error:"No document ID provided"}),m("No document ID provided"),u(!1);return}u(!0),m(null);try{n.info(`[DocViewerPanel] Fetching document URL from server for documentId: ${r}`,{sourceFile:Tr});const ie=await t8("filevine",r.toString(),n);if(n.info("[DocViewerPanel] Received document data:",{sourceFile:Tr,documentData:ie}),!ie.url){const ee=new Error("Document URL not found in response");throw n.error("[DocViewerPanel] Document URL not found in response",ee,{sourceFile:Tr}),ee}n.info(`[DocViewerPanel] Setting document URL: ${ie.url}`,{sourceFile:Tr}),i(ie.url);const se=((we=e.split(".").pop())==null?void 0:we.toLowerCase())||"";n.info(`[DocViewerPanel] Detected file extension: ${se}`,{sourceFile:Tr});const pe=U(se);n.info(`[DocViewerPanel] Determined document type: ${pe}`,{sourceFile:Tr}),x(pe)}catch(ie){n.error("[DocViewerPanel] Error fetching document URL:",ie,{sourceFile:Tr}),m("Failed to load document. Please try again later.")}finally{u(!1)}})()},[r,e,T,n,U]),w.useEffect(()=>(P.current&&(clearTimeout(P.current),P.current=null),j(!1),!c&&b&&g!=="image"&&(n.info("[DocViewerPanel] Setting loading timeout for document",{sourceFile:Tr}),P.current=setTimeout(()=>{n.info("[DocViewerPanel] Document loading is taking too long",{sourceFile:Tr}),j(!0)},1e4)),()=>{P.current&&(clearTimeout(P.current),P.current=null)}),[c,b,g,n]);const B=()=>{n.info("[DocViewerPanel] iframe loaded successfully",{sourceFile:Tr}),E(!1),S(!1),j(!1),P.current&&(clearTimeout(P.current),P.current=null)},$=ue=>{n.error("[DocViewerPanel] iframe error:",ue,{sourceFile:Tr}),E(!1),S(!0),j(!1),P.current&&(clearTimeout(P.current),P.current=null)},Y=()=>{n.info("[DocViewerPanel] Retrying document load",{sourceFile:Tr}),E(!0),S(!1),j(!1),R(ue=>ue+1)},J=()=>{if(r){const ue=`${$9}/docwebviewer/view/${r}`;n.info(`[DocViewerPanel] Opening document in new tab with original URL: ${ue}`,{sourceFile:Tr}),window.open(ue,"_blank")}},he=()=>{if(!s){n.warn("[DocViewerPanel] No document URL available for download",{sourceFile:Tr});return}try{n.info(`[DocViewerPanel] Starting download for: ${e}`,{sourceFile:Tr});const ue=new URL(s);ue.searchParams.set("response-content-disposition",`attachment; filename="${encodeURIComponent(e)}"`);const we=document.createElement("a");we.href=ue.toString(),we.download=e,we.target="_blank",we.rel="noopener noreferrer",document.body.appendChild(we),we.click(),setTimeout(()=>{document.body.removeChild(we)},100),n.info(`[DocViewerPanel] Download initiated for: ${e}`,{sourceFile:Tr})}catch(ue){n.error("[DocViewerPanel] Error downloading document:",ue,{sourceFile:Tr})}};if(c)return n.info("[DocViewerPanel] Rendering loading state",{sourceFile:Tr}),d.jsxs(li,{className:"w-full h-full",children:[d.jsx($i,{className:"pb-4",children:d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[d.jsx(ze,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(vm,{className:"h-4 w-4"})}),d.jsx(Ui,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),d.jsx(ci,{className:"flex items-center justify-center h-[80vh]",children:d.jsxs("div",{className:"text-center",children:[d.jsx(Hi,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),d.jsx("p",{className:"dark:text-gray-200",children:"Loading document..."})]})})]});if(p)return n.info(`[DocViewerPanel] Rendering error state: ${p}`,{sourceFile:Tr}),d.jsxs(li,{className:"w-full h-full",children:[d.jsx($i,{className:"pb-4",children:d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[d.jsx(ze,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(vm,{className:"h-4 w-4"})}),d.jsx(Ui,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),d.jsx(ci,{className:"flex items-center justify-center h-[80vh]",children:d.jsxs("div",{className:"text-center text-red-500",children:[d.jsx("p",{children:p}),d.jsxs(ze,{variant:"outline",className:"mt-4",onClick:Y,children:[d.jsx(wo,{className:"h-4 w-4 mr-2"}),"Retry"]})]})})]});const te=()=>{if(n.info(`[DocViewerPanel] renderDocumentViewer called with documentType: ${g}, documentUrl: ${s}`,{sourceFile:Tr}),!s)return n.info("[DocViewerPanel] No document URL available, returning null",{sourceFile:Tr}),null;const ue=`https://docs.google.com/viewer?url=${encodeURIComponent(s||"")}&embedded=true`;n.info(`[DocViewerPanel] Google Docs Viewer URL: ${ue}`,{sourceFile:Tr});const we=g==="pdf"?"PDF":g==="office"?"Office document":g==="text"?"Text document":g==="image"?"Image":"Document";return g==="image"?(n.info("[DocViewerPanel] Rendering image viewer",{sourceFile:Tr}),d.jsx("div",{className:"w-full h-full flex items-center justify-center overflow-auto",children:d.jsx("img",{src:s,alt:e,className:"max-w-full max-h-full object-contain",onLoad:()=>E(!1),onError:()=>{E(!1),S(!0)}})})):(n.info(`[DocViewerPanel] Rendering ${we} viewer with Google Docs for: ${e}`,{sourceFile:Tr}),d.jsxs("div",{className:"w-full h-full relative",children:[b&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 bg-opacity-80 dark:bg-opacity-80 z-10",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 dark:border-gray-100 mx-auto mb-4"}),d.jsxs("p",{className:"dark:text-gray-200",children:["Loading ",we.toLowerCase(),"..."]}),d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"This may take a moment for large files"}),A&&d.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[d.jsx("p",{className:"text-amber-700 font-medium",children:"This is taking longer than expected."}),d.jsx("p",{className:"text-sm text-amber-600 mt-1",children:g==="office"?"Office documents can sometimes be slow to load in the viewer.":"This document might be large or complex."}),d.jsxs("div",{className:"mt-3 flex justify-center space-x-3",children:[d.jsxs(ze,{variant:"outline",size:"sm",onClick:Y,children:[d.jsx(wo,{className:"h-3 w-3 mr-1"}),"Retry"]}),d.jsx(ze,{variant:"default",size:"sm",onClick:J,children:"Open in new tab"})]})]})]})}),N&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-10",children:d.jsxs("div",{className:"text-center text-red-500 dark:text-red-400",children:[d.jsxs("p",{children:["Failed to load ",we.toLowerCase(),"."]}),d.jsx("p",{className:"text-sm mt-2 dark:text-gray-400",children:"The document might be too large or in an unsupported format."}),d.jsxs("div",{className:"mt-4 flex justify-center space-x-3",children:[d.jsxs(ze,{variant:"outline",onClick:Y,children:[d.jsx(wo,{className:"h-4 w-4 mr-2"}),"Retry"]}),d.jsx(ze,{variant:"default",onClick:J,children:"Open in new tab"})]})]})}),d.jsx("iframe",{src:ue,className:"w-full h-full border-none",title:e,sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",onLoad:B,onError:$})]}))};return n.info(`[DocViewerPanel] Rendering main component with documentType: ${g}`,{sourceFile:Tr}),d.jsxs(li,{className:"w-full h-full",children:[d.jsxs($i,{className:"pb-4",children:[d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[d.jsx(ze,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(vm,{className:"h-4 w-4"})}),d.jsx(Ui,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]}),!c&&d.jsxs("div",{className:"flex gap-2 pl-8 pr-6",children:[d.jsxs(ze,{variant:"outline",size:"sm",onClick:he,className:"h-9 px-4","aria-label":"Download file",children:[d.jsx(sB,{className:"h-4 w-4 mr-2"}),"Download"]}),d.jsxs(ze,{variant:"outline",size:"sm",onClick:J,className:"h-9 px-4","aria-label":"Open in new tab",children:[d.jsx(Pl,{className:"h-4 w-4 mr-2"}),"Open in new tab"]})]})]}),d.jsx(ci,{className:"h-[80vh] overflow-hidden",children:te()})]})},Cl="src/sidepanel/panels/ClientDocumentsPanel.tsx",U9="https://rubypowerslaw.filevineapp.com",z9=({clientEmail:r,projectId:e,documents:t,isLoading:n,error:s,goBack:i,initialSelectedDocument:c})=>{const u=Or(),[p,m]=w.useState([]),[g,x]=w.useState(!1),[b,E]=w.useState(null),[N,S]=w.useState(""),[T,R]=w.useState(null),[A,j]=w.useState({contracts:!1,payments:!1,allDocuments:!0}),[P,U]=w.useState({});w.useEffect(()=>{const z={sourceFile:Cl,functionName:"useEffect[fetchData]"};if(t&&t.length>0||n){t&&m(t);return}(async()=>{if(!e){E("No project ID provided. Please select a valid project.");return}x(!0),E(null);try{const D=await mT(e,u);if(D){u.debug("Using cached documents for project",{...z,data:{projectId:e}}),m(D),x(!1);return}u.debug("ClientDocumentsPanel: Fetching documents from server for project",{...z,data:{projectId:e}});const oe=(await CT("filevine",e,u)).documents.map(Ee=>({name:Ee.filename,url:`${U9}/docwebviewer/view/${Ee.documentId}`,documentId:Ee.documentId,folderName:Ee.folderName}));await pT(e,oe,u),m(oe)}catch(D){u.error("Error fetching documents:",D,z),E("Failed to load documents. Please try again later.")}finally{x(!1)}})()},[e,t,n,u]);const B=n!==void 0?n:g,$=s!==void 0?s:b,Y=nr.useMemo(()=>{const z={sourceFile:Cl,functionName:"useMemo[filteredDocuments]"};return u.debug("Computing filteredDocuments",z),p.filter(K=>K.name.toLowerCase().includes(N.toLowerCase()))},[p,N,u]),J=p.filter(z=>z.folderName&&z.folderName.toLowerCase().includes("contract")),he=p.filter(z=>z.folderName&&z.folderName.toLowerCase().includes("payment")),te=z=>{var oe;const K={sourceFile:Cl,functionName:"isViewableDocument",data:{filename:z}},D=(oe=z.split(".").pop())==null?void 0:oe.toLowerCase(),M=["pdf","jpg","jpeg","png","gif","bmp","webp","doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf","txt"];return u.debug(`File extension: ${D}`,K),u.debug(`Viewable extensions: ${M}`,K),M.includes(D||"")},ue=z=>{var D;const K=((D=z.split(".").pop())==null?void 0:D.toLowerCase())||"";return["jpg","jpeg","png","gif","bmp","webp","svg","tiff"].includes(K)?d.jsx(cB,{className:"h-4 w-4 text-purple-500 dark:text-purple-400"}):["xls","xlsx","csv","ods"].includes(K)?d.jsx(iB,{className:"h-4 w-4 text-green-500 dark:text-green-400"}):["ppt","pptx","odp"].includes(K)?d.jsx(mB,{className:"h-4 w-4 text-orange-500 dark:text-orange-400"}):["pdf","doc","docx","txt","rtf","odt"].includes(K)?d.jsx(Jf,{className:"h-4 w-4 text-blue-500 dark:text-blue-400"}):d.jsx(aB,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})},we=z=>{const K={sourceFile:Cl,functionName:"handleViewDocument",data:{docName:z.name,docId:z.documentId,url:z.url,folder:z.folderName}};u.debug("Handling view document",K),z.documentId&&te(z.name)?(u.debug("Selected document",K),R({name:z.name,documentId:z.documentId,url:z.url,folderName:z.folderName})):z.url&&(u.debug("Opening document URL",K),window.open(z.url,"_blank"))},ie=z=>{j(K=>({...K,[z]:!K[z]}))},se=z=>{const K={sourceFile:Cl,functionName:"toggleFolder",data:{folderName:z}};u.debug("Toggling folder",K),U(D=>({...D,[z]:!D[z]}))},pe=nr.useCallback(z=>{const K={sourceFile:Cl,functionName:"groupDocumentsByFolder"};u.debug("Running groupDocumentsByFolder",K);const D={};return D["No Folder"]=[],z.forEach(M=>{const oe=M.folderName||"No Folder";D[oe]||(D[oe]=[]),D[oe].push(M)}),D["No Folder"].length===0&&delete D["No Folder"],D},[u]),ee=nr.useMemo(()=>{const z={sourceFile:Cl,functionName:"useMemo[groupedFilteredDocuments]"};return u.debug("Computing groupedFilteredDocuments",z),pe(Y)},[Y,pe,u]);w.useEffect(()=>{const z={sourceFile:Cl,functionName:"useEffect[folderExpansion]"};if(u.debug("Running folder expansion initialization effect",z),Y.length>0){const K=Object.keys(ee);u.debug(`Found folders: ${K.join(", ")}`,z),U(D=>{const M={...D};let oe=!1;return K.forEach(Ee=>{M[Ee]===void 0&&(M[Ee]=!1,oe=!0)}),oe?M:D})}},[ee,Y.length,u]),w.useEffect(()=>{const z={sourceFile:Cl,functionName:"useEffect[initialSelectedDocument]"};c&&(u.debug("Setting initial selected document",{...z,document:c}),R({name:c.name,documentId:c.documentId,url:c.url}))},[c,u]);const G=()=>!B&&!$&&p.length===0?d.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No documents found for this client."}):!B&&!$&&p.length>0?d.jsxs("div",{className:"space-y-4",children:[J.length>0&&d.jsxs("div",{children:[d.jsxs("button",{onClick:()=>ie("contracts"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Jf,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),d.jsxs("span",{children:["Contracts (",J.length,")"]})]}),A.contracts?d.jsx(Ev,{className:"h-4 w-4"}):d.jsx(ns,{className:"h-4 w-4"})]}),A.contracts&&d.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:J.map(z=>d.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"flex-shrink-0",children:ue(z.name)}),d.jsx("button",{onClick:()=>we(z),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:z.name,children:z.name})]},z.documentId))})]}),he.length>0&&d.jsxs("div",{children:[d.jsxs("button",{onClick:()=>ie("payments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(nB,{className:"h-4 w-4 mr-2 text-green-500 dark:text-green-400"}),d.jsxs("span",{children:["Payments (",he.length,")"]})]}),A.payments?d.jsx(Ev,{className:"h-4 w-4"}):d.jsx(ns,{className:"h-4 w-4"})]}),A.payments&&d.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:he.map(z=>d.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"flex-shrink-0",children:ue(z.name)}),d.jsx("button",{onClick:()=>we(z),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:z.name,children:z.name})]},z.documentId))})]}),Y.length>0&&d.jsxs("div",{children:[d.jsxs("button",{onClick:()=>ie("allDocuments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Jf,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400"}),d.jsxs("span",{children:["All Documents (",Y.length,")"]})]}),A.allDocuments?d.jsx(Ev,{className:"h-4 w-4"}):d.jsx(ns,{className:"h-4 w-4"})]}),A.allDocuments&&d.jsx("div",{className:"ml-2 mt-2 space-y-2 text-sm",children:Object.entries(ee).map(([z,K])=>d.jsxs("div",{children:[d.jsxs("button",{onClick:()=>se(z),className:"flex items-center justify-between w-full py-1 text-left font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-1",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(lB,{className:"h-4 w-4 text-amber-500 dark:text-amber-400"}),d.jsxs("span",{children:[z," (",K.length,")"]})]}),P[z]?d.jsx(Ev,{className:"h-4 w-4"}):d.jsx(ns,{className:"h-4 w-4"})]}),P[z]&&d.jsx("ul",{className:"ml-6 mt-1 space-y-1",children:K.map(D=>d.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"flex-shrink-0",children:ue(D.name)}),d.jsx("button",{onClick:()=>we(D),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:D.name,children:D.name})]},D.documentId))})]},z))})]})]}):null;return d.jsx("div",{className:"flex flex-col h-full bg-background",children:d.jsx("div",{className:"flex-grow overflow-hidden",children:T?d.jsx($I,{documentId:T.documentId,documentName:T.name,onBack:()=>R(null)}):B?d.jsxs(li,{className:"w-full h-full",children:[d.jsx($i,{className:"pb-4",children:d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&d.jsx(ze,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(vm,{className:"h-4 w-4"})}),d.jsx(Ui,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),d.jsx(ci,{className:"flex items-center justify-center h-[80vh]",children:d.jsxs("div",{className:"text-center",children:[d.jsx(Hi,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),d.jsx("p",{className:"dark:text-gray-200",children:"Loading documents..."})]})})]}):$?d.jsxs("div",{className:"text-red-600 bg-red-50 p-3 rounded-md",children:["Error: ",$]}):d.jsxs(li,{className:"mb-4",children:[d.jsx($i,{className:"pb-2",children:d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&d.jsx(ze,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(vm,{className:"h-4 w-4"})}),d.jsx(Ui,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),d.jsxs(ci,{className:"px-4 pt-2 pb-4",children:[d.jsxs("div",{className:"relative mb-4",children:[d.jsx(qs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsx(Qr,{type:"text",placeholder:"Search All Documents...",value:N,onChange:z=>S(z.target.value),className:"w-full pl-9 pr-4 py-2 h-9 text-sm border rounded-md"})]}),d.jsx("div",{className:"overflow-y-auto max-h-[80vh] pb-32",children:G()})]})]})})})};function H9(r){const e=B9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,u=w.Children.toArray(i),p=u.find(W9);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function B9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=q9(s),u=V9(i,s.props);return s.type!==w.Fragment&&(u.ref=n?qc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var G9=Symbol("radix.slottable");function W9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===G9}function V9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function q9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var Sb=["Enter"," "],K9=["ArrowDown","PageUp","Home"],UI=["ArrowUp","PageDown","End"],Y9=[...K9,...UI],J9={ltr:[...Sb,"ArrowRight"],rtl:[...Sb,"ArrowLeft"]},X9={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Jm="Menu",[Dm,Q9,Z9]=NE(Jm),[od,zI]=Ba(Jm,[Z9,Xy,s0]),i0=Xy(),HI=s0(),[eV,id]=od(Jm),[tV,Xm]=od(Jm),BI=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:s,onOpenChange:i,modal:c=!0}=r,u=i0(e),[p,m]=w.useState(null),g=w.useRef(!1),x=$l(i),b=n0(s);return w.useEffect(()=>{const E=()=>{g.current=!0,document.addEventListener("pointerdown",N,{capture:!0,once:!0}),document.addEventListener("pointermove",N,{capture:!0,once:!0})},N=()=>g.current=!1;return document.addEventListener("keydown",E,{capture:!0}),()=>{document.removeEventListener("keydown",E,{capture:!0}),document.removeEventListener("pointerdown",N,{capture:!0}),document.removeEventListener("pointermove",N,{capture:!0})}},[]),d.jsx(pA,{...u,children:d.jsx(eV,{scope:e,open:t,onOpenChange:x,content:p,onContentChange:m,children:d.jsx(tV,{scope:e,onClose:w.useCallback(()=>x(!1),[x]),isUsingKeyboardRef:g,dir:b,modal:c,children:n})})})};BI.displayName=Jm;var rV="MenuAnchor",RE=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=i0(t);return d.jsx(mA,{...s,...n,ref:e})});RE.displayName=rV;var AE="MenuPortal",[nV,GI]=od(AE,{forceMount:void 0}),WI=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:s}=r,i=id(AE,e);return d.jsx(nV,{scope:e,forceMount:t,children:d.jsx(qi,{present:t||i.open,children:d.jsx(yE,{asChild:!0,container:s,children:n})})})};WI.displayName=AE;var hi="MenuContent",[sV,IE]=od(hi),VI=w.forwardRef((r,e)=>{const t=GI(hi,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=id(hi,r.__scopeMenu),c=Xm(hi,r.__scopeMenu);return d.jsx(Dm.Provider,{scope:r.__scopeMenu,children:d.jsx(qi,{present:n||i.open,children:d.jsx(Dm.Slot,{scope:r.__scopeMenu,children:c.modal?d.jsx(oV,{...s,ref:e}):d.jsx(iV,{...s,ref:e})})})})}),oV=w.forwardRef((r,e)=>{const t=id(hi,r.__scopeMenu),n=w.useRef(null),s=Nn(e,n);return w.useEffect(()=>{const i=n.current;if(i)return zA(i)},[]),d.jsx(PE,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:Ct(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),iV=w.forwardRef((r,e)=>{const t=id(hi,r.__scopeMenu);return d.jsx(PE,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),aV=H9("MenuContent.ScrollLock"),PE=w.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:c,disableOutsidePointerEvents:u,onEntryFocus:p,onEscapeKeyDown:m,onPointerDownOutside:g,onFocusOutside:x,onInteractOutside:b,onDismiss:E,disableOutsideScroll:N,...S}=r,T=id(hi,t),R=Xm(hi,t),A=i0(t),j=HI(t),P=Q9(t),[U,B]=w.useState(null),$=w.useRef(null),Y=Nn(e,$,T.onContentChange),J=w.useRef(0),he=w.useRef(""),te=w.useRef(0),ue=w.useRef(null),we=w.useRef("right"),ie=w.useRef(0),se=N?_E:w.Fragment,pe=N?{as:aV,allowPinchZoom:!0}:void 0,ee=z=>{var xe,ve;const K=he.current+z,D=P().filter(le=>!le.disabled),M=document.activeElement,oe=(xe=D.find(le=>le.ref.current===M))==null?void 0:xe.textValue,Ee=D.map(le=>le.textValue),V=xV(Ee,K,oe),ce=(ve=D.find(le=>le.textValue===V))==null?void 0:ve.ref.current;(function le(Ne){he.current=Ne,window.clearTimeout(J.current),Ne!==""&&(J.current=window.setTimeout(()=>le(""),1e3))})(K),ce&&setTimeout(()=>ce.focus())};w.useEffect(()=>()=>window.clearTimeout(J.current),[]),FA();const G=w.useCallback(z=>{var D,M;return we.current===((D=ue.current)==null?void 0:D.side)&&bV(z,(M=ue.current)==null?void 0:M.area)},[]);return d.jsx(sV,{scope:t,searchRef:he,onItemEnter:w.useCallback(z=>{G(z)&&z.preventDefault()},[G]),onItemLeave:w.useCallback(z=>{var K;G(z)||((K=$.current)==null||K.focus(),B(null))},[G]),onTriggerLeave:w.useCallback(z=>{G(z)&&z.preventDefault()},[G]),pointerGraceTimerRef:te,onPointerGraceIntentChange:w.useCallback(z=>{ue.current=z},[]),children:d.jsx(se,{...pe,children:d.jsx(bE,{asChild:!0,trapped:s,onMountAutoFocus:Ct(i,z=>{var K;z.preventDefault(),(K=$.current)==null||K.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:d.jsx(Qy,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:m,onPointerDownOutside:g,onFocusOutside:x,onInteractOutside:b,onDismiss:E,children:d.jsx(EI,{asChild:!0,...j,dir:R.dir,orientation:"vertical",loop:n,currentTabStopId:U,onCurrentTabStopIdChange:B,onEntryFocus:Ct(p,z=>{R.isUsingKeyboardRef.current||z.preventDefault()}),preventScrollOnEntryFocus:!0,children:d.jsx(gA,{role:"menu","aria-orientation":"vertical","data-state":lP(T.open),"data-radix-menu-content":"",dir:R.dir,...A,...S,ref:Y,style:{outline:"none",...S.style},onKeyDown:Ct(S.onKeyDown,z=>{const D=z.target.closest("[data-radix-menu-content]")===z.currentTarget,M=z.ctrlKey||z.altKey||z.metaKey,oe=z.key.length===1;D&&(z.key==="Tab"&&z.preventDefault(),!M&&oe&&ee(z.key));const Ee=$.current;if(z.target!==Ee||!Y9.includes(z.key))return;z.preventDefault();const ce=P().filter(xe=>!xe.disabled).map(xe=>xe.ref.current);UI.includes(z.key)&&ce.reverse(),vV(ce)}),onBlur:Ct(r.onBlur,z=>{z.currentTarget.contains(z.target)||(window.clearTimeout(J.current),he.current="")}),onPointerMove:Ct(r.onPointerMove,Lm(z=>{const K=z.target,D=ie.current!==z.clientX;if(z.currentTarget.contains(K)&&D){const M=z.clientX>ie.current?"right":"left";we.current=M,ie.current=z.clientX}}))})})})})})})});VI.displayName=hi;var lV="MenuGroup",FE=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return d.jsx(Ar.div,{role:"group",...n,ref:e})});FE.displayName=lV;var cV="MenuLabel",qI=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return d.jsx(Ar.div,{...n,ref:e})});qI.displayName=cV;var Ny="MenuItem",f1="menu.itemSelect",a0=w.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...s}=r,i=w.useRef(null),c=Xm(Ny,r.__scopeMenu),u=IE(Ny,r.__scopeMenu),p=Nn(e,i),m=w.useRef(!1),g=()=>{const x=i.current;if(!t&&x){const b=new CustomEvent(f1,{bubbles:!0,cancelable:!0});x.addEventListener(f1,E=>n==null?void 0:n(E),{once:!0}),nA(x,b),b.defaultPrevented?m.current=!1:c.onClose()}};return d.jsx(KI,{...s,ref:p,disabled:t,onClick:Ct(r.onClick,g),onPointerDown:x=>{var b;(b=r.onPointerDown)==null||b.call(r,x),m.current=!0},onPointerUp:Ct(r.onPointerUp,x=>{var b;m.current||(b=x.currentTarget)==null||b.click()}),onKeyDown:Ct(r.onKeyDown,x=>{const b=u.searchRef.current!=="";t||b&&x.key===" "||Sb.includes(x.key)&&(x.currentTarget.click(),x.preventDefault())})})});a0.displayName=Ny;var KI=w.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:s,...i}=r,c=IE(Ny,t),u=HI(t),p=w.useRef(null),m=Nn(e,p),[g,x]=w.useState(!1),[b,E]=w.useState("");return w.useEffect(()=>{const N=p.current;N&&E((N.textContent??"").trim())},[i.children]),d.jsx(Dm.ItemSlot,{scope:t,disabled:n,textValue:s??b,children:d.jsx(SI,{asChild:!0,...u,focusable:!n,children:d.jsx(Ar.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:m,onPointerMove:Ct(r.onPointerMove,Lm(N=>{n?c.onItemLeave(N):(c.onItemEnter(N),N.defaultPrevented||N.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ct(r.onPointerLeave,Lm(N=>c.onItemLeave(N))),onFocus:Ct(r.onFocus,()=>x(!0)),onBlur:Ct(r.onBlur,()=>x(!1))})})})}),uV="MenuCheckboxItem",YI=w.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...s}=r;return d.jsx(eP,{scope:r.__scopeMenu,checked:t,children:d.jsx(a0,{role:"menuitemcheckbox","aria-checked":Ty(t)?"mixed":t,...s,ref:e,"data-state":OE(t),onSelect:Ct(s.onSelect,()=>n==null?void 0:n(Ty(t)?!0:!t),{checkForDefaultPrevented:!1})})})});YI.displayName=uV;var JI="MenuRadioGroup",[dV,fV]=od(JI,{value:void 0,onValueChange:()=>{}}),XI=w.forwardRef((r,e)=>{const{value:t,onValueChange:n,...s}=r,i=$l(n);return d.jsx(dV,{scope:r.__scopeMenu,value:t,onValueChange:i,children:d.jsx(FE,{...s,ref:e})})});XI.displayName=JI;var QI="MenuRadioItem",ZI=w.forwardRef((r,e)=>{const{value:t,...n}=r,s=fV(QI,r.__scopeMenu),i=t===s.value;return d.jsx(eP,{scope:r.__scopeMenu,checked:i,children:d.jsx(a0,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":OE(i),onSelect:Ct(n.onSelect,()=>{var c;return(c=s.onValueChange)==null?void 0:c.call(s,t)},{checkForDefaultPrevented:!1})})})});ZI.displayName=QI;var jE="MenuItemIndicator",[eP,hV]=od(jE,{checked:!1}),tP=w.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...s}=r,i=hV(jE,t);return d.jsx(qi,{present:n||Ty(i.checked)||i.checked===!0,children:d.jsx(Ar.span,{...s,ref:e,"data-state":OE(i.checked)})})});tP.displayName=jE;var pV="MenuSeparator",rP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return d.jsx(Ar.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});rP.displayName=pV;var mV="MenuArrow",nP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=i0(t);return d.jsx(vA,{...s,...n,ref:e})});nP.displayName=mV;var gV="MenuSub",[AK,sP]=od(gV),um="MenuSubTrigger",oP=w.forwardRef((r,e)=>{const t=id(um,r.__scopeMenu),n=Xm(um,r.__scopeMenu),s=sP(um,r.__scopeMenu),i=IE(um,r.__scopeMenu),c=w.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:p}=i,m={__scopeMenu:r.__scopeMenu},g=w.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return w.useEffect(()=>g,[g]),w.useEffect(()=>{const x=u.current;return()=>{window.clearTimeout(x),p(null)}},[u,p]),d.jsx(RE,{asChild:!0,...m,children:d.jsx(KI,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":lP(t.open),...r,ref:qc(e,s.onTriggerChange),onClick:x=>{var b;(b=r.onClick)==null||b.call(r,x),!(r.disabled||x.defaultPrevented)&&(x.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:Ct(r.onPointerMove,Lm(x=>{i.onItemEnter(x),!x.defaultPrevented&&!r.disabled&&!t.open&&!c.current&&(i.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),g()},100))})),onPointerLeave:Ct(r.onPointerLeave,Lm(x=>{var E,N;g();const b=(E=t.content)==null?void 0:E.getBoundingClientRect();if(b){const S=(N=t.content)==null?void 0:N.dataset.side,T=S==="right",R=T?-5:5,A=b[T?"left":"right"],j=b[T?"right":"left"];i.onPointerGraceIntentChange({area:[{x:x.clientX+R,y:x.clientY},{x:A,y:b.top},{x:j,y:b.top},{x:j,y:b.bottom},{x:A,y:b.bottom}],side:S}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(x),x.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Ct(r.onKeyDown,x=>{var E;const b=i.searchRef.current!=="";r.disabled||b&&x.key===" "||J9[n.dir].includes(x.key)&&(t.onOpenChange(!0),(E=t.content)==null||E.focus(),x.preventDefault())})})})});oP.displayName=um;var iP="MenuSubContent",aP=w.forwardRef((r,e)=>{const t=GI(hi,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=id(hi,r.__scopeMenu),c=Xm(hi,r.__scopeMenu),u=sP(iP,r.__scopeMenu),p=w.useRef(null),m=Nn(e,p);return d.jsx(Dm.Provider,{scope:r.__scopeMenu,children:d.jsx(qi,{present:n||i.open,children:d.jsx(Dm.Slot,{scope:r.__scopeMenu,children:d.jsx(PE,{id:u.contentId,"aria-labelledby":u.triggerId,...s,ref:m,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{var x;c.isUsingKeyboardRef.current&&((x=p.current)==null||x.focus()),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:Ct(r.onFocusOutside,g=>{g.target!==u.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Ct(r.onEscapeKeyDown,g=>{c.onClose(),g.preventDefault()}),onKeyDown:Ct(r.onKeyDown,g=>{var E;const x=g.currentTarget.contains(g.target),b=X9[c.dir].includes(g.key);x&&b&&(i.onOpenChange(!1),(E=u.trigger)==null||E.focus(),g.preventDefault())})})})})})});aP.displayName=iP;function lP(r){return r?"open":"closed"}function Ty(r){return r==="indeterminate"}function OE(r){return Ty(r)?"indeterminate":r?"checked":"unchecked"}function vV(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function yV(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function xV(r,e,t){const s=e.length>1&&Array.from(e).every(m=>m===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let c=yV(r,Math.max(i,0));s.length===1&&(c=c.filter(m=>m!==t));const p=c.find(m=>m.toLowerCase().startsWith(s.toLowerCase()));return p!==t?p:void 0}function wV(r,e){const{x:t,y:n}=r;let s=!1;for(let i=0,c=e.length-1;i<e.length;c=i++){const u=e[i],p=e[c],m=u.x,g=u.y,x=p.x,b=p.y;g>n!=b>n&&t<(x-m)*(n-g)/(b-g)+m&&(s=!s)}return s}function bV(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return wV(t,e)}function Lm(r){return e=>e.pointerType==="mouse"?r(e):void 0}var _V=BI,EV=RE,SV=WI,CV=VI,kV=FE,NV=qI,TV=a0,RV=YI,AV=XI,IV=ZI,PV=tP,FV=rP,jV=nP,OV=oP,DV=aP,l0="DropdownMenu",[LV]=Ba(l0,[zI]),Js=zI(),[MV,cP]=LV(l0),uP=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:s,defaultOpen:i,onOpenChange:c,modal:u=!0}=r,p=Js(e),m=w.useRef(null),[g,x]=Kc({prop:s,defaultProp:i??!1,onChange:c,caller:l0});return d.jsx(MV,{scope:e,triggerId:jl(),triggerRef:m,contentId:jl(),open:g,onOpenChange:x,onOpenToggle:w.useCallback(()=>x(b=>!b),[x]),modal:u,children:d.jsx(_V,{...p,open:g,onOpenChange:x,dir:n,modal:u,children:t})})};uP.displayName=l0;var dP="DropdownMenuTrigger",fP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...s}=r,i=cP(dP,t),c=Js(t);return d.jsx(EV,{asChild:!0,...c,children:d.jsx(Ar.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:qc(e,i.triggerRef),onPointerDown:Ct(r.onPointerDown,u=>{!n&&u.button===0&&u.ctrlKey===!1&&(i.onOpenToggle(),i.open||u.preventDefault())}),onKeyDown:Ct(r.onKeyDown,u=>{n||(["Enter"," "].includes(u.key)&&i.onOpenToggle(),u.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});fP.displayName=dP;var $V="DropdownMenuPortal",hP=r=>{const{__scopeDropdownMenu:e,...t}=r,n=Js(e);return d.jsx(SV,{...n,...t})};hP.displayName=$V;var pP="DropdownMenuContent",mP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=cP(pP,t),i=Js(t),c=w.useRef(!1);return d.jsx(CV,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:Ct(r.onCloseAutoFocus,u=>{var p;c.current||(p=s.triggerRef.current)==null||p.focus(),c.current=!1,u.preventDefault()}),onInteractOutside:Ct(r.onInteractOutside,u=>{const p=u.detail.originalEvent,m=p.button===0&&p.ctrlKey===!0,g=p.button===2||m;(!s.modal||g)&&(c.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mP.displayName=pP;var UV="DropdownMenuGroup",zV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(kV,{...s,...n,ref:e})});zV.displayName=UV;var HV="DropdownMenuLabel",gP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(NV,{...s,...n,ref:e})});gP.displayName=HV;var BV="DropdownMenuItem",vP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(TV,{...s,...n,ref:e})});vP.displayName=BV;var GV="DropdownMenuCheckboxItem",yP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(RV,{...s,...n,ref:e})});yP.displayName=GV;var WV="DropdownMenuRadioGroup",VV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(AV,{...s,...n,ref:e})});VV.displayName=WV;var qV="DropdownMenuRadioItem",xP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(IV,{...s,...n,ref:e})});xP.displayName=qV;var KV="DropdownMenuItemIndicator",wP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(PV,{...s,...n,ref:e})});wP.displayName=KV;var YV="DropdownMenuSeparator",bP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(FV,{...s,...n,ref:e})});bP.displayName=YV;var JV="DropdownMenuArrow",XV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(jV,{...s,...n,ref:e})});XV.displayName=JV;var QV="DropdownMenuSubTrigger",_P=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(OV,{...s,...n,ref:e})});_P.displayName=QV;var ZV="DropdownMenuSubContent",EP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=Js(t);return d.jsx(DV,{...s,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});EP.displayName=ZV;var eq=uP,tq=fP,rq=hP,SP=mP,CP=gP,kP=vP,NP=yP,TP=xP,RP=wP,AP=bP,IP=_P,PP=EP;const Ns=eq,Ts=tq,nq=w.forwardRef(({className:r,inset:e,children:t,...n},s)=>d.jsxs(IP,{ref:s,className:_r("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",r),...n,children:[t,d.jsx(Gv,{className:"ml-auto h-4 w-4"})]}));nq.displayName=IP.displayName;const sq=w.forwardRef(({className:r,...e},t)=>d.jsx(PP,{ref:t,className:_r("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",r),...e}));sq.displayName=PP.displayName;const os=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>d.jsx(rq,{children:d.jsx(SP,{ref:n,sideOffset:e,className:_r("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white dark:bg-card p-1 text-neutral-950 dark:text-card-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t})}));os.displayName=SP.displayName;const Wn=w.forwardRef(({className:r,inset:e,...t},n)=>d.jsx(kP,{ref:n,className:_r("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:text-gray-200",e&&"pl-8",r),...t}));Wn.displayName=kP.displayName;const oq=w.forwardRef(({className:r,children:e,checked:t,...n},s)=>d.jsxs(NP,{ref:s,className:_r("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(RP,{children:d.jsx(tB,{className:"h-4 w-4"})})}),e]}));oq.displayName=NP.displayName;const iq=w.forwardRef(({className:r,children:e,...t},n)=>d.jsxs(TP,{ref:n,className:_r("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(RP,{children:d.jsx("div",{className:"h-2 w-2 rounded-full bg-current"})})}),e]}));iq.displayName=TP.displayName;const aq=w.forwardRef(({className:r,inset:e,...t},n)=>d.jsx(CP,{ref:n,className:_r("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));aq.displayName=CP.displayName;const Ry=w.forwardRef(({className:r,...e},t)=>d.jsx(AP,{ref:t,className:_r("-mx-1 my-1 h-px bg-neutral-100",r),...e}));Ry.displayName=AP.displayName;const Vs=({rows:r=2})=>d.jsx("div",{className:"p-1",children:d.jsx("table",{className:"w-full text-sm text-left text-gray-600 dark:text-gray-300",children:d.jsx("tbody",{children:Array.from({length:r}).map((e,t)=>d.jsxs("tr",{className:"bg-card animate-pulse",children:[d.jsx("td",{className:"py-2 px-3 whitespace-normal font-medium w-1/3",children:d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})}),d.jsx("td",{className:"py-2 px-3",children:d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"})})]},t))})})}),lq=({value:r,onChange:e,onSelect:t,suggestions:n,isLoading:s=!1,isValidating:i=!1,isValid:c=null,placeholder:u="Enter contact email",className:p="",disabled:m=!1})=>{const[g,x]=w.useState(0),b=w.useRef(null),E=w.useMemo(()=>{if(!r||r.length<2)return[];const P=r.toLowerCase();return n.filter(U=>{var B;return U.email.toLowerCase().includes(P)||((B=U.name)==null?void 0:B.toLowerCase().includes(P))}).slice(0,6)},[r,n]),N=E.length>0&&r.length>=2;w.useEffect(()=>{x(0)},[E]);const S=P=>P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),T=(P,U)=>{if(!U)return P;const B=S(U),$=P.split(new RegExp(`(${B})`,"gi"));return d.jsx("span",{children:$.map((Y,J)=>Y.toLowerCase()===U.toLowerCase()?d.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:Y},J):d.jsx("span",{children:Y},J))})},R=P=>{if(!N){P.key==="Enter"&&(P.preventDefault(),t(r));return}switch(P.key){case"ArrowDown":P.preventDefault(),x(U=>U<E.length-1?U+1:U);break;case"ArrowUp":P.preventDefault(),x(U=>U>0?U-1:U);break;case"Enter":P.preventDefault(),E[g]?A(E[g].email):t(r);break}},A=P=>{e(P),t(P)},j=()=>i?d.jsx(Hi,{className:"w-4 h-4 animate-spin text-gray-400"}):c===!0?d.jsx(Uc,{className:"w-4 h-4 text-green-600"}):c===!1?d.jsx(yy,{className:"w-4 h-4 text-red-600"}):null;return d.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[d.jsxs("div",{className:"relative w-full",children:[d.jsx(Qr,{ref:b,type:"email",value:r,onChange:P=>e(P.target.value),onKeyDown:R,placeholder:u,className:`pr-8 ${p} ${c===!1?"border-red-300 focus:ring-red-500":""}`,disabled:m}),d.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none",children:d.jsx(j,{})})]}),(N||s&&r.length>=2)&&d.jsx("div",{className:"w-full border border-gray-200 dark:border-gray-700 rounded-md max-h-[200px] overflow-y-auto bg-white dark:bg-gray-800",children:s?d.jsxs("div",{className:"flex items-center justify-center py-4",children:[d.jsx(Hi,{className:"h-4 w-4 animate-spin text-gray-400"}),d.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"Loading contacts..."})]}):d.jsx("div",{className:"py-1",children:E.map((P,U)=>d.jsx("div",{onClick:B=>{B.preventDefault(),B.stopPropagation(),A(P.email)},onMouseEnter:()=>x(U),className:`px-3 py-2 cursor-pointer transition-colors ${U===g?"bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:d.jsxs("div",{className:"flex flex-col w-full",children:[P.name&&d.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:T(P.name,r)}),d.jsx("span",{className:`text-xs text-gray-600 dark:text-gray-400 truncate ${P.name?"":"text-sm font-medium text-gray-900 dark:text-gray-100"}`,children:T(P.email,r)})]})},P.email))})})]})},Gu="src/shared/hooks/useFilevineContacts.ts";let Pa=null,Fv=null;const cq=1800*1e3,Wu=1e4;let Tc=null;function uq(r="filevine"){const[e,t]=w.useState(Pa||[]),[n,s]=w.useState(!1),[i,c]=w.useState(null),u=Or(),p=w.useCallback(async()=>{if(Pa&&Fv&&Date.now()-Fv<cq)return Pa.length>Wu&&(u.warn("Cached contacts exceed size limit, truncating",{sourceFile:Gu,actual:Pa.length,limit:Wu}),Pa=Pa.slice(0,Wu)),u.debug("Using cached contacts",{sourceFile:Gu}),t(Pa),Pa;if(Tc){u.debug("Waiting for existing fetch request",{sourceFile:Gu});try{const g=await Tc;return t(g),g}catch(g){throw c(g instanceof Error?g:new Error("Failed to fetch contacts")),g}}return s(!0),c(null),Tc=(async()=>{try{u.debug("Fetching all contacts from server",{sourceFile:Gu});const g=await r8(u,r),x=[];g.clients&&Object.entries(g.clients).forEach(([E,N])=>{var R;const S=Array.isArray(N)?N:[],T=S==null?void 0:S[0];if(T){const A=T.fullName||void 0,j=((R=T.personTypes)==null?void 0:R[0])||void 0;x.push({email:E,name:A,role:j})}else x.push({email:E,name:void 0,role:void 0})}),x.sort((E,N)=>{var R,A;const S=((R=E.name)==null?void 0:R.toLowerCase())||E.email.toLowerCase(),T=((A=N.name)==null?void 0:A.toLowerCase())||N.email.toLowerCase();return S.localeCompare(T)}),u.debug(`Fetched ${x.length} contacts`,{sourceFile:Gu,count:x.length});const b=x.length>Wu?x.slice(0,Wu):x;return x.length>Wu&&u.warn("Contact cache size exceeds limit, truncating",{sourceFile:Gu,actual:x.length,limit:Wu}),Pa=b,Fv=Date.now(),t(b),s(!1),b}catch(g){const x=g instanceof Error?g:new Error("Failed to fetch contacts");throw u.error("Error fetching contacts",x,{sourceFile:Gu}),c(x),s(!1),x}finally{Tc=null}})(),Tc},[r,u]);return{contacts:e,isLoading:n,error:i,loadContacts:p,refreshContacts:async()=>{if(Tc)try{await Tc}catch{}return Pa=null,Fv=null,Tc=null,p()}}}const dq="src/sidepanel/panels/components/FilevineClientInfoBox.tsx",fq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,tempClientEmail:n,setTempClientEmail:s,setIsManuallySet:i,isManuallySet:c,selectedClientDetails:u,isLoading:p,ClientNavigation:m,setClientEmail:g,isValidClient:x,isTempEmailValid:b,isValidating:E,isProjectManuallySelected:N=!1})=>{const S=Or(),{isConnected:T,initiateReconnection:R}=Wi(),{platform:A}=tn(),[j,P]=nr.useState(!1),{contacts:U,isLoading:B,loadContacts:$}=uq("filevine");nr.useEffect(()=>{j&&U.length===0&&!B&&$()},[j,U.length,B,$]);const Y=()=>d.jsx(Vs,{rows:2}),J=()=>d.jsxs("div",{className:"p-4 text-center",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:d.jsx(Bc,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),d.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2",children:"Gmail disconnected"}),d.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Connect Gmail to view email insights"}),d.jsxs(ze,{onClick:async()=>{try{await R()}catch(he){S.error("Failed to reconnect Gmail:",he,{sourceFile:dq})}},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-4 py-2",children:[d.jsx(wo,{className:"h-3 w-3 mr-1"}),"Reconnect Gmail"]})]});return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(xy,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),d.jsxs(Ns,{open:j,onOpenChange:P,children:[d.jsx(Ts,{asChild:!0,children:d.jsx(ze,{variant:"ghost",size:"icon",className:"h-6 w-6",children:d.jsx(qs,{className:"h-4 w-4"})})}),d.jsx(os,{align:"end",className:"p-3 w-80",children:d.jsx(lq,{value:n||"",onChange:he=>s(he),onSelect:he=>{g(he,!0),P(!1)},suggestions:U,isLoading:B,isValidating:E,isValid:b,placeholder:"Search contact by email or name",className:"h-9 text-sm"})})]})]}),p?Y():N?d.jsxs("div",{className:"p-4 text-center",children:[d.jsx(qs,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),d.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Manually Selected"}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Search for a contact to view full client information"})]}):d.jsxs(d.Fragment,{children:[t.length>0&&!c&&d.jsx(m,{}),c&&r&&d.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:d.jsxs("div",{className:"flex flex-col",children:[(()=>{const he=U.find(te=>te.email===r);return he!=null&&he.name?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:he.name}),d.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:r})]}):d.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:r})})(),d.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"(Manually set)"})]})}),E&&e.length>0&&t.length===0&&!c?d.jsx(Vs,{rows:2}):u&&Object.keys(u).length>0?d.jsx(Yc,{details:u}):A==="chrome"&&!T?J():d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:d.jsx("p",{className:"mb-2",children:c&&r?`No contact information found for ${r}`:e.length>0&&t.length===0?`No contact information available for emails on the selected thread:
                        ${e.join(", ")}`:e.length>0?"No contact information available for the selected email ID":"Select a contact email thread to view contact information"})})]})]})};var c0="Collapsible",[hq,FP]=Ba(c0),[pq,DE]=hq(c0),jP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:s,disabled:i,onOpenChange:c,...u}=r,[p,m]=Kc({prop:n,defaultProp:s??!1,onChange:c,caller:c0});return d.jsx(pq,{scope:t,disabled:i,contentId:jl(),open:p,onOpenToggle:w.useCallback(()=>m(g=>!g),[m]),children:d.jsx(Ar.div,{"data-state":ME(p),"data-disabled":i?"":void 0,...u,ref:e})})});jP.displayName=c0;var OP="CollapsibleTrigger",DP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,...n}=r,s=DE(OP,t);return d.jsx(Ar.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":ME(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:e,onClick:Ct(r.onClick,s.onOpenToggle)})});DP.displayName=OP;var LE="CollapsibleContent",LP=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=DE(LE,r.__scopeCollapsible);return d.jsx(qi,{present:t||s.open,children:({present:i})=>d.jsx(mq,{...n,ref:e,present:i})})});LP.displayName=LE;var mq=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,present:n,children:s,...i}=r,c=DE(LE,t),[u,p]=w.useState(n),m=w.useRef(null),g=Nn(e,m),x=w.useRef(0),b=x.current,E=w.useRef(0),N=E.current,S=c.open||u,T=w.useRef(S),R=w.useRef(void 0);return w.useEffect(()=>{const A=requestAnimationFrame(()=>T.current=!1);return()=>cancelAnimationFrame(A)},[]),Dl(()=>{const A=m.current;if(A){R.current=R.current||{transitionDuration:A.style.transitionDuration,animationName:A.style.animationName},A.style.transitionDuration="0s",A.style.animationName="none";const j=A.getBoundingClientRect();x.current=j.height,E.current=j.width,T.current||(A.style.transitionDuration=R.current.transitionDuration,A.style.animationName=R.current.animationName),p(n)}},[c.open,n]),d.jsx(Ar.div,{"data-state":ME(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!S,...i,ref:g,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":N?`${N}px`:void 0,...r.style},children:S&&s})});function ME(r){return r?"open":"closed"}var gq=jP,vq=DP,yq=LP,Yi="Accordion",xq=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[$E,wq,bq]=NE(Yi),[u0]=Ba(Yi,[bq,FP]),UE=FP(),MP=nr.forwardRef((r,e)=>{const{type:t,...n}=r,s=n,i=n;return d.jsx($E.Provider,{scope:r.__scopeAccordion,children:t==="multiple"?d.jsx(Cq,{...i,ref:e}):d.jsx(Sq,{...s,ref:e})})});MP.displayName=Yi;var[$P,_q]=u0(Yi),[UP,Eq]=u0(Yi,{collapsible:!1}),Sq=nr.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},collapsible:i=!1,...c}=r,[u,p]=Kc({prop:t,defaultProp:n??"",onChange:s,caller:Yi});return d.jsx($P,{scope:r.__scopeAccordion,value:nr.useMemo(()=>u?[u]:[],[u]),onItemOpen:p,onItemClose:nr.useCallback(()=>i&&p(""),[i,p]),children:d.jsx(UP,{scope:r.__scopeAccordion,collapsible:i,children:d.jsx(zP,{...c,ref:e})})})}),Cq=nr.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},...i}=r,[c,u]=Kc({prop:t,defaultProp:n??[],onChange:s,caller:Yi}),p=nr.useCallback(g=>u((x=[])=>[...x,g]),[u]),m=nr.useCallback(g=>u((x=[])=>x.filter(b=>b!==g)),[u]);return d.jsx($P,{scope:r.__scopeAccordion,value:c,onItemOpen:p,onItemClose:m,children:d.jsx(UP,{scope:r.__scopeAccordion,collapsible:!0,children:d.jsx(zP,{...i,ref:e})})})}),[kq,d0]=u0(Yi),zP=nr.forwardRef((r,e)=>{const{__scopeAccordion:t,disabled:n,dir:s,orientation:i="vertical",...c}=r,u=nr.useRef(null),p=Nn(u,e),m=wq(t),x=n0(s)==="ltr",b=Ct(r.onKeyDown,E=>{var Y;if(!xq.includes(E.key))return;const N=E.target,S=m().filter(J=>{var he;return!((he=J.ref.current)!=null&&he.disabled)}),T=S.findIndex(J=>J.ref.current===N),R=S.length;if(T===-1)return;E.preventDefault();let A=T;const j=0,P=R-1,U=()=>{A=T+1,A>P&&(A=j)},B=()=>{A=T-1,A<j&&(A=P)};switch(E.key){case"Home":A=j;break;case"End":A=P;break;case"ArrowRight":i==="horizontal"&&(x?U():B());break;case"ArrowDown":i==="vertical"&&U();break;case"ArrowLeft":i==="horizontal"&&(x?B():U());break;case"ArrowUp":i==="vertical"&&B();break}const $=A%R;(Y=S[$].ref.current)==null||Y.focus()});return d.jsx(kq,{scope:t,disabled:n,direction:s,orientation:i,children:d.jsx($E.Slot,{scope:t,children:d.jsx(Ar.div,{...c,"data-orientation":i,ref:p,onKeyDown:n?void 0:b})})})}),Ay="AccordionItem",[Nq,zE]=u0(Ay),HP=nr.forwardRef((r,e)=>{const{__scopeAccordion:t,value:n,...s}=r,i=d0(Ay,t),c=_q(Ay,t),u=UE(t),p=jl(),m=n&&c.value.includes(n)||!1,g=i.disabled||r.disabled;return d.jsx(Nq,{scope:t,open:m,disabled:g,triggerId:p,children:d.jsx(gq,{"data-orientation":i.orientation,"data-state":KP(m),...u,...s,ref:e,disabled:g,open:m,onOpenChange:x=>{x?c.onItemOpen(n):c.onItemClose(n)}})})});HP.displayName=Ay;var BP="AccordionHeader",GP=nr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=d0(Yi,t),i=zE(BP,t);return d.jsx(Ar.h3,{"data-orientation":s.orientation,"data-state":KP(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:e})});GP.displayName=BP;var Cb="AccordionTrigger",WP=nr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=d0(Yi,t),i=zE(Cb,t),c=Eq(Cb,t),u=UE(t);return d.jsx($E.ItemSlot,{scope:t,children:d.jsx(vq,{"aria-disabled":i.open&&!c.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...u,...n,ref:e})})});WP.displayName=Cb;var VP="AccordionContent",qP=nr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=d0(Yi,t),i=zE(VP,t),c=UE(t);return d.jsx(yq,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...c,...n,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...r.style}})});qP.displayName=VP;function KP(r){return r?"open":"closed"}var Tq=MP,Rq=HP,Aq=GP,YP=WP,JP=qP;const Iq=Tq,XP=w.forwardRef(({className:r,...e},t)=>d.jsx(Rq,{ref:t,className:_r("border-b border-neutral-200 dark:border-border",r),...e}));XP.displayName="AccordionItem";const QP=w.forwardRef(({className:r,children:e,...t},n)=>d.jsx(Aq,{className:"flex",children:d.jsxs(YP,{ref:n,className:_r("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",r),...t,children:[e,d.jsx(ns,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));QP.displayName=YP.displayName;const ZP=w.forwardRef(({className:r,children:e,...t},n)=>d.jsx(JP,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:d.jsx("div",{className:_r("pb-4 pt-0",r),children:e})}));ZP.displayName=JP.displayName;var dm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Pq=dm.exports,h1;function Fq(){return h1||(h1=1,(function(r,e){(function(){var t,n="4.17.23",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",u="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",m=500,g="__lodash_placeholder__",x=1,b=2,E=4,N=1,S=2,T=1,R=2,A=4,j=8,P=16,U=32,B=64,$=128,Y=256,J=512,he=30,te="...",ue=800,we=16,ie=1,se=2,pe=3,ee=1/0,G=9007199254740991,z=17976931348623157e292,K=NaN,D=4294967295,M=D-1,oe=D>>>1,Ee=[["ary",$],["bind",T],["bindKey",R],["curry",j],["curryRight",P],["flip",J],["partial",U],["partialRight",B],["rearg",Y]],V="[object Arguments]",ce="[object Array]",xe="[object AsyncFunction]",ve="[object Boolean]",le="[object Date]",Ne="[object DOMException]",He="[object Error]",Ue="[object Function]",Me="[object GeneratorFunction]",Te="[object Map]",gt="[object Number]",jt="[object Null]",ot="[object Object]",Ut="[object Promise]",Zt="[object Proxy]",er="[object RegExp]",et="[object Set]",It="[object String]",hr="[object Symbol]",Ae="[object Undefined]",Xe="[object WeakMap]",pt="[object WeakSet]",tt="[object ArrayBuffer]",Pt="[object DataView]",Er="[object Float32Array]",Dr="[object Float64Array]",lt="[object Int8Array]",kt="[object Int16Array]",de="[object Int32Array]",Ie="[object Uint8Array]",Ge="[object Uint8ClampedArray]",ut="[object Uint16Array]",Ft="[object Uint32Array]",cr=/\b__p \+= '';/g,ft=/\b(__p \+=) '' \+/g,Nt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Sr=/&(?:amp|lt|gt|quot|#39);/g,as=/[&<>"']/g,Vn=RegExp(Sr.source),As=RegExp(as.source),Ji=/<%-([\s\S]+?)%>/g,Ir=/<%([\s\S]+?)%>/g,ls=/<%=([\s\S]+?)%>/g,gi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Xi=/^\w*$/,Xs=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bo=/[\\^$.*+?()[\]{}|]/g,Qs=RegExp(bo.source),Qi=/^\s+/,xn=/\s/,cs=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ho=/\{\n\/\* \[wrapped with (.+)\] \*/,vi=/,? & /,Zi=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Wa=/[()=,{}\[\]\/\s]/,us=/\\(\\)?/g,Is=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ea=/\w*$/,ta=/^[-+]0x[0-9a-f]+$/i,ra=/^0b[01]+$/i,na=/^\[object .+?Constructor\]$/,it=/^0o[0-7]+$/i,Q=/^(?:0|[1-9]\d*)$/,De=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,We=/($^)/,xr=/['\n\r\u2028\u2029\\]/g,Dt="\\ud800-\\udfff",Pr="\\u0300-\\u036f",Hr="\\ufe20-\\ufe2f",fn="\\u20d0-\\u20ff",wn=Pr+Hr+fn,yi="\\u2700-\\u27bf",qr="a-z\\xdf-\\xf6\\xf8-\\xff",xi="\\xac\\xb1\\xd7\\xf7",qn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Jc="\\u2000-\\u206f",Ps=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ad="A-Z\\xc0-\\xd6\\xd8-\\xde",ld="\\ufe0e\\ufe0f",cd=xi+qn+Jc+Ps,sa="[']",Bo="["+Dt+"]",Go="["+cd+"]",wi="["+wn+"]",Xc="\\d+",mh="["+yi+"]",zl="["+qr+"]",Qc="[^"+Dt+cd+Xc+yi+qr+ad+"]",Va="\\ud83c[\\udffb-\\udfff]",qa="(?:"+wi+"|"+Va+")",ud="[^"+Dt+"]",oa="(?:\\ud83c[\\udde6-\\uddff]){2}",sr="[\\ud800-\\udbff][\\udc00-\\udfff]",be="["+ad+"]",$e="\\u200d",at="(?:"+zl+"|"+Qc+")",zt="(?:"+be+"|"+Qc+")",Kt="(?:"+sa+"(?:d|ll|m|re|s|t|ve))?",Ht="(?:"+sa+"(?:D|LL|M|RE|S|T|VE))?",nt=qa+"?",Cr="["+ld+"]?",Fs="(?:"+$e+"(?:"+[ud,oa,sr].join("|")+")"+Cr+nt+")*",ds="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ia="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Hl=Cr+nt+Fs,Zc="(?:"+[mh,oa,sr].join("|")+")"+Hl,aa="(?:"+[ud+wi+"?",wi,oa,sr,Bo].join("|")+")",f0=RegExp(sa,"g"),Qm=RegExp(wi,"g"),Ka=RegExp(Va+"(?="+Va+")|"+aa+Hl,"g"),h0=RegExp([be+"?"+zl+"+"+Kt+"(?="+[Go,be,"$"].join("|")+")",zt+"+"+Ht+"(?="+[Go,be+at,"$"].join("|")+")",be+"?"+at+"+"+Kt,be+"+"+Ht,ia,ds,Xc,Zc].join("|"),"g"),Zm=RegExp("["+$e+Dt+wn+ld+"]"),dd=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],p0=-1,wr={};wr[Er]=wr[Dr]=wr[lt]=wr[kt]=wr[de]=wr[Ie]=wr[Ge]=wr[ut]=wr[Ft]=!0,wr[V]=wr[ce]=wr[tt]=wr[ve]=wr[Pt]=wr[le]=wr[He]=wr[Ue]=wr[Te]=wr[gt]=wr[ot]=wr[er]=wr[et]=wr[It]=wr[Xe]=!1;var pr={};pr[V]=pr[ce]=pr[tt]=pr[Pt]=pr[ve]=pr[le]=pr[Er]=pr[Dr]=pr[lt]=pr[kt]=pr[de]=pr[Te]=pr[gt]=pr[ot]=pr[er]=pr[et]=pr[It]=pr[hr]=pr[Ie]=pr[Ge]=pr[ut]=pr[Ft]=!0,pr[He]=pr[Ue]=pr[Xe]=!1;var Bl={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},fd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},m0={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},g0={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},gh=parseFloat,hd=parseInt,pd=typeof hv=="object"&&hv&&hv.Object===Object&&hv,tg=typeof self=="object"&&self&&self.Object===Object&&self,Br=pd||tg||Function("return this")(),eu=e&&!e.nodeType&&e,Wo=eu&&!0&&r&&!r.nodeType&&r,vh=Wo&&Wo.exports===eu,Gl=vh&&pd.process,Kn=(function(){try{var ne=Wo&&Wo.require&&Wo.require("util").types;return ne||Gl&&Gl.binding&&Gl.binding("util")}catch{}})(),yh=Kn&&Kn.isArrayBuffer,fs=Kn&&Kn.isDate,Ya=Kn&&Kn.isMap,md=Kn&&Kn.isRegExp,Wl=Kn&&Kn.isSet,rg=Kn&&Kn.isTypedArray;function Yn(ne,Se,ge){switch(ge.length){case 0:return ne.call(Se);case 1:return ne.call(Se,ge[0]);case 2:return ne.call(Se,ge[0],ge[1]);case 3:return ne.call(Se,ge[0],ge[1],ge[2])}return ne.apply(Se,ge)}function xh(ne,Se,ge,Ke){for(var Ot=-1,ur=ne==null?0:ne.length;++Ot<ur;){var an=ne[Ot];Se(Ke,an,ge(an),ne)}return Ke}function Dn(ne,Se){for(var ge=-1,Ke=ne==null?0:ne.length;++ge<Ke&&Se(ne[ge],ge,ne)!==!1;);return ne}function gd(ne,Se){for(var ge=ne==null?0:ne.length;ge--&&Se(ne[ge],ge,ne)!==!1;);return ne}function wh(ne,Se){for(var ge=-1,Ke=ne==null?0:ne.length;++ge<Ke;)if(!Se(ne[ge],ge,ne))return!1;return!0}function la(ne,Se){for(var ge=-1,Ke=ne==null?0:ne.length,Ot=0,ur=[];++ge<Ke;){var an=ne[ge];Se(an,ge,ne)&&(ur[Ot++]=an)}return ur}function vd(ne,Se){var ge=ne==null?0:ne.length;return!!ge&&Vl(ne,Se,0)>-1}function bh(ne,Se,ge){for(var Ke=-1,Ot=ne==null?0:ne.length;++Ke<Ot;)if(ge(Se,ne[Ke]))return!0;return!1}function Fr(ne,Se){for(var ge=-1,Ke=ne==null?0:ne.length,Ot=Array(Ke);++ge<Ke;)Ot[ge]=Se(ne[ge],ge,ne);return Ot}function ca(ne,Se){for(var ge=-1,Ke=Se.length,Ot=ne.length;++ge<Ke;)ne[Ot+ge]=Se[ge];return ne}function _h(ne,Se,ge,Ke){var Ot=-1,ur=ne==null?0:ne.length;for(Ke&&ur&&(ge=ne[++Ot]);++Ot<ur;)ge=Se(ge,ne[Ot],Ot,ne);return ge}function v0(ne,Se,ge,Ke){var Ot=ne==null?0:ne.length;for(Ke&&Ot&&(ge=ne[--Ot]);Ot--;)ge=Se(ge,ne[Ot],Ot,ne);return ge}function Eh(ne,Se){for(var ge=-1,Ke=ne==null?0:ne.length;++ge<Ke;)if(Se(ne[ge],ge,ne))return!0;return!1}var y0=Ch("length");function ng(ne){return ne.split("")}function x0(ne){return ne.match(Zi)||[]}function sg(ne,Se,ge){var Ke;return ge(ne,function(Ot,ur,an){if(Se(Ot,ur,an))return Ke=ur,!1}),Ke}function yd(ne,Se,ge,Ke){for(var Ot=ne.length,ur=ge+(Ke?1:-1);Ke?ur--:++ur<Ot;)if(Se(ne[ur],ur,ne))return ur;return-1}function Vl(ne,Se,ge){return Se===Se?bd(ne,Se,ge):yd(ne,og,ge)}function Sh(ne,Se,ge,Ke){for(var Ot=ge-1,ur=ne.length;++Ot<ur;)if(Ke(ne[Ot],Se))return Ot;return-1}function og(ne){return ne!==ne}function ig(ne,Se){var ge=ne==null?0:ne.length;return ge?kh(ne,Se)/ge:K}function Ch(ne){return function(Se){return Se==null?t:Se[ne]}}function xd(ne){return function(Se){return ne==null?t:ne[Se]}}function ag(ne,Se,ge,Ke,Ot){return Ot(ne,function(ur,an,kr){ge=Ke?(Ke=!1,ur):Se(ge,ur,an,kr)}),ge}function w0(ne,Se){var ge=ne.length;for(ne.sort(Se);ge--;)ne[ge]=ne[ge].value;return ne}function kh(ne,Se){for(var ge,Ke=-1,Ot=ne.length;++Ke<Ot;){var ur=Se(ne[Ke]);ur!==t&&(ge=ge===t?ur:ge+ur)}return ge}function Nh(ne,Se){for(var ge=-1,Ke=Array(ne);++ge<ne;)Ke[ge]=Se(ge);return Ke}function b0(ne,Se){return Fr(Se,function(ge){return[ge,ne[ge]]})}function lg(ne){return ne&&ne.slice(0,_d(ne)+1).replace(Qi,"")}function js(ne){return function(Se){return ne(Se)}}function tu(ne,Se){return Fr(Se,function(ge){return ne[ge]})}function bi(ne,Se){return ne.has(Se)}function cg(ne,Se){for(var ge=-1,Ke=ne.length;++ge<Ke&&Vl(Se,ne[ge],0)>-1;);return ge}function Th(ne,Se){for(var ge=ne.length;ge--&&Vl(Se,ne[ge],0)>-1;);return ge}function ug(ne,Se){for(var ge=ne.length,Ke=0;ge--;)ne[ge]===Se&&++Ke;return Ke}var dg=xd(Bl),fg=xd(fd);function hg(ne){return"\\"+g0[ne]}function ql(ne,Se){return ne==null?t:ne[Se]}function Kl(ne){return Zm.test(ne)}function _0(ne){return dd.test(ne)}function E0(ne){for(var Se,ge=[];!(Se=ne.next()).done;)ge.push(Se.value);return ge}function wd(ne){var Se=-1,ge=Array(ne.size);return ne.forEach(function(Ke,Ot){ge[++Se]=[Ot,Ke]}),ge}function Rh(ne,Se){return function(ge){return ne(Se(ge))}}function Zs(ne,Se){for(var ge=-1,Ke=ne.length,Ot=0,ur=[];++ge<Ke;){var an=ne[ge];(an===Se||an===g)&&(ne[ge]=g,ur[Ot++]=ge)}return ur}function ua(ne){var Se=-1,ge=Array(ne.size);return ne.forEach(function(Ke){ge[++Se]=Ke}),ge}function S0(ne){var Se=-1,ge=Array(ne.size);return ne.forEach(function(Ke){ge[++Se]=[Ke,Ke]}),ge}function bd(ne,Se,ge){for(var Ke=ge-1,Ot=ne.length;++Ke<Ot;)if(ne[Ke]===Se)return Ke;return-1}function C0(ne,Se,ge){for(var Ke=ge+1;Ke--;)if(ne[Ke]===Se)return Ke;return Ke}function Ja(ne){return Kl(ne)?mg(ne):y0(ne)}function Os(ne){return Kl(ne)?gg(ne):ng(ne)}function _d(ne){for(var Se=ne.length;Se--&&xn.test(ne.charAt(Se)););return Se}var pg=xd(m0);function mg(ne){for(var Se=Ka.lastIndex=0;Ka.test(ne);)++Se;return Se}function gg(ne){return ne.match(Ka)||[]}function k0(ne){return ne.match(h0)||[]}var N0=(function ne(Se){Se=Se==null?Br:Yl.defaults(Br.Object(),Se,Yl.pick(Br,eg));var ge=Se.Array,Ke=Se.Date,Ot=Se.Error,ur=Se.Function,an=Se.Math,kr=Se.Object,ru=Se.RegExp,T0=Se.String,eo=Se.TypeError,_i=ge.prototype,Ah=ur.prototype,Vo=kr.prototype,Jl=Se["__core-js_shared__"],nu=Ah.toString,ir=Vo.hasOwnProperty,Xl=0,Ed=(function(){var l=/[^.]+$/.exec(Jl&&Jl.keys&&Jl.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})(),su=Vo.toString,Sd=nu.call(kr),vg=Br._,yg=ru("^"+nu.call(ir).replace(bo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ou=vh?Se.Buffer:t,Ei=Se.Symbol,iu=Se.Uint8Array,Ih=ou?ou.allocUnsafe:t,_o=Rh(kr.getPrototypeOf,kr),Cd=kr.create,kd=Vo.propertyIsEnumerable,Nd=_i.splice,xg=Ei?Ei.isConcatSpreadable:t,Si=Ei?Ei.iterator:t,Xa=Ei?Ei.toStringTag:t,au=(function(){try{var l=ba(kr,"defineProperty");return l({},"",{}),l}catch{}})(),wg=Se.clearTimeout!==Br.clearTimeout&&Se.clearTimeout,Lr=Ke&&Ke.now!==Br.Date.now&&Ke.now,Ph=Se.setTimeout!==Br.setTimeout&&Se.setTimeout,Qa=an.ceil,da=an.floor,Td=kr.getOwnPropertySymbols,Fh=ou?ou.isBuffer:t,Ql=Se.isFinite,Rd=_i.join,Zl=Rh(kr.keys,kr),ln=an.max,Ln=an.min,R0=Ke.now,bg=Se.parseInt,lu=an.random,Ad=_i.reverse,cu=ba(Se,"DataView"),Za=ba(Se,"Map"),uu=ba(Se,"Promise"),fa=ba(Se,"Set"),du=ba(Se,"WeakMap"),ec=ba(kr,"create"),Id=du&&new du,tc={},jh=_a(cu),ha=_a(Za),_g=_a(uu),rc=_a(fa),qo=_a(du),pa=Ei?Ei.prototype:t,Ds=pa?pa.valueOf:t,Pd=pa?pa.toString:t;function O(l){if(un(l)&&!$t(l)&&!(l instanceof Mt)){if(l instanceof Mn)return l;if(ir.call(l,"__wrapped__"))return Jg(l)}return new Mn(l)}var nc=(function(){function l(){}return function(f){if(!sn(f))return{};if(Cd)return Cd(f);l.prototype=f;var y=new l;return l.prototype=t,y}})();function Ko(){}function Mn(l,f){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}O.templateSettings={escape:Ji,evaluate:Ir,interpolate:ls,variable:"",imports:{_:O}},O.prototype=Ko.prototype,O.prototype.constructor=O,Mn.prototype=nc(Ko.prototype),Mn.prototype.constructor=Mn;function Mt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function Fd(){var l=new Mt(this.__wrapped__);return l.__actions__=Xn(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=Xn(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=Xn(this.__views__),l}function Oh(){if(this.__filtered__){var l=new Mt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function sc(){var l=this.__wrapped__.value(),f=this.__dir__,y=$t(l),C=f<0,I=y?l.length:0,L=cp(0,I,this.__views__),q=L.start,Z=L.end,ae=Z-q,ke=C?Z:q-1,Re=this.__iteratees__,je=Re.length,Be=0,ht=Ln(ae,this.__takeCount__);if(!y||!C&&I==ae&&ht==ae)return fc(l,this.__actions__);var Rt=[];e:for(;ae--&&Be<ht;){ke+=f;for(var Vt=-1,At=l[ke];++Vt<je;){var tr=Re[Vt],lr=tr.iteratee,Po=tr.type,zs=lr(At);if(Po==se)At=zs;else if(!zs){if(Po==ie)continue e;break e}}Rt[Be++]=At}return Rt}Mt.prototype=nc(Ko.prototype),Mt.prototype.constructor=Mt;function hs(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function Mr(){this.__data__=ec?ec(null):{},this.size=0}function jr(l){var f=this.has(l)&&delete this.__data__[l];return this.size-=f?1:0,f}function ma(l){var f=this.__data__;if(ec){var y=f[l];return y===p?t:y}return ir.call(f,l)?f[l]:t}function $n(l){var f=this.__data__;return ec?f[l]!==t:ir.call(f,l)}function ps(l,f){var y=this.__data__;return this.size+=this.has(l)?0:1,y[l]=ec&&f===t?p:f,this}hs.prototype.clear=Mr,hs.prototype.delete=jr,hs.prototype.get=ma,hs.prototype.has=$n,hs.prototype.set=ps;function Jn(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function oc(){this.__data__=[],this.size=0}function ms(l){var f=this.__data__,y=zn(f,l);if(y<0)return!1;var C=f.length-1;return y==C?f.pop():Nd.call(f,y,1),--this.size,!0}function jd(l){var f=this.__data__,y=zn(f,l);return y<0?t:f[y][1]}function Eg(l){return zn(this.__data__,l)>-1}function Sg(l,f){var y=this.__data__,C=zn(y,l);return C<0?(++this.size,y.push([l,f])):y[C][1]=f,this}Jn.prototype.clear=oc,Jn.prototype.delete=ms,Jn.prototype.get=jd,Jn.prototype.has=Eg,Jn.prototype.set=Sg;function to(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function Cg(){this.size=0,this.__data__={hash:new hs,map:new(Za||Jn),string:new hs}}function Ci(l){var f=Nu(this,l).delete(l);return this.size-=f?1:0,f}function Od(l){return Nu(this,l).get(l)}function Dh(l){return Nu(this,l).has(l)}function kg(l,f){var y=Nu(this,l),C=y.size;return y.set(l,f),this.size+=y.size==C?0:1,this}to.prototype.clear=Cg,to.prototype.delete=Ci,to.prototype.get=Od,to.prototype.has=Dh,to.prototype.set=kg;function el(l){var f=-1,y=l==null?0:l.length;for(this.__data__=new to;++f<y;)this.add(l[f])}function ga(l){return this.__data__.set(l,p),this}function ic(l){return this.__data__.has(l)}el.prototype.add=el.prototype.push=ga,el.prototype.has=ic;function Un(l){var f=this.__data__=new Jn(l);this.size=f.size}function Dd(){this.__data__=new Jn,this.size=0}function Ld(l){var f=this.__data__,y=f.delete(l);return this.size=f.size,y}function ro(l){return this.__data__.get(l)}function no(l){return this.__data__.has(l)}function tl(l,f){var y=this.__data__;if(y instanceof Jn){var C=y.__data__;if(!Za||C.length<s-1)return C.push([l,f]),this.size=++y.size,this;y=this.__data__=new to(C)}return y.set(l,f),this.size=y.size,this}Un.prototype.clear=Dd,Un.prototype.delete=Ld,Un.prototype.get=ro,Un.prototype.has=no,Un.prototype.set=tl;function Yo(l,f){var y=$t(l),C=!y&&$u(l),I=!y&&!C&&_c(l),L=!y&&!C&&!I&&Nf(l),q=y||C||I||L,Z=q?Nh(l.length,T0):[],ae=Z.length;for(var ke in l)(f||ir.call(l,ke))&&!(q&&(ke=="length"||I&&(ke=="offset"||ke=="parent")||L&&(ke=="buffer"||ke=="byteLength"||ke=="byteOffset")||Wr(ke,ae)))&&Z.push(ke);return Z}function Jo(l){var f=l.length;return f?l[uc(0,f-1)]:t}function rl(l,f){return uf(Xn(l),ki(f,0,l.length))}function Ng(l){return uf(Xn(l))}function fu(l,f,y){(y!==t&&!Di(l[f],y)||y===t&&!(f in l))&&Xo(l,f,y)}function nl(l,f,y){var C=l[f];(!(ir.call(l,f)&&Di(C,y))||y===t&&!(f in l))&&Xo(l,f,y)}function zn(l,f){for(var y=l.length;y--;)if(Di(l[y][0],f))return y;return-1}function Ls(l,f,y,C){return Zo(l,function(I,L,q){f(C,I,y(I),q)}),C}function $r(l,f){return l&&So(f,Gn(f),l)}function Eo(l,f){return l&&So(f,ho(f),l)}function Xo(l,f,y){f=="__proto__"&&au?au(l,f,{configurable:!0,enumerable:!0,value:y,writable:!0}):l[f]=y}function Md(l,f){for(var y=-1,C=f.length,I=ge(C),L=l==null;++y<C;)I[y]=L?t:Z0(l,f[y]);return I}function ki(l,f,y){return l===l&&(y!==t&&(l=l<=y?l:y),f!==t&&(l=l>=f?l:f)),l}function gs(l,f,y,C,I,L){var q,Z=f&x,ae=f&b,ke=f&E;if(y&&(q=I?y(l,C,I,L):y(l)),q!==t)return q;if(!sn(l))return l;var Re=$t(l);if(Re){if(q=Ru(l),!Z)return Xn(l,q)}else{var je=An(l),Be=je==Ue||je==Me;if(_c(l))return Xh(l,Z);if(je==ot||je==V||Be&&!I){if(q=ae||Be?{}:In(l),!Z)return ae?I0(l,Eo(q,l)):Xd(l,$r(q,l))}else{if(!pr[je])return I?l:{};q=P0(l,je,Z)}}L||(L=new Un);var ht=L.get(l);if(ht)return ht;L.set(l,q),WE(l)?l.forEach(function(At){q.add(gs(At,f,y,At,l,L))}):BE(l)&&l.forEach(function(At,tr){q.set(tr,gs(At,f,y,tr,l,L))});var Rt=ke?ae?ku:Cu:ae?ho:Gn,Vt=Re?t:Rt(l);return Dn(Vt||l,function(At,tr){Vt&&(tr=At,At=l[tr]),nl(q,tr,gs(At,f,y,tr,l,L))}),q}function Tg(l){var f=Gn(l);return function(y){return hu(y,l,f)}}function hu(l,f,y){var C=y.length;if(l==null)return!C;for(l=kr(l);C--;){var I=y[C],L=f[I],q=l[I];if(q===t&&!(I in l)||!L(q))return!1}return!0}function Lh(l,f,y){if(typeof l!="function")throw new eo(c);return xc(function(){l.apply(t,y)},f)}function Qo(l,f,y,C){var I=-1,L=vd,q=!0,Z=l.length,ae=[],ke=f.length;if(!Z)return ae;y&&(f=Fr(f,js(y))),C?(L=bh,q=!1):f.length>=s&&(L=bi,q=!1,f=new el(f));e:for(;++I<Z;){var Re=l[I],je=y==null?Re:y(Re);if(Re=C||Re!==0?Re:0,q&&je===je){for(var Be=ke;Be--;)if(f[Be]===je)continue e;ae.push(Re)}else L(f,je,C)||ae.push(Re)}return ae}var Zo=lo(Ms),Rg=lo(va,!0);function pu(l,f){var y=!0;return Zo(l,function(C,I,L){return y=!!f(C,I,L),y}),y}function sl(l,f,y){for(var C=-1,I=l.length;++C<I;){var L=l[C],q=f(L);if(q!=null&&(Z===t?q===q&&!Io(q):y(q,Z)))var Z=q,ae=L}return ae}function Ag(l,f,y,C){var I=l.length;for(y=Gt(y),y<0&&(y=-y>I?0:I+y),C=C===t||C>I?I:Gt(C),C<0&&(C+=I),C=y>C?0:qE(C);y<C;)l[y++]=f;return l}function Mh(l,f){var y=[];return Zo(l,function(C,I,L){f(C,I,L)&&y.push(C)}),y}function en(l,f,y,C,I){var L=-1,q=l.length;for(y||(y=af),I||(I=[]);++L<q;){var Z=l[L];f>0&&y(Z)?f>1?en(Z,f-1,y,C,I):ca(I,Z):C||(I[I.length]=Z)}return I}var $d=Zd(),mu=Zd(!0);function Ms(l,f){return l&&$d(l,f,Gn)}function va(l,f){return l&&mu(l,f,Gn)}function ac(l,f){return la(f,function(y){return vl(l[y])})}function Ni(l,f){f=ri(f,l);for(var y=0,C=f.length;l!=null&&y<C;)l=l[To(f[y++])];return y&&y==C?l:t}function Ud(l,f,y){var C=f(l);return $t(l)?C:ca(C,y(l))}function Tn(l){return l==null?l===t?Ae:jt:Xa&&Xa in kr(l)?of(l):dp(l)}function ya(l,f){return l>f}function so(l,f){return l!=null&&ir.call(l,f)}function ol(l,f){return l!=null&&f in kr(l)}function $h(l,f,y){return l>=Ln(f,y)&&l<ln(f,y)}function zd(l,f,y){for(var C=y?bh:vd,I=l[0].length,L=l.length,q=L,Z=ge(L),ae=1/0,ke=[];q--;){var Re=l[q];q&&f&&(Re=Fr(Re,js(f))),ae=Ln(Re.length,ae),Z[q]=!y&&(f||I>=120&&Re.length>=120)?new el(q&&Re):t}Re=l[0];var je=-1,Be=Z[0];e:for(;++je<I&&ke.length<ae;){var ht=Re[je],Rt=f?f(ht):ht;if(ht=y||ht!==0?ht:0,!(Be?bi(Be,Rt):C(ke,Rt,y))){for(q=L;--q;){var Vt=Z[q];if(!(Vt?bi(Vt,Rt):C(l[q],Rt,y)))continue e}Be&&Be.push(Rt),ke.push(ht)}}return ke}function Ti(l,f,y,C){return Ms(l,function(I,L,q){f(C,y(I),L,q)}),C}function oo(l,f,y){f=ri(f,l),l=bn(l,f);var C=l==null?l:l[To(es(f))];return C==null?t:Yn(C,l,y)}function Hd(l){return un(l)&&Tn(l)==V}function Ig(l){return un(l)&&Tn(l)==tt}function Ri(l){return un(l)&&Tn(l)==le}function io(l,f,y,C,I){return l===f?!0:l==null||f==null||!un(l)&&!un(f)?l!==l&&f!==f:Bd(l,f,y,C,io,I)}function Bd(l,f,y,C,I,L){var q=$t(l),Z=$t(f),ae=q?ce:An(l),ke=Z?ce:An(f);ae=ae==V?ot:ae,ke=ke==V?ot:ke;var Re=ae==ot,je=ke==ot,Be=ae==ke;if(Be&&_c(l)){if(!_c(f))return!1;q=!0,Re=!1}if(Be&&!Re)return L||(L=new Un),q||Nf(l)?ap(l,f,y,C,I,L):lp(l,f,ae,y,C,I,L);if(!(y&N)){var ht=Re&&ir.call(l,"__wrapped__"),Rt=je&&ir.call(f,"__wrapped__");if(ht||Rt){var Vt=ht?l.value():l,At=Rt?f.value():f;return L||(L=new Un),I(Vt,At,y,C,L)}}return Be?(L||(L=new Un),Hg(l,f,y,C,I,L)):!1}function Pg(l){return un(l)&&An(l)==Te}function lc(l,f,y,C){var I=y.length,L=I,q=!C;if(l==null)return!L;for(l=kr(l);I--;){var Z=y[I];if(q&&Z[2]?Z[1]!==l[Z[0]]:!(Z[0]in l))return!1}for(;++I<L;){Z=y[I];var ae=Z[0],ke=l[ae],Re=Z[1];if(q&&Z[2]){if(ke===t&&!(ae in l))return!1}else{var je=new Un;if(C)var Be=C(ke,Re,ae,l,f,je);if(!(Be===t?io(Re,ke,N|S,C,je):Be))return!1}}return!0}function Uh(l){if(!sn(l)||Wg(l))return!1;var f=vl(l)?yg:na;return f.test(_a(l))}function gu(l){return un(l)&&Tn(l)==er}function ei(l){return un(l)&&An(l)==et}function vu(l){return un(l)&&uv(l.length)&&!!wr[Tn(l)]}function cc(l){return typeof l=="function"?l:l==null?po:typeof l=="object"?$t(l)?Gr(l[0],l[1]):Gd(l):sS(l)}function Ai(l){if(!ji(l))return Zl(l);var f=[];for(var y in kr(l))ir.call(l,y)&&y!="constructor"&&f.push(y);return f}function zh(l){if(!sn(l))return Kg(l);var f=ji(l),y=[];for(var C in l)C=="constructor"&&(f||!ir.call(l,C))||y.push(C);return y}function xa(l,f){return l<f}function Hh(l,f){var y=-1,C=fo(l)?ge(l.length):[];return Zo(l,function(I,L,q){C[++y]=f(I,L,q)}),C}function Gd(l){var f=Tu(l);return f.length==1&&f[0][2]?lf(f[0][0],f[0][1]):function(y){return y===l||lc(y,l,f)}}function Gr(l,f){return Ze(l)&&Iu(f)?lf(To(l),f):function(y){var C=Z0(y,l);return C===t&&C===f?ex(y,l):io(f,C,N|S)}}function il(l,f,y,C,I){l!==f&&$d(f,function(L,q){if(I||(I=new Un),sn(L))Bh(l,f,q,y,il,C,I);else{var Z=C?C(oi(l,q),L,q+"",l,f,I):t;Z===t&&(Z=L),fu(l,q,Z)}},ho)}function Bh(l,f,y,C,I,L,q){var Z=oi(l,y),ae=oi(f,y),ke=q.get(ae);if(ke){fu(l,y,ke);return}var Re=L?L(Z,ae,y+"",l,f,q):t,je=Re===t;if(je){var Be=$t(ae),ht=!Be&&_c(ae),Rt=!Be&&!ht&&Nf(ae);Re=ae,Be||ht||Rt?$t(Z)?Re=Z:mn(Z)?Re=Xn(Z):ht?(je=!1,Re=Xh(ae,!0)):Rt?(je=!1,Re=Lg(ae,!0)):Re=[]:Rp(ae)||$u(ae)?(Re=Z,$u(Z)?Re=KE(Z):(!sn(Z)||vl(Z))&&(Re=In(ae))):je=!1}je&&(q.set(ae,Re),I(Re,ae,C,L,q),q.delete(ae)),fu(l,y,Re)}function Wd(l,f){var y=l.length;if(y)return f+=f<0?y:0,Wr(f,y)?l[f]:t}function yu(l,f,y){f.length?f=Fr(f,function(L){return $t(L)?function(q){return Ni(q,L.length===1?L[0]:L)}:L}):f=[po];var C=-1;f=Fr(f,js(St()));var I=Hh(l,function(L,q,Z){var ae=Fr(f,function(ke){return ke(L)});return{criteria:ae,index:++C,value:L}});return w0(I,function(L,q){return A0(L,q,y)})}function Gh(l,f){return wa(l,f,function(y,C){return ex(l,C)})}function wa(l,f,y){for(var C=-1,I=f.length,L={};++C<I;){var q=f[C],Z=Ni(l,q);y(Z,q)&&ll(L,ri(q,l),Z)}return L}function Kr(l){return function(f){return Ni(f,l)}}function rn(l,f,y,C){var I=C?Sh:Vl,L=-1,q=f.length,Z=l;for(l===f&&(f=Xn(f)),y&&(Z=Fr(l,js(y)));++L<q;)for(var ae=0,ke=f[L],Re=y?y(ke):ke;(ae=I(Z,Re,ae,C))>-1;)Z!==l&&Nd.call(Z,ae,1),Nd.call(l,ae,1);return l}function hn(l,f){for(var y=l?f.length:0,C=y-1;y--;){var I=f[y];if(y==C||I!==L){var L=I;Wr(I)?Nd.call(l,I,1):Kd(l,I)}}return l}function uc(l,f){return l+da(lu()*(f-l+1))}function xu(l,f,y,C){for(var I=-1,L=ln(Qa((f-l)/(y||1)),0),q=ge(L);L--;)q[C?L:++I]=l,l+=y;return q}function al(l,f){var y="";if(!l||f<1||f>G)return y;do f%2&&(y+=l),f=da(f/2),f&&(l+=l);while(f);return y}function Bt(l,f){return $s(cf(l,f,po),l+"")}function Hn(l){return Jo(Tf(l))}function Wh(l,f){var y=Tf(l);return uf(y,ki(f,0,y.length))}function ll(l,f,y,C){if(!sn(l))return l;f=ri(f,l);for(var I=-1,L=f.length,q=L-1,Z=l;Z!=null&&++I<L;){var ae=To(f[I]),ke=y;if(ae==="__proto__"||ae==="constructor"||ae==="prototype")return l;if(I!=q){var Re=Z[ae];ke=C?C(Re,ae,Z):t,ke===t&&(ke=sn(Re)?Re:Wr(f[I+1])?[]:{})}nl(Z,ae,ke),Z=Z[ae]}return l}var Vd=Id?function(l,f){return Id.set(l,f),l}:po,ti=au?function(l,f){return au(l,"toString",{configurable:!0,enumerable:!1,value:rx(f),writable:!0})}:po;function ao(l){return uf(Tf(l))}function Bn(l,f,y){var C=-1,I=l.length;f<0&&(f=-f>I?0:I+f),y=y>I?I:y,y<0&&(y+=I),I=f>y?0:y-f>>>0,f>>>=0;for(var L=ge(I);++C<I;)L[C]=l[C+f];return L}function Vh(l,f){var y;return Zo(l,function(C,I,L){return y=f(C,I,L),!y}),!!y}function dc(l,f,y){var C=0,I=l==null?C:l.length;if(typeof f=="number"&&f===f&&I<=oe){for(;C<I;){var L=C+I>>>1,q=l[L];q!==null&&!Io(q)&&(y?q<=f:q<f)?C=L+1:I=L}return I}return qd(l,f,po,y)}function qd(l,f,y,C){var I=0,L=l==null?0:l.length;if(L===0)return 0;f=y(f);for(var q=f!==f,Z=f===null,ae=Io(f),ke=f===t;I<L;){var Re=da((I+L)/2),je=y(l[Re]),Be=je!==t,ht=je===null,Rt=je===je,Vt=Io(je);if(q)var At=C||Rt;else ke?At=Rt&&(C||Be):Z?At=Rt&&Be&&(C||!ht):ae?At=Rt&&Be&&!ht&&(C||!Vt):ht||Vt?At=!1:At=C?je<=f:je<f;At?I=Re+1:L=Re}return Ln(L,M)}function qh(l,f){for(var y=-1,C=l.length,I=0,L=[];++y<C;){var q=l[y],Z=f?f(q):q;if(!y||!Di(Z,ae)){var ae=Z;L[I++]=q===0?0:q}}return L}function Kh(l){return typeof l=="number"?l:Io(l)?K:+l}function vs(l){if(typeof l=="string")return l;if($t(l))return Fr(l,vs)+"";if(Io(l))return Pd?Pd.call(l):"";var f=l+"";return f=="0"&&1/l==-ee?"-0":f}function Ii(l,f,y){var C=-1,I=vd,L=l.length,q=!0,Z=[],ae=Z;if(y)q=!1,I=bh;else if(L>=s){var ke=f?null:zg(l);if(ke)return ua(ke);q=!1,I=bi,ae=new el}else ae=f?[]:Z;e:for(;++C<L;){var Re=l[C],je=f?f(Re):Re;if(Re=y||Re!==0?Re:0,q&&je===je){for(var Be=ae.length;Be--;)if(ae[Be]===je)continue e;f&&ae.push(je),Z.push(Re)}else I(ae,je,y)||(ae!==Z&&ae.push(je),Z.push(Re))}return Z}function Kd(l,f){f=ri(f,l);var y=-1,C=f.length;if(!C)return!0;for(var I=l==null||typeof l!="object"&&typeof l!="function";++y<C;){var L=f[y];if(typeof L=="string"){if(L==="__proto__"&&!ir.call(l,"__proto__"))return!1;if(L==="constructor"&&y+1<C&&typeof f[y+1]=="string"&&f[y+1]==="prototype"){if(I&&y===0)continue;return!1}}}var q=bn(l,f);return q==null||delete q[To(es(f))]}function Yh(l,f,y,C){return ll(l,f,y(Ni(l,f)),C)}function wu(l,f,y,C){for(var I=l.length,L=C?I:-1;(C?L--:++L<I)&&f(l[L],L,l););return y?Bn(l,C?0:L,C?L+1:I):Bn(l,C?L+1:0,C?I:L)}function fc(l,f){var y=l;return y instanceof Mt&&(y=y.value()),_h(f,function(C,I){return I.func.apply(I.thisArg,ca([C],I.args))},y)}function Yd(l,f,y){var C=l.length;if(C<2)return C?Ii(l[0]):[];for(var I=-1,L=ge(C);++I<C;)for(var q=l[I],Z=-1;++Z<C;)Z!=I&&(L[I]=Qo(L[I]||q,l[Z],f,y));return Ii(en(L,1),f,y)}function bu(l,f,y){for(var C=-1,I=l.length,L=f.length,q={};++C<I;){var Z=C<L?f[C]:t;y(q,l[C],Z)}return q}function hc(l){return mn(l)?l:[]}function Jd(l){return typeof l=="function"?l:po}function ri(l,f){return $t(l)?l:Ze(l,f)?[l]:pp(Nr(l))}var Fg=Bt;function Pi(l,f,y){var C=l.length;return y=y===t?C:y,!f&&y>=C?l:Bn(l,f,y)}var Jh=wg||function(l){return Br.clearTimeout(l)};function Xh(l,f){if(f)return l.slice();var y=l.length,C=Ih?Ih(y):new l.constructor(y);return l.copy(C),C}function _u(l){var f=new l.constructor(l.byteLength);return new iu(f).set(new iu(l)),f}function jg(l,f){var y=f?_u(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.byteLength)}function Og(l){var f=new l.constructor(l.source,ea.exec(l));return f.lastIndex=l.lastIndex,f}function Dg(l){return Ds?kr(Ds.call(l)):{}}function Lg(l,f){var y=f?_u(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.length)}function Qh(l,f){if(l!==f){var y=l!==t,C=l===null,I=l===l,L=Io(l),q=f!==t,Z=f===null,ae=f===f,ke=Io(f);if(!Z&&!ke&&!L&&l>f||L&&q&&ae&&!Z&&!ke||C&&q&&ae||!y&&ae||!I)return 1;if(!C&&!L&&!ke&&l<f||ke&&y&&I&&!C&&!L||Z&&y&&I||!q&&I||!ae)return-1}return 0}function A0(l,f,y){for(var C=-1,I=l.criteria,L=f.criteria,q=I.length,Z=y.length;++C<q;){var ae=Qh(I[C],L[C]);if(ae){if(C>=Z)return ae;var ke=y[C];return ae*(ke=="desc"?-1:1)}}return l.index-f.index}function Mg(l,f,y,C){for(var I=-1,L=l.length,q=y.length,Z=-1,ae=f.length,ke=ln(L-q,0),Re=ge(ae+ke),je=!C;++Z<ae;)Re[Z]=f[Z];for(;++I<q;)(je||I<L)&&(Re[y[I]]=l[I]);for(;ke--;)Re[Z++]=l[I++];return Re}function Zh(l,f,y,C){for(var I=-1,L=l.length,q=-1,Z=y.length,ae=-1,ke=f.length,Re=ln(L-Z,0),je=ge(Re+ke),Be=!C;++I<Re;)je[I]=l[I];for(var ht=I;++ae<ke;)je[ht+ae]=f[ae];for(;++q<Z;)(Be||I<L)&&(je[ht+y[q]]=l[I++]);return je}function Xn(l,f){var y=-1,C=l.length;for(f||(f=ge(C));++y<C;)f[y]=l[y];return f}function So(l,f,y,C){var I=!y;y||(y={});for(var L=-1,q=f.length;++L<q;){var Z=f[L],ae=C?C(y[Z],l[Z],Z,y,l):t;ae===t&&(ae=l[Z]),I?Xo(y,Z,ae):nl(y,Z,ae)}return y}function Xd(l,f){return So(l,Co(l),f)}function I0(l,f){return So(l,Bg(l),f)}function Qd(l,f){return function(y,C){var I=$t(y)?xh:Ls,L=f?f():{};return I(y,l,St(C,2),L)}}function pc(l){return Bt(function(f,y){var C=-1,I=y.length,L=I>1?y[I-1]:t,q=I>2?y[2]:t;for(L=l.length>3&&typeof L=="function"?(I--,L):t,q&&Zn(y[0],y[1],q)&&(L=I<3?t:L,I=1),f=kr(f);++C<I;){var Z=y[C];Z&&l(f,Z,C,L)}return f})}function lo(l,f){return function(y,C){if(y==null)return y;if(!fo(y))return l(y,C);for(var I=y.length,L=f?I:-1,q=kr(y);(f?L--:++L<I)&&C(q[L],L,q)!==!1;);return y}}function Zd(l){return function(f,y,C){for(var I=-1,L=kr(f),q=C(f),Z=q.length;Z--;){var ae=q[l?Z:++I];if(y(L[ae],ae,L)===!1)break}return f}}function ef(l,f,y){var C=f&T,I=mc(l);function L(){var q=this&&this!==Br&&this instanceof L?I:l;return q.apply(C?y:this,arguments)}return L}function ep(l){return function(f){f=Nr(f);var y=Kl(f)?Os(f):t,C=y?y[0]:f.charAt(0),I=y?Pi(y,1).join(""):f.slice(1);return C[l]()+I}}function cl(l){return function(f){return _h(rS(tS(f).replace(f0,"")),l,"")}}function mc(l){return function(){var f=arguments;switch(f.length){case 0:return new l;case 1:return new l(f[0]);case 2:return new l(f[0],f[1]);case 3:return new l(f[0],f[1],f[2]);case 4:return new l(f[0],f[1],f[2],f[3]);case 5:return new l(f[0],f[1],f[2],f[3],f[4]);case 6:return new l(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new l(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var y=nc(l.prototype),C=l.apply(y,f);return sn(C)?C:y}}function tp(l,f,y){var C=mc(l);function I(){for(var L=arguments.length,q=ge(L),Z=L,ae=Fi(I);Z--;)q[Z]=arguments[Z];var ke=L<3&&q[0]!==ae&&q[L-1]!==ae?[]:Zs(q,ae);if(L-=ke.length,L<y)return Qn(l,f,gc,I.placeholder,t,q,ke,t,t,y-L);var Re=this&&this!==Br&&this instanceof I?C:l;return Yn(Re,this,q)}return I}function ul(l){return function(f,y,C){var I=kr(f);if(!fo(f)){var L=St(y,3);f=Gn(f),y=function(Z){return L(I[Z],Z,I)}}var q=l(f,y,C);return q>-1?I[L?f[q]:q]:t}}function tf(l){return si(function(f){var y=f.length,C=y,I=Mn.prototype.thru;for(l&&f.reverse();C--;){var L=f[C];if(typeof L!="function")throw new eo(c);if(I&&!q&&vc(L)=="wrapper")var q=new Mn([],!0)}for(C=q?C:y;++C<y;){L=f[C];var Z=vc(L),ae=Z=="wrapper"?sf(L):t;ae&&Au(ae[0])&&ae[1]==($|j|U|Y)&&!ae[4].length&&ae[9]==1?q=q[vc(ae[0])].apply(q,ae[3]):q=L.length==1&&Au(L)?q[Z]():q.thru(L)}return function(){var ke=arguments,Re=ke[0];if(q&&ke.length==1&&$t(Re))return q.plant(Re).value();for(var je=0,Be=y?f[je].apply(this,ke):Re;++je<y;)Be=f[je].call(this,Be);return Be}})}function gc(l,f,y,C,I,L,q,Z,ae,ke){var Re=f&$,je=f&T,Be=f&R,ht=f&(j|P),Rt=f&J,Vt=Be?t:mc(l);function At(){for(var tr=arguments.length,lr=ge(tr),Po=tr;Po--;)lr[Po]=arguments[Po];if(ht)var zs=Fi(At),Fo=ug(lr,zs);if(C&&(lr=Mg(lr,C,I,ht)),L&&(lr=Zh(lr,L,q,ht)),tr-=Fo,ht&&tr<ke){var gn=Zs(lr,zs);return Qn(l,f,gc,At.placeholder,y,lr,gn,Z,ae,ke-tr)}var Li=je?y:this,xl=Be?Li[l]:l;return tr=lr.length,Z?lr=ko(lr,Z):Rt&&tr>1&&lr.reverse(),Re&&ae<tr&&(lr.length=ae),this&&this!==Br&&this instanceof At&&(xl=Vt||mc(xl)),xl.apply(Li,lr)}return At}function $g(l,f){return function(y,C){return Ti(y,l,f(C),{})}}function Eu(l,f){return function(y,C){var I;if(y===t&&C===t)return f;if(y!==t&&(I=y),C!==t){if(I===t)return C;typeof y=="string"||typeof C=="string"?(y=vs(y),C=vs(C)):(y=Kh(y),C=Kh(C)),I=l(y,C)}return I}}function rf(l){return si(function(f){return f=Fr(f,js(St())),Bt(function(y){var C=this;return l(f,function(I){return Yn(I,C,y)})})})}function Su(l,f){f=f===t?" ":vs(f);var y=f.length;if(y<2)return y?al(f,l):f;var C=al(f,Qa(l/Ja(f)));return Kl(f)?Pi(Os(C),0,l).join(""):C.slice(0,l)}function Ug(l,f,y,C){var I=f&T,L=mc(l);function q(){for(var Z=-1,ae=arguments.length,ke=-1,Re=C.length,je=ge(Re+ae),Be=this&&this!==Br&&this instanceof q?L:l;++ke<Re;)je[ke]=C[ke];for(;ae--;)je[ke++]=arguments[++Z];return Yn(Be,I?y:this,je)}return q}function rp(l){return function(f,y,C){return C&&typeof C!="number"&&Zn(f,y,C)&&(y=C=t),f=yl(f),y===t?(y=f,f=0):y=yl(y),C=C===t?f<y?1:-1:yl(C),xu(f,y,C,l)}}function nf(l){return function(f,y){return typeof f=="string"&&typeof y=="string"||(f=ii(f),y=ii(y)),l(f,y)}}function Qn(l,f,y,C,I,L,q,Z,ae,ke){var Re=f&j,je=Re?q:t,Be=Re?t:q,ht=Re?L:t,Rt=Re?t:L;f|=Re?U:B,f&=~(Re?B:U),f&A||(f&=-4);var Vt=[l,f,I,ht,je,Rt,Be,Z,ae,ke],At=y.apply(t,Vt);return Au(l)&&fp(At,Vt),At.placeholder=C,hp(At,l,f)}function Rn(l){var f=an[l];return function(y,C){if(y=ii(y),C=C==null?0:Ln(Gt(C),292),C&&Ql(y)){var I=(Nr(y)+"e").split("e"),L=f(I[0]+"e"+(+I[1]+C));return I=(Nr(L)+"e").split("e"),+(I[0]+"e"+(+I[1]-C))}return f(y)}}var zg=fa&&1/ua(new fa([,-0]))[1]==ee?function(l){return new fa(l)}:ox;function np(l){return function(f){var y=An(f);return y==Te?wd(f):y==et?S0(f):b0(f,l(f))}}function ni(l,f,y,C,I,L,q,Z){var ae=f&R;if(!ae&&typeof l!="function")throw new eo(c);var ke=C?C.length:0;if(ke||(f&=-97,C=I=t),q=q===t?q:ln(Gt(q),0),Z=Z===t?Z:Gt(Z),ke-=I?I.length:0,f&B){var Re=C,je=I;C=I=t}var Be=ae?t:sf(l),ht=[l,f,y,C,I,Re,je,L,q,Z];if(Be&&qg(ht,Be),l=ht[0],f=ht[1],y=ht[2],C=ht[3],I=ht[4],Z=ht[9]=ht[9]===t?ae?0:l.length:ln(ht[9]-ke,0),!Z&&f&(j|P)&&(f&=-25),!f||f==T)var Rt=ef(l,f,y);else f==j||f==P?Rt=tp(l,f,Z):(f==U||f==(T|U))&&!I.length?Rt=Ug(l,f,y,C):Rt=gc.apply(t,ht);var Vt=Be?Vd:fp;return hp(Vt(Rt,ht),l,f)}function sp(l,f,y,C){return l===t||Di(l,Vo[y])&&!ir.call(C,y)?f:l}function op(l,f,y,C,I,L){return sn(l)&&sn(f)&&(L.set(f,l),il(l,f,t,op,L),L.delete(f)),l}function ip(l){return Rp(l)?t:l}function ap(l,f,y,C,I,L){var q=y&N,Z=l.length,ae=f.length;if(Z!=ae&&!(q&&ae>Z))return!1;var ke=L.get(l),Re=L.get(f);if(ke&&Re)return ke==f&&Re==l;var je=-1,Be=!0,ht=y&S?new el:t;for(L.set(l,f),L.set(f,l);++je<Z;){var Rt=l[je],Vt=f[je];if(C)var At=q?C(Vt,Rt,je,f,l,L):C(Rt,Vt,je,l,f,L);if(At!==t){if(At)continue;Be=!1;break}if(ht){if(!Eh(f,function(tr,lr){if(!bi(ht,lr)&&(Rt===tr||I(Rt,tr,y,C,L)))return ht.push(lr)})){Be=!1;break}}else if(!(Rt===Vt||I(Rt,Vt,y,C,L))){Be=!1;break}}return L.delete(l),L.delete(f),Be}function lp(l,f,y,C,I,L,q){switch(y){case Pt:if(l.byteLength!=f.byteLength||l.byteOffset!=f.byteOffset)return!1;l=l.buffer,f=f.buffer;case tt:return!(l.byteLength!=f.byteLength||!L(new iu(l),new iu(f)));case ve:case le:case gt:return Di(+l,+f);case He:return l.name==f.name&&l.message==f.message;case er:case It:return l==f+"";case Te:var Z=wd;case et:var ae=C&N;if(Z||(Z=ua),l.size!=f.size&&!ae)return!1;var ke=q.get(l);if(ke)return ke==f;C|=S,q.set(l,f);var Re=ap(Z(l),Z(f),C,I,L,q);return q.delete(l),Re;case hr:if(Ds)return Ds.call(l)==Ds.call(f)}return!1}function Hg(l,f,y,C,I,L){var q=y&N,Z=Cu(l),ae=Z.length,ke=Cu(f),Re=ke.length;if(ae!=Re&&!q)return!1;for(var je=ae;je--;){var Be=Z[je];if(!(q?Be in f:ir.call(f,Be)))return!1}var ht=L.get(l),Rt=L.get(f);if(ht&&Rt)return ht==f&&Rt==l;var Vt=!0;L.set(l,f),L.set(f,l);for(var At=q;++je<ae;){Be=Z[je];var tr=l[Be],lr=f[Be];if(C)var Po=q?C(lr,tr,Be,f,l,L):C(tr,lr,Be,l,f,L);if(!(Po===t?tr===lr||I(tr,lr,y,C,L):Po)){Vt=!1;break}At||(At=Be=="constructor")}if(Vt&&!At){var zs=l.constructor,Fo=f.constructor;zs!=Fo&&"constructor"in l&&"constructor"in f&&!(typeof zs=="function"&&zs instanceof zs&&typeof Fo=="function"&&Fo instanceof Fo)&&(Vt=!1)}return L.delete(l),L.delete(f),Vt}function si(l){return $s(cf(l,t,ff),l+"")}function Cu(l){return Ud(l,Gn,Co)}function ku(l){return Ud(l,ho,Bg)}var sf=Id?function(l){return Id.get(l)}:ox;function vc(l){for(var f=l.name+"",y=tc[f],C=ir.call(tc,f)?y.length:0;C--;){var I=y[C],L=I.func;if(L==null||L==l)return I.name}return f}function Fi(l){var f=ir.call(O,"placeholder")?O:l;return f.placeholder}function St(){var l=O.iteratee||nx;return l=l===nx?cc:l,arguments.length?l(arguments[0],arguments[1]):l}function Nu(l,f){var y=l.__data__;return yc(f)?y[typeof f=="string"?"string":"hash"]:y.map}function Tu(l){for(var f=Gn(l),y=f.length;y--;){var C=f[y],I=l[C];f[y]=[C,I,Iu(I)]}return f}function ba(l,f){var y=ql(l,f);return Uh(y)?y:t}function of(l){var f=ir.call(l,Xa),y=l[Xa];try{l[Xa]=t;var C=!0}catch{}var I=su.call(l);return C&&(f?l[Xa]=y:delete l[Xa]),I}var Co=Td?function(l){return l==null?[]:(l=kr(l),la(Td(l),function(f){return kd.call(l,f)}))}:ix,Bg=Td?function(l){for(var f=[];l;)ca(f,Co(l)),l=_o(l);return f}:ix,An=Tn;(cu&&An(new cu(new ArrayBuffer(1)))!=Pt||Za&&An(new Za)!=Te||uu&&An(uu.resolve())!=Ut||fa&&An(new fa)!=et||du&&An(new du)!=Xe)&&(An=function(l){var f=Tn(l),y=f==ot?l.constructor:t,C=y?_a(y):"";if(C)switch(C){case jh:return Pt;case ha:return Te;case _g:return Ut;case rc:return et;case qo:return Xe}return f});function cp(l,f,y){for(var C=-1,I=y.length;++C<I;){var L=y[C],q=L.size;switch(L.type){case"drop":l+=q;break;case"dropRight":f-=q;break;case"take":f=Ln(f,l+q);break;case"takeRight":l=ln(l,f-q);break}}return{start:l,end:f}}function Gg(l){var f=l.match(Ho);return f?f[1].split(vi):[]}function up(l,f,y){f=ri(f,l);for(var C=-1,I=f.length,L=!1;++C<I;){var q=To(f[C]);if(!(L=l!=null&&y(l,q)))break;l=l[q]}return L||++C!=I?L:(I=l==null?0:l.length,!!I&&uv(I)&&Wr(q,I)&&($t(l)||$u(l)))}function Ru(l){var f=l.length,y=new l.constructor(f);return f&&typeof l[0]=="string"&&ir.call(l,"index")&&(y.index=l.index,y.input=l.input),y}function In(l){return typeof l.constructor=="function"&&!ji(l)?nc(_o(l)):{}}function P0(l,f,y){var C=l.constructor;switch(f){case tt:return _u(l);case ve:case le:return new C(+l);case Pt:return jg(l,y);case Er:case Dr:case lt:case kt:case de:case Ie:case Ge:case ut:case Ft:return Lg(l,y);case Te:return new C;case gt:case It:return new C(l);case er:return Og(l);case et:return new C;case hr:return Dg(l)}}function F0(l,f){var y=f.length;if(!y)return l;var C=y-1;return f[C]=(y>1?"& ":"")+f[C],f=f.join(y>2?", ":" "),l.replace(cs,`{
/* [wrapped with `+f+`] */
`)}function af(l){return $t(l)||$u(l)||!!(xg&&l&&l[xg])}function Wr(l,f){var y=typeof l;return f=f??G,!!f&&(y=="number"||y!="symbol"&&Q.test(l))&&l>-1&&l%1==0&&l<f}function Zn(l,f,y){if(!sn(y))return!1;var C=typeof f;return(C=="number"?fo(y)&&Wr(f,y.length):C=="string"&&f in y)?Di(y[f],l):!1}function Ze(l,f){if($t(l))return!1;var y=typeof l;return y=="number"||y=="symbol"||y=="boolean"||l==null||Io(l)?!0:Xi.test(l)||!gi.test(l)||f!=null&&l in kr(f)}function yc(l){var f=typeof l;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?l!=="__proto__":l===null}function Au(l){var f=vc(l),y=O[f];if(typeof y!="function"||!(f in Mt.prototype))return!1;if(l===y)return!0;var C=sf(y);return!!C&&l===C[0]}function Wg(l){return!!Ed&&Ed in l}var j0=Jl?vl:ax;function ji(l){var f=l&&l.constructor,y=typeof f=="function"&&f.prototype||Vo;return l===y}function Iu(l){return l===l&&!sn(l)}function lf(l,f){return function(y){return y==null?!1:y[l]===f&&(f!==t||l in kr(y))}}function Vg(l){var f=me(l,function(C){return y.size===m&&y.clear(),C}),y=f.cache;return f}function qg(l,f){var y=l[1],C=f[1],I=y|C,L=I<(T|R|$),q=C==$&&y==j||C==$&&y==Y&&l[7].length<=f[8]||C==($|Y)&&f[7].length<=f[8]&&y==j;if(!(L||q))return l;C&T&&(l[2]=f[2],I|=y&T?0:A);var Z=f[3];if(Z){var ae=l[3];l[3]=ae?Mg(ae,Z,f[4]):Z,l[4]=ae?Zs(l[3],g):f[4]}return Z=f[5],Z&&(ae=l[5],l[5]=ae?Zh(ae,Z,f[6]):Z,l[6]=ae?Zs(l[5],g):f[6]),Z=f[7],Z&&(l[7]=Z),C&$&&(l[8]=l[8]==null?f[8]:Ln(l[8],f[8])),l[9]==null&&(l[9]=f[9]),l[0]=f[0],l[1]=I,l}function Kg(l){var f=[];if(l!=null)for(var y in kr(l))f.push(y);return f}function dp(l){return su.call(l)}function cf(l,f,y){return f=ln(f===t?l.length-1:f,0),function(){for(var C=arguments,I=-1,L=ln(C.length-f,0),q=ge(L);++I<L;)q[I]=C[f+I];I=-1;for(var Z=ge(f+1);++I<f;)Z[I]=C[I];return Z[f]=y(q),Yn(l,this,Z)}}function bn(l,f){return f.length<2?l:Ni(l,Bn(f,0,-1))}function ko(l,f){for(var y=l.length,C=Ln(f.length,y),I=Xn(l);C--;){var L=f[C];l[C]=Wr(L,y)?I[L]:t}return l}function oi(l,f){if(!(f==="constructor"&&typeof l[f]=="function")&&f!="__proto__")return l[f]}var fp=No(Vd),xc=Ph||function(l,f){return Br.setTimeout(l,f)},$s=No(ti);function hp(l,f,y){var C=f+"";return $s(l,F0(C,Yg(Gg(C),y)))}function No(l){var f=0,y=0;return function(){var C=R0(),I=we-(C-y);if(y=C,I>0){if(++f>=ue)return arguments[0]}else f=0;return l.apply(t,arguments)}}function uf(l,f){var y=-1,C=l.length,I=C-1;for(f=f===t?C:f;++y<f;){var L=uc(y,I),q=l[L];l[L]=l[y],l[y]=q}return l.length=f,l}var pp=Vg(function(l){var f=[];return l.charCodeAt(0)===46&&f.push(""),l.replace(Xs,function(y,C,I,L){f.push(I?L.replace(us,"$1"):C||y)}),f});function To(l){if(typeof l=="string"||Io(l))return l;var f=l+"";return f=="0"&&1/l==-ee?"-0":f}function _a(l){if(l!=null){try{return nu.call(l)}catch{}try{return l+""}catch{}}return""}function Yg(l,f){return Dn(Ee,function(y){var C="_."+y[0];f&y[1]&&!vd(l,C)&&l.push(C)}),l.sort()}function Jg(l){if(l instanceof Mt)return l.clone();var f=new Mn(l.__wrapped__,l.__chain__);return f.__actions__=Xn(l.__actions__),f.__index__=l.__index__,f.__values__=l.__values__,f}function df(l,f,y){(y?Zn(l,f,y):f===t)?f=1:f=ln(Gt(f),0);var C=l==null?0:l.length;if(!C||f<1)return[];for(var I=0,L=0,q=ge(Qa(C/f));I<C;)q[L++]=Bn(l,I,I+=f);return q}function mp(l){for(var f=-1,y=l==null?0:l.length,C=0,I=[];++f<y;){var L=l[f];L&&(I[C++]=L)}return I}function co(){var l=arguments.length;if(!l)return[];for(var f=ge(l-1),y=arguments[0],C=l;C--;)f[C-1]=arguments[C];return ca($t(y)?Xn(y):[y],en(f,1))}var ar=Bt(function(l,f){return mn(l)?Qo(l,en(f,1,mn,!0)):[]}),_n=Bt(function(l,f){var y=es(f);return mn(y)&&(y=t),mn(l)?Qo(l,en(f,1,mn,!0),St(y,2)):[]}),cn=Bt(function(l,f){var y=es(f);return mn(y)&&(y=t),mn(l)?Qo(l,en(f,1,mn,!0),t,y):[]});function Pn(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Gt(f),Bn(l,f<0?0:f,C)):[]}function Us(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Gt(f),f=C-f,Bn(l,0,f<0?0:f)):[]}function wc(l,f){return l&&l.length?wu(l,St(f,3),!0,!0):[]}function pn(l,f){return l&&l.length?wu(l,St(f,3),!0):[]}function Pu(l,f,y,C){var I=l==null?0:l.length;return I?(y&&typeof y!="number"&&Zn(l,f,y)&&(y=0,C=I),Ag(l,f,y,C)):[]}function Ea(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=y==null?0:Gt(y);return I<0&&(I=ln(C+I,0)),yd(l,St(f,3),I)}function Fu(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=C-1;return y!==t&&(I=Gt(y),I=y<0?ln(C+I,0):Ln(I,C-1)),yd(l,St(f,3),I,!0)}function ff(l){var f=l==null?0:l.length;return f?en(l,1):[]}function ju(l){var f=l==null?0:l.length;return f?en(l,ee):[]}function ys(l,f){var y=l==null?0:l.length;return y?(f=f===t?1:Gt(f),en(l,f)):[]}function gp(l){for(var f=-1,y=l==null?0:l.length,C={};++f<y;){var I=l[f];C[I[0]]=I[1]}return C}function dl(l){return l&&l.length?l[0]:t}function Oi(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=y==null?0:Gt(y);return I<0&&(I=ln(C+I,0)),Vl(l,f,I)}function hf(l){var f=l==null?0:l.length;return f?Bn(l,0,-1):[]}var vp=Bt(function(l){var f=Fr(l,hc);return f.length&&f[0]===l[0]?zd(f):[]}),Sa=Bt(function(l){var f=es(l),y=Fr(l,hc);return f===es(y)?f=t:y.pop(),y.length&&y[0]===l[0]?zd(y,St(f,2)):[]}),pf=Bt(function(l){var f=es(l),y=Fr(l,hc);return f=typeof f=="function"?f:t,f&&y.pop(),y.length&&y[0]===l[0]?zd(y,t,f):[]});function Ca(l,f){return l==null?"":Rd.call(l,f)}function es(l){var f=l==null?0:l.length;return f?l[f-1]:t}function Ou(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=C;return y!==t&&(I=Gt(y),I=I<0?ln(C+I,0):Ln(I,C-1)),f===f?C0(l,f,I):yd(l,og,I,!0)}function yp(l,f){return l&&l.length?Wd(l,Gt(f)):t}var mf=Bt(Du);function Du(l,f){return l&&l.length&&f&&f.length?rn(l,f):l}function ts(l,f,y){return l&&l.length&&f&&f.length?rn(l,f,St(y,2)):l}function ka(l,f,y){return l&&l.length&&f&&f.length?rn(l,f,t,y):l}var Ro=si(function(l,f){var y=l==null?0:l.length,C=Md(l,f);return hn(l,Fr(f,function(I){return Wr(I,y)?+I:I}).sort(Qh)),C});function xs(l,f){var y=[];if(!(l&&l.length))return y;var C=-1,I=[],L=l.length;for(f=St(f,3);++C<L;){var q=l[C];f(q,C,l)&&(y.push(q),I.push(C))}return hn(l,I),y}function gf(l){return l==null?l:Ad.call(l)}function xp(l,f,y){var C=l==null?0:l.length;return C?(y&&typeof y!="number"&&Zn(l,f,y)?(f=0,y=C):(f=f==null?0:Gt(f),y=y===t?C:Gt(y)),Bn(l,f,y)):[]}function wp(l,f){return dc(l,f)}function O0(l,f,y){return qd(l,f,St(y,2))}function Na(l,f){var y=l==null?0:l.length;if(y){var C=dc(l,f);if(C<y&&Di(l[C],f))return C}return-1}function Xg(l,f){return dc(l,f,!0)}function bp(l,f,y){return qd(l,f,St(y,2),!0)}function fl(l,f){var y=l==null?0:l.length;if(y){var C=dc(l,f,!0)-1;if(Di(l[C],f))return C}return-1}function _p(l){return l&&l.length?qh(l):[]}function hl(l,f){return l&&l.length?qh(l,St(f,2)):[]}function Qg(l){var f=l==null?0:l.length;return f?Bn(l,1,f):[]}function Zg(l,f,y){return l&&l.length?(f=y||f===t?1:Gt(f),Bn(l,0,f<0?0:f)):[]}function Ep(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Gt(f),f=C-f,Bn(l,f<0?0:f,C)):[]}function vf(l,f){return l&&l.length?wu(l,St(f,3),!1,!0):[]}function D0(l,f){return l&&l.length?wu(l,St(f,3)):[]}var L0=Bt(function(l){return Ii(en(l,1,mn,!0))}),ev=Bt(function(l){var f=es(l);return mn(f)&&(f=t),Ii(en(l,1,mn,!0),St(f,2))}),tv=Bt(function(l){var f=es(l);return f=typeof f=="function"?f:t,Ii(en(l,1,mn,!0),t,f)});function pl(l){return l&&l.length?Ii(l):[]}function M0(l,f){return l&&l.length?Ii(l,St(f,2)):[]}function bc(l,f){return f=typeof f=="function"?f:t,l&&l.length?Ii(l,t,f):[]}function yf(l){if(!(l&&l.length))return[];var f=0;return l=la(l,function(y){if(mn(y))return f=ln(y.length,f),!0}),Nh(f,function(y){return Fr(l,Ch(y))})}function Yr(l,f){if(!(l&&l.length))return[];var y=yf(l);return f==null?y:Fr(y,function(C){return Yn(f,t,C)})}var $0=Bt(function(l,f){return mn(l)?Qo(l,f):[]}),rv=Bt(function(l){return Yd(la(l,mn))}),U0=Bt(function(l){var f=es(l);return mn(f)&&(f=t),Yd(la(l,mn),St(f,2))}),z0=Bt(function(l){var f=es(l);return f=typeof f=="function"?f:t,Yd(la(l,mn),t,f)}),nv=Bt(yf);function sv(l,f){return bu(l||[],f||[],nl)}function H0(l,f){return bu(l||[],f||[],ll)}var uo=Bt(function(l){var f=l.length,y=f>1?l[f-1]:t;return y=typeof y=="function"?(l.pop(),y):t,Yr(l,y)});function xf(l){var f=O(l);return f.__chain__=!0,f}function B0(l,f){return f(l),l}function Ao(l,f){return f(l)}var wf=si(function(l){var f=l.length,y=f?l[0]:0,C=this.__wrapped__,I=function(L){return Md(L,l)};return f>1||this.__actions__.length||!(C instanceof Mt)||!Wr(y)?this.thru(I):(C=C.slice(y,+y+(f?1:0)),C.__actions__.push({func:Ao,args:[I],thisArg:t}),new Mn(C,this.__chain__).thru(function(L){return f&&!L.length&&L.push(t),L}))});function ml(){return xf(this)}function bf(){return new Mn(this.value(),this.__chain__)}function Sp(){this.__values__===t&&(this.__values__=VE(this.value()));var l=this.__index__>=this.__values__.length,f=l?t:this.__values__[this.__index__++];return{done:l,value:f}}function Cp(){return this}function G0(l){for(var f,y=this;y instanceof Ko;){var C=Jg(y);C.__index__=0,C.__values__=t,f?I.__wrapped__=C:f=C;var I=C;y=y.__wrapped__}return I.__wrapped__=l,f}function kp(){var l=this.__wrapped__;if(l instanceof Mt){var f=l;return this.__actions__.length&&(f=new Mt(this)),f=f.reverse(),f.__actions__.push({func:Ao,args:[gf],thisArg:t}),new Mn(f,this.__chain__)}return this.thru(gf)}function W0(){return fc(this.__wrapped__,this.__actions__)}var ov=Qd(function(l,f,y){ir.call(l,y)?++l[y]:Xo(l,y,1)});function iv(l,f,y){var C=$t(l)?wh:pu;return y&&Zn(l,f,y)&&(f=t),C(l,St(f,3))}function _f(l,f){var y=$t(l)?la:Mh;return y(l,St(f,3))}var Ef=ul(Ea),av=ul(Fu);function Np(l,f){return en(gl(l,f),1)}function V0(l,f){return en(gl(l,f),ee)}function lv(l,f,y){return y=y===t?1:Gt(y),en(gl(l,f),y)}function Sf(l,f){var y=$t(l)?Dn:Zo;return y(l,St(f,3))}function Lu(l,f){var y=$t(l)?gd:Rg;return y(l,St(f,3))}var Tp=Qd(function(l,f,y){ir.call(l,y)?l[y].push(f):Xo(l,y,[f])});function Cf(l,f,y,C){l=fo(l)?l:Tf(l),y=y&&!C?Gt(y):0;var I=l.length;return y<0&&(y=ln(I+y,0)),dv(l)?y<=I&&l.indexOf(f,y)>-1:!!I&&Vl(l,f,y)>-1}var cv=Bt(function(l,f,y){var C=-1,I=typeof f=="function",L=fo(l)?ge(l.length):[];return Zo(l,function(q){L[++C]=I?Yn(f,q,y):oo(q,f,y)}),L}),q0=Qd(function(l,f,y){Xo(l,y,f)});function gl(l,f){var y=$t(l)?Fr:Hh;return y(l,St(f,3))}function K0(l,f,y,C){return l==null?[]:($t(f)||(f=f==null?[]:[f]),y=C?t:y,$t(y)||(y=y==null?[]:[y]),yu(l,f,y))}var Mu=Qd(function(l,f,y){l[y?0:1].push(f)},function(){return[[],[]]});function Y0(l,f,y){var C=$t(l)?_h:ag,I=arguments.length<3;return C(l,St(f,4),y,I,Zo)}function kf(l,f,y){var C=$t(l)?v0:ag,I=arguments.length<3;return C(l,St(f,4),y,I,Rg)}function o(l,f){var y=$t(l)?la:Mh;return y(l,Le(St(f,3)))}function a(l){var f=$t(l)?Jo:Hn;return f(l)}function h(l,f,y){(y?Zn(l,f,y):f===t)?f=1:f=Gt(f);var C=$t(l)?rl:Wh;return C(l,f)}function v(l){var f=$t(l)?Ng:ao;return f(l)}function _(l){if(l==null)return 0;if(fo(l))return dv(l)?Ja(l):l.length;var f=An(l);return f==Te||f==et?l.size:Ai(l).length}function k(l,f,y){var C=$t(l)?Eh:Vh;return y&&Zn(l,f,y)&&(f=t),C(l,St(f,3))}var F=Bt(function(l,f){if(l==null)return[];var y=f.length;return y>1&&Zn(l,f[0],f[1])?f=[]:y>2&&Zn(f[0],f[1],f[2])&&(f=[f[0]]),yu(l,en(f,1),[])}),W=Lr||function(){return Br.Date.now()};function X(l,f){if(typeof f!="function")throw new eo(c);return l=Gt(l),function(){if(--l<1)return f.apply(this,arguments)}}function ye(l,f,y){return f=y?t:f,f=l&&f==null?l.length:f,ni(l,$,t,t,t,t,f)}function Fe(l,f){var y;if(typeof f!="function")throw new eo(c);return l=Gt(l),function(){return--l>0&&(y=f.apply(this,arguments)),l<=1&&(f=t),y}}var Oe=Bt(function(l,f,y){var C=T;if(y.length){var I=Zs(y,Fi(Oe));C|=U}return ni(l,C,f,y,I)}),Pe=Bt(function(l,f,y){var C=T|R;if(y.length){var I=Zs(y,Fi(Pe));C|=U}return ni(f,C,l,y,I)});function Ye(l,f,y){f=y?t:f;var C=ni(l,j,t,t,t,t,t,f);return C.placeholder=Ye.placeholder,C}function rt(l,f,y){f=y?t:f;var C=ni(l,P,t,t,t,t,t,f);return C.placeholder=rt.placeholder,C}function st(l,f,y){var C,I,L,q,Z,ae,ke=0,Re=!1,je=!1,Be=!0;if(typeof l!="function")throw new eo(c);f=ii(f)||0,sn(y)&&(Re=!!y.leading,je="maxWait"in y,L=je?ln(ii(y.maxWait)||0,f):L,Be="trailing"in y?!!y.trailing:Be);function ht(gn){var Li=C,xl=I;return C=I=t,ke=gn,q=l.apply(xl,Li),q}function Rt(gn){return ke=gn,Z=xc(tr,f),Re?ht(gn):q}function Vt(gn){var Li=gn-ae,xl=gn-ke,oS=f-Li;return je?Ln(oS,L-xl):oS}function At(gn){var Li=gn-ae,xl=gn-ke;return ae===t||Li>=f||Li<0||je&&xl>=L}function tr(){var gn=W();if(At(gn))return lr(gn);Z=xc(tr,Vt(gn))}function lr(gn){return Z=t,Be&&C?ht(gn):(C=I=t,q)}function Po(){Z!==t&&Jh(Z),ke=0,C=ae=I=Z=t}function zs(){return Z===t?q:lr(W())}function Fo(){var gn=W(),Li=At(gn);if(C=arguments,I=this,ae=gn,Li){if(Z===t)return Rt(ae);if(je)return Jh(Z),Z=xc(tr,f),ht(ae)}return Z===t&&(Z=xc(tr,f)),q}return Fo.cancel=Po,Fo.flush=zs,Fo}var nn=Bt(function(l,f){return Lh(l,1,f)}),fe=Bt(function(l,f,y){return Lh(l,ii(f)||0,y)});function re(l){return ni(l,J)}function me(l,f){if(typeof l!="function"||f!=null&&typeof f!="function")throw new eo(c);var y=function(){var C=arguments,I=f?f.apply(this,C):C[0],L=y.cache;if(L.has(I))return L.get(I);var q=l.apply(this,C);return y.cache=L.set(I,q)||L,q};return y.cache=new(me.Cache||to),y}me.Cache=to;function Le(l){if(typeof l!="function")throw new eo(c);return function(){var f=arguments;switch(f.length){case 0:return!l.call(this);case 1:return!l.call(this,f[0]);case 2:return!l.call(this,f[0],f[1]);case 3:return!l.call(this,f[0],f[1],f[2])}return!l.apply(this,f)}}function ct(l){return Fe(2,l)}var bt=Fg(function(l,f){f=f.length==1&&$t(f[0])?Fr(f[0],js(St())):Fr(en(f,1),js(St()));var y=f.length;return Bt(function(C){for(var I=-1,L=Ln(C.length,y);++I<L;)C[I]=f[I].call(this,C[I]);return Yn(l,this,C)})}),vt=Bt(function(l,f){var y=Zs(f,Fi(vt));return ni(l,U,t,f,y)}),Tt=Bt(function(l,f){var y=Zs(f,Fi(Tt));return ni(l,B,t,f,y)}),En=si(function(l,f){return ni(l,Y,t,t,t,f)});function dr(l,f){if(typeof l!="function")throw new eo(c);return f=f===t?f:Gt(f),Bt(l,f)}function Ta(l,f){if(typeof l!="function")throw new eo(c);return f=f==null?0:ln(Gt(f),0),Bt(function(y){var C=y[f],I=Pi(y,0,f);return C&&ca(I,C),Yn(l,this,I)})}function J0(l,f,y){var C=!0,I=!0;if(typeof l!="function")throw new eo(c);return sn(y)&&(C="leading"in y?!!y.leading:C,I="trailing"in y?!!y.trailing:I),st(l,f,{leading:C,maxWait:f,trailing:I})}function oF(l){return ye(l,1)}function iF(l,f){return vt(Jd(f),l)}function aF(){if(!arguments.length)return[];var l=arguments[0];return $t(l)?l:[l]}function lF(l){return gs(l,E)}function cF(l,f){return f=typeof f=="function"?f:t,gs(l,E,f)}function uF(l){return gs(l,x|E)}function dF(l,f){return f=typeof f=="function"?f:t,gs(l,x|E,f)}function fF(l,f){return f==null||hu(l,f,Gn(f))}function Di(l,f){return l===f||l!==l&&f!==f}var hF=nf(ya),pF=nf(function(l,f){return l>=f}),$u=Hd((function(){return arguments})())?Hd:function(l){return un(l)&&ir.call(l,"callee")&&!kd.call(l,"callee")},$t=ge.isArray,mF=yh?js(yh):Ig;function fo(l){return l!=null&&uv(l.length)&&!vl(l)}function mn(l){return un(l)&&fo(l)}function gF(l){return l===!0||l===!1||un(l)&&Tn(l)==ve}var _c=Fh||ax,vF=fs?js(fs):Ri;function yF(l){return un(l)&&l.nodeType===1&&!Rp(l)}function xF(l){if(l==null)return!0;if(fo(l)&&($t(l)||typeof l=="string"||typeof l.splice=="function"||_c(l)||Nf(l)||$u(l)))return!l.length;var f=An(l);if(f==Te||f==et)return!l.size;if(ji(l))return!Ai(l).length;for(var y in l)if(ir.call(l,y))return!1;return!0}function wF(l,f){return io(l,f)}function bF(l,f,y){y=typeof y=="function"?y:t;var C=y?y(l,f):t;return C===t?io(l,f,t,y):!!C}function X0(l){if(!un(l))return!1;var f=Tn(l);return f==He||f==Ne||typeof l.message=="string"&&typeof l.name=="string"&&!Rp(l)}function _F(l){return typeof l=="number"&&Ql(l)}function vl(l){if(!sn(l))return!1;var f=Tn(l);return f==Ue||f==Me||f==xe||f==Zt}function HE(l){return typeof l=="number"&&l==Gt(l)}function uv(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=G}function sn(l){var f=typeof l;return l!=null&&(f=="object"||f=="function")}function un(l){return l!=null&&typeof l=="object"}var BE=Ya?js(Ya):Pg;function EF(l,f){return l===f||lc(l,f,Tu(f))}function SF(l,f,y){return y=typeof y=="function"?y:t,lc(l,f,Tu(f),y)}function CF(l){return GE(l)&&l!=+l}function kF(l){if(j0(l))throw new Ot(i);return Uh(l)}function NF(l){return l===null}function TF(l){return l==null}function GE(l){return typeof l=="number"||un(l)&&Tn(l)==gt}function Rp(l){if(!un(l)||Tn(l)!=ot)return!1;var f=_o(l);if(f===null)return!0;var y=ir.call(f,"constructor")&&f.constructor;return typeof y=="function"&&y instanceof y&&nu.call(y)==Sd}var Q0=md?js(md):gu;function RF(l){return HE(l)&&l>=-G&&l<=G}var WE=Wl?js(Wl):ei;function dv(l){return typeof l=="string"||!$t(l)&&un(l)&&Tn(l)==It}function Io(l){return typeof l=="symbol"||un(l)&&Tn(l)==hr}var Nf=rg?js(rg):vu;function AF(l){return l===t}function IF(l){return un(l)&&An(l)==Xe}function PF(l){return un(l)&&Tn(l)==pt}var FF=nf(xa),jF=nf(function(l,f){return l<=f});function VE(l){if(!l)return[];if(fo(l))return dv(l)?Os(l):Xn(l);if(Si&&l[Si])return E0(l[Si]());var f=An(l),y=f==Te?wd:f==et?ua:Tf;return y(l)}function yl(l){if(!l)return l===0?l:0;if(l=ii(l),l===ee||l===-ee){var f=l<0?-1:1;return f*z}return l===l?l:0}function Gt(l){var f=yl(l),y=f%1;return f===f?y?f-y:f:0}function qE(l){return l?ki(Gt(l),0,D):0}function ii(l){if(typeof l=="number")return l;if(Io(l))return K;if(sn(l)){var f=typeof l.valueOf=="function"?l.valueOf():l;l=sn(f)?f+"":f}if(typeof l!="string")return l===0?l:+l;l=lg(l);var y=ra.test(l);return y||it.test(l)?hd(l.slice(2),y?2:8):ta.test(l)?K:+l}function KE(l){return So(l,ho(l))}function OF(l){return l?ki(Gt(l),-G,G):l===0?l:0}function Nr(l){return l==null?"":vs(l)}var DF=pc(function(l,f){if(ji(f)||fo(f)){So(f,Gn(f),l);return}for(var y in f)ir.call(f,y)&&nl(l,y,f[y])}),YE=pc(function(l,f){So(f,ho(f),l)}),fv=pc(function(l,f,y,C){So(f,ho(f),l,C)}),LF=pc(function(l,f,y,C){So(f,Gn(f),l,C)}),MF=si(Md);function $F(l,f){var y=nc(l);return f==null?y:$r(y,f)}var UF=Bt(function(l,f){l=kr(l);var y=-1,C=f.length,I=C>2?f[2]:t;for(I&&Zn(f[0],f[1],I)&&(C=1);++y<C;)for(var L=f[y],q=ho(L),Z=-1,ae=q.length;++Z<ae;){var ke=q[Z],Re=l[ke];(Re===t||Di(Re,Vo[ke])&&!ir.call(l,ke))&&(l[ke]=L[ke])}return l}),zF=Bt(function(l){return l.push(t,op),Yn(JE,t,l)});function HF(l,f){return sg(l,St(f,3),Ms)}function BF(l,f){return sg(l,St(f,3),va)}function GF(l,f){return l==null?l:$d(l,St(f,3),ho)}function WF(l,f){return l==null?l:mu(l,St(f,3),ho)}function VF(l,f){return l&&Ms(l,St(f,3))}function qF(l,f){return l&&va(l,St(f,3))}function KF(l){return l==null?[]:ac(l,Gn(l))}function YF(l){return l==null?[]:ac(l,ho(l))}function Z0(l,f,y){var C=l==null?t:Ni(l,f);return C===t?y:C}function JF(l,f){return l!=null&&up(l,f,so)}function ex(l,f){return l!=null&&up(l,f,ol)}var XF=$g(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=su.call(f)),l[f]=y},rx(po)),QF=$g(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=su.call(f)),ir.call(l,f)?l[f].push(y):l[f]=[y]},St),ZF=Bt(oo);function Gn(l){return fo(l)?Yo(l):Ai(l)}function ho(l){return fo(l)?Yo(l,!0):zh(l)}function ej(l,f){var y={};return f=St(f,3),Ms(l,function(C,I,L){Xo(y,f(C,I,L),C)}),y}function tj(l,f){var y={};return f=St(f,3),Ms(l,function(C,I,L){Xo(y,I,f(C,I,L))}),y}var rj=pc(function(l,f,y){il(l,f,y)}),JE=pc(function(l,f,y,C){il(l,f,y,C)}),nj=si(function(l,f){var y={};if(l==null)return y;var C=!1;f=Fr(f,function(L){return L=ri(L,l),C||(C=L.length>1),L}),So(l,ku(l),y),C&&(y=gs(y,x|b|E,ip));for(var I=f.length;I--;)Kd(y,f[I]);return y});function sj(l,f){return XE(l,Le(St(f)))}var oj=si(function(l,f){return l==null?{}:Gh(l,f)});function XE(l,f){if(l==null)return{};var y=Fr(ku(l),function(C){return[C]});return f=St(f),wa(l,y,function(C,I){return f(C,I[0])})}function ij(l,f,y){f=ri(f,l);var C=-1,I=f.length;for(I||(I=1,l=t);++C<I;){var L=l==null?t:l[To(f[C])];L===t&&(C=I,L=y),l=vl(L)?L.call(l):L}return l}function aj(l,f,y){return l==null?l:ll(l,f,y)}function lj(l,f,y,C){return C=typeof C=="function"?C:t,l==null?l:ll(l,f,y,C)}var QE=np(Gn),ZE=np(ho);function cj(l,f,y){var C=$t(l),I=C||_c(l)||Nf(l);if(f=St(f,4),y==null){var L=l&&l.constructor;I?y=C?new L:[]:sn(l)?y=vl(L)?nc(_o(l)):{}:y={}}return(I?Dn:Ms)(l,function(q,Z,ae){return f(y,q,Z,ae)}),y}function uj(l,f){return l==null?!0:Kd(l,f)}function dj(l,f,y){return l==null?l:Yh(l,f,Jd(y))}function fj(l,f,y,C){return C=typeof C=="function"?C:t,l==null?l:Yh(l,f,Jd(y),C)}function Tf(l){return l==null?[]:tu(l,Gn(l))}function hj(l){return l==null?[]:tu(l,ho(l))}function pj(l,f,y){return y===t&&(y=f,f=t),y!==t&&(y=ii(y),y=y===y?y:0),f!==t&&(f=ii(f),f=f===f?f:0),ki(ii(l),f,y)}function mj(l,f,y){return f=yl(f),y===t?(y=f,f=0):y=yl(y),l=ii(l),$h(l,f,y)}function gj(l,f,y){if(y&&typeof y!="boolean"&&Zn(l,f,y)&&(f=y=t),y===t&&(typeof f=="boolean"?(y=f,f=t):typeof l=="boolean"&&(y=l,l=t)),l===t&&f===t?(l=0,f=1):(l=yl(l),f===t?(f=l,l=0):f=yl(f)),l>f){var C=l;l=f,f=C}if(y||l%1||f%1){var I=lu();return Ln(l+I*(f-l+gh("1e-"+((I+"").length-1))),f)}return uc(l,f)}var vj=cl(function(l,f,y){return f=f.toLowerCase(),l+(y?eS(f):f)});function eS(l){return tx(Nr(l).toLowerCase())}function tS(l){return l=Nr(l),l&&l.replace(De,dg).replace(Qm,"")}function yj(l,f,y){l=Nr(l),f=vs(f);var C=l.length;y=y===t?C:ki(Gt(y),0,C);var I=y;return y-=f.length,y>=0&&l.slice(y,I)==f}function xj(l){return l=Nr(l),l&&As.test(l)?l.replace(as,fg):l}function wj(l){return l=Nr(l),l&&Qs.test(l)?l.replace(bo,"\\$&"):l}var bj=cl(function(l,f,y){return l+(y?"-":"")+f.toLowerCase()}),_j=cl(function(l,f,y){return l+(y?" ":"")+f.toLowerCase()}),Ej=ep("toLowerCase");function Sj(l,f,y){l=Nr(l),f=Gt(f);var C=f?Ja(l):0;if(!f||C>=f)return l;var I=(f-C)/2;return Su(da(I),y)+l+Su(Qa(I),y)}function Cj(l,f,y){l=Nr(l),f=Gt(f);var C=f?Ja(l):0;return f&&C<f?l+Su(f-C,y):l}function kj(l,f,y){l=Nr(l),f=Gt(f);var C=f?Ja(l):0;return f&&C<f?Su(f-C,y)+l:l}function Nj(l,f,y){return y||f==null?f=0:f&&(f=+f),bg(Nr(l).replace(Qi,""),f||0)}function Tj(l,f,y){return(y?Zn(l,f,y):f===t)?f=1:f=Gt(f),al(Nr(l),f)}function Rj(){var l=arguments,f=Nr(l[0]);return l.length<3?f:f.replace(l[1],l[2])}var Aj=cl(function(l,f,y){return l+(y?"_":"")+f.toLowerCase()});function Ij(l,f,y){return y&&typeof y!="number"&&Zn(l,f,y)&&(f=y=t),y=y===t?D:y>>>0,y?(l=Nr(l),l&&(typeof f=="string"||f!=null&&!Q0(f))&&(f=vs(f),!f&&Kl(l))?Pi(Os(l),0,y):l.split(f,y)):[]}var Pj=cl(function(l,f,y){return l+(y?" ":"")+tx(f)});function Fj(l,f,y){return l=Nr(l),y=y==null?0:ki(Gt(y),0,l.length),f=vs(f),l.slice(y,y+f.length)==f}function jj(l,f,y){var C=O.templateSettings;y&&Zn(l,f,y)&&(f=t),l=Nr(l),f=fv({},f,C,sp);var I=fv({},f.imports,C.imports,sp),L=Gn(I),q=tu(I,L),Z,ae,ke=0,Re=f.interpolate||We,je="__p += '",Be=ru((f.escape||We).source+"|"+Re.source+"|"+(Re===ls?Is:We).source+"|"+(f.evaluate||We).source+"|$","g"),ht="//# sourceURL="+(ir.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++p0+"]")+`
`;l.replace(Be,function(At,tr,lr,Po,zs,Fo){return lr||(lr=Po),je+=l.slice(ke,Fo).replace(xr,hg),tr&&(Z=!0,je+=`' +
__e(`+tr+`) +
'`),zs&&(ae=!0,je+=`';
`+zs+`;
__p += '`),lr&&(je+=`' +
((__t = (`+lr+`)) == null ? '' : __t) +
'`),ke=Fo+At.length,At}),je+=`';
`;var Rt=ir.call(f,"variable")&&f.variable;if(!Rt)je=`with (obj) {
`+je+`
}
`;else if(Wa.test(Rt))throw new Ot(u);je=(ae?je.replace(cr,""):je).replace(ft,"$1").replace(Nt,"$1;"),je="function("+(Rt||"obj")+`) {
`+(Rt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Z?", __e = _.escape":"")+(ae?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+je+`return __p
}`;var Vt=nS(function(){return ur(L,ht+"return "+je).apply(t,q)});if(Vt.source=je,X0(Vt))throw Vt;return Vt}function Oj(l){return Nr(l).toLowerCase()}function Dj(l){return Nr(l).toUpperCase()}function Lj(l,f,y){if(l=Nr(l),l&&(y||f===t))return lg(l);if(!l||!(f=vs(f)))return l;var C=Os(l),I=Os(f),L=cg(C,I),q=Th(C,I)+1;return Pi(C,L,q).join("")}function Mj(l,f,y){if(l=Nr(l),l&&(y||f===t))return l.slice(0,_d(l)+1);if(!l||!(f=vs(f)))return l;var C=Os(l),I=Th(C,Os(f))+1;return Pi(C,0,I).join("")}function $j(l,f,y){if(l=Nr(l),l&&(y||f===t))return l.replace(Qi,"");if(!l||!(f=vs(f)))return l;var C=Os(l),I=cg(C,Os(f));return Pi(C,I).join("")}function Uj(l,f){var y=he,C=te;if(sn(f)){var I="separator"in f?f.separator:I;y="length"in f?Gt(f.length):y,C="omission"in f?vs(f.omission):C}l=Nr(l);var L=l.length;if(Kl(l)){var q=Os(l);L=q.length}if(y>=L)return l;var Z=y-Ja(C);if(Z<1)return C;var ae=q?Pi(q,0,Z).join(""):l.slice(0,Z);if(I===t)return ae+C;if(q&&(Z+=ae.length-Z),Q0(I)){if(l.slice(Z).search(I)){var ke,Re=ae;for(I.global||(I=ru(I.source,Nr(ea.exec(I))+"g")),I.lastIndex=0;ke=I.exec(Re);)var je=ke.index;ae=ae.slice(0,je===t?Z:je)}}else if(l.indexOf(vs(I),Z)!=Z){var Be=ae.lastIndexOf(I);Be>-1&&(ae=ae.slice(0,Be))}return ae+C}function zj(l){return l=Nr(l),l&&Vn.test(l)?l.replace(Sr,pg):l}var Hj=cl(function(l,f,y){return l+(y?" ":"")+f.toUpperCase()}),tx=ep("toUpperCase");function rS(l,f,y){return l=Nr(l),f=y?t:f,f===t?_0(l)?k0(l):x0(l):l.match(f)||[]}var nS=Bt(function(l,f){try{return Yn(l,t,f)}catch(y){return X0(y)?y:new Ot(y)}}),Bj=si(function(l,f){return Dn(f,function(y){y=To(y),Xo(l,y,Oe(l[y],l))}),l});function Gj(l){var f=l==null?0:l.length,y=St();return l=f?Fr(l,function(C){if(typeof C[1]!="function")throw new eo(c);return[y(C[0]),C[1]]}):[],Bt(function(C){for(var I=-1;++I<f;){var L=l[I];if(Yn(L[0],this,C))return Yn(L[1],this,C)}})}function Wj(l){return Tg(gs(l,x))}function rx(l){return function(){return l}}function Vj(l,f){return l==null||l!==l?f:l}var qj=tf(),Kj=tf(!0);function po(l){return l}function nx(l){return cc(typeof l=="function"?l:gs(l,x))}function Yj(l){return Gd(gs(l,x))}function Jj(l,f){return Gr(l,gs(f,x))}var Xj=Bt(function(l,f){return function(y){return oo(y,l,f)}}),Qj=Bt(function(l,f){return function(y){return oo(l,y,f)}});function sx(l,f,y){var C=Gn(f),I=ac(f,C);y==null&&!(sn(f)&&(I.length||!C.length))&&(y=f,f=l,l=this,I=ac(f,Gn(f)));var L=!(sn(y)&&"chain"in y)||!!y.chain,q=vl(l);return Dn(I,function(Z){var ae=f[Z];l[Z]=ae,q&&(l.prototype[Z]=function(){var ke=this.__chain__;if(L||ke){var Re=l(this.__wrapped__),je=Re.__actions__=Xn(this.__actions__);return je.push({func:ae,args:arguments,thisArg:l}),Re.__chain__=ke,Re}return ae.apply(l,ca([this.value()],arguments))})}),l}function Zj(){return Br._===this&&(Br._=vg),this}function ox(){}function eO(l){return l=Gt(l),Bt(function(f){return Wd(f,l)})}var tO=rf(Fr),rO=rf(wh),nO=rf(Eh);function sS(l){return Ze(l)?Ch(To(l)):Kr(l)}function sO(l){return function(f){return l==null?t:Ni(l,f)}}var oO=rp(),iO=rp(!0);function ix(){return[]}function ax(){return!1}function aO(){return{}}function lO(){return""}function cO(){return!0}function uO(l,f){if(l=Gt(l),l<1||l>G)return[];var y=D,C=Ln(l,D);f=St(f),l-=D;for(var I=Nh(C,f);++y<l;)f(y);return I}function dO(l){return $t(l)?Fr(l,To):Io(l)?[l]:Xn(pp(Nr(l)))}function fO(l){var f=++Xl;return Nr(l)+f}var hO=Eu(function(l,f){return l+f},0),pO=Rn("ceil"),mO=Eu(function(l,f){return l/f},1),gO=Rn("floor");function vO(l){return l&&l.length?sl(l,po,ya):t}function yO(l,f){return l&&l.length?sl(l,St(f,2),ya):t}function xO(l){return ig(l,po)}function wO(l,f){return ig(l,St(f,2))}function bO(l){return l&&l.length?sl(l,po,xa):t}function _O(l,f){return l&&l.length?sl(l,St(f,2),xa):t}var EO=Eu(function(l,f){return l*f},1),SO=Rn("round"),CO=Eu(function(l,f){return l-f},0);function kO(l){return l&&l.length?kh(l,po):0}function NO(l,f){return l&&l.length?kh(l,St(f,2)):0}return O.after=X,O.ary=ye,O.assign=DF,O.assignIn=YE,O.assignInWith=fv,O.assignWith=LF,O.at=MF,O.before=Fe,O.bind=Oe,O.bindAll=Bj,O.bindKey=Pe,O.castArray=aF,O.chain=xf,O.chunk=df,O.compact=mp,O.concat=co,O.cond=Gj,O.conforms=Wj,O.constant=rx,O.countBy=ov,O.create=$F,O.curry=Ye,O.curryRight=rt,O.debounce=st,O.defaults=UF,O.defaultsDeep=zF,O.defer=nn,O.delay=fe,O.difference=ar,O.differenceBy=_n,O.differenceWith=cn,O.drop=Pn,O.dropRight=Us,O.dropRightWhile=wc,O.dropWhile=pn,O.fill=Pu,O.filter=_f,O.flatMap=Np,O.flatMapDeep=V0,O.flatMapDepth=lv,O.flatten=ff,O.flattenDeep=ju,O.flattenDepth=ys,O.flip=re,O.flow=qj,O.flowRight=Kj,O.fromPairs=gp,O.functions=KF,O.functionsIn=YF,O.groupBy=Tp,O.initial=hf,O.intersection=vp,O.intersectionBy=Sa,O.intersectionWith=pf,O.invert=XF,O.invertBy=QF,O.invokeMap=cv,O.iteratee=nx,O.keyBy=q0,O.keys=Gn,O.keysIn=ho,O.map=gl,O.mapKeys=ej,O.mapValues=tj,O.matches=Yj,O.matchesProperty=Jj,O.memoize=me,O.merge=rj,O.mergeWith=JE,O.method=Xj,O.methodOf=Qj,O.mixin=sx,O.negate=Le,O.nthArg=eO,O.omit=nj,O.omitBy=sj,O.once=ct,O.orderBy=K0,O.over=tO,O.overArgs=bt,O.overEvery=rO,O.overSome=nO,O.partial=vt,O.partialRight=Tt,O.partition=Mu,O.pick=oj,O.pickBy=XE,O.property=sS,O.propertyOf=sO,O.pull=mf,O.pullAll=Du,O.pullAllBy=ts,O.pullAllWith=ka,O.pullAt=Ro,O.range=oO,O.rangeRight=iO,O.rearg=En,O.reject=o,O.remove=xs,O.rest=dr,O.reverse=gf,O.sampleSize=h,O.set=aj,O.setWith=lj,O.shuffle=v,O.slice=xp,O.sortBy=F,O.sortedUniq=_p,O.sortedUniqBy=hl,O.split=Ij,O.spread=Ta,O.tail=Qg,O.take=Zg,O.takeRight=Ep,O.takeRightWhile=vf,O.takeWhile=D0,O.tap=B0,O.throttle=J0,O.thru=Ao,O.toArray=VE,O.toPairs=QE,O.toPairsIn=ZE,O.toPath=dO,O.toPlainObject=KE,O.transform=cj,O.unary=oF,O.union=L0,O.unionBy=ev,O.unionWith=tv,O.uniq=pl,O.uniqBy=M0,O.uniqWith=bc,O.unset=uj,O.unzip=yf,O.unzipWith=Yr,O.update=dj,O.updateWith=fj,O.values=Tf,O.valuesIn=hj,O.without=$0,O.words=rS,O.wrap=iF,O.xor=rv,O.xorBy=U0,O.xorWith=z0,O.zip=nv,O.zipObject=sv,O.zipObjectDeep=H0,O.zipWith=uo,O.entries=QE,O.entriesIn=ZE,O.extend=YE,O.extendWith=fv,sx(O,O),O.add=hO,O.attempt=nS,O.camelCase=vj,O.capitalize=eS,O.ceil=pO,O.clamp=pj,O.clone=lF,O.cloneDeep=uF,O.cloneDeepWith=dF,O.cloneWith=cF,O.conformsTo=fF,O.deburr=tS,O.defaultTo=Vj,O.divide=mO,O.endsWith=yj,O.eq=Di,O.escape=xj,O.escapeRegExp=wj,O.every=iv,O.find=Ef,O.findIndex=Ea,O.findKey=HF,O.findLast=av,O.findLastIndex=Fu,O.findLastKey=BF,O.floor=gO,O.forEach=Sf,O.forEachRight=Lu,O.forIn=GF,O.forInRight=WF,O.forOwn=VF,O.forOwnRight=qF,O.get=Z0,O.gt=hF,O.gte=pF,O.has=JF,O.hasIn=ex,O.head=dl,O.identity=po,O.includes=Cf,O.indexOf=Oi,O.inRange=mj,O.invoke=ZF,O.isArguments=$u,O.isArray=$t,O.isArrayBuffer=mF,O.isArrayLike=fo,O.isArrayLikeObject=mn,O.isBoolean=gF,O.isBuffer=_c,O.isDate=vF,O.isElement=yF,O.isEmpty=xF,O.isEqual=wF,O.isEqualWith=bF,O.isError=X0,O.isFinite=_F,O.isFunction=vl,O.isInteger=HE,O.isLength=uv,O.isMap=BE,O.isMatch=EF,O.isMatchWith=SF,O.isNaN=CF,O.isNative=kF,O.isNil=TF,O.isNull=NF,O.isNumber=GE,O.isObject=sn,O.isObjectLike=un,O.isPlainObject=Rp,O.isRegExp=Q0,O.isSafeInteger=RF,O.isSet=WE,O.isString=dv,O.isSymbol=Io,O.isTypedArray=Nf,O.isUndefined=AF,O.isWeakMap=IF,O.isWeakSet=PF,O.join=Ca,O.kebabCase=bj,O.last=es,O.lastIndexOf=Ou,O.lowerCase=_j,O.lowerFirst=Ej,O.lt=FF,O.lte=jF,O.max=vO,O.maxBy=yO,O.mean=xO,O.meanBy=wO,O.min=bO,O.minBy=_O,O.stubArray=ix,O.stubFalse=ax,O.stubObject=aO,O.stubString=lO,O.stubTrue=cO,O.multiply=EO,O.nth=yp,O.noConflict=Zj,O.noop=ox,O.now=W,O.pad=Sj,O.padEnd=Cj,O.padStart=kj,O.parseInt=Nj,O.random=gj,O.reduce=Y0,O.reduceRight=kf,O.repeat=Tj,O.replace=Rj,O.result=ij,O.round=SO,O.runInContext=ne,O.sample=a,O.size=_,O.snakeCase=Aj,O.some=k,O.sortedIndex=wp,O.sortedIndexBy=O0,O.sortedIndexOf=Na,O.sortedLastIndex=Xg,O.sortedLastIndexBy=bp,O.sortedLastIndexOf=fl,O.startCase=Pj,O.startsWith=Fj,O.subtract=CO,O.sum=kO,O.sumBy=NO,O.template=jj,O.times=uO,O.toFinite=yl,O.toInteger=Gt,O.toLength=qE,O.toLower=Oj,O.toNumber=ii,O.toSafeInteger=OF,O.toString=Nr,O.toUpper=Dj,O.trim=Lj,O.trimEnd=Mj,O.trimStart=$j,O.truncate=Uj,O.unescape=zj,O.uniqueId=fO,O.upperCase=Hj,O.upperFirst=tx,O.each=Sf,O.eachRight=Lu,O.first=dl,sx(O,(function(){var l={};return Ms(O,function(f,y){ir.call(O.prototype,y)||(l[y]=f)}),l})(),{chain:!1}),O.VERSION=n,Dn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){O[l].placeholder=O}),Dn(["drop","take"],function(l,f){Mt.prototype[l]=function(y){y=y===t?1:ln(Gt(y),0);var C=this.__filtered__&&!f?new Mt(this):this.clone();return C.__filtered__?C.__takeCount__=Ln(y,C.__takeCount__):C.__views__.push({size:Ln(y,D),type:l+(C.__dir__<0?"Right":"")}),C},Mt.prototype[l+"Right"]=function(y){return this.reverse()[l](y).reverse()}}),Dn(["filter","map","takeWhile"],function(l,f){var y=f+1,C=y==ie||y==pe;Mt.prototype[l]=function(I){var L=this.clone();return L.__iteratees__.push({iteratee:St(I,3),type:y}),L.__filtered__=L.__filtered__||C,L}}),Dn(["head","last"],function(l,f){var y="take"+(f?"Right":"");Mt.prototype[l]=function(){return this[y](1).value()[0]}}),Dn(["initial","tail"],function(l,f){var y="drop"+(f?"":"Right");Mt.prototype[l]=function(){return this.__filtered__?new Mt(this):this[y](1)}}),Mt.prototype.compact=function(){return this.filter(po)},Mt.prototype.find=function(l){return this.filter(l).head()},Mt.prototype.findLast=function(l){return this.reverse().find(l)},Mt.prototype.invokeMap=Bt(function(l,f){return typeof l=="function"?new Mt(this):this.map(function(y){return oo(y,l,f)})}),Mt.prototype.reject=function(l){return this.filter(Le(St(l)))},Mt.prototype.slice=function(l,f){l=Gt(l);var y=this;return y.__filtered__&&(l>0||f<0)?new Mt(y):(l<0?y=y.takeRight(-l):l&&(y=y.drop(l)),f!==t&&(f=Gt(f),y=f<0?y.dropRight(-f):y.take(f-l)),y)},Mt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Mt.prototype.toArray=function(){return this.take(D)},Ms(Mt.prototype,function(l,f){var y=/^(?:filter|find|map|reject)|While$/.test(f),C=/^(?:head|last)$/.test(f),I=O[C?"take"+(f=="last"?"Right":""):f],L=C||/^find/.test(f);I&&(O.prototype[f]=function(){var q=this.__wrapped__,Z=C?[1]:arguments,ae=q instanceof Mt,ke=Z[0],Re=ae||$t(q),je=function(tr){var lr=I.apply(O,ca([tr],Z));return C&&Be?lr[0]:lr};Re&&y&&typeof ke=="function"&&ke.length!=1&&(ae=Re=!1);var Be=this.__chain__,ht=!!this.__actions__.length,Rt=L&&!Be,Vt=ae&&!ht;if(!L&&Re){q=Vt?q:new Mt(this);var At=l.apply(q,Z);return At.__actions__.push({func:Ao,args:[je],thisArg:t}),new Mn(At,Be)}return Rt&&Vt?l.apply(this,Z):(At=this.thru(je),Rt?C?At.value()[0]:At.value():At)})}),Dn(["pop","push","shift","sort","splice","unshift"],function(l){var f=_i[l],y=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",C=/^(?:pop|shift)$/.test(l);O.prototype[l]=function(){var I=arguments;if(C&&!this.__chain__){var L=this.value();return f.apply($t(L)?L:[],I)}return this[y](function(q){return f.apply($t(q)?q:[],I)})}}),Ms(Mt.prototype,function(l,f){var y=O[f];if(y){var C=y.name+"";ir.call(tc,C)||(tc[C]=[]),tc[C].push({name:f,func:y})}}),tc[gc(t,R).name]=[{name:"wrapper",func:t}],Mt.prototype.clone=Fd,Mt.prototype.reverse=Oh,Mt.prototype.value=sc,O.prototype.at=wf,O.prototype.chain=ml,O.prototype.commit=bf,O.prototype.next=Sp,O.prototype.plant=G0,O.prototype.reverse=kp,O.prototype.toJSON=O.prototype.valueOf=O.prototype.value=W0,O.prototype.first=O.prototype.head,Si&&(O.prototype[Si]=Cp),O}),Yl=N0();Wo?((Wo.exports=Yl)._=Yl,eu._=Yl):Br._=Yl}).call(Pq)})(dm,dm.exports)),dm.exports}var Iy=Fq();const jv="src/shared/components/sidepanel/panels/components/FilevineCaseInfoBox.tsx",jq=({caseSummaryData:r,isCaseSummaryLoading:e,caseSummaryError:t,caseDetails:n,onDocumentView:s})=>{if(e)return d.jsxs("div",{className:"space-y-2",children:[d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]});if(t)return d.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:t});if(!r)return null;const i={};return r.caseFacts&&(i["Case Facts"]=r.caseFacts),r.supioLink&&(i["Supio Link"]=r.supioLink),n.incidentDate&&(i["Incident Date"]=new Date(n.incidentDate).toLocaleDateString(void 0,{timeZone:"UTC"})),r.statuteoflimitations&&r.statuteoflimitations.dateValue&&(i["Statute of Limitations (SOL)"]=new Date(r.statuteoflimitations.dateValue).toLocaleDateString(void 0,{timeZone:"UTC"})),r.totalMeds>0&&(i["Total Meds"]=`$${r.totalMeds.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),r.totalLiens>0&&(i["Total Liens"]=`$${r.totalLiens.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),d.jsxs("div",{className:"space-y-3",children:[d.jsx(Yc,{details:i}),r.disbursementSheet&&d.jsx("div",{className:"px-3 pb-2",children:d.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300",children:d.jsx("tbody",{children:d.jsxs("tr",{className:"bg-card",children:[d.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-1/3 text-gray-800 dark:text-gray-200",children:"Disbursement Sheet"}),d.jsx("td",{className:"py-2 px-3",children:d.jsxs("button",{onClick:()=>{s&&r.disbursementSheet&&s({name:r.disbursementSheet.filename,documentId:r.disbursementSheet.documentId,url:""})},className:"text-blue-600 dark:text-blue-400 hover:underline inline-flex items-center gap-1 cursor-pointer focus:outline-none",children:[d.jsx(Jf,{className:"w-3 h-3"}),r.disbursementSheet.filename]})})]})})})})]})},Oq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:u,setCurrentCaseIndex:p,isValidating:m=!1,handleSectionClick:g,projectId:x,onDocumentView:b,onProjectManuallySelected:E,onResetToEmailProject:N,isProjectManuallySelected:S=!1})=>{const T=Or(),[R,A]=w.useState(""),[j,P]=w.useState(!1),[U,B]=w.useState(null),[$,Y]=w.useState(!1),[J,he]=w.useState(null),[te,ue]=w.useState(""),[we,ie]=w.useState([]),[se,pe]=w.useState(!1),[ee,G]=w.useState(!1),[z,K]=w.useState(null),D=w.useMemo(()=>{if(!R.trim())return t;const le=R.toLowerCase();return t.filter(Ne=>String(Ne.projectName||"").toLowerCase().includes(le))},[t,R]),M=w.useMemo(()=>Iy.debounce(async le=>{if(!le.trim()||le.length<2){ie([]),K(null);return}pe(!0),K(null);try{const Ne=await Hy("filevine",le,T);ie(Ne.projects||[]),Ne.projects.length===0&&K(`No projects found for "${le}"`)}catch(Ne){T.error("Project search failed",Ne,{sourceFile:jv}),K("Failed to search projects. Please try again."),ie([])}finally{pe(!1)}},400),[T]),oe=le=>{var Ne,He,Ue;try{const Me={projectId:{native:((Ne=le.projectId)==null?void 0:Ne.native)||null,partner:((He=le.projectId)==null?void 0:He.partner)||null},projectName:le.projectName||"",projectTypeCode:le.projectTypeCode||"",projectTypeName:le.projectTypeName||"",phaseName:le.phaseName||"",phaseDate:le.phaseDate||"",firstPrimaryName:le.firstPrimaryName||"",firstPrimaryUsername:le.firstPrimaryUsername||"",hashtags:Array.isArray(le.hashtags)?le.hashtags.join(", "):"",projectEmailAddress:le.projectEmailAddress||"",projectUrl:le.projectUrl||"",incidentDate:le.incidentDate||""};T.info("Project manually selected via search",{projectId:(Ue=Me.projectId)==null?void 0:Ue.native,projectName:Me.projectName,sourceFile:jv}),E&&E(Me),G(!1),ue(""),ie([]),K(null)}catch(Me){T.error("Failed to select project",Me,{sourceFile:jv})}},Ee=le=>{P(le),le||A("")},V=async()=>{if(!(!x||U)){Y(!0),he(null);try{const le=await Z6("filevine",x,T);B(le)}catch(le){T.error("Error fetching case summary",le,{sourceFile:jv}),he("Failed to load case summary data")}finally{Y(!1)}}};w.useEffect(()=>{B(null),he(null)},[x]);const ce=()=>d.jsx(Vs,{rows:2}),xe=()=>g?d.jsxs(ze,{variant:"ghost",className:"justify-between w-full text-sm px-0 hover:bg-transparent",onClick:()=>g("Project Documents"),children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Jf,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),d.jsx("span",{className:"text-blue-500 dark:text-blue-400",children:"Project Documents"})]}),d.jsx(Fc,{src:"/icons/chevron-right.svg",width:16,height:16,alt:"Chevron right",className:"h-4 w-4"})]}):null,ve=le=>{if(p)p(le);else if(le>n)for(let Ne=n;Ne<le;Ne++)i();else if(le<n)for(let Ne=n;Ne>le;Ne--)c()};return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(GR,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"PROJECTS"})]}),d.jsxs("div",{className:"flex items-center gap-1",children:[S&&N&&d.jsx(ze,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Reset to email-based project",onClick:N,children:d.jsx(wo,{className:"h-4 w-4"})}),d.jsxs(Ns,{open:ee,onOpenChange:G,children:[d.jsx(Ts,{asChild:!0,children:d.jsx(ze,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Search all projects",onClick:le=>{le.stopPropagation(),G(!ee)},children:d.jsx(qs,{className:"h-4 w-4"})})}),d.jsxs(os,{align:"end",className:"w-[320px] p-0",children:[d.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Projects"}),d.jsxs("div",{className:"relative",children:[d.jsx(qs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(Qr,{placeholder:"Search by project or client name...",value:te,onChange:le=>{const Ne=le.target.value;ue(Ne),M(Ne)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:le=>le.stopPropagation(),onKeyDown:le=>le.stopPropagation()}),te&&d.jsx("button",{onClick:le=>{le.stopPropagation(),ue(""),ie([]),K(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(fi,{className:"w-4 h-4"})})]})]}),d.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:se?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):z&&we.length===0?d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:z}):we.length>0?we.map(le=>d.jsxs(Wn,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>oe(le),children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:le.projectName}),d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[le.phaseName,"  Client: ",le.clientName]})]},le.projectId.native)):te.trim()&&!se?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No projects found for "',te,'"']}):d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search projects..."})})]})]})]})]}),u?ce():e&&Object.keys(e).length>0?d.jsxs(d.Fragment,{children:[t.length>0&&d.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[d.jsxs("div",{className:"flex-1 min-w-0 flex items-center",children:[t.length>1&&d.jsxs(Ns,{open:j,onOpenChange:Ee,children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[d.jsx("span",{className:"truncate",title:e.Title||"",children:e.Title||"Case"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",n+1,"/",t.length,")"]}),d.jsx(ns,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),d.jsxs(os,{align:"start",className:"w-[280px] p-0",children:[d.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"relative",children:[d.jsx(qs,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(Qr,{placeholder:"Search projects...",value:R,onChange:le=>A(le.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:le=>le.stopPropagation(),onKeyDown:le=>le.stopPropagation()}),R&&d.jsx("button",{onClick:le=>{le.stopPropagation(),A("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(fi,{className:"w-4 h-4"})})]}),R&&d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",D.length," of ",t.length]})]}),d.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:D.length>0?D.map((le,Ne)=>{const He=t.findIndex(Ue=>Ue===le);return d.jsx(Wn,{className:`text-xs truncate ${He===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>ve(He),children:String(le.projectName||`Case ${He+1}`)},He)}):d.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No projects match "',R,'"']})})]})]}),t.length===1&&d.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300 px-2 truncate",title:e.Title||"",children:e.Title||"Case"})]}),s.projectUrl&&d.jsxs("a",{href:s.projectUrl,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[d.jsx(Pl,{className:"w-3 h-3"}),"View"]})]}),d.jsx("div",{className:"break-words overflow-hidden",children:d.jsx(Yc,{details:e})}),d.jsx("div",{className:"px-3 border-t",children:xe()}),s.projectTypeCode&&s.projectTypeCode!=="IM"&&d.jsx("div",{className:"border-t",children:d.jsx(Iq,{type:"single",collapsible:!0,onValueChange:le=>{le==="view-more"&&V()},children:d.jsxs(XP,{value:"view-more",className:"border-0",children:[d.jsx(QP,{className:"px-3 py-2 hover:no-underline text-sm font-medium",children:"View More"}),d.jsx(ZP,{className:"px-3 pb-2",children:d.jsx(jq,{caseSummaryData:U,isCaseSummaryLoading:$,caseSummaryError:J,caseDetails:s,onDocumentView:b})})]})},x)})]}):m?d.jsx(Vs,{rows:2}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?d.jsx(d.Fragment,{children:d.jsx("p",{className:"mb-2",children:"Select a client email thread to view project information"})}):"Select a client email thread to view case information"})]})},Qt="src/sidepanel/mainPanelContent/FilevineInsights.tsx",Dq="https://rubypowerslaw.filevineapp.com",Lq=({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:u,tempClientEmail:p,setTempClientEmail:m,emailParticipants:g,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:E,currentCaseIndex:N,casesForCurrentClient:S,setCasesForCurrentClient:T,isManuallySet:R,setIsManuallySet:A,isProjectManuallySelected:j,setIsProjectManuallySelected:P,isValidClient:U,isTempEmailValid:B,nextCase:$,prevCase:Y,handleSetCurrentCaseIndex:J,ClientNavigation:he,onClientDataValidated:te,isValidating:ue,refreshTrigger:we,integrationSettings:ie})=>{const[se,pe]=w.useState(!1),[ee,G]=w.useState({}),[z,K]=w.useState({}),[D,M]=w.useState({}),[oe,Ee]=w.useState(!1),[V,ce]=w.useState(void 0),[xe,ve]=w.useState([]),[le,Ne]=w.useState(!1),[He,Ue]=w.useState(null),Me=w.useRef({}),Te=Or(),gt=w.useCallback(Ae=>{if(!Ae||!Ae.client_data)return!1;const Xe=Ae.client_data;return Xe&&typeof Xe=="object"&&Object.keys(Xe).length>0},[]),jt=w.useCallback(Ae=>{Te.info("selectClientDetails called",{sourceFile:Qt,hasDetails:!!Ae,detailsKeys:Ae?Object.keys(Ae):[]});const Xe=tt=>{const Pt=tt.replace(/\D/g,"");return Pt.length===10?`(${Pt.slice(0,3)}) ${Pt.slice(3,6)}-${Pt.slice(6)}`:tt};Te.debug("Client details received for formatting",{sourceFile:Qt,caseNames:Ae.caseNames});const pt={Name:Ae.fullName||"",Phone:Xe(Ae.phoneNumber||""),Address:Ae.fullAddress||""};Te.info("Client details formatted and set",{sourceFile:Qt,selectedDetails:pt,originalDetails:Ae}),K(pt)},[Te]),ot=w.useCallback(Ae=>{Te.info("selectCaseDetails called",{sourceFile:Qt,hasDetails:!!Ae,detailsKeys:Ae?Object.keys(Ae):[]});let Xe="";if(Ae.projectName){const Pt=Ae.projectName.match(/(\d{2}-\d{3})/);Pt&&Pt[1]&&(Xe=Pt[1])}Te.debug("Case details received for formatting",{sourceFile:Qt});const tt=(Ae.projectTypeCode||"")==="IM"?{Title:Ae.projectName||"","Internal Case ID":Xe,"Assigned To":Ae.firstPrimaryName||"",Phase:Ae.phaseName||"",Tags:Ae.hashtags||"","Filevine Email":Ae.projectEmailAddress||""}:{Title:Ae.projectName||"","Assigned To":Ae.firstPrimaryName||"",Phase:Ae.phaseName||"",Tags:Ae.hashtags||"","Filevine Email":Ae.projectEmailAddress||""};Te.info("Case details formatted and set",{sourceFile:Qt,selectedDetails:tt,originalDetails:Ae}),M(tt)},[Te]),Ut=w.useCallback(async Ae=>{if(Me.current[Ae]){Te.debug("Using cached client data",{sourceFile:Qt,email:Ae});return}try{Te.debug("Fetching client data",{sourceFile:Qt,email:Ae});const Xe=await J_("filevine",Ae,Te);Me.current[Ae]=Xe}catch(Xe){throw Xe instanceof Error&&(Xe.message.includes("Client not found")||Xe.message.includes("(cached)"))?Te.debug("Client not found for email (including cached)",{sourceFile:Qt,email:Ae}):Te.error(`Error fetching client data for ${Ae}`,Xe,{sourceFile:Qt}),Xe}},[Te]),Zt=w.useCallback(async()=>{if(Te.info("fetchClientData called",{sourceFile:Qt,clientEmail:e,isFilevineConnected:se,hasClientEmail:!!e}),!e||!se){Te.info("fetchClientData early return",{sourceFile:Qt,reason:e?"filevine not connected":"no client email",clientEmail:e,isFilevineConnected:se});return}try{if(Ee(!0),Te.info("fetchClientData starting data fetch",{sourceFile:Qt,clientEmail:e,isLoading:!0}),!Me.current[e])try{await Ut(e)}catch(Er){Er instanceof Error&&Er.message.includes("(cached)")?Te.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Qt,clientEmail:e}):Te.error("Error fetching client data",Er,{sourceFile:Qt}),G({}),T([]),K({}),M({}),Ee(!1);return}const Ae=Me.current[e];if(!Ae){G({}),T([]),K({}),M({}),Ee(!1),te(e,!1);return}const Xe=gt(Ae);if(te(e,Xe),!Xe){Te.debug("Client data exists but is not valid",{sourceFile:Qt,clientEmail:e}),G({}),T([]),K({}),M({}),Ee(!1);return}const pt=Ae.client_data;jt(pt);const tt=Ae.case_data||[];T(tt);const Pt=tt.length>0?Object.entries(tt[0]).reduce((Er,[Dr,lt])=>(Er[Dr]=String(lt),Er),{}):{};G(Pt),ot(Pt)}catch(Ae){Te.error("Error processing client data",Ae,{sourceFile:Qt}),G({}),T([]),e&&te(e,!1)}finally{Ee(!1)}},[e,se,Ut,Te,jt,ot,T,te,gt]);w.useEffect(()=>{Te.info("FilevineInsights component initialized",{sourceFile:Qt,clientEmail:e,emailParticipants:g.length,currentClientIndex:b,currentCaseIndex:N,casesForCurrentClient:S.length}),(async()=>{try{pe(!0)}catch(Xe){Te.error("Error checking Filevine connection",Xe,{sourceFile:Qt}),pe(!1)}})()},[Te,S.length,N,b,e,g.length]),w.useEffect(()=>{ue&&g.length>0&&(Me.current={},Te.debug("Cleared component-level client data cache for refresh",{sourceFile:Qt}))},[ue,g.length,Te]),w.useEffect(()=>{const Ae=async()=>{if(se){Te.info("Validating all email participants",{sourceFile:Qt,participantCount:g.length});for(const Xe of g)try{await Ut(Xe);const pt=Me.current[Xe],tt=gt(pt);te(Xe,tt),Te.debug("Participant validation result",{sourceFile:Qt,email:Xe,hasValidData:tt})}catch(pt){Te.debug("Participant validation failed",{sourceFile:Qt,email:Xe,error:pt}),te(Xe,!1)}}};g.length>0&&se&&Ae()},[g,se,Ut,gt,te,Te,we]),w.useEffect(()=>{if(j){Te.debug("Skipping fetchClientData because project was manually selected",{sourceFile:Qt,clientEmail:e,isProjectManuallySelected:j});return}e&&se&&(Zt(),m(e),R&&!g.includes(e.toLowerCase())&&Te.debug("Manually set email not in participants, validating separately",{sourceFile:Qt,clientEmail:e}))},[e,se,Zt,m,R,j,g,Te]),w.useEffect(()=>{(!e||g.length===0&&!R)&&(m(null),K({}),M({}))},[e,g.length,R,m,K,M]),w.useEffect(()=>{var Ae;if(S.length>0&&N<S.length){const Xe=S[N],pt=Xe?Object.entries(Xe).reduce((Pt,[Er,Dr])=>(Pt[Er]=String(Dr),Pt),{}):{};G(pt),ot(pt);const tt=(Ae=Xe==null?void 0:Xe.projectId)!=null&&Ae.native?String(Xe.projectId.native):void 0;ce(tt),n&&tt&&n(tt)}},[N,S,ot,n]);const er=w.useCallback(async()=>{var pt;if(!se||S.length===0)return;const Ae=S[N],Xe=((pt=Ae==null?void 0:Ae.projectId)==null?void 0:pt.native)||(Ae==null?void 0:Ae.projectId);if(!Xe){Te.debug("No project ID found for current case",{sourceFile:Qt,currentCaseIndex:N});const tt="No project ID available. Cannot fetch documents.";Ue(tt),c&&c(tt);return}Ne(!0),i&&i(!0),Ue(null),c&&c(null);try{const tt=await mT(String(Xe),Te);if(tt){Te.debug("Using cached documents for project",{sourceFile:Qt,projectId:Xe}),ve(tt),s&&s(tt),Ne(!1),i&&i(!1);return}const Er=(await CT("filevine",String(Xe),Te)).documents.map(Dr=>({name:Dr.filename,url:`${Dq}/docwebviewer/view/${Dr.documentId}`,documentId:Dr.documentId,folderName:Dr.folderName}));await pT(String(Xe),Er,Te),ve(Er),s&&s(Er)}catch(tt){Te.error("Error fetching documents",tt,{sourceFile:Qt});const Pt="Failed to load documents. Please try again later.";Ue(Pt),c&&c(Pt)}finally{Ne(!1),i&&i(!1)}},[se,S,N,s,i,c,Te]),et=Ae=>{var Xe;try{const pt=((Xe=Ae.projectId)==null?void 0:Xe.native)||Ae.projectId;Te.info("Project manually selected via search",{projectId:pt,projectName:Ae.projectName,sourceFile:Qt}),G(Ae),ot(Ae),T([Ae]),t(""),K({}),P(!0),ce(pt),n&&pt&&n(pt)}catch(pt){Te.error("Failed to set manually selected project",pt,{sourceFile:Qt})}},It=()=>{try{if(Te.info("Resetting to email-based project",{sourceFile:Qt}),P(!1),x.length>0){const Ae=x[0];t(Ae),Te.debug("Restored client email",{sourceFile:Qt,clientEmail:Ae})}}catch(Ae){Te.error("Failed to reset to email-based project",Ae,{sourceFile:Qt})}};if(!se)return null;const hr=Ae=>{Te.debug(`[FilevineInfoBox] handleSectionClick called with section: "${Ae}"`,{sourceFile:Qt,functionName:"handleSectionClick",data:{section:Ae}}),r?(Te.debug(`[FilevineInfoBox] Calling toggleSection with section: "${Ae}"`,{sourceFile:Qt,functionName:"handleSectionClick",data:{section:Ae}}),r(Ae),Ae.toLowerCase()==="project documents"?(Te.debug('[FilevineInfoBox] Section is "project documents", calling fetchMatterDocuments',{sourceFile:Qt,functionName:"handleSectionClick",data:{section:Ae}}),er()):Te.debug('[FilevineInfoBox] Section is not "project documents", not calling fetchMatterDocuments',{sourceFile:Qt,functionName:"handleSectionClick",data:{section:Ae}})):Te.warn("[FilevineInfoBox] toggleSection is not defined. Cannot navigate.",{sourceFile:Qt,functionName:"handleSectionClick",data:{section:Ae}})};return d.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[d.jsx(fq,{clientEmail:e,emailParticipants:g,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:E,setClientEmail:t,isManuallySet:R,selectedClientDetails:z,isLoading:oe,ClientNavigation:he,tempClientEmail:p,setTempClientEmail:m,setIsManuallySet:A,isValidClient:U,isTempEmailValid:B,isValidating:ue,isProjectManuallySelected:j}),d.jsx(Oq,{clientEmail:e,selectedCaseDetails:D,casesForCurrentClient:S,currentCaseIndex:N,caseDetails:ee,nextCase:$,prevCase:Y,isLoading:oe,setCurrentCaseIndex:J,isValidating:ue,handleSectionClick:hr,projectId:V,onDocumentView:u,onProjectManuallySelected:et,onResetToEmailProject:It,isProjectManuallySelected:j}),d.jsx("div",{className:"h-8"})]})},Mq=lE("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Py=w.forwardRef(({className:r,variant:e,...t},n)=>d.jsx("div",{ref:n,role:"alert",className:_r(Mq({variant:e}),r),...t}));Py.displayName="Alert";const $q=w.forwardRef(({className:r,...e},t)=>d.jsx("h5",{ref:t,className:_r("mb-1 font-medium leading-none tracking-tight",r),...e}));$q.displayName="AlertTitle";const Fy=w.forwardRef(({className:r,...e},t)=>d.jsx("div",{ref:t,className:_r("text-sm [&_p]:leading-relaxed",r),...e}));Fy.displayName="AlertDescription";const Ov="src/shared/components/sidepanel/panels/components/ClioContactCreation.tsx",p1=r=>{if(!r||r.trim()==="")return!0;if(!/^[\d\s+().-]+$/.test(r))return!1;const t=r.replace(/\D/g,"");return t.length>=7&&t.length<=15},Uq=({emailParticipants:r,emailParticipantClients:e,getClientNameFromCache:t,onContactsCreated:n})=>{const s=Or(),[i,c]=w.useState([]),[u,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState([]),[E,N]=w.useState({}),[S,T]=w.useState([]),[R,A]=w.useState(!1),[j,P]=w.useState(null),[U,B]=w.useState(!1),$=w.useCallback(ie=>{const se=ie.toLowerCase();return e.some(pe=>pe.toLowerCase()===se)},[e]);w.useEffect(()=>{const ie=r.map((se,pe)=>{const ee=$(se);let G="";if(ee){const z=t(se);z&&(G=z)}return G||(G=se.split("@")[0].split(".").map(K=>K.charAt(0).toUpperCase()+K.slice(1).toLowerCase()).join(" ")),{id:`participant-${pe}`,name:G,email:se,inClio:ee}});c(ie),s.debug("Participants initialized with Clio status",{sourceFile:Ov,totalParticipants:ie.length,inClio:ie.filter(se=>se.inClio).length,notInClio:ie.filter(se=>!se.inClio).length})},[r,e,s,$,t]);const Y=i.some(ie=>!ie.inClio),J=()=>{p(!0),g(!1);const ie={};i.forEach(se=>{if(!se.inClio){const pe=se.name.split(" ");ie[se.id]={firstName:pe[0]||"",lastName:pe.slice(1).join(" ")||"",email:se.email,phoneNumber:"",type:"person",companyName:""}}}),N(ie)},he=()=>{p(!1),b([]),P(null)},te=ie=>{b(se=>se.includes(ie)?se.filter(pe=>pe!==ie):[...se,ie])},ue=(ie,se,pe)=>{N(ee=>({...ee,[ie]:{...ee[ie],[se]:pe}}))},we=async()=>{var ie,se,pe;A(!0),P(null);for(const ee of x){const G=E[ee];if(!G){P({type:"validation",message:"Contact data is missing. Please try again."}),A(!1);return}if(G.type==="person"){if(!((ie=G.firstName)!=null&&ie.trim())||!((se=G.lastName)!=null&&se.trim())){P({type:"validation",message:"First and Last name is required for person contacts."}),A(!1);return}}else if(G.type==="company"&&!((pe=G.companyName)!=null&&pe.trim())){P({type:"validation",message:"Company name is required for company contacts."}),A(!1);return}if(G!=null&&G.phoneNumber&&!p1(G.phoneNumber)){P({type:"validation",message:"Invalid phone number. Please enter 7-15 digits with optional formatting (+, -, spaces, parentheses)."}),A(!1);return}}try{const ee=[];for(const z of x){const K=i.find(M=>M.id===z),D=E[z];if(!(!K||!D))try{const M=await u8(D,s);ee.push({id:M.id,name:K.name,email:K.email}),s.info("Contact created successfully in Clio",{sourceFile:Ov,email:K.email})}catch(M){if(s.error("Error creating contact in Clio",M,{sourceFile:Ov,email:K.email}),M instanceof Error&&(M.message.includes("duplicate")||M.message.includes("already exists")?P({type:"duplicate",message:"A contact with this email already exists in Clio."}):M.message.includes("permission")?P({type:"permission",message:"You do not have permission to create contacts in Clio. Contact your admin."}):P({type:"network",message:"Something went wrong. Please try again."})),ee.length>0){const oe=[...S,...ee];T(oe),c(V=>V.map(ce=>ee.some(ve=>ve.email.toLowerCase()===ce.email.toLowerCase())?{...ce,inClio:!0}:ce));const Ee=ee.map(V=>{var ce;return(ce=i.find(xe=>xe.email.toLowerCase()===V.email.toLowerCase()))==null?void 0:ce.id}).filter(Boolean);b(V=>V.filter(ce=>!Ee.includes(ce))),n&&n(oe)}A(!1);return}}B(!0);const G=[...S,...ee];T(G),p(!1),b([]),A(!1),c(z=>z.map(K=>ee.some(M=>M.email.toLowerCase()===K.email.toLowerCase())?{...K,inClio:!0}:K)),n&&n(G)}catch(ee){s.error("Unexpected error in contact creation flow",ee,{sourceFile:Ov}),P({type:"network",message:"Something went wrong. Please try again."}),A(!1)}};return i.length===0||!Y&&S.length===0?null:d.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:d.jsxs("div",{className:"p-4",children:[!U&&d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Some email participants are not contacts in Clio."}),Y&&!u&&d.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[d.jsx(ze,{onClick:J,size:"sm",className:"h-9",children:"Add to Clio"}),d.jsx("button",{onClick:()=>g(!m),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"How this works"})]}),m&&d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3 leading-relaxed",children:"Create a Clio contact from email participants so Candle can show client and matter context."}),u&&d.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Add contact to Clio"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Select people on this email thread"}),j&&d.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:d.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm",children:j.message}),j.type==="network"&&d.jsx("div",{className:"mt-2",children:d.jsx(ze,{onClick:we,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),d.jsx("div",{className:"space-y-2 mb-4",children:i.map(ie=>d.jsxs("div",{className:`flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md ${ie.inClio?"bg-gray-50 dark:bg-gray-800 opacity-60":"bg-white dark:bg-gray-900"}`,children:[d.jsx("input",{type:"checkbox",checked:x.includes(ie.id),onChange:()=>te(ie.id),disabled:ie.inClio,className:"h-4 w-4 text-blue-600"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ie.name}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ie.email})]}),d.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ie.inClio?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800":"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border border-orange-300 dark:border-orange-800"}`,children:ie.inClio?"In Clio":"Not in Clio"})]},ie.id))}),x.length>0&&d.jsx("div",{className:"border-t dark:border-gray-700 pt-4 space-y-4",children:x.map(ie=>{const se=i.find(ee=>ee.id===ie),pe=E[ie]||{};return se?d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:se.name}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contact type"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>ue(ie,"type","person"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${pe.type==="person"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Person"}),d.jsx("button",{onClick:()=>ue(ie,"type","company"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${pe.type==="company"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Company"})]})]}),pe.type==="person"?d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First name"}),d.jsx(Qr,{type:"text",value:pe.firstName||"",onChange:ee=>ue(ie,"firstName",ee.target.value),className:"h-9 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last name"}),d.jsx(Qr,{type:"text",value:pe.lastName||"",onChange:ee=>ue(ie,"lastName",ee.target.value),className:"h-9 text-sm"})]})]}):d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company name"}),d.jsx(Qr,{type:"text",value:pe.companyName||"",onChange:ee=>ue(ie,"companyName",ee.target.value),className:"h-9 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone number (optional)"}),d.jsx(Qr,{type:"tel",value:pe.phoneNumber||"",onChange:ee=>ue(ie,"phoneNumber",ee.target.value),placeholder:"+1 (555) 123-4567",className:"h-9 text-sm"}),pe.phoneNumber&&!p1(pe.phoneNumber)&&d.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Please enter a valid phone number (7-15 digits)"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),d.jsx(Qr,{type:"text",value:pe.email||"",readOnly:!0,disabled:!0,className:"h-9 text-sm"})]})]},ie):null})}),d.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t dark:border-gray-700",children:[d.jsx(ze,{onClick:we,disabled:x.length===0||R,size:"sm",className:"h-9",children:R?"Creating...":"Create contact"}),d.jsx(ze,{onClick:he,variant:"outline",size:"sm",className:"h-9",children:"Cancel"})]})]})]}),U&&d.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-2",children:"This contact has been added in Clio"}),d.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Clio may take a few minutes to show updates."}),d.jsx("div",{className:"space-y-2",children:S.map(ie=>d.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ie.name}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ie.email})]}),d.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800 rounded-full",children:"In Clio"})]},ie.id))}),d.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-3",children:"Go to the Matter section below to link this contact to a matter."}),Y&&d.jsx(ze,{onClick:()=>{B(!1),p(!0)},size:"sm",variant:"outline",className:"h-8 text-xs mt-3",children:"Add more contacts"})]})]})})},zq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:u,linkableFields:p,isLoading:m,ClientNavigation:g,handleSectionClick:x,tempClientEmail:b,setTempClientEmail:E,setIsManuallySet:N,isValidClient:S,isTempEmailValid:T,showClientDocumentsButton:R,isValidating:A,fetchError:j=!1,hasTransientError:P=!1,onContactsCreated:U,getClientNameFromCache:B,isClientDataValidationComplete:$})=>{var we;Or();const Y=()=>d.jsx(Vs,{rows:2}),J=(we=p.find(ie=>ie.field==="Name"))==null?void 0:we.url,he=()=>d.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[d.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:d.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",title:b||"",children:[b," (Manually set)"]})}),J&&d.jsxs("a",{href:J,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[d.jsx(Pl,{className:"w-3 h-3"}),"View"]})]}),te=()=>d.jsx(Yc,{details:u}),ue=()=>{let ie="Select a client email thread to view client information";return c&&r?ie=`No client information found for ${r}`:e.length>0&&(t.length===0?ie=`No client information available for emails on the selected thread: ${e.join(", ")}`:ie="No client information available for the selected email ID"),d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:d.jsx("p",{className:"mb-2",children:ie})})};return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(xy,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),d.jsxs(Ns,{children:[d.jsx(Ts,{asChild:!0,children:d.jsx(ze,{variant:"ghost",size:"icon",className:"h-6 w-6 hidden",children:d.jsx(qs,{className:"h-4 w-4"})})}),d.jsx(os,{align:"end",className:"p-2",children:d.jsx("div",{className:"flex flex-col gap-2 w-64",children:d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsx(Qr,{type:"email",value:b||"",onChange:ie=>E(ie.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${T===!1?"border-red-300 focus:ring-red-500":""}`}),d.jsx(ze,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${T===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(b||""),N(!0)},disabled:!b,title:T===!1?"Warning: This email is not recognized as a valid client in Clio":"Set email as current client",children:"Search"})]})})})]})]}),m?Y():j?d.jsxs(Py,{variant:"destructive",className:"m-2",children:[d.jsx(yy,{className:"h-4 w-4"}),d.jsx(Fy,{className:"ml-2",children:"Failed to fetch contact data. Please refresh to try again."})]}):d.jsxs(d.Fragment,{children:[t.length>0&&!c&&d.jsx(g,{clientUrl:J}),c&&r&&d.jsx(he,{}),u&&Object.keys(u).length>0?d.jsx(te,{}):A&&!c?d.jsx(Vs,{rows:2}):P&&!c?d.jsx("div",{className:"flex justify-center p-2",children:d.jsxs(Py,{variant:"default",className:"w-full border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950",children:[d.jsx(yy,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),d.jsx(Fy,{className:"ml-2 text-amber-800 dark:text-amber-200",children:"Request timed out. Please try again later."})]})}):d.jsx(ue,{})]}),$&&!c&&e.length!==t.length&&B&&d.jsx(Uq,{emailParticipants:e,emailParticipantClients:t,getClientNameFromCache:B,onContactsCreated:U})]})},Dv="src/shared/components/sidepanel/panels/components/ClioMatterLinking.tsx",yw=({createdContacts:r,onMatterLinked:e})=>{const t=Or(),[n,s]=w.useState(!1),[i,c]=w.useState(""),[u,p]=w.useState(!1),[m,g]=w.useState(null),[x,b]=w.useState([]),[E,N]=w.useState([]),[S,T]=w.useState({}),[R,A]=w.useState(!1),[j,P]=w.useState(null),[U,B]=w.useState(null),[$,Y]=w.useState(!1),J=()=>{s(!0),P(null),N(r.map(se=>se.id))},he=()=>{s(!1),c(""),p(!1),g(null),P(null),T({})},te=async se=>{if(c(se),p(!0),!se){g(null),b([]);return}if(se.length<3){b([]);return}Y(!0);try{const ee=((await Hy("clio",se,t)).projects||[]).map(G=>{var z;return{id:String(((z=G.projectId)==null?void 0:z.native)||""),name:G.projectName||"",status:G.isArchived?"closed":"open",description:G.projectName||""}});b(ee)}catch(pe){t.error("Error searching matters",pe,{sourceFile:Dv,searchQuery:se})}finally{Y(!1)}},ue=se=>{g(se),c(se.name),p(!1)},we=se=>{N(pe=>pe.includes(se)?pe.filter(ee=>ee!==se):[...pe,se])},ie=async()=>{if(m){A(!0),P(null);try{const se=[];for(const pe of E){const ee=S[pe]||"Related Contact";try{await d8("clio",pe,m.id,ee,t),se.push(pe),t.info("Contact linked to matter successfully",{sourceFile:Dv})}catch(G){t.error("Error linking contact to matter",G,{sourceFile:Dv}),G instanceof Error&&(G.message.includes("permission")?P({type:"permission",message:"You do not have permission to modify matters in Clio. Contact your admin."}):P({type:"network",message:"Something went wrong. Please try again."})),se.length>0&&(N(z=>z.filter(K=>!se.includes(K))),e&&e(m.id)),A(!1);return}}B(m),s(!1),A(!1),e&&e(m.id)}catch(se){t.error("Unexpected error in matter linking flow",se,{sourceFile:Dv}),P({type:"network",message:"Something went wrong. Please try again."}),A(!1)}}};return d.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:d.jsxs("div",{className:"p-2",children:[!n&&!U&&d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Link the created contact(s) to a matter as related contacts."}),d.jsx(ze,{onClick:J,size:"sm",className:"h-9",children:"Add to a matter"})]}),n&&d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Link matter as a related contact"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Add as a related contact in Clio"}),j&&d.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:d.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm",children:j.message}),j.type==="network"&&d.jsx("div",{className:"mt-2",children:d.jsx(ze,{onClick:ie,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Matter"}),d.jsx(Qr,{type:"text",placeholder:"Search matters...",value:i,onChange:se=>te(se.target.value),onFocus:()=>p(!0),className:"h-9 text-sm"}),u&&i&&x.length>0&&d.jsx("div",{className:"mt-1 max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 shadow-lg",children:x.map(se=>d.jsxs("div",{onClick:()=>ue(se),className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer border-b dark:border-gray-600 last:border-b-0",children:[d.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 flex-1 truncate",children:se.name}),d.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${se.status==="open"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border border-blue-300 dark:border-blue-800":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-700"}`,children:se.status==="open"?"Open":"Closed"})]},se.id))}),$&&d.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Searching matters..."})]}),m&&d.jsx(d.Fragment,{children:d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Related contact(s) to add"}),r.map(se=>d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[d.jsx("input",{type:"checkbox",checked:E.includes(se.id),onChange:()=>we(se.id),className:"h-4 w-4 text-blue-600"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:se.name}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:se.email})]})]}),E.includes(se.id)&&d.jsxs("div",{className:"mt-2",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Relationship"}),d.jsx(Qr,{type:"text",placeholder:"e.g., Opposing Counsel, Co-Counsel, Employee",value:S[se.id]||"",onChange:pe=>T(ee=>({...ee,[se.id]:pe.target.value})),className:"h-9 text-sm"})]})]},se.id))]})}),d.jsxs("div",{className:"flex gap-2 pt-4 border-t dark:border-gray-700",children:[d.jsx(ze,{onClick:ie,disabled:!m||E.length===0||R,size:"sm",className:"h-9",children:R?"Saving...":"Save"}),d.jsx(ze,{onClick:he,variant:"outline",size:"sm",className:"h-9",children:"Back"})]})]}),U&&!n&&d.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-3",children:"Added to matter"}),d.jsx("div",{className:"mb-3 p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:U.name})}),d.jsx("div",{className:"space-y-2 mb-3",children:r.filter(se=>E.includes(se.id)).map(se=>d.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:se.name}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:S[se.id]||"Related contact"})]}),d.jsxs("a",{href:`https://app.clio.com/nc#/contacts/${se.id}`,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline ml-2",children:[d.jsx(Pl,{className:"w-3 h-3"}),"View"]})]},se.id))}),d.jsx("div",{className:"flex gap-2",children:d.jsx(ze,{onClick:()=>{B(null),s(!0),g(null),c(""),T({})},variant:"outline",size:"sm",className:"h-9 whitespace-nowrap",children:"Link another matter"})})]})]})})},Rc="src/shared/components/sidepanel/panels/components/ClioCaseInfoBox.tsx",Hq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,linkableFields:s,nextCase:i,prevCase:c,isLoading:u,isManuallySet:p,setCurrentCaseIndex:m,calendarEntries:g=[],isValidating:x=!1,caseUrl:b,matterId:E,onMatterManuallySelected:N,fetchError:S=!1,hasTransientError:T=!1,userData:R,createdContacts:A=[],onMatterLinked:j})=>{var oa,sr;const P=Or(),U=sd(),[B,$]=w.useState(!1),[Y,J]=w.useState(!1),[he,te]=w.useState(!1),[ue,we]=w.useState(!1),[ie,se]=w.useState(""),[pe,ee]=w.useState(!1),[G,z]=w.useState(""),[K,D]=w.useState([]),[M,oe]=w.useState(!1),[Ee,V]=w.useState(!1),[ce,xe]=w.useState(null),[ve,le]=w.useState(!1),[Ne,He]=w.useState(""),[Ue,Me]=w.useState(""),[Te,gt]=w.useState(new Date().toISOString().split("T")[0]),[jt,ot]=w.useState("Normal"),[Ut,Zt]=w.useState(!1),[er,et]=w.useState(!1),[It,hr]=w.useState(!1),Ae=w.useRef(!1),Xe=w.useRef(null),[pt,tt]=w.useState(null),[Pt,Er]=w.useState(null),[Dr,lt]=w.useState(!0),[kt,de]=w.useState(!1),[Ie,Ge]=w.useState(""),[ut,Ft]=w.useState([]),[cr,ft]=w.useState(!1),[Nt,Sr]=w.useState(!1),[as,Vn]=w.useState(null),[As,Ji]=w.useState(""),[Ir,ls]=w.useState(""),[gi,Xi]=w.useState(!1),[Xs,bo]=w.useState(1),[Qs,Qi]=w.useState("Days"),[xn]=w.useState("Email"),[cs,Ho]=w.useState(!1),[vi,Zi]=w.useState(!0),[Wa,us]=w.useState(!0),[Is,ea]=w.useState(!0),[ta,ra]=w.useState(!1),[na,it]=w.useState(""),[Q,De]=w.useState(""),[We,xr]=w.useState(new Date().toISOString().split("T")[0]),[Dt,Pr]=w.useState(!1),[Hr,fn]=w.useState(null),wn=()=>{He(""),Me(""),gt(new Date().toISOString().split("T")[0]),ot("Normal"),Ji((R==null?void 0:R.id)||""),ls((R==null?void 0:R.name)||""),Ge(""),Ft([]),Vn(null),Xi(!1),bo(1),Qi("Days"),Ae.current=!1,tt(null),lt(!0),Zi(!0),us(!0)},yi=()=>{it(""),De(""),xr(new Date().toISOString().split("T")[0]),fn(null)};w.useEffect(()=>{Er(null)},[E]),w.useEffect(()=>{if(!pt)return;const be=setTimeout(()=>tt(null),5e3);return()=>clearTimeout(be)},[pt]),w.useEffect(()=>{if(!Hr)return;const be=setTimeout(()=>fn(null),5e3);return()=>clearTimeout(be)},[Hr]),w.useEffect(()=>{const be=!!(As&&(R!=null&&R.id)&&As!==R.id);ea(!be)},[As,R]),w.useEffect(()=>{A&&A.length>0?de(!0):de(!1)},[A]),w.useEffect(()=>{E||(wn(),le(!1)),ve||(Ae.current=!1)},[ve,E]),w.useEffect(()=>{ve&&R&&!As&&(Ji(R.id),ls(R.name))},[ve,R,As]);const qr=w.useMemo(()=>Iy.debounce(async be=>{if(!be.trim()||be.length<2){Ft([]),Vn(null);return}ft(!0),Vn(null);try{const $e=await o8("clio",be,P);Ft($e.users||[]),$e.users.length===0&&Vn(`No users found for "${be}"`)}catch($e){P.error("Assignee search failed",$e,{sourceFile:Rc}),Vn("Failed to search users. Please try again."),Ft([])}finally{ft(!1)}},400),[P]);w.useEffect(()=>{const be=async $e=>{if(!$e){wn(),le(!1);return}if($e.threadId!=Xe.current){wn(),le(!1),Xe.current=String($e.threadId),Er(null);return}};return U&&(U.onThreadChanged(be),U.getCurrentThread().then($e=>{be($e)}).catch($e=>{P.error("Error getting initial thread",$e,{sourceFile:"ClioCaseInfoBox.tsx"})})),()=>{U==null||U.removeThreadListener(be)}},[U,P]),w.useEffect(()=>{(async()=>{var $e;if(ve&&!Ae.current){Ae.current=!0,Zt(!0);try{const at=await U.getCurrentThread();if(at&&(($e=at==null?void 0:at.messages)==null?void 0:$e.length)>0){const zt=at.messages[at.messages.length-1].subject,Kt=at.messages[at.messages.length-1].body,Ht="Subject: "+zt+`
Body: `+Kt,nt=await a8("clio",Ht,P);He(nt.name),Me(nt.description)}}catch(at){P.error("Failed to generate task description",at,{sourceFile:Rc})}finally{Zt(!1)}}})()},[ve,U,P]);const xi=async()=>{var at;tt(null);const be=[];if(Ne.trim()||be.push("Task Name"),Ue.trim()||be.push("Task Description"),E||be.push("Matter"),As||be.push("Assign To"),(!Te||!/^\d{4}-\d{2}-\d{2}$/.test(Te)||Number.isNaN(Date.parse(Te)))&&be.push("Date"),be.length>0){tt({type:"error",text:`Please fill in the following fields: ${be.join(", ")}`});return}et(!0);try{const zt=Te?new Date(Te).toISOString():null;let Kt=Ue;if(Dr){const Cr=await U.getCurrentThread();if(!Cr||((at=Cr==null?void 0:Cr.messages)==null?void 0:at.length)<1){tt({type:"error",text:"Something went wrong. Please try again"});return}const Fs=Cr.messages[Cr.messages.length-1].body;Kt=Ue+`

Referenced Email Below

`+Fs}await l8("clio",Ne,Kt,E,zt,jt,P,As||void 0,gi?{value:Xs,unit:Qs,method:xn,assigneeId:As||void 0}:void 0,Is?void 0:{notifyAssignee:vi,notifyCompletion:Wa}),wn(),le(!1),tt({type:"success",text:"Task created successfully!"}),Er({name:Ne,description:Ue,due_at:Te,priority:jt})}catch(zt){P.error("Failed to create task",zt,{sourceFile:Rc}),tt({type:"error",text:"Failed to create task. Please try again."})}finally{et(!1)}},qn=async()=>{Pr(!0),fn(null);const be=[];if(na.trim()||be.push("Subject"),Q.trim()||be.push("Note"),E||be.push("Matter"),(!We||!/^\d{4}-\d{2}-\d{2}$/.test(We)||Number.isNaN(Date.parse(We)))&&be.push("Date"),be.length>0){fn({type:"error",text:`Please fill in: ${be.join(", ")}`}),Pr(!1);return}try{const at=await c8("clio",na,Q,We,E,null,P);P.info("Note created successfully",{sourceFile:Rc,noteId:at.noteId}),yi(),ra(!1),fn({type:"success",text:"Note created successfully!"})}catch(at){P.error("Error creating note",at,{sourceFile:Rc}),fn({type:"error",text:at instanceof Error?at.message:"Failed to create note"})}finally{Pr(!1)}},Jc=w.useMemo(()=>{if(!ie.trim())return t;const be=ie.toLowerCase();return t.filter($e=>String($e.description||"").toLowerCase().includes(be))},[t,ie]),Ps=be=>{ee(be),be||se("")},ad=w.useMemo(()=>Iy.debounce(async be=>{if(!be.trim()||be.length<2){D([]),xe(null);return}oe(!0),xe(null);try{const $e=await Hy("clio",be,P);D($e.projects||[]),$e.projects.length===0&&xe(`No matters found for "${be}"`)}catch($e){P.error("Matter search failed",$e,{sourceFile:Rc}),xe("Failed to search matters. Please try again."),D([])}finally{oe(!1)}},400),[P]),ld=be=>{var $e,at;try{const zt={id:((at=($e=be.projectId)==null?void 0:$e.native)==null?void 0:at.toString())||"",description:be.projectName||"",practice_area:be.projectTypeName||"",matter_stage:be.phaseName||"",status:be.isArchived?"Closed":"Open",client_name:be.clientName||"",responsible_attorney:be.firstPrimaryName||"",url:be.projectUrl||"",name:be.projectName||""};P.info("Matter manually selected via search",{matterId:zt.id,matterName:zt.description,sourceFile:Rc}),N&&N(zt),V(!1),z(""),D([]),xe(null)}catch(zt){P.error("Failed to select matter",zt,{sourceFile:Rc})}},cd=()=>d.jsx(Vs,{rows:2}),sa=be=>{if(m)m(be);else if(be>n)for(let $e=n;$e<be;$e++)i();else if(be<n)for(let $e=n;$e>be;$e--)c()},Bo=be=>{try{const $e=be.split("T")[0];if(!$e)return be;const[at,zt,Kt]=$e.split("-").map(Number);return isNaN(at)||isNaN(zt)||isNaN(Kt)||zt<1||zt>12?be:`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][zt-1]} ${Kt}, ${at}`}catch{return be}},Go=be=>{try{const $e=be.split("T")[1];if(!$e)return"";const at=$e.split(/[Z+-]/)[0],[zt,Kt]=at.split(":").map(Number);if(isNaN(zt)||isNaN(Kt))return"";const Ht=zt>=12?"PM":"AM",nt=zt%12||12,Cr=Kt.toString().padStart(2,"0");return`${nt}:${Cr} ${Ht}`}catch{return""}},wi=be=>be?(new DOMParser().parseFromString(be,"text/html").body.textContent||"").length>200:!1,Xc=be=>{const $e=["a","b","br","div","em","i","li","ol","p","s","strong","u","ul"],at=["href","rel","type","target"],Kt=new DOMParser().parseFromString(be,"text/html"),Ht=Kt.body.getElementsByTagName("*");for(let nt=Ht.length-1;nt>=0;nt--){const Cr=Ht[nt];$e.includes(Cr.tagName.toLowerCase())?Array.from(Cr.attributes).forEach(ds=>{at.includes(ds.name.toLowerCase())||Cr.removeAttribute(ds.name)}):Cr.replaceWith(document.createTextNode(Cr.textContent||""))}return Kt.body.innerHTML},mh=()=>{if(!t.length||n>=t.length)return[];const be=t[n],$e=String(be.id||"");return $e?g.filter(at=>{var Kt;return String(((Kt=at.matter)==null?void 0:Kt.id)||at.case_id||"")===$e}):[]},zl=be=>{const $e=String(be.start_at||be.date||"");if(!$e)return!1;try{return new Date($e)>=new Date}catch{return!1}},Qc=()=>{const $e=mh().filter(zl).sort((at,zt)=>{const Kt=new Date(String(at.start_at||at.date||"")),Ht=new Date(String(zt.start_at||zt.date||""));return Kt.getTime()-Ht.getTime()});return $e.length>0?[$e[0]]:$e},Va=()=>{const be=Qc(),$e=t.length>0&&n<t.length?t[n]:null,at=$e==null?void 0:$e.id,zt=at?`https://app.clio.com/nc/#/matters/${at}/calendar`:null;return d.jsxs("div",{className:"border-t bg-card",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[d.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>$(!B),children:[d.jsx(jf,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Next Event"}),be.length>0&&!u&&(B?d.jsx(Gv,{className:"w-4 h-4 text-gray-400"}):d.jsx(ns,{className:"w-4 h-4 text-gray-400"}))]}),zt&&d.jsxs("a",{href:zt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:Kt=>Kt.stopPropagation(),children:[d.jsx(Pl,{className:"w-3 h-3"}),"View all"]})]}),!B&&d.jsx(d.Fragment,{children:u?d.jsx(Vs,{rows:2}):be.length>0?d.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:be.map((Kt,Ht)=>{const nt=String(Kt.start_at||Kt.date||""),Cr=String(Kt.end_at||""),Fs=String(Kt.summary||Kt.title||"Calendar Event"),ds=String(Kt.location||"");return d.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:Fs}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(jf,{className:"w-3 h-3"}),d.jsx("span",{children:Bo(nt)})]}),ds&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(dB,{className:"w-3 h-3"}),d.jsx("span",{children:ds})]})]}),d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(Sv,{className:"w-3 h-3"}),d.jsxs("span",{children:[Go(nt),Cr&&` - ${Go(Cr)}`]})]})]})]},Ht)})}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?d.jsx(d.Fragment,{children:d.jsx("p",{className:"mb-2",children:"No upcoming calendar entries found for this case"})}):"Select a client email thread to view calendar entries"})})]})},qa=()=>{const be=t.length>0&&n<t.length?t[n]:null,$e=be==null?void 0:be.last_completed_task,at=be==null?void 0:be.next_upcoming_task,zt=$e||at,Kt=be==null?void 0:be.id,Ht=Kt?`https://app.clio.com/nc/#/matters/${Kt}/tasks`:null;return d.jsxs("div",{className:"border-t bg-card",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[d.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>J(!Y),children:[d.jsx(uB,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Tasks"}),(zt||ve)&&!u&&(Y?d.jsx(Gv,{className:"w-4 h-4 text-gray-400"}):d.jsx(ns,{className:"w-4 h-4 text-gray-400"}))]}),d.jsxs("div",{className:"flex items-center gap-2",children:[E&&(ve?d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:nt=>{nt.stopPropagation(),le(!1),wn()},children:[d.jsx(Tk,{className:"w-3 h-3 mr-1"}),"Remove"]}):d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:nt=>{nt.stopPropagation(),le(!0)},children:[d.jsx(Rk,{className:"w-3 h-3 mr-1"}),"Add Task"]})),Ht&&d.jsxs("a",{href:Ht,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:nt=>nt.stopPropagation(),children:[d.jsx(Pl,{className:"w-3 h-3"}),"View all"]})]})]}),!Y&&d.jsxs(d.Fragment,{children:[ve&&d.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50",children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Name"}),d.jsx(Qr,{disabled:Ut,placeholder:Ut?"Generating task name...":"Enter task name...",value:Ne,onChange:nt=>He(nt.target.value),className:"h-8 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Description"}),d.jsx("textarea",{placeholder:Ut?"Generating task description...":"Enter task description...",value:Ue,onChange:nt=>Me(nt.target.value),disabled:Ut,className:`w-full min-h-[80px] px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${Ut?"opacity-60 cursor-not-allowed":""}`}),Ut&&d.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 dark:text-gray-400",children:[d.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),"Generating task from email..."]})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due At"}),d.jsx(Qr,{type:"date",value:Te,onChange:nt=>gt(nt.target.value),className:"h-8 text-sm"})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority"}),d.jsxs(Ns,{open:It,onOpenChange:hr,children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[d.jsx("span",{children:jt}),d.jsx(ns,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),d.jsx(os,{align:"start",className:"w-[140px]",children:["High","Normal","Low"].map(nt=>d.jsx(Wn,{className:`cursor-pointer ${jt===nt?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{ot(nt),hr(!1)},children:nt},nt))})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Assign To"}),d.jsxs(Ns,{open:Nt,onOpenChange:Sr,children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[d.jsx("span",{className:"truncate",children:Ir||"Select assignee"}),d.jsx(ns,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),d.jsxs(os,{align:"start",className:"w-[320px] p-0",children:[d.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search Users"}),d.jsxs("div",{className:"relative",children:[d.jsx(qs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(Qr,{placeholder:"Search by name...",value:Ie,onChange:nt=>{const Cr=nt.target.value;Ge(Cr),qr(Cr)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:nt=>nt.stopPropagation(),onKeyDown:nt=>nt.stopPropagation()}),Ie&&d.jsx("button",{onClick:nt=>{nt.stopPropagation(),Ge(""),Ft([]),Vn(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(fi,{className:"w-4 h-4"})})]})]}),d.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:cr?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):as&&ut.length===0?d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:as}):ut.length>0?ut.map(nt=>d.jsx(Wn,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>{Ji(nt.id),ls(nt.name),Sr(!1),Ge(""),Ft([])},children:d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:nt.name})},nt.id)):Ie.trim()&&!cr?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No users found for "',Ie,'"']}):d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:Ir?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Currently assigned to: ",Ir]}),d.jsx("div",{className:"text-xs",children:"Type at least 2 characters to search for other users..."})]}):"Type at least 2 characters to search users..."})})]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",id:"hasReminder",checked:gi,onChange:nt=>Xi(nt.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"hasReminder",className:"text-xs font-medium text-gray-700 dark:text-gray-300 cursor-pointer",children:"Add Reminder"})]}),gi&&d.jsxs("div",{className:"pl-5 space-y-2 border-l-2 border-gray-200 dark:border-gray-600",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remind"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(Qr,{type:"number",min:"1",value:Xs,onChange:nt=>bo(Math.max(1,parseInt(nt.target.value)||1)),className:"h-8 text-sm w-20"}),d.jsxs(Ns,{open:cs,onOpenChange:Ho,children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"outline",className:"flex-1 h-8 text-sm justify-between font-normal",children:[d.jsx("span",{children:Qs}),d.jsx(ns,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),d.jsx(os,{align:"start",className:"w-[140px]",children:["Minutes","Hours","Days","Weeks"].map(nt=>d.jsx(Wn,{className:`cursor-pointer ${Qs===nt?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{Qi(nt),Ho(!1)},children:nt},nt))})]})]}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"before due date"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Delivery Method"}),d.jsx("div",{className:"w-full h-8 px-3 text-sm flex items-center border border-input rounded-md bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:"Email"})]})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",id:"appendEmailToDescription",checked:Dr,onChange:nt=>lt(nt.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"appendEmailToDescription",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Append email to Description"})]}),!Is&&d.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",id:"notifyAssignee",checked:vi,onChange:nt=>Zi(nt.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"notifyAssignee",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify assignee when task is assigned"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",id:"notifyCompletion",checked:Wa,onChange:nt=>us(nt.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"notifyCompletion",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify me when task is completed"})]})]}),d.jsx(ze,{onClick:xi,disabled:er,className:"w-full h-8 text-sm",children:er?"Creating task in Clio...":"Create Task"})]})}),pt&&d.jsx("div",{className:`p-2 rounded-md text-sm ${pt.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:pt.text}),Pt&&d.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:d.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[d.jsx(Sv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Newly Created Task"}),d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Pt.name||"Untitled Task")}),d.jsxs("div",{className:"space-y-1",children:[!!Pt.due_at&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(jf,{className:"w-3 h-3"}),d.jsxs("span",{children:["Due: ",Bo(String(Pt.due_at))]})]}),!!Pt.priority&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"font-medium",children:"Priority:"}),d.jsx("span",{children:String(Pt.priority)})]})]})]})]})}),u?d.jsx(Vs,{rows:2}):zt?d.jsxs("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[$e&&d.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:d.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[d.jsx(Uc,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Last Completed Task"}),d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String($e.name||"Untitled Task")}),!!$e.completed_at&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(jf,{className:"w-3 h-3"}),d.jsxs("span",{children:["Completed: ",Bo(String($e.completed_at))]})]})]})]})}),at&&d.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:d.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[d.jsx(Sv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Next Upcoming Task"}),d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(at.name||"Untitled Task")}),d.jsxs("div",{className:"space-y-1",children:[!!at.due_at&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(jf,{className:"w-3 h-3"}),d.jsxs("span",{children:["Due: ",Bo(String(at.due_at))]})]}),!!at.priority&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"font-medium",children:"Priority:"}),d.jsx("span",{children:String(at.priority)})]})]})]})]})})]}):!ve&&!Pt?d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?d.jsx(d.Fragment,{children:d.jsx("p",{className:"mb-2",children:"No tasks found for this matter"})}):"Select a client email thread to view tasks"}):null]})]})},ud=()=>{const be=t.length>0&&n<t.length?t[n]:null,$e=be==null?void 0:be.most_recent_note,at=$e&&$e.detail,zt=be==null?void 0:be.id,Kt=zt?`https://app.clio.com/nc/#/matters/${zt}/notes`:null;return d.jsxs("div",{className:"border-t bg-card",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[d.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>te(!he),children:[d.jsx(Jf,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Latest Note"}),!!at&&!u&&d.jsx(d.Fragment,{children:he?d.jsx(Gv,{className:"w-4 h-4 text-gray-400"}):d.jsx(ns,{className:"w-4 h-4 text-gray-400"})})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[zt&&(ta?d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:Ht=>{Ht.stopPropagation(),ra(!1),yi()},children:[d.jsx(Tk,{className:"w-3 h-3 mr-1"}),"Remove"]}):d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:Ht=>{Ht.stopPropagation(),ra(!0)},children:[d.jsx(Rk,{className:"w-3 h-3 mr-1"}),"Add Note"]})),Kt&&d.jsxs("a",{href:Kt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:Ht=>Ht.stopPropagation(),children:[d.jsx(Pl,{className:"w-3 h-3"}),"View all"]})]})]}),ta&&d.jsx("div",{className:"bg-gray-50/50 dark:bg-gray-800/30 p-3 border-b border-gray-200 dark:border-gray-700",children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),d.jsx(Qr,{type:"text",value:na,onChange:Ht=>it(Ht.target.value),placeholder:"Enter note subject...",className:"h-9 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Note"}),d.jsx("textarea",{value:Q,onChange:Ht=>De(Ht.target.value),placeholder:"Enter note details...",className:"w-full min-h-[80px] px-3 py-2 text-sm border rounded-md resize-y dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100",rows:3})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),d.jsx(Qr,{type:"date",value:We,onChange:Ht=>xr(Ht.target.value),className:"h-9 text-sm"})]}),d.jsx(ze,{onClick:qn,disabled:Dt,className:"w-full h-9",children:Dt?"Creating note in Clio...":"Create Note"})]})}),Hr&&d.jsx("div",{className:`p-2 rounded-md text-sm ${Hr.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:Hr.text}),!he&&d.jsx(d.Fragment,{children:u?d.jsx(Vs,{rows:1}):at?d.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:d.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-2",children:String($e.subject||"Note")}),d.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400 mb-2",children:[d.jsx(jf,{className:"w-3 h-3"}),d.jsx("span",{children:Bo(String($e.created_at))}),(()=>{const Ht=Go(String($e.created_at||""));return Ht?d.jsxs(d.Fragment,{children:[d.jsx("span",{children:""}),d.jsx(Sv,{className:"w-3 h-3"}),d.jsx("span",{children:Ht})]}):null})()]}),d.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:(()=>{const Ht=String($e.detail||""),nt=wi(Ht);return ue||!nt?d.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:Xc(Ht)}}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"line-clamp-3 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:Xc(Ht)}}),d.jsx("button",{onClick:Cr=>{Cr.stopPropagation(),we(!0)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-1 text-xs font-medium",children:"Expand"})]})})()}),ue&&d.jsx("button",{onClick:Ht=>{Ht.stopPropagation(),we(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-2 text-xs font-medium",children:"Show less"})]})}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?"No notes found for this matter":"Select a client email thread to view matter notes"})})]})};return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Matters and Calendar Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(GR,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"MATTERS"})]}),d.jsxs(Ns,{open:Ee,onOpenChange:V,children:[d.jsx(Ts,{asChild:!0,children:d.jsx(ze,{variant:"ghost",size:"icon",className:"h-8 w-8 hidden",title:"Search all matters",children:d.jsx(qs,{className:"h-4 w-4"})})}),d.jsxs(os,{align:"end",className:"w-[320px] p-0",children:[d.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Matters"}),d.jsxs("div",{className:"relative",children:[d.jsx(qs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(Qr,{placeholder:"Search by matter or client name...",value:G,onChange:be=>{const $e=be.target.value;z($e),ad($e)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:be=>be.stopPropagation(),onKeyDown:be=>be.stopPropagation()}),G&&d.jsx("button",{onClick:be=>{be.stopPropagation(),z(""),D([]),xe(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(fi,{className:"w-4 h-4"})})]})]}),d.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:M?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):ce&&K.length===0?d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:ce}):K.length>0?K.map(be=>d.jsxs(Wn,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>ld(be),children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:be.projectName}),d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[be.phaseName,"  Client: ",be.clientName]})]},be.projectId.native)):G.trim()&&!M?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',G,'"']}):d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search matters..."})})]})]})]}),u?cd():S?d.jsxs(Py,{variant:"destructive",className:"m-2",children:[d.jsx(yy,{className:"h-4 w-4"}),d.jsx(Fy,{className:"ml-2",children:"Failed to fetch matter data. Please refresh to try again."})]}):e&&Object.keys(e).length>0?d.jsxs(d.Fragment,{children:[t.length>0&&d.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[d.jsxs("div",{className:"flex-1 min-w-0 flex items-center",children:[t.length>1&&d.jsxs(Ns,{open:pe,onOpenChange:Ps,children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[d.jsx("span",{className:"truncate",title:e.Title||"",children:e.Title||"Case"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",n+1,"/",t.length,")"]}),d.jsx(ns,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),d.jsxs(os,{align:"start",className:"w-[280px] p-0",children:[d.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"relative",children:[d.jsx(qs,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(Qr,{placeholder:"Search matters...",value:ie,onChange:be=>se(be.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:be=>be.stopPropagation(),onKeyDown:be=>be.stopPropagation()}),ie&&d.jsx("button",{onClick:be=>{be.stopPropagation(),se("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(fi,{className:"w-4 h-4"})})]}),ie&&d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",Jc.length," of ",t.length]})]}),d.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:Jc.length>0?Jc.map(be=>{const $e=t.findIndex(at=>at===be);return d.jsx(Wn,{className:`text-xs truncate ${$e===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>sa($e),children:String(be.description||`Case ${$e+1}`)},$e)}):d.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No matters match "',ie,'"']})})]})]}),t.length===1&&d.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 px-2 truncate",title:e.Title||"",children:e.Title||"Case"})]}),((oa=s.find(be=>be.field==="Title"))==null?void 0:oa.url)&&d.jsxs("a",{href:(sr=s.find(be=>be.field==="Title"))==null?void 0:sr.url,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[d.jsx(Pl,{className:"w-3 h-3"}),"View"]})]}),kt&&!p&&d.jsx(yw,{createdContacts:A,onMatterLinked:j}),d.jsx("div",{className:"break-words",children:d.jsx(Yc,{details:e})}),ud(),Va(),qa()]}):x?d.jsx(Vs,{rows:2}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?d.jsxs(d.Fragment,{children:[d.jsx("p",{className:"mb-2",children:"Select a client email thread to view matter information"}),kt&&!p&&d.jsx(yw,{createdContacts:A,onMatterLinked:j})]}):d.jsxs(d.Fragment,{children:[kt&&!p&&d.jsx(yw,{createdContacts:A,onMatterLinked:j}),!kt&&"Select a client email thread to view case information"]})})]})},xw="src/shared/components/sidepanel/panels/components/UnifiedSearch.tsx",Bq=({onMatterSelected:r})=>{const e=Or(),t=w.useRef(null),[n,s]=w.useState(""),[i,c]=w.useState([]),[u,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState(null);w.useEffect(()=>{const S=T=>{t.current&&!t.current.contains(T.target)&&g(!1)};return document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[]);const E=w.useMemo(()=>Iy.debounce(async S=>{if(!S.trim()||S.length<2){c([]),b(null);return}p(!0),b(null);try{const T=await Hy("clio",S,e);c(T.projects||[]),T.projects.length===0&&b(`No matters found for "${S}"`)}catch(T){e.error("Matter search failed",T,{sourceFile:xw}),b("Failed to search matters. Please try again."),c([])}finally{p(!1)}},400),[e]),N=S=>{var T,R;try{e.info("Matter selected via unified search",{matterId:(R=(T=S.projectId)==null?void 0:T.native)==null?void 0:R.toString(),matterName:S.projectName,sourceFile:xw}),r(S),g(!1),s(""),c([]),b(null)}catch(A){e.error("Failed to select matter",A,{sourceFile:xw})}};return d.jsxs("div",{ref:t,className:"w-full mb-3 p-1",children:[d.jsxs("div",{className:"relative",children:[d.jsx(qs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none z-10"}),d.jsx(Qr,{placeholder:"Search clients and matters...",value:n,onChange:S=>{const T=S.target.value;s(T),g(!0),E(T)},onFocus:()=>g(!0),className:"pl-10 pr-10 h-10 text-sm border border-border/50 rounded-lg shadow-sm bg-card"}),n&&d.jsx("button",{onClick:S=>{S.stopPropagation(),s(""),c([]),b(null),g(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 z-10",children:d.jsx(fi,{className:"w-4 h-4"})})]}),m&&(n.length>=2||u||i.length>0)&&d.jsx("div",{className:"relative",children:d.jsx("div",{className:"absolute top-2 left-0 right-0 z-50 w-full max-w-full border border-border/50 rounded-lg shadow-lg bg-card",children:d.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:u?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):x&&i.length===0?d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:x}):i.length>0?i.map(S=>d.jsxs("div",{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 border-b border-gray-100 dark:border-gray-700 last:border-b-0",onClick:()=>N(S),children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:S.projectName}),d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[S.phaseName,"  Client: ",S.clientName]})]},S.projectId.native)):n.trim()&&!u?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',n,'"']}):d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search clients and matters..."})})})})]})},go="src/shared/hooks/useParticipantValidation.ts",Gq=0,ww=1,m1=2e3,g1=3e4;function Wq(r){const e=r.message.toLowerCase();return e.includes("client not found")||e.includes("404")||e.includes("not found")}function Vq(r){const e=r.message.toLowerCase();return e.includes("timed out")||e.includes("timeout")||e.includes("504")||e.includes("503")||e.includes("network")||e.includes("failed to fetch")}function qq({emailParticipants:r,getClientDetailsForEmail:e,clientDataCache:t,isValidClientData:n,onClientDataValidated:s,refreshTrigger:i,onTransientError:c,onValidationComplete:u}){const p=Or(),m=w.useRef(null),g=w.useRef(new Set),x=w.useCallback(async(T,R)=>{var $;if(R.aborted)return;const A=T.toLowerCase();if(g.current.has(A)){p.debug("Skipping duplicate in-flight validation",{sourceFile:go,email:T});return}g.current.add(A);let j,P,U=!1;const B=e(T);try{if(await Promise.race([B,new Promise((he,te)=>{j=setTimeout(()=>{U=!0,te(new Error(`Request timed out after ${g1}ms`))},g1),P=()=>{clearTimeout(j),te(new DOMException("Aborted","AbortError"))},R.addEventListener("abort",P,{once:!0})})]),R.aborted)return;const Y=($=t.current)==null?void 0:$[T],J=Y?n(Y):!1;s(T,J),p.debug("Participant validation result",{sourceFile:go,email:T,hasValidData:J})}catch(Y){if(R.aborted)return;Y instanceof Error?Wq(Y)?(p.debug("Participant not found in system",{sourceFile:go,email:T,error:Y.message}),s(T,!1)):Vq(Y)?(p.warn("Participant validation timed out or network error - marking as pending",{sourceFile:go,email:T,error:Y.message}),s(T,!1),c==null||c(T,Y),U&&B.then(()=>{var te;if(R.aborted)return;const J=(te=t.current)==null?void 0:te[T];(J?n(J):!1)&&(p.info("Request succeeded after timeout - updating validation",{sourceFile:go,email:T}),console.log(` [Late Success] Data loaded after timeout for ${T}`),s(T,!0))}).catch(J=>{R.aborted||p.debug("Request failed after timeout",{sourceFile:go,email:T,error:J instanceof Error?J.message:String(J)})})):(p.error("Participant validation failed with unexpected error",Y,{sourceFile:go,email:T}),s(T,!1)):(p.error("Participant validation failed with non-Error",new Error(String(Y)),{sourceFile:go,email:T}),s(T,!1))}finally{j!==void 0&&clearTimeout(j),P&&R.removeEventListener("abort",P),g.current.delete(A)}},[e,t,n,s,c,p]),b=w.useCallback(async(T,R)=>{await Promise.all(T.map(A=>x(A,R)))},[x]),E=(T,R)=>new Promise((A,j)=>{if(R.aborted)return j(new DOMException("Aborted","AbortError"));const P=()=>{clearTimeout(U),j(new DOMException("Aborted","AbortError"))},U=setTimeout(()=>{R.removeEventListener("abort",P),A()},T);R.addEventListener("abort",P,{once:!0})}),N=w.useMemo(()=>[...r].sort().join(","),[r]),S=w.useRef(Gq);w.useEffect(()=>{var U;if(r.length===0)return;(U=m.current)==null||U.abort();const T=new AbortController;m.current=T;const R=g.current,A=i>S.current,j=t.current;return A&&j&&(Object.keys(j).forEach(B=>{delete j[B]}),vT(p),F5(),R.clear(),p.debug("Cleared all cache tiers for refresh",{sourceFile:go,refreshTrigger:i})),S.current=i,(async()=>{const{signal:B}=T;p.info("Validating all email participants (rate-limited)",{sourceFile:go,participantCount:r.length,batchSize:ww,batchDelayMs:m1});const $=[];for(let Y=0;Y<r.length;Y+=ww)$.push(r.slice(Y,Y+ww));for(let Y=0;Y<$.length;Y++){if(B.aborted){p.debug("Validation aborted",{sourceFile:go});return}const J=$[Y];if(p.debug("Processing validation batch",{sourceFile:go,batchIndex:Y+1,totalBatches:$.length,batchEmails:J}),await b(J,B),Y<$.length-1&&!B.aborted)try{await E(m1,B)}catch(he){if(he instanceof DOMException&&he.name==="AbortError"){p.debug("Validation delay aborted",{sourceFile:go});return}throw he}}p.info("Completed validating all participants",{sourceFile:go,participantCount:r.length}),u==null||u()})(),()=>{T.abort(),R.clear()}},[N,b,p,i,t,u])}const eF=w.createContext(void 0),Kq=({children:r})=>{const[e,t]=w.useState(0),[n,s]=w.useState(!1),i=w.useRef(null),[c,u]=w.useState(!0),p=w.useRef(new Map),m=Ul(),g=async R=>{try{return await m.getLocalItem(`elapsedTime_${R}`)??0}catch(A){return console.warn("Failed to read from storage, using in-memory storage:",A),p.current.get(R)??0}},x=async(R,A)=>{try{await m.setLocalItem(`elapsedTime_${R}`,A)}catch(j){console.warn("Failed to write to storage, using in-memory storage:",j),p.current.set(R,A)}},b=()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},E=async R=>{!n&&c&&(s(!0),b(),g(R).then(A=>{t(A)}),i.current=window.setInterval(()=>{t(A=>{const j=A+1;return x(R,j),j})},1e3))},N=async R=>{if(n){s(!1),b();const A=await g(R);x(R,A)}},S=R=>{x(R,0),t(0)},T=async R=>await g(R);return w.useEffect(()=>()=>{b()},[]),d.jsx(eF.Provider,{value:{elapsedTime:e,isTimerRunning:n,startTimer:E,stopTimer:N,resetTimer:S,getElapsedTimeForThread:T,setShouldStartTimer:u,setElapsedTime:t},children:r})},tF=()=>{const r=w.useContext(eF);if(!r)throw new Error("useTimer must be used within a TimerProvider");return r},bw=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},Yq=({userData:r,clientEmail:e,fileToMatterChecked:t,casesForCurrentClient:n,selectedCase:s,onSave:i,onCancel:c})=>{const u=Or(),p=sd(),{platform:m}=tn(),{elapsedTime:g,stopTimer:x,resetTimer:b}=tF(),[E,N]=w.useState(new Date().toISOString().slice(0,10)),[S,T]=w.useState(bw(g)),[R,A]=w.useState(""),[j,P]=w.useState(s||n[0]||{}),U=t,[B,$]=w.useState((r==null?void 0:r.rate)||null),[Y,J]=w.useState(!1),[he,te]=w.useState("Failed to save time entry. Please try again."),[ue,we]=w.useState(!1),[ie,se]=w.useState(!1),[pe,ee]=w.useState(!1),[G,z]=w.useState(!1),K=nr.useRef(null),[D,M]=w.useState(!1),oe=async()=>{if(ee(!0),!(j!=null&&j.id)){ee(!1),z(!0),te("Please select a matter to file the time entry.");return}const V=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/,ce=S.trim().match(V);if(!ce){ee(!1),z(!0),te("Please enter a valid duration in HH:MM:SS format.");return}const[,xe,ve,le]=ce,Ne=Number(xe)*3600+Number(ve)*60+Number(le);if(!E||!/^\d{4}-\d{2}-\d{2}$/.test(E)||Number.isNaN(Date.parse(E))){ee(!1),z(!0),te("Please select a valid date (YYYY-MM-DD).");return}if(!K.current){ee(!1),z(!0),te("Unable to retrieve email thread information.");return}m==="chrome"&&kT(K.current,u).then(async Ue=>{if(Ue.length!=0)try{const Me=Ue[Ue.length-1],Te=Me.to.concat(Me.cc),gt=Me.from,jt=Me.subject||"",ot=Me.body||"",Ut=Me.date||"",Zt=Te,er=R.trim().replace(/[<>]/g,"").substring(0,5e3),et=await ty(e,"clio",E,Ne,er,j==null?void 0:j.id,U,jt,ot,Ut,gt,Zt,ue,ie,B,u);u.info("Time entry successfully written to server",{sourceFile:"TimeEntryModal.tsx",message:et}),te("New email log and time entry created successfully."),ee(!1),z(!1),K.current&&(await x(K.current),b(K.current)),i()}catch(Me){u.error("Error writing time entry to server",{error:Me},{sourceFile:"TimeEntryModal.tsx"}),ee(!1),z(!0),te("Something went wrong. Please try again.")}}).catch(Ue=>{u.error("Error fetching email details from server",{error:Ue},{sourceFile:"TimeEntryModal.tsx"}),ee(!1),z(!0),te("Something went wrong. Please try again.")}),m==="outlook"&&p.getCurrentThread().then(async Ue=>{if(Ue===null){ee(!1),z(!0),te("Unable to retrieve email details. Please try again.");return}const Me=Ue.messages[Ue.messages.length-1].from,Te=Ue.subject||"",gt=Ue.messages[Ue.messages.length-1].body||"",jt=Ue.messages[Ue.messages.length-1].timestamp||"",ot=Ue.participants.filter((er=>er!==Me)),Ut=R.trim().replace(/[<>]/g,"").substring(0,5e3),Zt=await ty(e,"clio",E,Ne,Ut,j==null?void 0:j.id,U,Te,gt,jt,Me,ot,ue,ie,B,u);u.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:Zt}),te("New email log and time entry created successfully."),ee(!1),z(!1),K.current&&(await x(K.current),b(K.current)),i()}).catch(Ue=>{u.error("Error writing time entry to server",{error:Ue},{sourceFile:"TimeEntryModal.tsx"}),ee(!1),z(!0),te("Something went wrong. Please try again.")})},Ee=V=>{let ce="";const xe=(V==null?void 0:V.messages)||[];let ve=xe;return xe.length>3&&(ve=xe.slice(-3)),ve.forEach((le,Ne)=>{ce+=`Email ${Ne} Subject: ${le.subject||""}
Email ${Ne} Body: ${le.body||""}

`}),ce};return w.useEffect(()=>{const V=async()=>{p==null||p.getCurrentThread().then(xe=>{M(!0);const ve=(xe==null?void 0:xe.threadId)||null;if(!ve){M(!1);return}if(m==="outlook"){const le=Ee(xe);EC(ve,le,u).then((Ne=>{A(Ne.description),M(!1)})).catch(Ne=>{u.error("Error generating email description summary",Ne,{sourceFile:"TimeEntryModal.tsx"}),M(!1)})}m==="chrome"&&EC(ve,null,u).then(le=>{A(le.description),M(!1)}).catch(le=>{u.error("Error generating email description summary",le,{sourceFile:"TimeEntryModal.tsx"}),M(!1)})})},ce=()=>{p==null||p.getCurrentThread().then(xe=>{K.current=(xe==null?void 0:xe.threadId)||null})};V(),ce()},[U,p,u]),w.useEffect(()=>{var V,ce,xe,ve;(ve=(xe=(ce=(V=j==null?void 0:j.raw_data)==null?void 0:V.custom_rate)==null?void 0:ce.rates)==null?void 0:xe[0])!=null&&ve.rate?$(j.raw_data.custom_rate.rates[0].rate):$((r==null?void 0:r.rate)||0)},[j,r]),d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 dark:bg-opacity-70 z-50 p-4 overflow-y-auto",onClick:c,children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg w-full max-w-lg p-6 my-auto max-h-[90vh] overflow-y-auto",onClick:V=>V.stopPropagation(),children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsxs("h2",{className:"text-lg font-semibold text-blue-600 dark:text-blue-400",children:["Review Time Entry"," "]}),d.jsx("button",{className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",onClick:c,children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),G&&d.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:d.jsxs("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:[d.jsx("svg",{className:"w-5 h-5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:d.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.72-1.36 3.485 0l6.518 11.588c.75 1.334-.213 2.995-1.742 2.995H3.481c-1.529 0-2.492-1.661-1.742-2.995L8.257 3.1zM10 8a1 1 0 10-0 2 1 1 0 000-2zm0 4a1 1 0 01-.993-.883L9 11V9a1 1 0 012 0v2a1 1 0 01-.883.993L10 12z",clipRule:"evenodd"})}),d.jsxs("div",{className:"ml-3 flex-1",children:[d.jsx("p",{className:"font-medium",children:"Error"}),d.jsx("p",{className:"mt-1 text-sm",children:he})]})]})}),d.jsx("p",{className:"mb-4",children:"Review and edit details before saving."}),d.jsxs("div",{className:"flex gap-4 mb-4 w-full",children:[d.jsxs("div",{className:"shrink-0",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date"}),d.jsx("input",{type:"date",value:E,onChange:V=>N(V.target.value),className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]"})]}),d.jsxs("div",{className:"shrink-0",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Duration"}),d.jsx("input",{type:"text",value:S,onChange:V=>{const ce=V.target.value,xe=/^(\d{0,2})(:\d{0,2}){0,2}$/;ce.length<=8&&/^[0-9:]*$/.test(ce)&&xe.test(ce)&&T(ce)},onBlur:V=>{const ce=V.target.value.trim(),xe=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/;if(xe.test(ce)){const[,ve,le,Ne]=ce.match(xe),He=Number(ve)*3600+Number(le)*60+Number(Ne);T(bw(He))}else T(bw(g))},className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]",style:{width:"10ch"},"aria-label":"Duration (HH:MM:SS)"})]})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),d.jsx("textarea",{disabled:D,value:D?"Generating AI description...":R,onChange:V=>A(V.target.value),className:"mt-1 block w-full border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500",rows:3})]}),d.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-4",children:d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100",children:"Billed By"}),d.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900 dark:text-gray-100",children:"Rate"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 text-right",children:(r==null?void 0:r.name)||"Unknown"}),d.jsxs("div",{className:"flex items-center justify-end gap-2",children:[d.jsx("input",{value:B??0,onChange:V=>$(Number(V.target.value)||0),onBlur:()=>J(!1),className:Y?"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 inline-block":"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-transparent rounded bg-transparent inline-block","aria-label":"Rate",disabled:!Y,style:{width:`${Math.max(String(B??0).length,1)+1}ch`}}),d.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300","aria-label":"Edit rate",onClick:()=>J(!Y),children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536M4 20h4.586a1 1 0 00.707-.293l9.414-9.414a1 1 0 000-1.414L15.121 4.88a1 1 0 00-1.414 0L4 14.586V20z"})})})]})]})]})}),d.jsxs("div",{className:"mb-4 mt-5",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Matter"}),d.jsxs(Ns,{children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"ghost",size:"sm",className:"mt-1 h-[38px] text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm w-full justify-between",children:[d.jsx("span",{className:"truncate",title:String((j==null?void 0:j.description)||"Select a matter"),children:String((j==null?void 0:j.description)||"Select a matter")}),d.jsx(ns,{className:"w-4 h-4 ml-1 flex-shrink-0"})]})}),d.jsx(os,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"var(--radix-dropdown-menu-trigger-width)"},children:n.map((V,ce)=>d.jsx(Wn,{className:"text-sm truncate max-w-full",onClick:()=>P(V),title:String((V==null?void 0:V.description)||`Case ${ce+1}`),children:String((V==null?void 0:V.description)||`Case ${ce+1}`)},ce))})]})]}),d.jsxs("div",{className:"mb-4 bg-blue-50 dark:bg-blue-950/30 p-3 rounded-md",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"fileToMatter",checked:ue,onChange:V=>we(V.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"fileToMatter",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Non-billable"})]}),ue&&d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"billEntry",checked:ie,onChange:V=>se(V.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"billEntry",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Show this entry on the bill"})]})]}),d.jsxs("div",{className:"flex flex-col gap-3",children:[d.jsx(ze,{className:"w-full p-2",disabled:pe,onClick:oe,children:pe?"Saving...":"Save Time Entry"}),d.jsx("button",{className:"w-full p-2 bg-transparent text-white hover:cursor-pointer hover:bg-transparent shadow-none border-none",disabled:pe,onClick:c,children:"Cancel"})]})]})})},Jq=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},Xq=({userData:r,clientEmail:e,emailParticipantClients:t,currentCaseIndex:n,casesForCurrentClient:s})=>{const i=Or(),{elapsedTime:c,isTimerRunning:u,startTimer:p,stopTimer:m,resetTimer:g,setShouldStartTimer:x,setElapsedTime:b}=tF(),E=sd(),{platform:N}=tn(),[S,T]=w.useState(s[0]||null),[R,A]=w.useState(!0),[j,P]=w.useState(!1),[U,B]=w.useState(!1),$=nr.useRef(null),[Y,J]=w.useState(s||null),he=new Date().toISOString().slice(0,10),te="",[ue,we]=w.useState("Failed to save time entry. Please try again."),[ie,se]=w.useState(!1),[pe,ee]=w.useState(!1),G=async()=>{if(se(!0),!he||!/^\d{4}-\d{2}-\d{2}$/.test(he)||Number.isNaN(Date.parse(he))){se(!1),ee(!0),we("Please select a valid date (YYYY-MM-DD).");return}if($.current===null){se(!1),ee(!0),we("Unable to retrieve email details. Please try again.");return}N==="chrome"&&kT($.current,i).then(async M=>{if(M.length<1){se(!1),ee(!0),we("Unable to retrieve email details. Please try again.");return}try{const oe=M[M.length-1],Ee=oe.to.concat(oe.cc),V=oe.from,ce=oe.subject||"",xe=oe.body||"",ve=oe.date||"",le=Ee,Ne=te.trim().replace(/[<>]/g,"").substring(0,5e3),He=await ty(e,"clio",he,c,Ne,S==null?void 0:S.id,R,ce,xe,ve,V,le,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:He}),we("New email log created successfully."),se(!1),ee(!1),B(!0),$.current&&(await m($.current),g($.current))}catch(oe){i.error("Error writing time entry to server",oe,{sourceFile:"InsightsTimer.tsx"}),se(!1),ee(!0),we("Something went wrong. Please try again.")}}).catch(M=>{i.error("Error fetching email details from server",M,{sourceFile:"InsightsTimer.tsx"}),se(!1),ee(!0),we("Something went wrong. Please try again.")}),N==="outlook"&&E.getCurrentThread().then(async M=>{if(M===null||!M.messages||M.messages.length===0){se(!1),ee(!0),we("Unable to retrieve email details. Please try again.");return}const oe=M.messages[M.messages.length-1].from,Ee=M.subject||"",V=M.messages[M.messages.length-1].body||"",ce=M.messages[M.messages.length-1].timestamp||"",xe=M.participants.filter((Ne=>Ne!==oe)),ve=te.trim().replace(/[<>]/g,"").substring(0,5e3),le=await ty(e,"clio",he,c,ve,S==null?void 0:S.id,R,Ee,V,ce,oe,xe,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:le}),we("New email log created successfully."),se(!1),ee(!1),B(!0),$.current&&(await m($.current),g($.current))}).catch(M=>{se(!1),ee(!0),we("Something went wrong. Please try again."),i.error("Error getting current thread",M,{sourceFile:"InsightsTimer.tsx"})})},z=async()=>{P(!1),B(!0),ee(!1),we("Successfully wrote email log and time entry"),$.current&&(await m($.current),g($.current))},K=async()=>{P(!1),x(!0),$.current&&await m($.current)};return w.useEffect(()=>{if(!u)return;(()=>{E==null||E.getCurrentThread().then(M=>{$.current=(M==null?void 0:M.threadId)||null})})()},[u,E]),w.useEffect(()=>{J(s),T(s[n]||null),B(!1),P(!1)},[n,s,r]),w.useEffect(()=>{let D=!0;const M=async ve=>{if(!D)return;const le=(ve==null?void 0:ve.threadId)||null;if(!le){$.current&&document.visibilityState==="visible"&&(await m($.current),b(0),i.info("Thread cleared - stopping timer",{sourceFile:"InsightsTimer.tsx"})),$.current=null;return}le!==$.current&&(i.info("Thread changed - starting timer",{sourceFile:"InsightsTimer.tsx",oldThreadId:$.current,newThreadId:le}),$.current&&await m($.current),$.current=le,x(!0),document.visibilityState==="visible"&&p(le))};E&&(E.onThreadChanged(M),E.getCurrentThread().then(ve=>{M(ve)}).catch(ve=>{i.error("Error getting initial thread",ve,{sourceFile:"InsightsTimer.tsx"})}));const oe=async()=>{$.current&&await m($.current)},Ee=async()=>{try{if(!E)return;const ve=await E.getCurrentThread(),le=(ve==null?void 0:ve.threadId)||null;if(!le||u&&$.current===le)return;$.current=le,p(le)}catch(ve){i.error("Error starting timer on visibility/focus",ve,{sourceFile:"InsightsTimer.tsx"})}},V=()=>{document.visibilityState==="hidden"?oe():document.visibilityState==="visible"&&Ee()},ce=()=>Ee(),xe=()=>oe();return document.addEventListener("visibilitychange",V),window.addEventListener("focus",ce),window.addEventListener("blur",xe),document.visibilityState==="visible"&&Ee(),()=>{D=!1,E&&E.removeThreadListener(M),document.removeEventListener("visibilitychange",V),window.removeEventListener("focus",ce),window.removeEventListener("blur",xe)}},[E,p,m,x,i]),w.useEffect(()=>{if(U||pe){const D=setTimeout(()=>{B(!1),ee(!1)},5e3);return()=>clearTimeout(D)}},[U,pe]),d.jsxs(d.Fragment,{children:[j&&d.jsx(Yq,{userData:r,clientEmail:e,emailParticipantClients:t,fileToMatterChecked:R,casesForCurrentClient:Y,selectedCase:S,onSave:z,onCancel:K}),d.jsxs("div",{className:"flex flex-col gap-3 p-2 border rounded-md bg-blue-50 dark:bg-gray-800 border-blue-500 dark:border-gray-600 shadow-sm",children:[d.jsx("h2",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:"File email log"}),d.jsxs("div",{className:"flex items-center gap-1.5 overflow-hidden",children:[d.jsxs("button",{type:"button",onClick:async()=>{$.current&&(u?(x(!1),await m($.current)):(x(!0),p($.current)))},className:"flex items-center justify-start gap-1.5 w-[110px] h-[34px] px-2 rounded-md bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors border border-gray-200 dark:border-gray-600 overflow-hidden flex-shrink-0",children:[d.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:u?d.jsx(fB,{className:"w-4 h-4 text-green-700 dark:text-green-400"}):d.jsx(pB,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"})}),d.jsx("span",{className:`text-base font-semibold ${u?"text-green-700 dark:text-green-400":"text-gray-700 dark:text-gray-300"} whitespace-nowrap w-[70px] text-center flex-shrink-0`,children:Jq(c)})]}),d.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400 flex-shrink min-w-0",children:[d.jsx("input",{type:"checkbox",id:"fileToMatter",checked:R,onChange:D=>A(D.target.checked),className:"cursor-pointer flex-shrink-0"}),d.jsx("span",{className:"truncate",children:"Add time entry"})]}),d.jsx("div",{className:"min-w-0 flex-1",children:d.jsx(ze,{disabled:ie,onClick:async()=>{if($.current){if(R){P(!0),x(!1),await m($.current);return}se(!0),x(!1),await m($.current),G()}},size:"sm",className:"h-8 text-xs px-1.5 w-full flex items-center justify-center",children:d.jsx("span",{className:"truncate",children:ie?"Saving...":"Save"})})})]}),d.jsx("div",{className:"min-w-0",children:d.jsx("div",{className:"flex items-center gap-2 w-full min-w-0",children:d.jsxs(Ns,{children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md w-full justify-between min-w-0",children:[d.jsx("span",{className:"truncate",title:String((S==null?void 0:S.description)||"Select a matter"),style:{maxWidth:"24ch",display:"inline-block"},children:String((S==null?void 0:S.description)||"Select a matter")}),d.jsx(ns,{className:"w-3 h-3 ml-1"})]})}),d.jsx(os,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"100%"},children:Y.map((D,M)=>d.jsx(Wn,{className:"text-xs truncate max-w-full",onClick:()=>T(D),title:String((D==null?void 0:D.description)||`Case ${M+1}`),children:String((D==null?void 0:D.description)||`Case ${M+1}`)},M))})]})})})]}),U&&d.jsx("div",{role:"success","aria-live":"assertive",className:"mt-3",children:d.jsx("div",{className:"flex items-start border rounded-md p-3 border-green-200 dark:border-green-700 text-green-900 dark:text-green-100 bg-green-50 dark:bg-green-900",children:d.jsx("div",{className:"ml-3 flex-1",children:d.jsx("p",{className:"mt-1 text-sm",children:ue})})})}),pe&&d.jsx("div",{role:"alert","aria-live":"assertive",className:"mt-3",children:d.jsx("div",{className:"flex items-start border rounded-md p-3 border-red-200 dark:border-red-700 text-red-900 dark:text-red-100 bg-red-50 dark:bg-red-900",children:d.jsx("div",{className:"ml-3 flex-1",children:d.jsx("p",{className:"mt-1 text-sm",children:ue})})})})]})},Yt="src/sidepanel/panels/ClioInsights.tsx",Qq=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:u,currentCaseIndex:p,casesForCurrentClient:m,setCasesForCurrentClient:g,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:E,setIsProjectManuallySelected:N,isValidClient:S,isTempEmailValid:T,nextCase:R,prevCase:A,handleSetCurrentCaseIndex:j,ClientNavigation:P,onClientDataValidated:U,onTransientError:B,isValidating:$,refreshTrigger:Y,integrationSettings:J,hasTransientError:he})=>{const te=Or(),{platform:ue}=tn(),we=Ul(),[ie]=w.useState(!0),[se,pe]=w.useState({}),[ee,G]=w.useState({}),[z,K]=w.useState({}),[D,M]=w.useState({}),[oe,Ee]=w.useState([]),[V,ce]=w.useState(!1),[xe,ve]=w.useState(null),[le,Ne]=w.useState(null),[He,Ue]=w.useState(!1),[Me,Te]=w.useState([]),[gt,jt]=w.useState(!1),ot=w.useRef({}),Ut=w.useCallback(de=>{const Ie=typeof de=="string"?parseFloat(de):de;return isNaN(Ie)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Ie)},[]),Zt=w.useCallback(de=>{if(!de||!de.client_data||!Array.isArray(de.client_data)||de.client_data.length===0)return!1;const Ie=de.client_data[0];return Ie&&typeof Ie=="object"&&Object.keys(Ie).length>0},[]),er=w.useCallback(de=>{if(te.info("selectClientDetails called",{sourceFile:Yt,hasDetails:!!de,detailsKeys:de?Object.keys(de):[]}),!de){te.warn("selectClientDetails called with undefined details",{sourceFile:Yt}),G({}),K({}),pe({}),M({});return}te.info("Client details received for formatting",{sourceFile:Yt,clientDetails:de});const Ie=ft=>{const Nt=ft.replace(/\D/g,"");return Nt.length===10?`(${Nt.slice(0,3)}) ${Nt.slice(3,6)}-${Nt.slice(6)}`:ft};let Ge="";if(de.primary_phone_number)Ge=de.primary_phone_number;else if(de.phone_numbers)try{const ft=JSON.parse(de.phone_numbers);Array.isArray(ft)&&ft.length>0&&(Ge=ft[0].number||"")}catch{const ft=de.phone_numbers;Array.isArray(ft)&&ft.length>0&&(Ge=ft[0].number||"")}else de.phones&&Array.isArray(de.phones)&&(Ge=de.phones[0]||"");let ut="";if(de.primary_email_address)ut=de.primary_email_address;else if(de.email_addresses)try{const ft=JSON.parse(de.email_addresses);Array.isArray(ft)&&ft.length>0&&(ut=ft[0].address||"")}catch{const ft=de.email_addresses;Array.isArray(ft)&&ft.length>0&&(ut=ft[0].address||"")}else de.emails&&Array.isArray(de.emails)&&(ut=de.emails[0]||"");let Ft="";try{let ft=[];de.addresses&&(typeof de.addresses=="string"?ft=JSON.parse(de.addresses):ft=de.addresses);const Nt=ft[0];Nt&&(Ft=`${Nt.street?`${Nt.street}, `:""}${Nt.city?`${Nt.city}, `:""}${Nt.province?`${Nt.province}, `:""}${Nt.country?`${Nt.country} `:""}${Nt.postal_code?`${Nt.postal_code}`:""}`.trim())}catch{te.warn("Error formatting address",{sourceFile:Yt})}const cr={Name:de.name||"",Email:ut||"",Phone:Ie(Ge),Address:Ft||""};te.info("Client details formatted and set",{sourceFile:Yt,selectedDetails:cr,originalDetails:de}),G(de),K(cr)},[te,Ut]),et=w.useCallback(de=>{te.info("selectCaseDetails called",{sourceFile:Yt,hasDetails:!!de,detailsKeys:de?Object.keys(de):[]}),te.info("Case details received for formatting",{sourceFile:Yt,caseNames:de});const Ie={"Matter Number":de.name||"",Title:de.description||"","Maildrop Address":de.maildrop_address||"","Practice Area":de.practice_area||"",Status:de.status||"",Stage:de.matter_stage||"","Assigned To":de.responsible_attorney||"","Rate Type":de.custom_rate||"","Outstanding Balance":Ut(de.outstanding_balance||de.balance_outstanding||de.balance||0)};te.info("Case details formatted and set",{sourceFile:Yt,selectedDetails:Ie,originalDetails:de}),M(Ie)},[te,Ut]),It=w.useCallback(async de=>{te.info("Matter manually selected",{sourceFile:Yt,matterId:de.id,matterName:de.description}),e(""),b(!0),N(!0);try{const Ie=await n8("clio",de.id,te);if(Ie&&Object.keys(Ie).length>0){const Ge=Ie.case_data||Ie,ut=Ie.client_data||{};te.info("Complete matter data fetched successfully",{sourceFile:Yt,matterId:de.id,hasCalendarEntries:!!Ge.calendar_entries,hasLastCompletedTask:!!Ge.last_completed_task,hasNextUpcomingTask:!!Ge.next_upcoming_task,hasClientData:!!ut&&Object.keys(ut).length>0});const Ft={};if(Object.entries(Ge).forEach(([Nt,Sr])=>{Ft[Nt]=String(Sr??"")}),pe(Ft),et(Ft),ut&&Object.keys(ut).length>0){er(ut);let Nt="";if(ut.primary_email_address)Nt=String(ut.primary_email_address);else if(ut.email_addresses)try{const Sr=JSON.parse(String(ut.email_addresses));Array.isArray(Sr)&&Sr.length>0&&(Nt=Sr[0].address||"")}catch{const Sr=ut.email_addresses;Array.isArray(Sr)&&Sr.length>0&&(Nt=Sr[0].address||"")}else ut.emails&&Array.isArray(ut.emails)&&(Nt=String(ut.emails[0]||""));Nt&&n(Nt)}const cr=String(Ge.id||de.id||""),ft=(Ge.calendar_entries||[]).map(Nt=>({...Nt,case_id:cr}));Ee(ft),g([Ge]),j(0)}else{te.warn("Failed to fetch complete matter data, using basic data",{sourceFile:Yt,matterId:de.id});const Ge={};Object.entries(de).forEach(([ut,Ft])=>{Ge[ut]=String(Ft??"")}),pe(Ge),et(Ge),Ee([]),g([de]),j(0)}}catch(Ie){te.error("Error fetching complete matter data",Ie,{sourceFile:Yt,matterId:de.id});const Ge={};Object.entries(de).forEach(([ut,Ft])=>{Ge[ut]=String(Ft??"")}),pe(Ge),et(Ge),Ee([]),g([de]),j(0)}},[te,e,n,b,N,g,j,et,er,Ee]),hr=w.useCallback(async de=>{if(ot.current[de]){console.log(` [Cache L1] Component cache HIT for ${de}`),te.debug("Using cached client data (component cache)",{sourceFile:Yt,email:de});return}console.log(` [Cache L2] Checking browser storage for ${de}...`);const Ie=await gT(de,te);if(Ie){console.log(` [Cache L2] Browser storage HIT - SALVAGED data for ${de}`),te.debug("Using cached client data (browser storage - salvaged)",{sourceFile:Yt,email:de}),ot.current[de]=Ie;return}console.log(` [Cache L2] Browser storage MISS for ${de}`);try{console.log(` [Cache L3] Fetching from SERVER for ${de}...`),te.debug("Fetching client data from server",{sourceFile:Yt,email:de});const Ge=await J_("clio",de,te);ot.current[de]=Ge}catch(Ge){throw Ge instanceof Error&&Ge.message.includes("Client not found")?te.debug("Client not found for email",{sourceFile:Yt,email:de}):te.error(`Error fetching client data for ${de}`,Ge,{sourceFile:Yt}),Ge}},[te]),Ae=w.useCallback(async()=>{te.info("fetchUserData called",{sourceFile:Yt,clientEmail:r});try{const de=await s8(te,"clio");Ne(de)}catch(de){te.error("Error processing user data",de,{sourceFile:Yt})}},[]),Xe=w.useCallback(async()=>{if(te.info("fetchClientData called",{sourceFile:Yt,clientEmail:r,hasClientEmail:!!r}),!r){te.info("fetchClientData early return",{sourceFile:Yt,reason:r?"clio not connected":"no client email",clientEmail:r});return}try{if(ce(!0),ve(null),te.info("fetchClientData starting data fetch",{sourceFile:Yt,clientEmail:r,isLoading:!0}),!ot.current[r])try{await hr(r)}catch(ft){ft instanceof Error&&ft.message.includes("(cached)")?te.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Yt,clientEmail:r}):ft instanceof Error&&ft.message.includes("Client not found")?te.debug("Client not found",{sourceFile:Yt,clientEmail:r}):(te.error("Error fetching client data",ft,{sourceFile:Yt}),ve("both")),pe({}),g([]),Ee([]),K({}),M({}),G({}),ce(!1);return}const de=ot.current[r];if(!de){pe({}),g([]),Ee([]),K({}),M({}),G({}),ce(!1),U(r,!1);return}const Ie=Zt(de);if(U(r,Ie),!Ie){te.debug("Client data exists but is not valid",{sourceFile:Yt,clientEmail:r}),pe({}),g([]),Ee([]),K({}),M({}),G({}),ce(!1);return}const Ge=de.client_data[0];te.debug("Client data received",{sourceFile:Yt,clientDataAsRecord:Ge}),er(Ge);const ut=de.case_data||[];g(ut);const Ft=ut.flatMap(ft=>{const Nt=String(ft.id||"");return(ft.calendar_entries||[]).map(as=>({...as,case_id:Nt}))});Ee(Ft);const cr=ut.length>0?Object.entries(ut[0]).reduce((ft,[Nt,Sr])=>(ft[Nt]=String(Sr),ft),{}):{};pe(cr),et(cr)}catch(de){te.error("Error processing client data",de,{sourceFile:Yt}),ve("both"),pe({}),g([]),Ee([]),r&&U(r,!1)}finally{ce(!1)}},[r,hr,te,er,et,g,U,Zt]);w.useEffect(()=>{Ae()},[]),w.useEffect(()=>{(async()=>{var Ie,Ge,ut,Ft;if(J&&J.clio){const cr=((Ge=(Ie=J==null?void 0:J.clio)==null?void 0:Ie.timeTracking)==null?void 0:Ge.enabled)||!1;Ue(cr);return}try{const cr=await we.getLocalItem("integrationSettings");if(cr&&cr.clio){const ft=((Ft=(ut=cr==null?void 0:cr.clio)==null?void 0:ut.timeTracking)==null?void 0:Ft.enabled)||!1;Ue(ft)}else Ue(!1)}catch(cr){te.error("Failed to fetch integration settings from storage",cr,{sourceFile:Yt}),Ue(!1)}})()},[J]),w.useEffect(()=>{Y>0&&(te.info("Clearing component cache due to refresh trigger",{sourceFile:"src/shared/components/sidepanel/panels/ClioInsights.tsx",refreshTrigger:Y}),ot.current={},jt(!1),r&&(te.info("Re-fetching client data after cache clear",{sourceFile:"src/shared/components/sidepanel/panels/ClioInsights.tsx",clientEmail:r}),Xe()))},[Y]),w.useEffect(()=>{jt(!1),s.length===0&&Te([])},[s]);const pt=w.useCallback(()=>{te.info("All participant validations complete",{sourceFile:Yt,participantCount:s.length}),jt(!0)},[te,s.length]);qq({emailParticipants:s,getClientDetailsForEmail:hr,clientDataCache:ot,isValidClientData:Zt,onClientDataValidated:U,refreshTrigger:Y,onTransientError:B,onValidationComplete:pt}),w.useEffect(()=>{te.info("useEffect: client email or connection changed",{sourceFile:Yt,clientEmail:r,willFetchData:!!r}),r&&(te.info("Triggering fetchClientData from useEffect",{sourceFile:Yt,clientEmail:r}),Xe(),n(r),x&&!s.includes(r.toLowerCase())&&te.debug("Manually set email not in participants, validating separately",{sourceFile:Yt,clientEmail:r}))},[r,Xe,n,x,s,te]),w.useEffect(()=>{(!r||s.length===0&&!x)&&(n(null),K({}),M({}),Ee([]))},[r,s.length,x,n,K,M]),w.useEffect(()=>{if(te.info("useEffect: case index changed",{sourceFile:Yt,currentCaseIndex:p,casesCount:m.length,willUpdateCaseDetails:m.length>0&&p<m.length}),m.length>0&&p<m.length){const de=m[p];te.info("Updating case details for index",{sourceFile:Yt,currentCaseIndex:p,caseData:de?Object.keys(de):null});const Ie=de?Object.entries(de).reduce((Ge,[ut,Ft])=>(Ge[ut]=String(Ft),Ge),{}):{};pe(Ie),et(Ie),te.info("Case details updated",{sourceFile:Yt,formattedCaseData:Ie})}},[p,m,et,te]);const tt=w.useCallback(de=>{te.info("Contacts created, storing for matter linking",{sourceFile:Yt,contactCount:de.length}),Te(de)},[te]),Pt=w.useCallback(de=>{te.info("Contact linked to matter successfully",{sourceFile:Yt})},[te]),Er=w.useCallback(async de=>{var Ge,ut;ce(!0);const Ie={id:((ut=(Ge=de.projectId)==null?void 0:Ge.native)==null?void 0:ut.toString())||"",description:de.projectName||"",practice_area:de.projectTypeName||"",matter_stage:de.phaseName||"",status:de.isArchived?"Closed":"Open",client_name:de.clientName||"",responsible_attorney:de.firstPrimaryName||"",url:de.projectUrl||"",name:de.projectName||""};await It(Ie).then(()=>{ce(!1)})},[It]),Dr=w.useCallback(de=>{const Ie=ot.current[de]?ot.current[de]:ot.current[de.toLowerCase()];if(Ie!=null&&Ie.client_data&&Array.isArray(Ie.client_data)&&Ie.client_data.length>0){const Ge=Ie.client_data[0];return String(Ge.name||"")}return null},[]),lt=(xe==="client"||xe==="both")&&!V,kt=(xe==="matter"||xe==="both")&&!V;return ie?d.jsxs("div",{className:"relative h-full",children:[d.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0 pb-32",children:[d.jsx(Bq,{onMatterSelected:Er}),d.jsx(zq,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:u,setClientEmail:e,isManuallySet:x,selectedClientDetails:z,linkableFields:[{field:"Name",url:ee.url||""}].filter(de=>de.url),isLoading:V,ClientNavigation:P,handleSectionClick:()=>{},tempClientEmail:t||"",setTempClientEmail:n,setIsManuallySet:b,isValidClient:S||!1,isTempEmailValid:T||!1,showClientDocumentsButton:!1,isValidating:$,fetchError:lt,hasTransientError:he,onContactsCreated:tt,getClientNameFromCache:Dr,isClientDataValidationComplete:gt}),d.jsx(Hq,{clientEmail:r,selectedCaseDetails:D,casesForCurrentClient:m,currentCaseIndex:p,linkableFields:[{field:"Title",url:se.url||""}].filter(de=>de.url),nextCase:R,prevCase:A,isLoading:V,isManuallySet:x,setCurrentCaseIndex:j,calendarEntries:oe,isValidating:$,matterId:se.id||"",onMatterManuallySelected:It,fetchError:kt,userData:le,createdContacts:Me,onMatterLinked:Pt})]}),He&&d.jsx("div",{className:"fixed bottom-5 left-4 right-4 z-10 shadow-[0_-4px_12px_rgba(0,0,0,0.1)]",children:d.jsx(Xq,{userData:le,clientEmail:r,emailParticipantClients:i,currentCaseIndex:p,casesForCurrentClient:m})})]}):(te.info("ClioInsights not rendering - Clio not connected",{sourceFile:Yt,isClioConnected:ie}),null)},Zq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:u,isLoading:p,ClientNavigation:m,handleSectionClick:g,tempClientEmail:x,setTempClientEmail:b,setIsManuallySet:E,isValidClient:N,isTempEmailValid:S,isValidating:T})=>{const R=()=>d.jsx(Vs,{rows:2});return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsx("div",{className:"flex items-center gap-2",children:d.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CLIENT"})}),d.jsxs(Ns,{children:[d.jsx(Ts,{asChild:!0,children:d.jsx(ze,{variant:"ghost",size:"icon",className:"h-6 w-6",children:d.jsx(qs,{className:"h-4 w-4"})})}),d.jsx(os,{align:"end",className:"p-2",children:d.jsx("div",{className:"flex flex-col gap-2 w-64",children:d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsx(Qr,{type:"email",value:x||"",onChange:A=>b(A.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${S===!1?"border-red-300 focus:ring-red-500":""}`}),d.jsx(ze,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${S===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(x||"",!0)},disabled:!x,title:S===!1?"Warning: This email is not recognized as a valid client in INSZoom":"Set email as current client",children:"Search"})]})})})]})]}),p?R():d.jsxs(d.Fragment,{children:[t.length>1&&!c&&d.jsx(m,{}),c&&r&&d.jsx("div",{className:"px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:d.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 truncate max-w-[200px]",title:r||"",children:[r," (Manually set)"]})}),T&&e.length>0&&t.length===0&&!c?d.jsx(Vs,{rows:2}):u&&Object.keys(u).length>0?d.jsx(Yc,{details:u}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:d.jsx("p",{className:"mb-2",children:c&&r?`No client information found for ${r}`:e.length>0&&t.length===0?`No client information available for emails on the selected thread:
                      ${e.join(", ")}`:e.length>0?"No client information available for the selected email ID":"Select a clientemail thread to view client information"})})]})]})},eK=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:u,setCurrentCaseIndex:p,isValidating:m=!1})=>{const[g,x]=w.useState(""),[b,E]=w.useState(!1),N=w.useMemo(()=>{if(!g.trim())return t;const A=g.toLowerCase();return t.filter(j=>{var U;return String(j.projectName||((U=j.Data)==null?void 0:U.CaseDescription)||"").toLowerCase().includes(A)})},[t,g]),S=A=>{E(A),A||x("")},T=()=>d.jsx(Vs,{rows:2}),R=A=>{if(p)p(A);else if(A>n)for(let j=n;j<A;j++)i();else if(A<n)for(let j=n;j>A;j--)c()};return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[d.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:d.jsx("div",{className:"flex items-center gap-2",children:d.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CASES"})})}),u?T():e&&Object.keys(e).length>0?d.jsxs(d.Fragment,{children:[t.length>1&&d.jsx("div",{className:"flex justify-between items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:d.jsx("div",{className:"flex-1 flex items-center",children:d.jsxs(Ns,{open:b,onOpenChange:S,children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2",children:[d.jsx("span",{className:"truncate max-w-[180px]",title:e.Title||e["Case Description"]||"",children:e.Title||e["Case Description"]||"Case"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",n+1,"/",t.length,")"]}),d.jsx(ns,{className:"w-3 h-3 ml-1"})]})}),d.jsxs(os,{align:"start",className:"w-[280px] p-0",children:[d.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"relative",children:[d.jsx(qs,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(Qr,{placeholder:"Search cases...",value:g,onChange:A=>x(A.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:A=>A.stopPropagation(),onKeyDown:A=>A.stopPropagation()}),g&&d.jsx("button",{onClick:A=>{A.stopPropagation(),x("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(fi,{className:"w-4 h-4"})})]}),g&&d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",N.length," of ",t.length]})]}),d.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:N.length>0?N.map((A,j)=>{var B;const P=t.findIndex($=>$===A),U=String(A.projectName||((B=A.Data)==null?void 0:B.CaseDescription)||`Case ${P+1}`);return d.jsx(Wn,{className:`text-xs truncate ${P===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>R(P),title:U,children:U},P)}):d.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No cases match "',g,'"']})})]})]})})}),d.jsx("div",{className:"break-words overflow-hidden",children:d.jsx(Yc,{details:e,linkableFields:[{field:"Title",url:s.projectUrl}]})})]}):m?d.jsx(Vs,{rows:2}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?d.jsx(d.Fragment,{children:d.jsx("p",{className:"mb-2",children:"Select a client email thread to view case information"})}):"Select a client email thread to view case information"})]})},gr="src/sidepanel/panels/InsZoomInsights.tsx",Oo=r=>{if(!r)return"";try{return new Date(r).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return r}},v1=r=>{if(console.log("caseData",r),!r||Object.keys(r).length===0)return{};const e=n=>n.replace(/([a-z])([A-Z])/g,"$1 $2");return Object.entries(r).reduce((n,[s,i])=>{if(i!==null&&typeof i=="object"&&!Array.isArray(i)){let c=Object.entries(i);if(s==="report_fields")return console.log("formatting report_fields",c),Object.fromEntries(c),c.filter(([x,b])=>x!=="i797_valid_from"&&x!=="i797_valid_to"&&b!==null&&b!==void 0).forEach(([x,b])=>{let E=x.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase()).replace(/I797/g,"I-797").replace(/H Or L/g,"H/L"),N=String(b);N.includes(" 00:00:00")&&(N=Oo(N.split(" ")[0])),n[E]=N}),console.log("promoted report_fields to top level",Object.keys(n)),n;s==="MilestoneCompletedDate"&&(c=c.sort(([,x],[,b])=>{const E=new Date(String(x)),N=new Date(String(b)),S=!isNaN(E.getTime()),T=!isNaN(N.getTime());return S&&T?N.getTime()-E.getTime():S&&!T?-1:!S&&T?1:0}));const u=[],p=[];c.forEach(([x,b])=>{const E=new Date(String(b));!isNaN(E.getTime())?u.push([x,b]):p.push([x,b])});const m=u.map(([x,b])=>`[[${e(x)}]]:
    ((${b}))
`).join(`
`),g=p.length>0?`
[[Not Completed:]]
${p.map(([x])=>`  - ${e(x)}`).join(`
`)}
`:"";n[s]=m+g}else{const c=i!=null?String(i):"";c.includes(`
`)?n[s]=`
  ${c.replace(/\n/g,`
  `)}`:n[s]=c}return n},{})},tK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:u,currentCaseIndex:p,casesForCurrentClient:m,setCasesForCurrentClient:g,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:E,setIsProjectManuallySelected:N,isValidClient:S,isTempEmailValid:T,nextCase:R,prevCase:A,handleSetCurrentCaseIndex:j,ClientNavigation:P,onClientDataValidated:U,isValidating:B,refreshTrigger:$,integrationSettings:Y})=>{const J=Or(),[he]=w.useState(!0),[te,ue]=w.useState({}),[we,ie]=w.useState({}),[se,pe]=w.useState({}),[ee,G]=w.useState(!1),z=w.useRef({}),K=w.useCallback(V=>{if(!V||!V.client_data)return!1;const ce=V.client_data;return ce&&typeof ce=="object"&&Object.keys(ce).length>0},[]),D=w.useCallback(async(V,ce=!1)=>{if(J.info("getClientDetailsForEmail called",{sourceFile:gr,email:V,hasCachedData:!!z.current[V],forceRefresh:ce}),ce&&z.current[V]&&(J.info("Force refresh requested - clearing component cache",{sourceFile:gr,email:V}),delete z.current[V]),z.current[V]&&!ce){J.info("Using cached client data",{sourceFile:gr,email:V}),J.debug("Using cached client data",{sourceFile:gr,email:V});return}try{J.info("Starting client data fetch from server",{sourceFile:gr,email:V,forceRefresh:ce}),J.debug("Fetching client data",{sourceFile:gr,email:V,forceRefresh:ce});const xe=await J_("inszoom",V,J,ce);if(xe&&xe.client_data&&xe.client_data.Data){const ve=xe.client_data.Data;let le="",Ne="",He="",Ue="";ve.ArrivalAndDepartureDetails&&typeof ve.ArrivalAndDepartureDetails=="object"&&ve.ArrivalAndDepartureDetails!==null&&"ImmigrantStatusOnI94"in ve.ArrivalAndDepartureDetails&&(le=String(ve.ArrivalAndDepartureDetails.ImmigrantStatusOnI94||""),Ne=Oo(String(ve.ArrivalAndDepartureDetails.I94ValidFrom||"")),He=Oo(String(ve.ArrivalAndDepartureDetails.DateOfExpiration||"")),Ue=String(ve.ArrivalAndDepartureDetails.I94Number||""));const Me={...xe.client_data,FirstName:String(ve.FirstName||""),LastName:String(ve.LastName||""),Email:String(ve.Email||V),FileNumber:String(ve.FileNumber||""),Category:String(ve.Category||""),ImmigrantStatusOnI94:le,I94ValidFrom:Ne,I94ValidTo:He,I94Number:Ue,...ve.report_fields&&{report_fields:ve.report_fields}};z.current[V]={client_data:Me,case_data:xe.case_data||[],timestamp:Date.now()}}else z.current[V]={client_data:xe.client_data,case_data:[],timestamp:Date.now()}}catch(xe){throw xe instanceof Error&&(xe.message.includes("Client not found")||xe.message.includes("(cached)"))?J.debug("Client not found for email (including cached)",{sourceFile:gr,email:V}):J.error(`Error fetching client data for ${V}`,xe,{sourceFile:gr}),xe}},[J]),M=w.useCallback(V=>{J.info("selectClientDetails called",{sourceFile:gr,hasDetails:!!V,detailsKeys:V?Object.keys(V):[]}),J.debug("Client details received for formatting",{sourceFile:gr,details:V});const ce=V.FirstName&&V.LastName?`${V.FirstName} ${V.LastName}`:V.fullName||"";let xe="";if(V.visa_details&&typeof V.visa_details=="object"&&V.visa_details!==null){const He=V.visa_details;He.Data&&Array.isArray(He.Data)&&(xe=He.Data.map(Me=>{const Te=String(Me.VisaType||""),gt=Oo(String(Me.IssuanceDate||"")),jt=Oo(String(Me.ExpirationDate||""));return`[[${Te}]]:
${gt} - ${jt}
`}).join(`
`))}let ve="";if(V.passport_details&&typeof V.passport_details=="object"&&V.passport_details!==null){const He=V.passport_details;He.Data&&Array.isArray(He.Data)&&(ve=He.Data.map(Me=>{const Te=String(Me.PassportNo||""),gt=String(Me.PassportType||""),jt=String(Me.PassportIssuingCountry||""),ot=Oo(String(Me.PassportIssuanceDate||"")),Ut=Oo(String(Me.PassportExpirationDate||""));return`[[${jt} (${gt})]]
${Te} :
${ot} - ${Ut}
`}).join(`
`))}let le="";if(V.report_fields&&typeof V.report_fields=="object"&&V.report_fields!==null){const He=V.report_fields,Ue=He.priority_date_1||"",Me=He.priority_date_1_country||"",Te=He.priority_date_2||"",gt=He.priority_date_2_country||"",jt=[];if(Ue||Me){const ot=`${Ue}${Me?` [${Me}]`:""}`;jt.push(ot)}if(Te||gt){const ot=`${Te}${gt?` [${gt}]`:""}`;jt.push(ot)}jt.length>0&&(le=jt.join(`
`))}const Ne={Name:ce,"Immigration Status":V.ImmigrantStatusOnI94||"","I-94 Number":V.I94Number||"","I-94 Validity":`${V.I94ValidFrom} - ${V.I94ValidTo}`||""};if(V.report_fields&&typeof V.report_fields=="object"&&V.report_fields!==null){const He=V.report_fields,Ue=He.i797_status||"";Ne["I-797 Status"]=Ue;const Me=He.i797_valid_from||"",Te=He.i797_valid_to||"";if(Me&&Me.trim()!==""||Te&&Te.trim()!==""){const gt=Me?Oo(Me.split(" ")[0]):"",jt=Te?Oo(Te.split(" ")[0]):"";Ne["I-797 Validity"]=`${gt} - ${jt}`}else Ne["I-797 Validity"]=""}else Ne["I-797 Status"]="",Ne["I-797 Validity"]="";if(Ne["Passport Details"]=ve,Ne["Visa Details"]=xe,V.report_fields&&typeof V.report_fields=="object"&&V.report_fields!==null){const Ue=V.report_fields.h_or_l_max_out_date||"";Ue&&Ue.includes(" 00:00:00")?Ne["H/L Maxout Date"]=Oo(Ue.split(" ")[0]):Ne["H/L Maxout Date"]=Ue}else Ne["H/L Maxout Date"]="";if(Ne["Priority Dates"]=le,V.report_fields&&typeof V.report_fields=="object"&&V.report_fields!==null){const Ue=V.report_fields.maxout_date_applicability_notes||"";Ne["Maxout Date Applicability and Notes"]=Ue}else Ne["Maxout Date Applicability and Notes"]="";J.info("Client details formatted and set",{sourceFile:gr,selectedDetails:Ne,originalDetails:V}),ie(Ne)},[J]),oe=w.useCallback(V=>{J.info("selectCaseDetails called",{sourceFile:gr,hasDetails:!!V,details:V||[]});const ce={"Case Description":V.CaseDescription||V.projectName||"","Case Manager":V.WorkingCaseManagers_names||"","Case Status":V.CaseStatus||"","Opened Date":Oo(V.CaseOpenedDate)||"","Date Filed":Oo(V.DateSentToGovt)||""};ce["Last Step Completed"]=V["Last Step Completed"]||"",ce["Last Step Completed Date"]=Oo(V["Last Step Completed Date"])||"",ce["Receipt Number"]=V["Receipt Number"]||"",ce["Case Main Receipt Status"]=V["Case Main Receipt Status"]||"",J.info("Case details formatted and set",{sourceFile:gr,selectedDetails:ce,originalDetails:V}),pe(ce)},[J]),Ee=w.useCallback(async(V=!1)=>{if(J.info("fetchClientData called",{sourceFile:gr,clientEmail:r,isINSZoomConnected:he,hasClientEmail:!!r,forceRefresh:V}),!r||!he){J.info("fetchClientData early return",{sourceFile:gr,reason:r?"INSZoom not connected":"no client email",clientEmail:r,isINSZoomConnected:he});return}try{if(G(!0),J.info("fetchClientData starting data fetch",{sourceFile:gr,clientEmail:r,isLoading:!0,forceRefresh:V}),V||!z.current[r]||z.current[r].timestamp<Date.now()-1e3*60*60*24)try{await D(r,V)}catch(He){He instanceof Error&&He.message.includes("(cached)")?J.debug("Using cached knowledge that this client doesn't exist",{sourceFile:gr,clientEmail:r}):J.error("Error fetching client data",He,{sourceFile:gr}),ue({}),g([]),ie({}),pe({}),G(!1);return}const ce=z.current[r];if(!ce){ue({}),g([]),ie({}),pe({}),G(!1),U(r,!1);return}const xe=K(ce);if(U(r,xe),!xe){J.debug("Client data exists but is not valid",{sourceFile:gr,clientEmail:r}),ue({}),g([]),ie({}),pe({}),G(!1);return}const ve=ce.client_data;M(ve);const Ne=(ce.case_data||[]).sort((He,Ue)=>{const Me=He.Data||He,Te=Ue.Data||Ue,gt=Me.CaseOpenedDate,jt=Te.CaseOpenedDate;if(!gt&&!jt)return 0;if(!gt)return 1;if(!jt)return-1;const ot=new Date(gt),Ut=new Date(jt),Zt=!isNaN(ot.getTime()),er=!isNaN(Ut.getTime());return!Zt&&!er?0:Zt?er?Ut.getTime()-ot.getTime():-1:1});if(g(Ne),Ne.length>0){const He=Ne[0].Data||Ne[0],Ue=v1(He);ue(Ue),oe(Ue)}else ue({}),oe({})}catch(ce){J.error("Error processing client data",ce,{sourceFile:gr}),ue({}),g([]),r&&U(r,!1)}finally{G(!1)}},[r,he,D,J,M,oe,g,U,K]);return w.useEffect(()=>{B&&s.length>0&&(z.current={},J.debug("Cleared component-level client data cache for refresh",{sourceFile:gr}))},[B,s.length,J]),w.useEffect(()=>{const V=async()=>{if(he){J.info("Validating all email participants",{sourceFile:gr,participantCount:s.length});for(const ce of s)try{await D(ce);const xe=z.current[ce],ve=K(xe);U(ce,ve),J.debug("Participant validation result",{sourceFile:gr,email:ce,hasValidData:ve})}catch(xe){J.debug("Participant validation failed",{sourceFile:gr,email:ce,error:xe}),U(ce,!1)}}};s.length>0&&he&&V()},[s,he,D,K,U,J,$]),w.useEffect(()=>{J.info("useEffect: client email or connection changed",{sourceFile:gr,clientEmail:r,isINSZoomConnected:he,willFetchData:!!(r&&he)}),r&&he&&(J.info("Triggering fetchClientData from useEffect",{sourceFile:gr,clientEmail:r,isManuallySet:x}),Ee(x),n(r),x&&!s.includes(r.toLowerCase())&&J.debug("Manually set email not in participants, validating separately",{sourceFile:gr,clientEmail:r}))},[r,he,Ee,n,x,s,J]),w.useEffect(()=>{(!r||s.length===0&&!x)&&(n(null),ie({}),pe({}))},[r,s.length,x,n,ie,pe]),w.useEffect(()=>{if(J.info("useEffect: case index changed",{sourceFile:gr,currentCaseIndex:p,casesCount:m.length,willUpdateCaseDetails:m.length>0&&p<m.length}),m.length>0&&p<m.length){const V=m[p];J.info("Updating case details for index",{sourceFile:gr,currentCaseIndex:p,caseData:V?Object.keys(V):null});const ce=V.Data||V,xe=v1(ce);ue(xe),oe(xe),J.info("Case details updated",{sourceFile:gr,formattedCaseData:Object.keys(xe)})}},[p,m,oe,J]),he?(J.info("INSZoomInsights rendering components",{sourceFile:gr,clientEmail:r,selectedClientDetails:Object.keys(we),selectedCaseDetails:Object.keys(se),isLoading:ee}),d.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[d.jsx(Zq,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:u,setClientEmail:e,isManuallySet:x,selectedClientDetails:we,isLoading:ee,ClientNavigation:P,handleSectionClick:()=>{},tempClientEmail:t,setTempClientEmail:n,setIsManuallySet:b,isValidClient:S,isTempEmailValid:T,isValidating:B}),d.jsx(eK,{clientEmail:r,selectedCaseDetails:se,casesForCurrentClient:m,currentCaseIndex:p,caseDetails:te,nextCase:R,prevCase:A,isLoading:ee,setCurrentCaseIndex:j,isValidating:B})]})):(J.info("INSZoomInsights not rendering - INSZoom not connected",{sourceFile:gr,isINSZoomConnected:he}),null)},rK=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function nK(r){return r.filter(e=>e&&e.trim().length>0&&rK.test(e.trim())).map(e=>e.trim().toLowerCase())}function sK(r,e){if(!e)return r;const t=e.toLowerCase(),n=t.split("@")[1];return n?["gmail.com","googlemail.com","outlook.com","hotmail.com","live.com","yahoo.com","ymail.com","aol.com","icloud.com","me.com","mac.com","protonmail.com","proton.me","mail.com","zoho.com","gmx.com","gmx.net","trycandle.ai"].includes(n)?r.filter(c=>c.toLowerCase()!==t):r.filter(c=>c.toLowerCase().split("@")[1]!==n):r}const rF={rawParticipants:[],sanitizedParticipants:[],emailsWithValidData:new Set,validatedEmails:new Set,selectedClient:"",currentClientIndex:0,isValidating:!1,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:0,integrationSettings:{},hasTransientError:!1};function oK(r,e){var t,n;switch(e.type){case"SET_RAW_PARTICIPANTS":{const s=nK(e.participants);return console.log(" [Reducer] SET_RAW_PARTICIPANTS:",{rawCount:((t=e.participants)==null?void 0:t.length)??0,sanitizedCount:s.length,raw:e.participants,sanitized:s,filtered:(n=e.participants)==null?void 0:n.filter(i=>!s.includes(i.toLowerCase().trim()))}),JSON.stringify(s)===JSON.stringify(r.sanitizedParticipants)?(console.log(" [Reducer] Participants unchanged, skipping update"),r):{...r,rawParticipants:e.participants,sanitizedParticipants:s,isValidating:s.length>0}}case"MARK_EMAIL_VALIDATED":{const s=new Set(r.validatedEmails);s.add(e.email.toLowerCase());const i=new Set(r.emailsWithValidData),c=e.email.toLowerCase(),u=r.selectedClient&&c===r.selectedClient.toLowerCase();e.isValid?i.add(c):(!r.isValidating||!u)&&i.delete(c);const p=r.sanitizedParticipants.length>0&&s.size>=r.sanitizedParticipants.length;return p&&u&&!e.isValid&&i.delete(c),{...r,validatedEmails:s,emailsWithValidData:i,isValidating:!p}}case"SELECT_CLIENT":return{...r,selectedClient:e.email,currentClientIndex:e.index,isManuallySet:e.isManual};case"SET_PROJECT_MANUALLY_SELECTED":return{...r,isProjectManuallySelected:e.value};case"START_VALIDATION":return{...r,isValidating:!0};case"COMPLETE_VALIDATION":return{...r,isValidating:!1};case"RESET_STATE":return{...rF,refreshTrigger:r.refreshTrigger,hasTransientError:!1};case"REFRESH_DATA":{const s=new Set;return r.selectedClient&&s.add(r.selectedClient.toLowerCase()),{...r,emailsWithValidData:s,validatedEmails:new Set,isValidating:!0,refreshTrigger:r.refreshTrigger+1,hasTransientError:!1}}case"SET_INTEGRATION_SETTINGS":return{...r,integrationSettings:e.settings};case"SET_TRANSIENT_ERROR":return{...r,hasTransientError:e.hasError};default:return r}}function iK({platform:r,dataProvider:e,isIntegrationConnected:t}){const n=Or(),[s,i]=w.useReducer(oK,rF),c=w.useRef(!1),u=w.useRef(0),p=Ul();w.useEffect(()=>{(async()=>{try{const $=await i8(n);Object.keys($).length>0&&await p.setLocalItem("integrationSettings",$),i({type:"SET_INTEGRATION_SETTINGS",settings:$})}catch($){n.error("Failed to fetch integration settings",$,{sourceFile:"src/shared/hooks/useEmailParticipants.ts"})}})()},[n]);const m=s.sanitizedParticipants.filter(B=>s.emailsWithValidData.has(B.toLowerCase())),g=w.useCallback((B,$)=>{n.info("Client data validation result received",{sourceFile:"useEmailParticipants.ts",email:B,isValid:$}),i({type:"MARK_EMAIL_VALIDATED",email:B,isValid:$})},[n]),x=w.useCallback((B,$,Y=!1)=>{i({type:"SELECT_CLIENT",email:B,index:$,isManual:Y})},[]),b=w.useCallback(B=>{i({type:"SET_PROJECT_MANUALLY_SELECTED",value:B})},[]),E=w.useCallback((B,$)=>{n.warn("Transient error during validation - user should try again later",{sourceFile:"useEmailParticipants.ts",email:B,error:$.message}),i({type:"SET_TRANSIENT_ERROR",hasError:!0})},[n]),N=w.useCallback(()=>{n.debug("Resetting participant state",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"})},[n]),S=w.useCallback(async()=>{const B=Date.now();if(B-u.current<50){n.debug("Debouncing fetchParticipants call",{sourceFile:"useEmailParticipants.ts"});return}u.current=B;try{if(r==="chrome"){const Y=await e.getCurrentThreadId();if(Y){n.info("Getting participants for Chrome",{sourceFile:"useEmailParticipants.ts",threadId:Y}),console.log(` [Participants] Fetching for thread: ${Y}`);try{const J=await e8(Y,n);console.log(` [Participants] Server returned ${(J==null?void 0:J.length)??0} participants:`,J),n.info("Received participants from server",{sourceFile:"useEmailParticipants.ts",threadId:Y,participantCount:(J==null?void 0:J.length)??0,participants:J==null?void 0:J.slice(0,5)}),(!J||J.length===0)&&(console.warn(` [Participants] No participants returned for thread ${Y}`),n.warn("No participants returned from server",{sourceFile:"useEmailParticipants.ts",threadId:Y})),i({type:"SET_RAW_PARTICIPANTS",participants:J||[]})}catch(J){console.error(` [Participants] Error fetching for thread ${Y}:`,J),n.error("Error fetching participants for Chrome",J,{sourceFile:"useEmailParticipants.ts",threadId:Y}),N()}}else console.warn(" [Participants] No threadId found for Chrome"),n.debug("No threadId found for Chrome",{sourceFile:"useEmailParticipants.ts"}),N()}else if(r==="outlook"){n.debug("Getting participants for Outlook",{sourceFile:"useEmailParticipants.ts"});try{const Y=await e.getCurrentThread();if(Y){let J=Y.participants;const he=e.getCurrentUserEmail();if(he){const te=J.length;J=sK(J,he),n.debug("Applied domain filtering for Outlook participants",{sourceFile:"useEmailParticipants.ts",userEmail:he,originalCount:te,filteredCount:J.length})}else n.warn("Could not get user email, skipping domain filtering",{sourceFile:"useEmailParticipants.ts"});i({type:"SET_RAW_PARTICIPANTS",participants:J})}else n.debug("No thread found for Outlook",{sourceFile:"useEmailParticipants.ts"}),N()}catch(Y){n.error("Error fetching participants for Outlook",Y,{sourceFile:"useEmailParticipants.ts"}),N()}}}catch(Y){n.error("Error in fetchParticipants",Y,{sourceFile:"useEmailParticipants.ts"}),N()}},[r,e,n,N]),T=w.useCallback(async()=>{if(!(s.isValidating||s.sanitizedParticipants.length===0)){n.info("Starting participant data refresh",{sourceFile:"useEmailParticipants.ts",participantCount:s.sanitizedParticipants.length});try{await Promise.all(s.sanitizedParticipants.map(B=>H5(B,n))),i({type:"REFRESH_DATA"}),n.info("Participant data refresh initiated",{sourceFile:"useEmailParticipants.ts"})}catch(B){n.error("Error refreshing participant data",B,{sourceFile:"useEmailParticipants.ts"})}}},[s.isValidating,s.sanitizedParticipants,n]),R=m.length>0,A=m[0]??"",j=s.selectedClient?m.includes(s.selectedClient):!0,P=R&&!s.selectedClient&&!s.isManuallySet&&!s.isProjectManuallySelected,U=!s.isValidating&&s.selectedClient&&!j&&!s.isManuallySet&&!s.isProjectManuallySelected;return w.useEffect(()=>{P?(n.info("Auto-selecting first validated client",{sourceFile:"useEmailParticipants.ts",selectedClient:A}),i({type:"SELECT_CLIENT",email:A,index:0,isManual:!1})):U&&(n.info("Current client no longer valid, clearing",{sourceFile:"useEmailParticipants.ts",clientEmail:s.selectedClient}),i({type:"SELECT_CLIENT",email:"",index:0,isManual:!1}))},[P,U,A,s.selectedClient,n]),w.useEffect(()=>{if(e!=null&&e.onThreadChanged){const B=$=>{$?(n.debug("Thread changed",{sourceFile:"useEmailParticipants.ts",newThreadId:$.threadId}),i({type:"RESET_STATE"}),S()):(n.info("Thread cleared",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"}))};return e.onThreadChanged(B),()=>{e.removeThreadListener&&e.removeThreadListener(B)}}},[e,S,n]),w.useEffect(()=>{t&&!c.current&&(c.current=!0,S())},[t,S]),{validClients:m,selectedClient:s.selectedClient,currentClientIndex:s.currentClientIndex,sanitizedParticipants:s.sanitizedParticipants,isValidating:s.isValidating,isManuallySet:s.isManuallySet,isProjectManuallySelected:s.isProjectManuallySelected,refreshTrigger:s.refreshTrigger,integrationSettings:s.integrationSettings,hasTransientError:s.hasTransientError,selectClient:x,setProjectManuallySelected:b,handleClientDataValidated:g,handleTransientError:E,refresh:T,resetState:N}}function aK({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:u}){const p=Or(),m=tn().platform,g=sd();Ul();const{isConnected:x}=Wi(),[b,E]=w.useState([]),[N,S]=w.useState(null),[T,R]=w.useState(!0),[A,j]=w.useState(0),[P,U]=w.useState([]),[B,$]=w.useState(null),[Y,J]=w.useState(null),[he,te]=w.useState(!1),[ue,we]=w.useState(!1),[ie,se]=w.useState(!1),pe=he||ue||ie,{validClients:ee,selectedClient:G,currentClientIndex:z,sanitizedParticipants:K,isValidating:D,isManuallySet:M,isProjectManuallySelected:oe,refreshTrigger:Ee,integrationSettings:V,hasTransientError:ce,selectClient:xe,setProjectManuallySelected:ve,handleClientDataValidated:le,handleTransientError:Ne,refresh:He}=iK({platform:m,dataProvider:g,isIntegrationConnected:pe});w.useEffect(()=>{t(G)},[G,t]),w.useEffect(()=>{(async()=>{await gI(p)})()},[p]);const Ue=w.useCallback(()=>{if(A<P.length-1){const et=A+1;j(et)}},[A,P.length]),Me=w.useCallback(()=>{if(A>0){const et=A-1;j(et)}},[A]),Te=w.useCallback(et=>{et>=0&&et<P.length&&j(et)},[P.length]),gt=w.useCallback(({className:et="",clientUrl:It})=>d.jsxs("div",{className:`flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2 ${et}`,children:[d.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:d.jsxs(Ns,{children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[d.jsx("span",{className:"truncate",title:G||"",children:G||"No client"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",z+1,"/",ee.length,")"]}),d.jsx(ns,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),d.jsx(os,{align:"start",className:"max-h-[200px] overflow-y-auto",children:ee.map((hr,Ae)=>d.jsx(Wn,{className:`text-xs ${Ae===z?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>{xe(hr,Ae,!1)},children:hr},hr))})]})}),It&&d.jsxs("a",{href:It,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[d.jsx(Pl,{className:"w-3 h-3"}),"View"]})]}),[G,z,ee,xe]);w.useEffect(()=>{(async()=>{try{const It=await vI(p),hr=It.some(pt=>pt.integration_type==="filevine"),Ae=It.some(pt=>pt.integration_type==="clio"),Xe=It.some(pt=>pt.integration_type==="inszoom");te(hr),we(Ae),se(Xe)}catch(It){p.error("Error checking integration connections",It,{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx"})}})()},[p]),w.useEffect(()=>{j(0)},[G]),w.useEffect(()=>{(async()=>{try{const It=await zm(p);E(It||[]);const hr=(It==null?void 0:It.some(tt=>tt.integration_type.toLowerCase()==="filevine"))||!1,Ae=(It==null?void 0:It.some(tt=>tt.integration_type.toLowerCase()==="clio"))||!1,Xe=(It==null?void 0:It.some(tt=>tt.integration_type.toLowerCase()==="inszoom"))||!1;let pt=null;if(hr?pt="filevine":Ae?pt="clio":Xe&&(pt="inszoom"),pt){const tt=await kE(pt);S(tt)}else S(null)}catch(It){p.error("Error fetching integrations:",It,{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx"})}finally{R(!1)}})()},[p]);const jt=b.some(et=>et.integration_type.toLowerCase()==="filevine"),ot=b.some(et=>et.integration_type.toLowerCase()==="clio"),Ut=b.some(et=>et.integration_type.toLowerCase()==="inszoom");w.useEffect(()=>{J(B?!0:null)},[B]);const Zt={clientEmail:G,setClientEmail:(et,It)=>{if(!et)xe("",0,!1);else{const hr=ee.indexOf(et),Ae=It===!0?!0:hr<0;xe(et,hr>=0?hr:0,Ae)}},tempClientEmail:B,setTempClientEmail:$,emailParticipants:K,emailParticipantClients:ee,currentClientIndex:z,setCurrentClientIndex:et=>{const It=ee[et];It?xe(It,et,!1):(p.warn("Invalid client index",{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx",index:et,availableClients:ee.length}),xe("",0,!1))},currentCaseIndex:A,casesForCurrentClient:P,setCasesForCurrentClient:U,isManuallySet:M,setIsManuallySet:et=>{xe(G||"",z,et)},isProjectManuallySelected:oe,setIsProjectManuallySelected:ve,isValidClient:G?!0:null,isTempEmailValid:Y,nextCase:Ue,prevCase:Me,handleSetCurrentCaseIndex:Te,ClientNavigation:gt,onClientDataValidated:le,onTransientError:Ne,isValidating:D,refreshTrigger:Ee,integrationSettings:V,hasTransientError:ce},er=m==="chrome"&&!x;return d.jsx("div",{className:"h-full",children:er?d.jsx("div",{className:"p-4",children:d.jsx(wE,{feature:"Insights",description:"Connect your Gmail account to view client insights and case information",benefits:["Automatically identify clients from email participants","View relevant case information and documents","Access client details from your case management system"]})}):T?d.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[d.jsx(Hi,{className:"h-8 w-8 animate-spin text-blue-600"}),d.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading integrations..."})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex items-center mb-1",children:d.jsx("span",{className:"font-small text-xs text-slate-800 dark:text-gray-400",children:"Data provided by"})}),d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[N&&d.jsxs("a",{href:N.homeUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:[d.jsx(Fc,{src:N.logo,width:20,height:20,alt:N.name,className:"h-5 w-auto dark:brightness-0 dark:invert"}),d.jsx("span",{className:"font-small text-xs text-slate-800 dark:text-gray-300",children:N.name})]}),d.jsx(ze,{size:"icon",variant:"outline",onClick:He,disabled:D||K.length===0,className:"flex items-center h-6 w-6 mr-4",title:D?"Refreshing...":K.length===0?"No participants to refresh":"Refresh participant data",children:d.jsx(wo,{className:`h-3 w-3 ${D?"animate-spin":""}`})})]}),jt&&d.jsx(Lq,{toggleSection:r,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,setProjectId:n,onDocumentView:u,...Zt}),ot&&d.jsx(Qq,{...Zt}),Ut&&d.jsx(tK,{...Zt})]})})}const lK={showEmailSummary:!1,showInsightsTab:!0,showComposeTab:!0,showTemplatesTab:!0},cK=()=>lK,uK=r=>cK()[r],dK=({className:r=""})=>{const[e,t]=w.useState(!1),{isConnected:n,wasEverConnected:s,isLoading:i,error:c,status:u,reconnectAttempts:p,initiateReconnection:m,clearError:g}=Wi(),{platform:x}=tn();if(x!=="chrome"||n&&u!=="error"||e)return null;const b=async()=>{try{await m()}catch(j){console.error("Failed to reconnect Gmail:",j)}},E=()=>{t(!0),c&&g()},N=()=>u==="error"?"bg-red-50 border-red-200":s?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200",S=()=>u==="error"?d.jsx(Xf,{className:"h-4 w-4 text-red-600 flex-shrink-0"}):s?d.jsx(Xf,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}):d.jsx(Xf,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),T=()=>u==="error"?c||"Gmail connection error occurred":s?"Gmail connection lost. Some features may not work properly.":"Gmail connection required to access all features.",R=()=>u==="error"?"text-red-800":s?"text-yellow-800":"text-blue-800",A=()=>u==="error"?"bg-red-100 border-red-300 text-red-800 hover:bg-red-200 hover:border-red-400":s?"bg-yellow-100 border-yellow-300 text-yellow-800 hover:bg-yellow-200 hover:border-yellow-400":"bg-blue-100 border-blue-300 text-blue-800 hover:bg-blue-200 hover:border-blue-400";return d.jsxs("div",{className:`flex items-center justify-between ${N()} px-4 py-3 ${r}`,role:"alert","aria-live":"polite","aria-atomic":"true",children:[d.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[S(),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:`text-sm ${R()} font-medium`,children:T()}),p>0&&d.jsxs("p",{className:`text-xs ${R()} opacity-75 mt-1`,children:["Reconnect attempts: ",p]})]})]}),d.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[d.jsx(ze,{onClick:b,disabled:i,variant:"outline",size:"sm",className:`${A()} text-xs px-3 py-1 h-auto whitespace-nowrap`,"aria-label":i?"Connecting to Gmail...":s?"Reconnect Gmail account":"Connect Gmail account",children:i?d.jsxs(d.Fragment,{children:[d.jsx(wo,{className:"h-3 w-3 mr-1 animate-spin","aria-hidden":"true"}),"Connecting..."]}):s?"Reconnect Gmail":"Connect Gmail"}),d.jsx(ze,{onClick:E,variant:"ghost",size:"sm",className:`${u==="error"?"text-red-600 hover:text-red-800 hover:bg-red-100":s?"text-yellow-600 hover:text-yellow-800 hover:bg-yellow-100":"text-blue-600 hover:text-blue-800 hover:bg-blue-100"} p-1 h-auto`,"aria-label":"Dismiss Gmail connection banner",children:d.jsx(fi,{className:"h-4 w-4","aria-hidden":"true"})})]})]})},nF=w.createContext(void 0),sF=()=>{const r=w.useContext(nF);if(r===void 0)throw new Error("useToast must be used within a ToastProvider");return r},fK=({children:r})=>{const[e,t]=w.useState([]),n=w.useCallback(u=>{const p=Math.random().toString(36).substr(2,9),m={...u,id:p};t(x=>[...x,m]);const g=u.duration??5e3;return g>0&&setTimeout(()=>{t(x=>x.filter(b=>b.id!==p))},g),p},[]),s=w.useCallback(u=>{t(p=>p.filter(m=>m.id!==u))},[]),i=w.useCallback(()=>{t([])},[]),c={toasts:e,addToast:n,removeToast:s,clearAll:i};return d.jsxs(nF.Provider,{value:c,children:[r,d.jsx(hK,{})]})},hK=()=>{const{toasts:r,removeToast:e}=sF();return r.length===0?null:d.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm",children:r.map(t=>d.jsx(pK,{toast:t,onRemove:e},t.id))})},pK=({toast:r,onRemove:e})=>{const t=s=>{switch(s){case"success":return d.jsx(Uc,{className:"h-5 w-5 text-green-600"});case"error":return d.jsx(Xf,{className:"h-5 w-5 text-red-600"});case"warning":return d.jsx(WR,{className:"h-5 w-5 text-amber-600"});case"info":return d.jsx(Bc,{className:"h-5 w-5 text-blue-600"});default:return null}},n=s=>{switch(s){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return d.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border shadow-lg animate-in slide-in-from-right-full ${n(r.type)}`,children:[t(r.type),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.title}),r.description&&d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),r.action&&d.jsx(ze,{onClick:r.action.onClick,variant:"outline",size:"sm",className:"mt-2 h-7 text-xs",children:r.action.label})]}),d.jsx(ze,{onClick:()=>e(r.id),variant:"ghost",size:"sm",className:"p-1 h-auto",children:d.jsx(fi,{className:"h-4 w-4"})})]})},mK=()=>{const{addToast:r}=sF(),e=w.useCallback(()=>{r({type:"success",title:"Gmail Connected",description:"Successfully connected to Gmail. All features are now available.",duration:4e3})},[r]),t=w.useCallback(c=>{r({type:"warning",title:"Gmail Connection Lost",description:"Some features may not work properly until you reconnect.",duration:0,action:c?{label:"Reconnect",onClick:c}:void 0})},[r]),n=w.useCallback((c,u)=>{r({type:"error",title:"Gmail Connection Error",description:c,duration:0,action:u?{label:"Retry",onClick:u}:void 0})},[r]),s=w.useCallback(()=>{r({type:"success",title:"Gmail Reconnected",description:"Successfully reconnected to Gmail.",duration:3e3})},[r]),i=w.useCallback(c=>{r({type:"error",title:"Reconnection Failed",description:"Failed to reconnect to Gmail. Please try again.",duration:0,action:c?{label:"Try Again",onClick:c}:void 0})},[r]);return{showConnectionSuccess:e,showConnectionLost:t,showConnectionError:n,showReconnectionSuccess:s,showReconnectionFailed:i}},gK=()=>{const{status:r,error:e,isConnected:t,initiateReconnection:n}=Wi(),{platform:s}=tn(),{showConnectionSuccess:i,showConnectionLost:c,showConnectionError:u,showReconnectionSuccess:p,showReconnectionFailed:m}=mK(),g=w.useRef("loading"),x=w.useRef(!0),b=w.useRef(!1);return w.useEffect(()=>{if(s!=="chrome")return;const E=g.current,N=x.current,S=b.current;if(!(!S&&r==="loading")){if(!S){b.current=!0,g.current=r,x.current=t;return}if(E!==r||N!==t)switch(r){case"connected":(E==="disconnected"||E==="error"||!N)&&(E==="loading"?p():i());break;case"disconnected":N&&E==="connected"&&c(()=>{n().catch(R=>{console.error("Failed to reconnect from toast:",R)})});break;case"error":u(e||"Unknown connection error occurred",()=>{n().catch(R=>{console.error("Failed to reconnect from toast:",R),m(()=>{n().catch(console.error)})})});break}g.current=r,x.current=t}},[r,e,t,s,n,i,c,u,p,m]),null},vK=({activeSection:r,toggleSection:e})=>{const t=Or();t.debug(`[MainPanelContent] Rendering with activeSection: "${r}"`,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent",data:{activeSection:r}});const n=NT(),s=Ul(),{platform:i}=tn(),{isConnected:c,wasEverConnected:u}=Wi(),p=i==="chrome"&&!c&&u,[m,g]=w.useState(""),[x,b]=w.useState(""),[E,N]=w.useState([]),[S,T]=w.useState(!1),[R,A]=w.useState(null),[j,P]=w.useState(null),[U,B]=w.useState("compose"),[$,Y]=w.useState(!1),[J,he]=w.useState(!1),[te,ue]=w.useState(!1),we=w.useRef(!1),ie=w.useRef(!1),se=w.useRef(null),pe=w.useCallback(async()=>{try{t.info("Checking authentication status...",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const K=await(n==null?void 0:n.isAuthenticated());return t.info("Authentication status checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",authenticated:K}),K||!1}catch(K){return t.error("Failed to check auth status",K,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),!1}},[n,t]);w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const K=async()=>{const M=await pe();he(!0),ue(M),M?(t.info("Valid token found. User is authenticated.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),r==="login"&&e("main")):(t.info("No valid token found. Show login page.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),e("login"))},D=M=>{M.token&&(t.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),K(),zy(t))};return s!=null&&s.onChanged&&s.onChanged(D),K(),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(D)}},[n,s,e,t,pe,r]),w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"})},[s,t]),w.useEffect(()=>{if(!J||!te||ie.current){t.debug("Skipping CMS integration check - auth not ready, not authenticated, or already checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",isAuthChecked:J,isAuthenticated:te,hasRunInitialCheck:ie.current});return}ie.current=!0;const K=async()=>{try{t.info("Checking Case Management System connection status",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const M=await mI(t);t.info("Case Management System connection status result",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",connected:M}),Y(M),we.current||(M?(t.info("CMS connected, setting active tab to insights",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),B("insights")):(t.info("CMS not connected, setting active tab to compose",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),B("compose")),we.current=!0)}catch(M){t.error("Error checking Case Management System connection",M,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),Y(!1),we.current||(B("compose"),we.current=!0)}},D=M=>{if(!M.integrations)return;t.info("Integrations changed via storage, rechecking CMS connection",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",oldValue:M.integrations.oldValue,newValue:M.integrations.newValue});const oe=M.integrations.newValue;if(!Array.isArray(oe))return;const Ee=["inszoom","filevine","clio"];oe.some(ce=>Ee.includes(ce.integration_type))&&(t.info("CMS integration found",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",newValue:M.integrations.newValue}),Y(!0))};return K(),s!=null&&s.onChanged&&s.onChanged(D),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(D)}},[J,te,t,s]);const ee=K=>{B(K),e(K==="login"?"login":"main")},G=()=>{t.debug("[MainPanelContent] goBack called. Setting activeSection to null.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"goBack"}),e("main"),P(null)},z=K=>{t.debug("[MainPanelContent] handleDocumentView called",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"handleDocumentView",data:{document:K}}),P(K),e("Project Documents")};return w.useEffect(()=>{r==="Project Documents"&&se.current&&(se.current.scrollTop=0)},[r]),d.jsxs(fK,{children:[d.jsx(gK,{}),d.jsxs("div",{ref:se,className:`flex flex-col h-full relative ${r==="login"||r==="Project Documents"?"overflow-hidden":"overflow-y-auto"}`,children:[r!=="login"&&d.jsx(dK,{className:"flex-shrink-0"}),d.jsxs("div",{className:"flex flex-col",children:[uK("showEmailSummary")&&d.jsx("div",{className:"flex-shrink-0 border-b-2 border-gray-300",children:d.jsx(y9,{})}),d.jsx("div",{className:"flex-grow flex flex-col",children:p?d.jsx("div",{className:"flex-grow"}):d.jsxs(M9,{defaultValue:$?"insights":"compose",value:U,onValueChange:ee,className:"w-full flex flex-col",children:[d.jsxs(MI,{className:`grid ${$?"grid-cols-3":"grid-cols-2"} w-full bg-white dark:bg-card border-b dark:border-border p-0 h-auto flex-shrink-0`,children:[$&&d.jsx(Yv,{value:"insights",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Insights"}),d.jsx(Yv,{value:"compose",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Compose"}),d.jsx(Yv,{value:"templates",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Templates"})]}),d.jsxs("div",{className:"flex-grow mb-0",children:[$&&d.jsx(Jv,{forceMount:!0,value:"insights",className:`p-4 ${U==="insights"?"block":"hidden"}`,children:d.jsx(aK,{toggleSection:e,clientEmail:m,setClientEmail:g,setProjectId:b,setDocuments:N,setIsDocumentsLoading:T,setDocumentsError:A,onDocumentView:z})}),d.jsx(Jv,{forceMount:!0,value:"compose",className:`p-4 ${U==="compose"?"block":"hidden"}`,children:d.jsx(i9,{clientEmail:m})}),d.jsx(Jv,{forceMount:!0,value:"templates",className:`p-4 ${U==="templates"?"block":"hidden"}`,children:d.jsx(w7,{clientEmail:m,isAuthenticated:te})})]})]})})]})," ",r==="login"&&d.jsx("div",{className:"fixed inset-0 bg-white dark:bg-gray-950 z-50",children:d.jsx(a9,{})}),r==="Project Documents"&&(t.debug('[MainPanelContent] activeSection is "Project Documents". Rendering overlay.',{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent.render",data:{activeSection:r,selectedDocumentToView:j}}),d.jsx("div",{className:"absolute inset-0 bg-white dark:bg-gray-950 z-10",children:j?d.jsx($I,{documentId:j.documentId,documentName:j.name,onBack:G}):d.jsx(z9,{clientEmail:m,projectId:x,documents:E,isLoading:S,error:R,goBack:G})}))]})]})},yK=()=>{var x;const[r,e]=w.useState(null),t=Or(),{platform:n}=tn(),s=sd(),{isConnected:i}=Wi();if(w.useEffect(()=>{var S,T;if(n!=="chrome")return;const b=async()=>{var R;try{if((R=chrome==null?void 0:chrome.tabs)!=null&&R.query){const[A]=await chrome.tabs.query({active:!0,currentWindow:!0});if(A!=null&&A.id&&(A!=null&&A.windowId)){let j;try{const P=await(s==null?void 0:s.getCurrentThread());j=P==null?void 0:P.subject}catch(P){t.debug("Could not get email thread subject",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",error:P})}e({tabId:A.id,windowId:A.windowId,title:A.title,url:A.url,emailSubject:j}),t.debug("Updated tab info in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",tabId:A.id,windowId:A.windowId,title:A.title,emailSubject:j})}}}catch(A){t.error("Error getting current tab info",A,{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo"})}};b();const E=[];if((S=chrome==null?void 0:chrome.tabs)!=null&&S.onActivated){const R=A=>{t.debug("Tab activated in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabActivated",tabId:A.tabId,windowId:A.windowId}),setTimeout(b,200)};chrome.tabs.onActivated.addListener(R),E.push(()=>{var A,j;(j=(A=chrome==null?void 0:chrome.tabs)==null?void 0:A.onActivated)!=null&&j.removeListener&&chrome.tabs.onActivated.removeListener(R)})}if((T=chrome==null?void 0:chrome.tabs)!=null&&T.onUpdated){const R=(A,j,P)=>{var U;j.url&&P.active&&P.windowId&&(t.debug("Tab URL updated, refreshing tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabUpdated",tabId:A,newUrl:j.url}),setTimeout(b,300)),j.status==="complete"&&P.active&&((U=P.url)!=null&&U.includes("mail.google.com"))&&setTimeout(b,500)};chrome.tabs.onUpdated.addListener(R),E.push(()=>{var A,j;(j=(A=chrome==null?void 0:chrome.tabs)==null?void 0:A.onUpdated)!=null&&j.removeListener&&chrome.tabs.onUpdated.removeListener(R)})}if(s!=null&&s.onThreadChanged){const R=()=>{t.debug("Thread data changed, updating tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleThreadChanged"}),setTimeout(b,100)};s.onThreadChanged(R),E.push(()=>{s.removeThreadListener&&s.removeThreadListener(R)})}const N=setInterval(()=>{b()},3e3);return E.push(()=>{clearInterval(N)}),()=>{E.forEach(R=>R())}},[n,t,s]),n!=="chrome"||!r||!i)return null;const c=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?r.emailSubject.length>50?`${r.emailSubject.substring(0,50)}...`:r.emailSubject:(b=r.url)!=null&&b.includes("mail.google.com")?"Open an email to begin":r.title?r.title.length>30?`${r.title.substring(0,30)}...`:r.title:"No content available"},u=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"border-green-400 bg-green-50 dark:border-green-500 dark:bg-green-950":(b=r.url)!=null&&b.includes("mail.google.com")?"border-yellow-400 bg-yellow-50 dark:border-yellow-500 dark:bg-yellow-950":"border-blue-400 bg-blue-50 dark:border-blue-500 dark:bg-blue-950"},p=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"bg-green-400 dark:bg-green-500":(b=r.url)!=null&&b.includes("mail.google.com")?"bg-yellow-400 dark:bg-yellow-500":"bg-blue-400 dark:bg-blue-500"},m=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-800 dark:text-green-200":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-800 dark:text-yellow-200":"text-blue-800 dark:text-blue-200"},g=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-600 dark:text-green-300":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-600 dark:text-yellow-300":"text-blue-600 dark:text-blue-300"};return d.jsx("div",{className:`border-l-4 p-3 mb-4 rounded-r-md ${u()}`,children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${p()}`})}),d.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[d.jsx("p",{className:`text-sm font-medium ${m()}`,children:r.emailSubject&&r.emailSubject!=="No Subject"?"Email Opened":(x=r.url)!=null&&x.includes("mail.google.com")?"No Email Selected":"Active Tab"}),d.jsx("p",{className:`text-sm ${g()} truncate`,title:r.emailSubject||r.title,children:c()})]})]})})},xK=()=>{const{activeSection:r,setActiveSection:e}=RT(),t=f8(),n=p8(),s=Or(),{platform:i}=tn(),c=u=>{if(s.debug(`toggleSection called with section: "${u}"`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:u,currentActiveSection:r}),r===u){s.debug(`toggleSection called with section: "${u}" but activeSection is already ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:u,currentActiveSection:r});return}else s.debug(`toggleSection called with section: "${u}" changing activeSection from ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:u,currentActiveSection:r}),e(u)};return w.useEffect(()=>{if(t!=null&&t.onMessage){const u=async p=>{if(p.type==="USER_LOGGED_OUT"&&(s.info("Received logout notification in sidepanel",{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"}),n!=null&&n.closeWindow))try{await n.closeWindow()}catch(m){s.error("Failed to close window",m,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"})}};return t.onMessage(u),()=>{t.removeMessageListener&&t.removeMessageListener(u)}}},[t,n,s]),w.useEffect(()=>{if(i==="chrome"&&(t!=null&&t.sendMessage))return t.sendMessage({type:"SIDE_PANEL_MOUNTED"}).catch(()=>{}),()=>{t.sendMessage&&t.sendMessage({type:"SIDE_PANEL_UNMOUNTED"}).catch(()=>{})}},[i,t]),d.jsxs("div",{className:"flex flex-col h-full",children:[r!=="login"&&r!=="Project Documents"&&d.jsx(yK,{}),d.jsx("div",{className:"flex-grow min-h-0",children:d.jsx(vK,{activeSection:r,toggleSection:c})})]})},wK=()=>d.jsx(Kq,{children:d.jsx(xK,{})}),bK=({variant:r})=>{const e=`logo ${r?`logo--${r}`:""}`;return d.jsx("div",{className:e,children:"candle"})},_K=({className:r="",variant:e="badge",showLastChecked:t=!1,hideInLogin:n=!1})=>{const[s,i]=w.useState(!1),{isConnected:c,isLoading:u,error:p,status:m,lastChecked:g,reconnectAttempts:x,wasEverConnected:b,initiateReconnection:E,clearError:N,forceRefresh:S}=Wi(),{platform:T}=tn();if(T!=="chrome"||n)return null;const R=$=>{switch($){case"connected":return d.jsx(Uc,{className:"h-4 w-4 text-green-600"});case"disconnected":return d.jsx(WR,{className:"h-4 w-4 text-amber-600"});case"loading":return d.jsx(Hi,{className:"h-4 w-4 animate-spin text-blue-600"});case"error":return d.jsx(Xf,{className:"h-4 w-4 text-red-600"});default:return d.jsx(Bc,{className:"h-4 w-4 text-gray-400"})}},A=$=>{switch($){case"connected":return"bg-green-50 border-green-200 text-green-800";case"disconnected":return"bg-amber-50 border-amber-200 text-amber-800";case"loading":return"bg-blue-50 border-blue-200 text-blue-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-gray-50 border-gray-200 text-gray-600"}},j=$=>{switch($){case"connected":return"Gmail Connected";case"disconnected":return"Gmail Disconnected";case"loading":return"Checking Connection...";case"error":return"Connection Error";default:return"Unknown Status"}},P=async()=>{try{await E(),i(!1)}catch($){console.error("Failed to reconnect Gmail:",$)}},U=async()=>{try{await S()}catch($){console.error("Failed to refresh connection status:",$)}},B=$=>{if(!$)return"Never checked";const J=new Date().getTime()-$.getTime(),he=Math.floor(J/6e4),te=Math.floor(J%6e4/1e3);return he<1?`${te}s ago`:he<60?`${he}m ago`:`${Math.floor(he/60)}h ago`};return e==="minimal"?d.jsxs("div",{className:`flex items-center gap-1 ${r}`,title:j(m),children:[d.jsx("div",{className:"cursor-pointer",title:j(m),"aria-label":j(m),children:R(m)}),!c&&!u&&d.jsx(ze,{onClick:P,variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",disabled:u,title:b?"Reconnect to Gmail":"Connect to Gmail",children:b?"Reconnect":"Connect"})]}):e==="full"?d.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${A(m)} ${r}`,children:[d.jsxs("div",{className:"flex items-center gap-3",children:[R(m),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm font-medium",children:j(m)}),p&&d.jsx("p",{className:"text-xs mt-1 opacity-80",children:p}),t&&g&&d.jsxs("p",{className:"text-xs mt-1 opacity-60",children:["Last checked: ",B(g)]})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[!c&&!u&&d.jsx(ze,{onClick:P,variant:"outline",size:"sm",className:"text-xs",disabled:u,children:u?d.jsxs(d.Fragment,{children:[d.jsx(Hi,{className:"h-3 w-3 mr-1 animate-spin"}),"Connecting..."]}):b?"Reconnect Gmail":"Connect Gmail"}),d.jsx(ze,{onClick:U,variant:"ghost",size:"sm",className:"p-1",disabled:u,children:d.jsx(wo,{className:`h-3 w-3 ${u?"animate-spin":""}`})}),p&&d.jsx(ze,{onClick:N,variant:"ghost",size:"sm",className:"p-1",children:d.jsx(fi,{className:"h-3 w-3"})})]})]}):d.jsxs(Ns,{open:s,onOpenChange:i,children:[d.jsx(Ts,{asChild:!0,children:d.jsxs(ze,{variant:"ghost",size:"sm",className:`h-8 px-2 flex items-center gap-2 ${A(m)} border hover:opacity-80 ${r}`,"aria-label":`Gmail connection status: ${j(m)}`,"aria-expanded":s,"aria-haspopup":"menu",children:[R(m),d.jsx("span",{className:"text-xs font-medium",children:j(m)})]})}),d.jsxs(os,{align:"end",className:"w-80",children:[d.jsxs("div",{className:"p-3",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[R(m),d.jsx("span",{className:"font-medium text-sm",children:j(m)})]}),p&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-2 mb-3",children:d.jsx("p",{className:"text-xs text-red-800",children:p})}),d.jsxs("div",{className:"text-xs text-gray-600 mb-3",children:[d.jsxs("p",{children:["Last checked: ",B(g)]}),x>0&&d.jsxs("p",{children:["Reconnect attempts: ",x]})]}),m==="connected"&&d.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-2 mb-3",children:d.jsx("p",{className:"text-xs text-green-800",children:"Gmail is connected and working properly. All features are available."})}),m==="disconnected"&&d.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-2 mb-3",children:d.jsx("p",{className:"text-xs text-amber-800",children:b?'Gmail connection lost. Some features may not work properly. Click "Reconnect Gmail" to restore connection.':'Gmail connection required. Some features may not work properly. Click "Connect Gmail" to enable all features.'})})]}),d.jsx(Ry,{}),d.jsxs("div",{className:"p-2",children:[d.jsx(Wn,{asChild:!0,children:d.jsxs(ze,{onClick:U,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:u,children:[d.jsx(wo,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),"Refresh Status"]})}),!c&&d.jsx(Wn,{asChild:!0,children:d.jsx(ze,{onClick:P,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:u,children:u?d.jsxs(d.Fragment,{children:[d.jsx(Hi,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Bc,{className:"h-4 w-4 mr-2"}),b?"Reconnect Gmail":"Connect Gmail"]})})}),p&&d.jsx(Wn,{asChild:!0,children:d.jsxs(ze,{onClick:N,variant:"ghost",size:"sm",className:"w-full justify-start",children:[d.jsx(fi,{className:"h-4 w-4 mr-2"}),"Clear Error"]})})]})]})]})},EK=({className:r="",variant:e="badge",hideInLogin:t=!1})=>{const{platform:n}=tn();if(n!=="outlook"||t)return null;const s="Outlook Connected";return e==="minimal"?d.jsx("div",{className:`flex items-center gap-1 ${r}`,title:s,children:d.jsx("div",{className:"cursor-pointer",title:s,"aria-label":s,children:d.jsx(Uc,{className:"h-4 w-4 text-green-600"})})}):e==="full"?d.jsx("div",{className:`flex items-center justify-between p-3 rounded-lg border bg-green-50 border-green-200 text-green-800 ${r}`,children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Uc,{className:"h-4 w-4 text-green-600"}),d.jsx("div",{className:"flex-1",children:d.jsx("p",{className:"text-sm font-medium",children:s})})]})}):d.jsxs("div",{className:`h-8 px-2 flex items-center gap-2 bg-green-50 border-green-200 text-green-800 border rounded ${r}`,children:[d.jsx(Uc,{className:"h-4 w-4 text-green-600"}),d.jsx("span",{className:"text-xs font-medium",children:s})]})},Mf="src/shared/components/sidepanel/mainPanelContent/panelHeader.tsx",SK=r=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:"18",height:"18",...r,children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),CK=({className:r})=>{const{activeSection:e,setActiveSection:t}=RT(),n=h8(),s=Or(),i=async()=>{if(n!=null&&n.openOptionsPage)try{await n.openOptionsPage()}catch(p){s.error("Failed to open options page",p,{sourceFile:Mf})}else s.warn("Options page opening not available on this platform",{sourceFile:Mf})},c=async()=>{if(n!=null&&n.openURL)try{await n.openURL(KN,"_blank")}catch(p){s.error("Failed to open feedback form",p,{sourceFile:Mf})}else s.warn("openURL not available on this platform",{sourceFile:Mf})},u=async()=>{s.info("Logout initiated",{sourceFile:Mf});try{await $y(s),await EU(s),await hT(s),t("login")}catch(p){s.error("Failed to logout",p,{sourceFile:Mf})}};return d.jsxs("div",{className:`relative flex items-center justify-between px-3 py-2 bg-blue-600 border-b border-gray-200 text-gray-100 ${r}`,children:[d.jsxs("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:[d.jsx(_K,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"}),d.jsx(EK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"})]}),d.jsx("div",{className:"flex-1 flex justify-center",children:d.jsx(bK,{variant:"panel"})}),d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsxs(Ns,{children:[d.jsx(Ts,{asChild:!0,children:d.jsx("button",{className:"p-1 rounded hover:bg-white/10 transition-colors",children:d.jsx(SK,{className:"text-white"})})}),d.jsxs(os,{align:"end",side:"bottom",sideOffset:5,children:[d.jsx(Wn,{onClick:i,children:"Configure"}),d.jsx(Ry,{}),d.jsx(Wn,{onClick:c,children:"Feedback"}),d.jsx(Ry,{}),d.jsx(Wn,{onClick:u,children:"Logout"})]})]})})]})};function _w(){try{const r=Office.context.officeTheme;if(console.log(" Outlook Theme Detection:",r),r){const e=r.bodyBackgroundColor;if(console.log(" Background Color:",e),e){const t=e.replace("#",""),n=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),c=(n+s+i)/3;console.log(` Brightness: ${c} (R:${n}, G:${s}, B:${i})`),c<128?(console.log(" Dark mode detected - applying dark class"),document.documentElement.classList.add("dark")):(console.log(" Light mode detected - removing dark class"),document.documentElement.classList.remove("dark")),console.log(" HTML classes:",document.documentElement.className)}}else console.warn(" Office theme not available")}catch(r){console.error(" Error detecting Outlook theme:",r)}}Office.onReady(()=>{_w(),Office.context.mailbox&&Office.context.mailbox.addHandlerAsync(Office.EventType.OfficeThemeChanged,r=>{console.log(" Office theme changed event triggered"),_w()},r=>{r.status===Office.AsyncResultStatus.Succeeded?console.log(" Office theme change listener added successfully"):console.warn(" Failed to add Office theme change listener:",r.error)}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log(" System color scheme changed:",e.matches?"dark":"light"),_w()}),$O.createRoot(document.getElementById("root")).render(d.jsx(nr.StrictMode,{children:d.jsx(w5,{children:d.jsx(g8,{children:d.jsx(v8,{children:d.jsx(LH,{children:d.jsxs("div",{className:"sidepanel-container",children:[d.jsx(CK,{className:"sticky top-0 z-50 border-b-0"}),d.jsx(wK,{})]})})})})})}))});export{Qu as f,Oy as t};
